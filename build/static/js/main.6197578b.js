/*! For license information please see main.6197578b.js.LICENSE.txt */
(()=>{var e={219:(e,t,r)=>{"use strict";var n=r(3763),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return n.isMemo(e)?o:s[e.$$typeof]||a}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=o;var c=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,m=Object.prototype;e.exports=function e(t,r,n){if("string"!==typeof r){if(m){var a=h(r);a&&a!==m&&e(t,a,n)}var o=d(r);u&&(o=o.concat(u(r)));for(var s=l(t),f=l(r),y=0;y<o.length;++y){var g=o[y];if(!i[g]&&(!n||!n[g])&&(!f||!f[g])&&(!s||!s[g])){var v=p(r,g);try{c(t,g,v)}catch(x){}}}}return t}},280:(e,t,r)=>{const{unifiedDatabase:n,initializeDatabaseConnection:a}=r(8153),{Sequelize:i}=r(8568);let o;async function s(){if(!o){const{db:e}=await a();o=e}return o}const l={FIRE:"fire",WATER:"water",EARTH:"earth",WIND:"wind",LIGHTNING:"lightning",DARKNESS:"darkness",LIGHT:"light",VOID:"void"},c={[l.FIRE]:"#ff4d4d",[l.WATER]:"#4d94ff",[l.EARTH]:"#a67c00",[l.WIND]:"#80ff80",[l.LIGHTNING]:"#ffff4d",[l.DARKNESS]:"#660066",[l.LIGHT]:"#ffff99",[l.VOID]:"#1a1a1a"};let d=[],u={};const p=(e,t)=>{const r=Math.floor(50*e*Math.pow(1.5,t-1)),n=Math.floor(20*e*Math.pow(1.3,t-1)),a={};return e>=5||t>=5?a.gold=Math.max(1,Math.floor(n/100)):e>=3||t>=3?a.silver=Math.max(1,Math.floor(n/3)):a.copper=n,{experience:r,currency:a}};function h(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((e=>{const t={type:e.type,name:e.name,duration:e.duration};return e.damage>0&&(t.damage=e.damage,t.damageType=e.damage_type),e.healing>0&&(t.healing=e.healing),e.stats&&(t.stats=e.stats),t}));return{id:e.technique_id,name:e.name,description:e.description,icon:e.icon,level:e.level,damage:e.damage,damageType:e.damage_type,energyCost:e.energy_cost,cooldown:e.cooldown,effects:t,maxLevel:e.max_level,type:e.type,requiredLevel:e.required_level,healing:e.healing,upgradeCost:t=>p(e.level,t)}}async function m(){try{const e=await s(),t=await n.query("SELECT * FROM techniques",{type:e.QueryTypes.SELECT}),r=`\n      SELECT * FROM technique_effects \n      WHERE technique_id IN (${t.map((e=>e.id)).map((e=>`'${e}'`)).join(",")})\n    `,a=await n.query(r,{type:e.QueryTypes.SELECT}),i={};a.forEach((e=>{i[e.technique_id]||(i[e.technique_id]=[]),i[e.technique_id].push(e)}));const o=t.map((e=>h(e,i[e.id]||[]))),l=o.reduce(((e,t)=>(e[t.level]||(e[t.level]=[]),e[t.level].push(t),e)),{});return d=o,u=l,o}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0442\u0435\u0445\u043d\u0438\u043a \u0438\u0437 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445:",e),d}}m().catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0443\u043b\u044f \u0442\u0435\u0445\u043d\u0438\u043a:",e)})),e.exports={techniqueTypes:{ATTACK:"attack",DEFENSE:"defense",SUPPORT:"support",CULTIVATION:"cultivation"},elementTypes:l,elementColors:c,techniqueCategories:[{id:"all",name:"\u0432\u0441\u0435"},{id:"attack",name:"\u0430\u0442\u0430\u043a\u0443\u044e\u0449\u0438\u0435"},{id:"defense",name:"\u0437\u0430\u0449\u0438\u0442\u043d\u044b\u0435"},{id:"support",name:"\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430"},{id:"cultivation",name:"\u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f"}],techniques:d,techniquesByLevel:u,calculateUpgradeCost:p,loadTechniques:m,getTechniqueByIdAsync:async function(e){try{const t=await s(),r=await n.query("SELECT * FROM techniques WHERE technique_id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT});if(0===r.length)return null;const a=await n.query("SELECT * FROM technique_effects WHERE technique_id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT});return h(r[0],a)}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u0441 ID ${e}:`,t),d.find((t=>t.id===e))||null}},getTechniqueById:function(e){return d.find((t=>t.id===e))||null},getTechniquesByType:async function(e){try{const t=await s(),r=await n.query("SELECT * FROM techniques WHERE type = :type",{replacements:{type:e},type:t.QueryTypes.SELECT});if(0===r.length)return[];const a=`\n      SELECT * FROM technique_effects \n      WHERE technique_id IN (${r.map((e=>e.id)).map((e=>`'${e}'`)).join(",")})\n    `,i=await n.query(a,{type:t.QueryTypes.SELECT}),o={};return i.forEach((e=>{o[e.technique_id]||(o[e.technique_id]=[]),o[e.technique_id].push(e)})),r.map((e=>h(e,o[e.id]||[])))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0442\u0435\u0445\u043d\u0438\u043a \u0442\u0438\u043f\u0430 ${e}:`,t),d.filter((t=>t.type===e))}},getTechniquesByLevel:async function(e){try{const t=await s(),r=await n.query("SELECT * FROM techniques WHERE level = :level",{replacements:{level:e},type:t.QueryTypes.SELECT});if(0===r.length)return[];const a=`\n      SELECT * FROM technique_effects \n      WHERE technique_id IN (${r.map((e=>e.id)).map((e=>`'${e}'`)).join(",")})\n    `,i=await n.query(a,{type:t.QueryTypes.SELECT}),o={};return i.forEach((e=>{o[e.technique_id]||(o[e.technique_id]=[]),o[e.technique_id].push(e)})),r.map((e=>h(e,o[e.id]||[])))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0442\u0435\u0445\u043d\u0438\u043a \u0443\u0440\u043e\u0432\u043d\u044f ${e}:`,t),u[e]||[]}}}},357:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){s.belongsTo(e.User,{foreignKey:"userId",as:"user"})}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{userId:{type:a.INTEGER,references:{model:"Users",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE",unique:!0},stage:{type:a.ENUM("\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430","\u041e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0426\u0438","\u0417\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e","\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438"),defaultValue:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430"},level:{type:a.INTEGER,defaultValue:1},experience:{type:a.INTEGER,defaultValue:0},experienceToNextLevel:{type:a.INTEGER,defaultValue:100},breakthroughProgress:{type:a.INTEGER,defaultValue:0},dailyCultivationLimit:{type:a.INTEGER,defaultValue:1e3},dailyCultivationUsed:{type:a.INTEGER,defaultValue:0},lastCultivationReset:{type:a.DATE,defaultValue:a.NOW},energy:{type:a.INTEGER,defaultValue:100},maxEnergy:{type:a.INTEGER,defaultValue:100},tribulationCompleted:{type:a.BOOLEAN,defaultValue:!1},insightPoints:{type:a.INTEGER,defaultValue:0},bottleneckProgress:{type:a.INTEGER,defaultValue:0},requiredBottleneckProgress:{type:a.INTEGER,defaultValue:100},lastInsightTime:{type:a.DATE,defaultValue:a.NOW},cultivationEfficiency:{type:a.FLOAT,defaultValue:1},requiredResources:{type:a.JSON,defaultValue:{}}},{sequelize:e,modelName:"CultivationProgress",tableName:"CultivationProgress"})},(async()=>{try{await s.init(),console.log("CultivationProgress \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 CultivationProgress:",e),console.error(e.stack)}})(),e.exports=s},480:(e,t,r)=>{"use strict";async function n(e){const t=new TextEncoder,r=(t.encode(e),e+"cultivationPathToImmortality"),n=t.encode(r),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map((e=>e.toString(16).padStart(2,"0"))).join("")}async function a(e,t){return await n(e)===t}r.d(t,{E:()=>n,b:()=>a})},528:(e,t)=>{"use strict";var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler");Symbol.for("react.provider");var s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen"),f=Symbol.for("react.client.reference");function y(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case a:case o:case i:case d:case u:return e;default:switch(e=e&&e.$$typeof){case l:case c:case h:case p:case s:return e;default:return t}}case n:return t}}}t.Hy=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===o||e===i||e===d||e===u||e===m||"object"===typeof e&&null!==e&&(e.$$typeof===h||e.$$typeof===p||e.$$typeof===l||e.$$typeof===s||e.$$typeof===c||e.$$typeof===f||void 0!==e.getModuleId)},t.QP=y},579:(e,t,r)=>{"use strict";e.exports=r(1153)},592:(e,t,r)=>{"use strict";r.r(t),r.d(t,{checkAndNormalizeSectData:()=>u,cleanEffects:()=>i,collectAllSectBenefits:()=>s,createCleanEffect:()=>n,createNormalizedSectData:()=>d,getBenefitValueByType:()=>l,getSectEffectsObject:()=>c,normalizeSectBenefits:()=>o,normalizeSectData:()=>p,sectBenefitsToEffects:()=>a});r(685);const n=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n="neutral",a="\u26aa";t>0?(n="positive",a="\ud83d\udd3c"):t<0&&(n="negative",a="\ud83d\udd3d");let i=e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ");return r.name&&(i=r.name.replace(/\s*\([^)]*\)\s*$/,"")),{type:e,modifier:t,displayType:n,displayValue:`${t>0?"+":""}${t}%`,icon:a,name:i}},a=e=>e&&Array.isArray(e)?e.map((e=>{let t;switch(e.type){case"cultivation_speed":t="cultivation_bonus";break;case"resource_gathering":t="resource_bonus";break;case"energy_regen":t="energy_regen";break;case"technique_discount":t="technique_discount";break;case"max_energy":t="max_energy";break;default:t=e.type}const r={name:e.name||""};return n(t,e.modifier,r)})):[],i=e=>{if(!e)return[];return(Array.isArray(e)?e:Object.values(e)).map((e=>"object"!==typeof e||null===e?n("unknown",0):n(e.type||"unknown",e.modifier||0,{name:e.name||""})))},o=e=>Array.isArray(e)?e.map((e=>({type:e.type,modifier:"number"===typeof e.modifier?e.modifier:0}))):e&&"object"===typeof e?[{type:"cultivation_speed",modifier:Math.round(100*(e.cultivationSpeedBonus||0))},{type:"resource_gathering",modifier:Math.round(100*(e.resourceGatheringBonus||0))},{type:"energy_regen",modifier:e.energyRegenBonus||0},{type:"technique_discount",modifier:Math.round(100*(e.techniqueDiscountPercent||0))},{type:"max_energy",modifier:e.maxEnergyBonus||0}]:[],s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=[];e&&e.benefits&&r.push(...o(e.benefits)),t&&t.benefits&&t!==e&&r.push(...o(t.benefits));const n={};return r.forEach((e=>{const t=e.type;(!n[t]||Math.abs(e.modifier)>Math.abs(n[t].modifier))&&(n[t]=e)})),Object.values(n)},l=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!Array.isArray(e)||0===e.length)return r;const n=e.find((e=>e.type===t));return n?n.modifier:r},c=e=>{const t=a(e),r={};return t.forEach((e=>{r[e.type]=e})),r},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=s(e,t),n=a(r);return{...t||(null===e||void 0===e?void 0:e.sect)||{},normalizedBenefits:r,effectsArray:n,getBenefitValue:function(e){return l(r,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}}},u=e=>{const t=(null===e||void 0===e?void 0:e.sect)||{};if(!t.sect)return console.log("\u2753 \u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u0441\u0435\u043a\u0442\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0438\u043b\u0438 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b, \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443"),e;let r=!1;const n={...t};if(t.benefits&&(Array.isArray(t.benefits)?t.benefits.some((e=>"object"!==typeof e||"string"!==typeof e.type||"number"!==typeof e.modifier))&&(console.log("\u26a0\ufe0f \u041d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b \u0441\u0435\u043a\u0442\u044b \u0438\u043c\u0435\u044e\u0442 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442, \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0443\u0435\u043c"),n.benefits=o(t.benefits),r=!0):(console.log("\u26a0\ufe0f \u0411\u043e\u043d\u0443\u0441\u044b \u0441\u0435\u043a\u0442\u044b \u043d\u0435 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u043c\u0430\u0441\u0441\u0438\u0432\u0430, \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0443\u0435\u043c"),n.benefits=o(t.benefits),r=!0)),n.sect){const e={...n.sect};e.benefits&&(Array.isArray(e.benefits)?e.benefits.some((e=>"object"!==typeof e||"string"!==typeof e.type||"number"!==typeof e.modifier))&&(console.log("\u26a0\ufe0f \u041d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b \u0432\u043d\u0443\u0442\u0440\u0438 \u0441\u0435\u043a\u0442\u044b \u0438\u043c\u0435\u044e\u0442 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442, \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0443\u0435\u043c"),e.benefits=o(e.benefits),r=!0):(console.log("\u26a0\ufe0f \u0411\u043e\u043d\u0443\u0441\u044b \u0432\u043d\u0443\u0442\u0440\u0438 \u0441\u0435\u043a\u0442\u044b \u043d\u0435 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u043c\u0430\u0441\u0441\u0438\u0432\u0430, \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0443\u0435\u043c"),e.benefits=o(e.benefits),r=!0)),e.id&&e.name||(console.log("\u26a0\ufe0f \u0412 \u043e\u0431\u044a\u0435\u043a\u0442\u0435 \u0441\u0435\u043a\u0442\u044b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f (id \u0438\u043b\u0438 name)"),r=!0),n.sect=e}return r?(console.log("\ud83d\udd27 \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u044b \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b, \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435"),{...e,sect:n}):e},p=e=>{if(!e||!e.sect)return e;const t=o(e.benefits||[]);let r={...e.sect};r.benefits&&(r.benefits=o(r.benefits));const n=a(t);return{...e,benefits:t,sect:r,effectsArray:n,getBenefitValue:function(e){return l(t,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}}}},685:(e,t,r)=>{"use strict";r.d(t,{IC:()=>a,N9:()=>i});const n={resource_bonus:"\u0411\u043e\u043d\u0443\u0441 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432",cultivation_bonus:"\u041a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",movement_speed:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f",movement_penalty:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f",perception:"\u0412\u043e\u0441\u043f\u0440\u0438\u044f\u0442\u0438\u0435",combat_damage:"\u0423\u0440\u043e\u043d \u0432 \u0431\u043e\u044e",energy_regen:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",stealth:"\u0421\u043a\u0440\u044b\u0442\u043d\u043e\u0441\u0442\u044c",cultivation_insight:"\u0428\u0430\u043d\u0441 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435",special_resources:"\u041e\u0441\u043e\u0431\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b",special_encounters:"\u041e\u0441\u043e\u0431\u044b\u0435 \u0432\u0441\u0442\u0440\u0435\u0447\u0438",market_discount:"\u0421\u043a\u0438\u0434\u043a\u0430 \u043d\u0430 \u0440\u044b\u043d\u043a\u0435",double_loot:"\u0428\u0430\u043d\u0441 \u0434\u0432\u043e\u0439\u043d\u043e\u0439 \u0434\u043e\u0431\u044b\u0447\u0438",reduced_encounter:"\u0421\u043d\u0438\u0436\u0435\u043d\u0438\u0435 \u0448\u0430\u043d\u0441\u0430 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0445 \u0432\u0441\u0442\u0440\u0435\u0447",resistance_required:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0441\u043e\u043f\u0440\u043e\u0442\u0438\u0432\u043b\u0435\u043d\u0438\u0435",energy_drain:"\u0420\u0430\u0441\u0445\u043e\u0434 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",max_energy:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f",fire_cultivation:"\u041e\u0433\u043d\u0435\u043d\u043d\u0430\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",water_cultivation:"\u0412\u043e\u0434\u043d\u0430\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",earth_cultivation:"\u0417\u0435\u043c\u043b\u044f\u043d\u0430\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",wind_cultivation:"\u041a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f \u0432\u0435\u0442\u0440\u0430",lightning_cultivation:"\u041a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f \u043c\u043e\u043b\u043d\u0438\u0438",dark_cultivation:"\u0422\u0451\u043c\u043d\u0430\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",light_cultivation:"\u0421\u0432\u0435\u0442\u043b\u0430\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",gathering_speed:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0441\u0431\u043e\u0440\u0430",mineral_bonus:"\u0411\u043e\u043d\u0443\u0441 \u043c\u0438\u043d\u0435\u0440\u0430\u043b\u043e\u0432",herbs:"\u0421\u0431\u043e\u0440 \u0442\u0440\u0430\u0432",ores:"\u0421\u0431\u043e\u0440 \u0440\u0443\u0434",crystals:"\u0421\u0431\u043e\u0440 \u043a\u0440\u0438\u0441\u0442\u0430\u043b\u043b\u043e\u0432",food:"\u0421\u0431\u043e\u0440 \u043f\u0438\u0449\u0438","combat_damage (thunderstorm)":"\u0423\u0440\u043e\u043d \u0432 \u0431\u043e\u044e (\u0433\u0440\u043e\u0437\u0430)","gathering_speed (thunderstorm)":"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0441\u0431\u043e\u0440\u0430 (\u0433\u0440\u043e\u0437\u0430)","lightning_cultivation (thunderstorm)":"\u041a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f \u043c\u043e\u043b\u043d\u0438\u0438 (\u0433\u0440\u043e\u0437\u0430)","movement_speed (thunderstorm)":"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u044f (\u0433\u0440\u043e\u0437\u0430)","perception (thunderstorm)":"\u0412\u043e\u0441\u043f\u0440\u0438\u044f\u0442\u0438\u0435 (\u0433\u0440\u043e\u0437\u0430)","resource_bonus (thunderstorm)":"\u0411\u043e\u043d\u0443\u0441 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 (\u0433\u0440\u043e\u0437\u0430)"},a=e=>{const t=[],a=[];if(Array.isArray(e.player.statusEffects)&&t.push(...e.player.statusEffects),e.player.sect&&Array.isArray(e.player.sect.benefits)&&t.push(...e.player.sect.benefits),e.player.inventory&&e.player.inventory.equipment){const r=e.player.inventory.equipment;Object.values(r).forEach((e=>{e&&Array.isArray(e.effects)&&t.push(...e.effects)}))}if(e.player.spiritPets&&e.player.spiritPets.activePetId&&e.player.spiritPets.pets){const r=e.player.spiritPets.pets.find((t=>t.id===e.player.spiritPets.activePetId));r&&Array.isArray(r.effects)&&t.push(...r.effects)}if(e.world&&e.world.weather){const r=Array.isArray(e.world.weather.effects)?e.world.weather.effects:Array.isArray(e.world.weather.weatherEffects)?e.world.weather.weatherEffects:[];r.length>0&&("thunderstorm"===e.world.weather.currentWeather?r.forEach((e=>{a.push(((e,t)=>{const r={id:`${e}_thunderstorm`,type:`${e}_thunderstorm`,modifier:t,icon:"\u26a1",displayValue:`${t>0?"+":""}${t}%`};return r.displayType=t>0?"positive":t<0?"negative":"neutral",r.name=n[`${e} (thunderstorm)`]?n[`${e} (thunderstorm)`]:`${e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ")} (\u0433\u0440\u043e\u0437\u0430)`,r})(e.type,e.modifier||e.value||0))})):t.push(...r))}e.world&&e.world.currentLocation&&Array.isArray(e.world.currentLocation.effects)&&t.push(...e.world.currentLocation.effects),e.gameState&&e.gameState.combat&&e.gameState.combat.active&&Array.isArray(e.gameState.combat.temporaryEffects)&&t.push(...e.gameState.combat.temporaryEffects);const i=t.filter((e=>null!==e&&void 0!==e)),{mergeEffects:o}=r(6433);return[...o(i),...a]},i=e=>{const t={};if(t.type=e.type||"unknown","number"===typeof e.modifier)t.modifier=e.modifier;else if("string"===typeof e.value){const r=e.value.match(/([+-]?\d+(?:\.\d+)?)%?/);if(r){const e=parseFloat(r[1]);t.modifier=r[0].includes("%")?e/100:e}else t.modifier=0}else"number"===typeof e.value?t.modifier=e.value:t.modifier=0;let r=t.type;t.name=n[r]?n[r]:t.type.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),t.modifier>0?t.displayType="positive":t.modifier<0?t.displayType="negative":t.displayType="neutral";const a=Math.abs(t.modifier);let i;return i=a<1&&a>0?`${t.modifier>0?"+":"-"}${(100*a).toFixed(0)}%`:`${t.modifier>0?"+":"-"}${a}%`,t.displayValue=i,t.icon="positive"===t.displayType?"\u2728":"negative"===t.displayType?"\ud83d\udd3b":"\u26aa",t.id=t.type,t}},870:(e,t,r)=>{const{calculateMerchantDiscount:n,applyLoyaltyDiscount:a}=r(3603),{unifiedDatabase:i,initializeDatabaseConnection:o}=r(8153),{Sequelize:s}=r(8568);let l;async function c(){if(!l){const{db:e}=await o();l=e}return l}async function d(e){try{const t=await c(),r=await i.query('SELECT * FROM merchant_inventories WHERE "merchantId" = :merchantId',{replacements:{merchantId:e.id},type:t.QueryTypes.SELECT}),n=await Promise.all(r.map((async e=>{const t=await c(),r=await i.query("SELECT * FROM item_effects WHERE item_id = :itemId",{replacements:{itemId:e.id},type:t.QueryTypes.SELECT}),n=await i.query("SELECT * FROM item_requirements WHERE item_id = :itemId",{replacements:{itemId:e.id},type:t.QueryTypes.SELECT}),a={};return r.length>0&&(a.effects=r.map((e=>({type:e.type,target:e.target,value:parseFloat(e.value),operation:e.operation,duration:e.duration?parseInt(e.duration):void 0})))),n.length>0&&(a.requirements={},n.forEach((e=>{a.requirements[e.type]=e.value}))),"pet_food"===e.itemType&&(a.nutritionValue=e.nutritionValue||0,a.loyaltyBonus=e.loyaltyBonus||0),{itemId:e.itemId,itemType:e.itemType,name:e.name,description:e.description,basePrice:e.price,quantity:e.quantity,maxQuantity:e.maxQuantity||e.quantity,restockRate:parseFloat(e.restockRate||0),lastRestockTime:e.lastRestockTime||0,rarity:e.rarity,...Object.keys(a).length>0?{properties:a}:{}}})));return{id:e.id,name:e.name,description:e.description,location:e.location,specialization:e.specialization,reputation:e.reputation||75,items:n}}catch(t){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0430:",t),{id:e.id,name:e.name,description:e.description,location:e.location,specialization:e.specialization,reputation:e.reputation||75,items:[]}}}async function u(){try{const e=await c(),t=await i.query("SELECT * FROM merchants",{type:e.QueryTypes.SELECT});return Promise.all(t.map(d))}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0435\u0432 \u0438\u0437 \u0411\u0414:",e),p}}(async function(){try{return p=await u(),p}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0435\u0432:",e),p}})().catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0435\u0432:",e)}));let p=[];e.exports={merchants:p,getAllMerchants:u,getMerchantById:async function(e){try{const t=await c(),[r]=await i.query("SELECT * FROM merchants WHERE id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT});return r?d(r):null}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0430 \u0441 ID ${e} \u0438\u0437 \u0411\u0414:`,t),p.find((t=>t.id===e))||null}},getMerchantsByLocation:async function(e){try{const t=await c(),r=await i.query("SELECT * FROM merchants WHERE location = :location",{replacements:{location:e},type:t.QueryTypes.SELECT});return Promise.all(r.map(d))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0435\u0432 \u0438\u0437 \u043b\u043e\u043a\u0430\u0446\u0438\u0438 ${e}:`,t),p.filter((t=>t.location===e))}},getMerchantsBySpecialization:async function(e){try{const t=await c(),r=await i.query("SELECT * FROM merchants WHERE specialization = :specialization",{replacements:{specialization:e},type:t.QueryTypes.SELECT});return Promise.all(r.map(d))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0435\u0432 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 ${e}:`,t),p.filter((t=>t.specialization===e))}},calculatePrice:function(e,t,r){const n=1+(100-t)/100,i=Math.round(e*n),{finalPrice:o}=a(i,r);return Math.round(o)},restockMerchantItems:async function(e){try{const t=await c();let r=!1;const n=await i.query("SELECT * FROM merchant_inventories",{type:t.QueryTypes.SELECT});for(const a of n){if(-1===a.quantity)continue;if(void 0===a.maxQuantity||void 0===a.restockRate||void 0===a.lastRestockTime)continue;if(a.quantity>=a.maxQuantity)continue;const n=(e-a.lastRestockTime)/24;if(n<.1)continue;const o=Math.floor(n*a.restockRate);if(o>0){const n=a.quantity;a.quantity=Math.min(a.maxQuantity,a.quantity+o),a.lastRestockTime=e,await i.query('UPDATE merchant_inventories SET quantity = :quantity, "lastRestockTime" = :lastRestockTime WHERE id = :id',{replacements:{quantity:a.quantity,lastRestockTime:a.lastRestockTime,id:a.id},type:t.QueryTypes.UPDATE}),n!==a.quantity&&(r=!0)}}return p&&p.length>0&&r&&(p=await u()),r}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0442\u043e\u0432\u0430\u0440\u043e\u0432:",t);let r=!1;return p.forEach((t=>{t.items&&t.items.length>0&&t.items.forEach((t=>{if(void 0!==t.maxQuantity&&void 0!==t.restockRate&&void 0!==t.lastRestockTime&&t.quantity<t.maxQuantity){const n=(e-t.lastRestockTime)/24;if(n>=.1){const a=Math.floor(n*t.restockRate);if(a>0){const n=t.quantity;t.quantity=Math.min(t.maxQuantity,t.quantity+a),t.lastRestockTime=e,n!==t.quantity&&(r=!0)}}}}))})),r}},addEquipmentToMerchant:async function(e){if(console.log(`\u0412\u044b\u0437\u0432\u0430\u043d\u0430 \u0444\u0443\u043d\u043a\u0446\u0438\u044f addEquipmentToMerchant \u0434\u043b\u044f \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0430: ${(null===e||void 0===e?void 0:e.name)||"\u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u0435\u043d"}`),!e)return console.warn("\u041f\u0435\u0440\u0435\u0434\u0430\u043d \u043f\u0443\u0441\u0442\u043e\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0430, \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439"),e;try{const t=await c(),[r]=await i.query("SELECT * FROM merchants WHERE id = :id",{replacements:{id:e.id},type:t.QueryTypes.SELECT});return r?d(r):(console.warn(`\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446 \u0441 ID ${e.id} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0411\u0414, \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u0431\u0435\u0437 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0439`),e)}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0443 ${e.name}:`,t),e}},addAlchemyItemsToMerchants:async function(e){try{return await u()}catch(t){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0430\u043b\u0445\u0438\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u043e\u0432:",t),e}}}},1153:(e,t,r)=>{"use strict";var n=r(5043),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,i={},c=null,d=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,n)&&!l.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:a,type:e,key:c,ref:d,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},1429:(e,t,r)=>{const n=r(357),a=(r(3382),r(5033)),i="undefined"!==typeof window;let o={};e.exports=class{static async getCultivationProgress(e){try{if(i){o[e]||(o[e]={userId:e,stage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",level:1,experience:0,experienceToNextLevel:100,breakthroughProgress:0,dailyCultivationLimit:1e3,dailyCultivationUsed:0,lastCultivationReset:new Date,energy:100,maxEnergy:100,tribulationCompleted:!1,insightPoints:0,bottleneckProgress:0,requiredBottleneckProgress:100,lastInsightTime:new Date,cultivationEfficiency:1,requiredResources:{}});const t=o[e];return{stage:t.stage,level:t.level,experience:t.experience,experienceToNextLevel:t.experienceToNextLevel,energy:t.energy,maxEnergy:t.maxEnergy,tribulationCompleted:t.tribulationCompleted,insightPoints:t.insightPoints,bottleneckProgress:t.bottleneckProgress,requiredBottleneckProgress:t.requiredBottleneckProgress,cultivationEfficiency:t.cultivationEfficiency,requiredResources:t.requiredResources}}{let t=await n.findOne({where:{userId:e}});return t||(t=await n.create({userId:e,stage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",level:1,experience:0,experienceToNextLevel:100,breakthroughProgress:0,dailyCultivationLimit:1e3,dailyCultivationUsed:0,lastCultivationReset:new Date,energy:100,maxEnergy:100,tribulationCompleted:!1,insightPoints:0,bottleneckProgress:0,requiredBottleneckProgress:100,lastInsightTime:new Date,cultivationEfficiency:1,requiredResources:{}})),{stage:t.stage,level:t.level,experience:t.experience,experienceToNextLevel:t.experienceToNextLevel,energy:t.energy,maxEnergy:t.maxEnergy,tribulationCompleted:t.tribulationCompleted,insightPoints:t.insightPoints,bottleneckProgress:t.bottleneckProgress,requiredBottleneckProgress:t.requiredBottleneckProgress,cultivationEfficiency:t.cultivationEfficiency,requiredResources:t.requiredResources}}}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438:",t),t}}static async updateCultivationProgress(e,t){try{if(i){o[e]||(o[e]={userId:e,stage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",level:1,experience:0,experienceToNextLevel:100,breakthroughProgress:0,dailyCultivationLimit:1e3,dailyCultivationUsed:0,lastCultivationReset:new Date,energy:100,maxEnergy:100,tribulationCompleted:!1,insightPoints:0,bottleneckProgress:0,requiredBottleneckProgress:100,lastInsightTime:new Date,cultivationEfficiency:1,requiredResources:{}}),void 0!==t.stage&&null!==t.stage&&(o[e].stage="string"===typeof t.stage?t.stage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430"),void 0!==t.level&&(o[e].level=t.level),void 0!==t.experience&&(o[e].experience=t.experience),void 0!==t.experienceToNextLevel&&(o[e].experienceToNextLevel=t.experienceToNextLevel),void 0!==t.energy&&(o[e].energy=t.energy),void 0!==t.maxEnergy&&(o[e].maxEnergy=t.maxEnergy),void 0!==t.tribulationCompleted&&(o[e].tribulationCompleted=t.tribulationCompleted),void 0!==t.insightPoints&&(o[e].insightPoints=t.insightPoints),void 0!==t.bottleneckProgress&&(o[e].bottleneckProgress=t.bottleneckProgress),void 0!==t.requiredBottleneckProgress&&(o[e].requiredBottleneckProgress=t.requiredBottleneckProgress),void 0!==t.cultivationEfficiency&&(o[e].cultivationEfficiency=t.cultivationEfficiency),void 0!==t.requiredResources&&(o[e].requiredResources=t.requiredResources);const r=o[e];return{stage:r.stage,level:r.level,experience:r.experience,experienceToNextLevel:r.experienceToNextLevel,energy:r.energy,maxEnergy:r.maxEnergy,tribulationCompleted:r.tribulationCompleted,insightPoints:r.insightPoints,bottleneckProgress:r.bottleneckProgress,requiredBottleneckProgress:r.requiredBottleneckProgress,cultivationEfficiency:r.cultivationEfficiency,requiredResources:r.requiredResources}}{let r=await n.findOne({where:{userId:e}});r||(r=await n.create({userId:e,stage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",level:1,experience:0,experienceToNextLevel:100,breakthroughProgress:0,dailyCultivationLimit:1e3,dailyCultivationUsed:0,lastCultivationReset:new Date,energy:100,maxEnergy:100,tribulationCompleted:!1,insightPoints:0,bottleneckProgress:0,requiredBottleneckProgress:100,lastInsightTime:new Date,cultivationEfficiency:1,requiredResources:{}}));const a={};return void 0!==t.stage&&null!==t.stage&&(a.stage="string"===typeof t.stage?t.stage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430"),void 0!==t.level&&(a.level=t.level),void 0!==t.experience&&(a.experience=t.experience),void 0!==t.experienceToNextLevel&&(a.experienceToNextLevel=t.experienceToNextLevel),void 0!==t.energy&&(a.energy=t.energy),void 0!==t.maxEnergy&&(a.maxEnergy=t.maxEnergy),void 0!==t.tribulationCompleted&&(a.tribulationCompleted=t.tribulationCompleted),void 0!==t.insightPoints&&(a.insightPoints=t.insightPoints),void 0!==t.bottleneckProgress&&(a.bottleneckProgress=t.bottleneckProgress),void 0!==t.requiredBottleneckProgress&&(a.requiredBottleneckProgress=t.requiredBottleneckProgress),void 0!==t.cultivationEfficiency&&(a.cultivationEfficiency=t.cultivationEfficiency),void 0!==t.requiredResources&&(a.requiredResources=t.requiredResources),await r.update(a),r=await n.findOne({where:{userId:e}}),{stage:r.stage,level:r.level,experience:r.experience,experienceToNextLevel:r.experienceToNextLevel,energy:r.energy,maxEnergy:r.maxEnergy,tribulationCompleted:r.tribulationCompleted,insightPoints:r.insightPoints,bottleneckProgress:r.bottleneckProgress,requiredBottleneckProgress:r.requiredBottleneckProgress,cultivationEfficiency:r.cultivationEfficiency,requiredResources:r.requiredResources}}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438:",r),r}}static generateBreakthroughRequirements(e,t){const r={resources:{},tribulation:null,bottleneckProgress:0};switch(r.resources=a.getBreakthroughResources(e,t),e.toLowerCase()){case"\u0437\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430":default:r.bottleneckProgress=10*t;break;case"\u043e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0446\u0438":r.bottleneckProgress=15*t;break;case"\u0437\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e":r.bottleneckProgress=20*t;break;case"\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438":r.bottleneckProgress=25*t}if(3===t||6===t||9===t)switch(e.toLowerCase()){case"\u0437\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430":r.tribulation={type:"\u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f",difficulty:10*t,description:"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u043d\u0430 \u0432\u044b\u043d\u043e\u0441\u043b\u0438\u0432\u043e\u0441\u0442\u044c \u0438 \u0441\u0438\u043b\u0443 \u0442\u0435\u043b\u0430"};break;case"\u043e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0446\u0438":r.tribulation={type:"\u044d\u043d\u0435\u0440\u0433\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f",difficulty:15*t,description:"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0438 \u043c\u0435\u0440\u0438\u0434\u0438\u0430\u043d\u043e\u0432"};break;case"\u0437\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e":r.tribulation={type:"\u0433\u0440\u043e\u0437\u043e\u0432\u0430\u044f",difficulty:20*t,description:"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u043d\u0430 \u0441\u0442\u043e\u0439\u043a\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434 \u0441\u0442\u0438\u0445\u0438\u0439\u043d\u044b\u043c\u0438 \u0441\u0438\u043b\u0430\u043c\u0438"};break;case"\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438":r.tribulation={type:"\u0434\u0443\u0445\u043e\u0432\u043d\u0430\u044f",difficulty:25*t,description:"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u043d\u0430 \u0441\u0438\u043b\u0443 \u0434\u0443\u0445\u0430 \u0438 \u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u0443\u044e \u0441\u0442\u043e\u0439\u043a\u043e\u0441\u0442\u044c"};break;default:r.tribulation={type:"\u0431\u0430\u0437\u043e\u0432\u0430\u044f",difficulty:10*t,description:"\u0411\u0430\u0437\u043e\u0432\u043e\u0435 \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"}}return r}static async checkBreakthroughPossibility(e){try{let t;if(i){if(t=o[e],!t)return{canBreakthrough:!1,requirements:null,missingRequirements:null,message:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"}}else if(t=await n.findOne({where:{userId:e}}),!t)return{canBreakthrough:!1,requirements:null,missingRequirements:null,message:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"};const r=t.experience>=t.experienceToNextLevel,a=t.energy>=.8*t.maxEnergy,s=3===t.level||6===t.level||9===t.level,l=!s||t.tribulationCompleted,c=t.bottleneckProgress>=t.requiredBottleneckProgress,d=this.generateBreakthroughRequirements(t.stage,t.level),u=!0,p=r&&a&&l&&c&&u,h=[];return r||h.push(`\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043e\u043f\u044b\u0442\u0430 (${t.experience}/${t.experienceToNextLevel})`),a||h.push("\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u044d\u043d\u0435\u0440\u0433\u0438\u0438 (\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f 80% \u043e\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c\u0430)"),s&&!l&&h.push(`\u041d\u0435 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f (${d.tribulation.type})`),c||h.push(`\u041d\u0435 \u043f\u0440\u0435\u043e\u0434\u043e\u043b\u0435\u043d\u043e "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0435 \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u043e" (${t.bottleneckProgress}/${t.requiredBottleneckProgress})`),u||h.push("\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0434\u043b\u044f \u043f\u0440\u043e\u0440\u044b\u0432\u0430"),{canBreakthrough:p,requirements:d,missingRequirements:h,message:p?"\u0412\u044b \u0433\u043e\u0442\u043e\u0432\u044b \u043a \u043f\u0440\u043e\u0440\u044b\u0432\u0443!":"\u0414\u043b\u044f \u043f\u0440\u043e\u0440\u044b\u0432\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f"}}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u043e\u0440\u044b\u0432\u0430:",t),t}}static async completeTribulation(e,t){try{if(i){const r=o[e];return r?t.success?(r.tribulationCompleted=!0,{success:!0,message:"\u0422\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430!",rewards:t.rewards||{}}):{success:!1,message:t.message||"\u0422\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f \u043d\u0435 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430",penalties:t.penalties||{}}:{success:!1,message:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"}}{const r=await n.findOne({where:{userId:e}});return r?t.success?(await r.update({tribulationCompleted:!0}),{success:!0,message:"\u0422\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430!",rewards:t.rewards||{}}):{success:!1,message:t.message||"\u0422\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f \u043d\u0435 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430",penalties:t.penalties||{}}:{success:!1,message:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"}}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u0438:",r),r}}static async increaseBottleneckProgress(e,t){try{if(i){const r=o[e];if(!r)return{success:!1,message:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"};const n=Math.min(r.bottleneckProgress+t,r.requiredBottleneckProgress);r.bottleneckProgress=n;const a=n>=r.requiredBottleneckProgress;return{success:!0,bottleneckProgress:n,requiredBottleneckProgress:r.requiredBottleneckProgress,isCompleted:a,message:a?'\u0412\u044b \u043f\u0440\u0435\u043e\u0434\u043e\u043b\u0435\u043b\u0438 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0435 \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u043e"!':`\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d (${n}/${r.requiredBottleneckProgress})`}}{const r=await n.findOne({where:{userId:e}});if(!r)return{success:!1,message:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"};const a=Math.min(r.bottleneckProgress+t,r.requiredBottleneckProgress);await r.update({bottleneckProgress:a});const i=a>=r.requiredBottleneckProgress;return{success:!0,bottleneckProgress:a,requiredBottleneckProgress:r.requiredBottleneckProgress,isCompleted:i,message:i?'\u0412\u044b \u043f\u0440\u0435\u043e\u0434\u043e\u043b\u0435\u043b\u0438 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0435 \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u043e"!':`\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d (${a}/${r.requiredBottleneckProgress})`}}}catch(r){throw console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u0430":',r),r}}static async gainInsight(e){try{if(i){const t=o[e];if(!t)return{success:!1,message:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"};const r=new Date,n=(r-new Date(t.lastInsightTime))/36e5;if(n<24)return{success:!1,message:"\u0412\u044b \u043d\u0435\u0434\u0430\u0432\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.",hoursRemaining:24-n};const a=Math.floor(4*Math.random());let i={},s="";switch(a){case 0:const e=.1+.2*Math.random();i={cultivationEfficiency:Math.min(t.cultivationEfficiency+e,2)},s=`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u042d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0430 \u043d\u0430 ${Math.floor(100*e)}%.`;break;case 1:const r=Math.floor(t.requiredBottleneckProgress*(.1+.2*Math.random()));i={bottleneckProgress:Math.min(t.bottleneckProgress+r,t.requiredBottleneckProgress)},s=`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u0430" \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d \u043d\u0430 ${r} \u0435\u0434\u0438\u043d\u0438\u0446.`;break;case 2:const n=Math.floor(t.experienceToNextLevel*(.1+.2*Math.random()));i={experience:t.experience+n},s=`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e ${n} \u0435\u0434\u0438\u043d\u0438\u0446 \u043e\u043f\u044b\u0442\u0430 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438.`;break;case 3:const a=Math.floor(t.maxEnergy*(.05+.1*Math.random()));i={maxEnergy:t.maxEnergy+a,energy:t.energy+a},s=`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0430 \u043d\u0430 ${a} \u0435\u0434\u0438\u043d\u0438\u0446.`}return void 0!==i.cultivationEfficiency&&(t.cultivationEfficiency=i.cultivationEfficiency),void 0!==i.bottleneckProgress&&(t.bottleneckProgress=i.bottleneckProgress),void 0!==i.experience&&(t.experience=i.experience),void 0!==i.maxEnergy&&(t.maxEnergy=i.maxEnergy,t.energy=i.energy),t.insightPoints=(t.insightPoints||0)+1,t.lastInsightTime=r,{success:!0,message:s,effect:i}}{const t=await n.findOne({where:{userId:e}});if(!t)return{success:!1,message:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"};const r=new Date,a=(r-new Date(t.lastInsightTime))/36e5;if(a<24)return{success:!1,message:"\u0412\u044b \u043d\u0435\u0434\u0430\u0432\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.",hoursRemaining:24-a};const i=Math.floor(4*Math.random());let o={},s="";switch(i){case 0:const e=.1+.2*Math.random();o={cultivationEfficiency:Math.min(t.cultivationEfficiency+e,2)},s=`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u042d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0430 \u043d\u0430 ${Math.floor(100*e)}%.`;break;case 1:const r=Math.floor(t.requiredBottleneckProgress*(.1+.2*Math.random()));o={bottleneckProgress:Math.min(t.bottleneckProgress+r,t.requiredBottleneckProgress)},s=`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u0430" \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d \u043d\u0430 ${r} \u0435\u0434\u0438\u043d\u0438\u0446.`;break;case 2:const n=Math.floor(t.experienceToNextLevel*(.1+.2*Math.random()));o={experience:t.experience+n},s=`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e ${n} \u0435\u0434\u0438\u043d\u0438\u0446 \u043e\u043f\u044b\u0442\u0430 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438.`;break;case 3:const a=Math.floor(t.maxEnergy*(.05+.1*Math.random()));o={maxEnergy:t.maxEnergy+a,energy:t.energy+a},s=`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0430 \u043d\u0430 ${a} \u0435\u0434\u0438\u043d\u0438\u0446.`}return await t.update({...o,insightPoints:t.insightPoints+1,lastInsightTime:r}),{success:!0,message:s,effect:o}}}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u044f:",t),t}}}},2285:e=>{var t,r,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"===typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var s,l=[],c=!1,d=-1;function u(){c&&s&&(c=!1,s.length?l=s.concat(l):d=-1,l.length&&p())}function p(){if(!c){var e=o(u);c=!0;for(var t=l.length;t;){for(s=l,l=[];++d<t;)s&&s[d].run();d=-1,t=l.length}s=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new h(e,t)),1!==l.length||c||o(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},2342:(e,t,r)=>{const n=r(8568),{initializeDatabaseConnection:a,unifiedDatabase:i}=r(8153);let o=null;async function s(){try{if(!o){console.log("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 Sequelize \u0447\u0435\u0440\u0435\u0437 database.js...");const e=await function(e,t,r){let n;const a=new Promise(((e,a)=>{n=setTimeout((()=>{a(new Error(r||"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b\u0430 \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f"))}),t)}));return Promise.race([e,a]).finally((()=>clearTimeout(n)))}(i.getSequelizeInstance(),15e3,"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 Sequelize \u0432 database.js \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b\u043e \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f");if(!e||!e.db)throw new Error("\u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0428\u0418\u0411\u041a\u0410: \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0411\u0414 \u0432\u0435\u0440\u043d\u0443\u043b\u0430 \u043f\u0443\u0441\u0442\u043e\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442");o=e.db,console.log("\u042d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 Sequelize \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0435\u043d \u0432 database.js")}return o}catch(e){throw console.error("\u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0428\u0418\u0411\u041a\u0410 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 Sequelize:",e.message),new Error(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a PostgreSQL: ${e.message}`)}}const l=new Proxy({modelManager:{getModel:function(e){return console.warn(`[PROXY] \u0417\u0430\u043f\u0440\u043e\u0441 \u043c\u043e\u0434\u0435\u043b\u0438 ${e} \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u043a\u0441\u0438`),null}},model:function(e){return console.warn(`[PROXY] \u0417\u0430\u043f\u0440\u043e\u0441 \u043c\u043e\u0434\u0435\u043b\u0438 ${e} \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u043a\u0441\u0438`),null},define:function(){return console.warn("[PROXY] \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u043a\u0441\u0438"),{}},authenticate:async function(){console.warn("[PROXY] \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u043a\u0441\u0438");return(await s()).authenticate()}},{get:function(e,t){return t in e?"function"===typeof e[t]?function(){return console.log(`[PROXY] \u0412\u044b\u0437\u043e\u0432 \u043c\u0435\u0442\u043e\u0434\u0430 ${t} \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u043a\u0441\u0438`),e[t](...arguments)}:e[t]:"modelManager"===t?new Proxy(e.modelManager||{},{get:function(e,t){return t in e?"function"===typeof e[t]?function(){return console.log(`[PROXY] \u0412\u044b\u0437\u043e\u0432 modelManager.${t}`),e[t](...arguments)}:e[t]:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return console.log(`[PROXY] \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 modelManager.${t} \u043d\u0430 \u0440\u0435\u0430\u043b\u044c\u043d\u044b\u0439 Sequelize`),s().then((e=>{if(!e||!e.modelManager||"function"!==typeof e.modelManager[t])throw console.error(`[PROXY] \u041c\u0435\u0442\u043e\u0434 modelManager.${t} \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d`),new Error(`\u041c\u0435\u0442\u043e\u0434 modelManager.${t} \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432 Sequelize`);return e.modelManager[t](...r)})).catch((e=>{throw console.error(`[PROXY] \u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0428\u0418\u0411\u041a\u0410 \u043f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 modelManager.${t}:`,e),e}))}}}):function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return console.log(`[PROXY] \u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430 ${t} \u043d\u0430 \u0440\u0435\u0430\u043b\u044c\u043d\u044b\u0439 Sequelize`),s().then((e=>{if(!e||"function"!==typeof e[t])throw console.error(`[PROXY] \u041c\u0435\u0442\u043e\u0434 ${t} \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c Sequelize`),new Error(`\u041c\u0435\u0442\u043e\u0434 ${t} \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432 Sequelize`);return e[t](...r)})).catch((e=>{throw console.error(`[PROXY] \u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0428\u0418\u0411\u041a\u0410 \u043f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 ${t}:`,e),e}))}}});e.exports={Model:n.Model,DataTypes:n.DataTypes,sequelize:l,getSequelizeInstance:s}},2696:(e,t,r)=>{const n=r(7456),a=(r(3382),"undefined"!==typeof window);let i={};e.exports=class{static async getCharacterStats(e){try{if(a){i[e]||(i[e]={userId:e,strength:10,intellect:10,spirit:10,agility:10,health:10,physicalDefense:0,spiritualDefense:0,attackSpeed:0,criticalChance:0,movementSpeed:0,luck:0});const t=i[e];return{strength:t.strength,intellect:t.intellect,spirit:t.spirit,agility:t.agility,health:t.health,physicalDefense:t.physicalDefense,spiritualDefense:t.spiritualDefense,attackSpeed:t.attackSpeed,criticalChance:t.criticalChance,movementSpeed:t.movementSpeed,luck:t.luck}}{let t=await n.findOne({where:{userId:e}});return t||(t=await n.create({userId:e,strength:10,intellect:10,spirit:10,agility:10,health:10,physicalDefense:0,spiritualDefense:0,attackSpeed:0,criticalChance:0,movementSpeed:0,luck:0})),{strength:t.strength,intellect:t.intellect,spirit:t.spirit,agility:t.agility,health:t.health,physicalDefense:t.physicalDefense,spiritualDefense:t.spiritualDefense,attackSpeed:t.attackSpeed,criticalChance:t.criticalChance,movementSpeed:t.movementSpeed,luck:t.luck}}}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430:",t),t}}static async updateCharacterStats(e,t){try{if(a){i[e]||(i[e]={userId:e,strength:10,intellect:10,spirit:10,agility:10,health:10,physicalDefense:0,spiritualDefense:0,attackSpeed:0,criticalChance:0,movementSpeed:0,luck:0});const r=i[e];return i[e]={...r,strength:void 0!==t.strength?t.strength:r.strength,intellect:void 0!==t.intellect?t.intellect:r.intellect,spirit:void 0!==t.spirit?t.spirit:r.spirit,agility:void 0!==t.agility?t.agility:r.agility,health:void 0!==t.health?t.health:r.health,physicalDefense:void 0!==t.physicalDefense?t.physicalDefense:r.physicalDefense,spiritualDefense:void 0!==t.spiritualDefense?t.spiritualDefense:r.spiritualDefense,attackSpeed:void 0!==t.attackSpeed?t.attackSpeed:r.attackSpeed,criticalChance:void 0!==t.criticalChance?t.criticalChance:r.criticalChance,movementSpeed:void 0!==t.movementSpeed?t.movementSpeed:r.movementSpeed,luck:void 0!==t.luck?t.luck:r.luck},{strength:i[e].strength,intellect:i[e].intellect,spirit:i[e].spirit,agility:i[e].agility,health:i[e].health,physicalDefense:i[e].physicalDefense,spiritualDefense:i[e].spiritualDefense,attackSpeed:i[e].attackSpeed,criticalChance:i[e].criticalChance,movementSpeed:i[e].movementSpeed,luck:i[e].luck}}{let r=await n.findOne({where:{userId:e}});return r||(r=await n.create({userId:e,strength:10,intellect:10,spirit:10,agility:10,health:10,physicalDefense:0,spiritualDefense:0,attackSpeed:0,criticalChance:0,movementSpeed:0,luck:0})),await r.update({strength:void 0!==t.strength?t.strength:r.strength,intellect:void 0!==t.intellect?t.intellect:r.intellect,spirit:void 0!==t.spirit?t.spirit:r.spirit,agility:void 0!==t.agility?t.agility:r.agility,health:void 0!==t.health?t.health:r.health,physicalDefense:void 0!==t.physicalDefense?t.physicalDefense:r.physicalDefense,spiritualDefense:void 0!==t.spiritualDefense?t.spiritualDefense:r.spiritualDefense,attackSpeed:void 0!==t.attackSpeed?t.attackSpeed:r.attackSpeed,criticalChance:void 0!==t.criticalChance?t.criticalChance:r.criticalChance,movementSpeed:void 0!==t.movementSpeed?t.movementSpeed:r.movementSpeed,luck:void 0!==t.luck?t.luck:r.luck}),r=await n.findOne({where:{userId:e}}),{strength:r.strength,intellect:r.intellect,spirit:r.spirit,agility:r.agility,health:r.health,physicalDefense:r.physicalDefense,spiritualDefense:r.spiritualDefense,attackSpeed:r.attackSpeed,criticalChance:r.criticalChance,movementSpeed:r.movementSpeed,luck:r.luck}}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430:",r),r}}static calculateSecondaryStats(e,t){try{if(!e||!t)return{physicalDefense:0,spiritualDefense:0,attackSpeed:0,criticalChance:0,movementSpeed:0,luck:0};const r={"\u0437\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430":0,"\u043e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0446\u0438":100,"\u0437\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e":300,"\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438":500},n=t.stage?t.stage.toLowerCase():"",a=t.level||1,i=(r[n]||0)+(a-1);return{physicalAttack:Math.floor(e.strength),physicalDefense:Math.floor(.5*e.strength+.3*e.health+.2*i),spiritualDefense:Math.floor(.5*e.spirit+.3*e.intellect+.2*i),attackSpeed:Math.floor(.6*e.agility+.1*i),criticalChance:Math.floor(.3*e.agility+.2*e.intellect),movementSpeed:Math.floor(.4*e.agility+.1*i),luck:Math.floor(.2*(e.spirit+e.intellect))}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0430\u0441\u0447\u0435\u0442\u0435 \u0432\u0442\u043e\u0440\u0438\u0447\u043d\u044b\u0445 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430:",r),r}}}},2730:(e,t,r)=>{"use strict";var n=r(5043),a=r(8853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function f(e,t,r,n,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){y[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];y[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){y[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){y[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){y[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){y[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){y[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){y[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){y[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function x(e,t,r,n){var a=y.hasOwnProperty(t)?y[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,a,n)&&(r=null),n||null===a?function(e){return!!u.call(m,e)||!u.call(h,e)&&(p.test(e)?m[e]=!0:(h[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,n=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,v);y[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),y.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){y[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),C=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var L,$=Object.assign;function O(e){if(void 0===L)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var q=!1;function U(e,t){if(!e||q)return"";q=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=n.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var l="\n"+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{q=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?O(e):""}function F(e){switch(e.tag){case 5:return O(e.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case _:return"Portal";case S:return"Profiler";case T:return"StrictMode";case I:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case j:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return z(e(t))}catch(r){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function V(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=W(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var r=t.checked;return $({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function K(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=G(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function J(e,t){X(e,t);var r=G(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&Q(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+G(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return $({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(i(92));if(te(r)){if(1<r.length)throw Error(i(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:G(r)}}function ie(e,t){var r=G(t.value),n=G(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function pe(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function ye(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),a=fe(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}Object.keys(he).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var ge=$({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Ee=null,Te=null;function Se(e){if(e=xa(e)){if("function"!==typeof _e)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),_e(e.stateNode,e.type,t))}}function je(e){Ee?Te?Te.push(e):Te=[e]:Ee=e}function Ce(){if(Ee){var e=Ee,t=Te;if(Te=Ee=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function ke(e,t){return e(t)}function Ie(){}var Ae=!1;function Ne(e,t,r){if(Ae)return e(t,r);Ae=!0;try{return ke(e,t,r)}finally{Ae=!1,(null!==Ee||null!==Te)&&(Ie(),Ce())}}function De(e,t){var r=e.stateNode;if(null===r)return null;var n=wa(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var Me=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Me=!1}function Pe(e,t,r,n,a,i,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Le=!1,$e=null,Oe=!1,qe=null,Ue={onError:function(e){Le=!0,$e=e}};function Fe(e,t,r,n,a,i,o,s,l){Le=!1,$e=null,Pe.apply(Ue,arguments)}function ze(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(ze(e)!==e)throw Error(i(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(n=a.return)){r=n;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===r)return Ge(a),e;if(o===n)return Ge(a),t;o=o.sibling}throw Error(i(188))}if(r.return!==n.return)r=a,n=o;else{for(var s=!1,l=a.child;l;){if(l===r){s=!0,r=a,n=o;break}if(l===n){s=!0,n=a,r=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===r){s=!0,r=o,n=a;break}if(l===n){s=!0,n=o,r=a;break}l=l.sibling}if(!s)throw Error(i(189))}}if(r.alternate!==n)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ve=a.unstable_scheduleCallback,Qe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Ke=a.unstable_requestPaint,Xe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,rt=a.unstable_LowPriority,nt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&r;if(0!==o){var s=o&~a;0!==s?n=ut(s):0!==(i&=o)&&(n=ut(i))}else 0!==(o=r&~a)?n=ut(o):0!==i&&(n=ut(i));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(r=31-ot(t)),n|=e[r],t&=~a;return n}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function yt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function gt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=r}function vt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ot(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var xt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,Et,Tt,St,jt=!1,Ct=[],kt=null,It=null,At=null,Nt=new Map,Dt=new Map,Mt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Nt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Lt(e,t,r,n,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=xa(t))&&_t(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function $t(e){var t=va(e.target);if(null!==t){var r=ze(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Be(r)))return e.blockedOn=t,void St(e.priority,(function(){Et(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=xa(r))&&_t(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);be=n,r.target.dispatchEvent(n),be=null,t.shift()}return!0}function qt(e,t,r){Ot(e)&&r.delete(t)}function Ut(){jt=!1,null!==kt&&Ot(kt)&&(kt=null),null!==It&&Ot(It)&&(It=null),null!==At&&Ot(At)&&(At=null),Nt.forEach(qt),Dt.forEach(qt)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,jt||(jt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function zt(e){function t(t){return Ft(t,e)}if(0<Ct.length){Ft(Ct[0],e);for(var r=1;r<Ct.length;r++){var n=Ct[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==kt&&Ft(kt,e),null!==It&&Ft(It,e),null!==At&&Ft(At,e),Nt.forEach(t),Dt.forEach(t),r=0;r<Mt.length;r++)(n=Mt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Mt.length&&null===(r=Mt[0]).blockedOn;)$t(r),null===r.blockedOn&&Mt.shift()}var Bt=b.ReactCurrentBatchConfig,Gt=!0;function Wt(e,t,r,n){var a=xt,i=Bt.transition;Bt.transition=null;try{xt=1,Vt(e,t,r,n)}finally{xt=a,Bt.transition=i}}function Ht(e,t,r,n){var a=xt,i=Bt.transition;Bt.transition=null;try{xt=4,Vt(e,t,r,n)}finally{xt=a,Bt.transition=i}}function Vt(e,t,r,n){if(Gt){var a=Yt(e,t,r,n);if(null===a)Gn(e,t,n,Qt,r),Pt(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return kt=Lt(kt,e,t,r,n,a),!0;case"dragenter":return It=Lt(It,e,t,r,n,a),!0;case"mouseover":return At=Lt(At,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Nt.set(i,Lt(Nt.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Dt.set(i,Lt(Dt.get(i)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Pt(e,n),4&t&&-1<Rt.indexOf(e)){for(;null!==a;){var i=xa(a);if(null!==i&&wt(i),null===(i=Yt(e,t,r,n))&&Gn(e,t,n,Qt,r),i===a)break;a=i}null!==a&&n.stopPropagation()}else Gn(e,t,n,null,r)}}var Qt=null;function Yt(e,t,r,n){if(Qt=null,null!==(e=va(e=we(n))))if(null===(t=ze(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Jt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Jt,n=r.length,a="value"in Xt?Xt.value:Xt.textContent,i=a.length;for(e=0;e<n&&r[e]===a[e];e++);var o=n-e;for(t=1;t<=o&&r[n-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ar(e){function t(t,r,n,a,i){for(var o in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return $(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ir,or,sr,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ar(lr),dr=$({},lr,{view:0,detail:0}),ur=ar(dr),pr=$({},dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(ir=e.screenX-sr.screenX,or=e.screenY-sr.screenY):or=ir=0,sr=e),ir)},movementY:function(e){return"movementY"in e?e.movementY:or}}),hr=ar(pr),mr=ar($({},pr,{dataTransfer:0})),fr=ar($({},dr,{relatedTarget:0})),yr=ar($({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),gr=$({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vr=ar(gr),xr=ar($({},lr,{data:0})),br={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_r={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Er(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_r[e])&&!!t[e]}function Tr(){return Er}var Sr=$({},dr,{key:function(e){if(e.key){var t=br[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),jr=ar(Sr),Cr=ar($({},pr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kr=ar($({},dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tr})),Ir=ar($({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ar=$({},pr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nr=ar(Ar),Dr=[9,13,27,32],Mr=d&&"CompositionEvent"in window,Rr=null;d&&"documentMode"in document&&(Rr=document.documentMode);var Pr=d&&"TextEvent"in window&&!Rr,Lr=d&&(!Mr||Rr&&8<Rr&&11>=Rr),$r=String.fromCharCode(32),Or=!1;function qr(e,t){switch(e){case"keyup":return-1!==Dr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Fr=!1;var zr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Br(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zr[e.type]:"textarea"===t}function Gr(e,t,r,n){je(n),0<(t=Hn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Wr=null,Hr=null;function Vr(e){On(e,0)}function Qr(e){if(V(ba(e)))return e}function Yr(e,t){if("change"===e)return t}var Kr=!1;if(d){var Xr;if(d){var Jr="oninput"in document;if(!Jr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Jr="function"===typeof Zr.oninput}Xr=Jr}else Xr=!1;Kr=Xr&&(!document.documentMode||9<document.documentMode)}function en(){Wr&&(Wr.detachEvent("onpropertychange",tn),Hr=Wr=null)}function tn(e){if("value"===e.propertyName&&Qr(Hr)){var t=[];Gr(t,Hr,e,we(e)),Ne(Vr,t)}}function rn(e,t,r){"focusin"===e?(en(),Hr=r,(Wr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qr(Hr)}function an(e,t){if("click"===e)return Qr(t)}function on(e,t){if("input"===e||"change"===e)return Qr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!u.call(t,a)||!sn(e[a],t[a]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function un(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?un(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pn(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=Q((e=t.contentWindow).document)}return t}function hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=pn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&un(r.ownerDocument.documentElement,r)){if(null!==n&&hn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=void 0===n.end?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=dn(r,i);var o=dn(r,n);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fn=d&&"documentMode"in document&&11>=document.documentMode,yn=null,gn=null,vn=null,xn=!1;function bn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;xn||null==yn||yn!==Q(n)||("selectionStart"in(n=yn)&&hn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&ln(vn,n)||(vn=n,0<(n=Hn(gn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=yn)))}function wn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var _n={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},En={},Tn={};function Sn(e){if(En[e])return En[e];if(!_n[e])return e;var t,r=_n[e];for(t in r)if(r.hasOwnProperty(t)&&t in Tn)return En[e]=r[t];return e}d&&(Tn=document.createElement("div").style,"AnimationEvent"in window||(delete _n.animationend.animation,delete _n.animationiteration.animation,delete _n.animationstart.animation),"TransitionEvent"in window||delete _n.transitionend.transition);var jn=Sn("animationend"),Cn=Sn("animationiteration"),kn=Sn("animationstart"),In=Sn("transitionend"),An=new Map,Nn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dn(e,t){An.set(e,t),l(t,[e])}for(var Mn=0;Mn<Nn.length;Mn++){var Rn=Nn[Mn];Dn(Rn.toLowerCase(),"on"+(Rn[0].toUpperCase()+Rn.slice(1)))}Dn(jn,"onAnimationEnd"),Dn(Cn,"onAnimationIteration"),Dn(kn,"onAnimationStart"),Dn("dblclick","onDoubleClick"),Dn("focusin","onFocus"),Dn("focusout","onBlur"),Dn(In,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ln=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pn));function $n(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,a,o,s,l,c){if(Fe.apply(this,arguments),Le){if(!Le)throw Error(i(198));var d=$e;Le=!1,$e=null,Oe||(Oe=!0,qe=d)}}(n,t,void 0,e),e.currentTarget=null}function On(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;$n(a,s,c),i=l}else for(o=0;o<n.length;o++){if(l=(s=n[o]).instance,c=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;$n(a,s,c),i=l}}}if(Oe)throw e=qe,Oe=!1,qe=null,e}function qn(e,t){var r=t[fa];void 0===r&&(r=t[fa]=new Set);var n=e+"__bubble";r.has(n)||(Bn(t,e,2,!1),r.add(n))}function Un(e,t,r){var n=0;t&&(n|=4),Bn(r,e,n,t)}var Fn="_reactListening"+Math.random().toString(36).slice(2);function zn(e){if(!e[Fn]){e[Fn]=!0,o.forEach((function(t){"selectionchange"!==t&&(Ln.has(t)||Un(t,!1,e),Un(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fn]||(t[Fn]=!0,Un("selectionchange",!1,t))}}function Bn(e,t,r,n){switch(Kt(t)){case 1:var a=Wt;break;case 4:a=Ht;break;default:a=Vt}r=a.bind(null,t,r,e),a=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Gn(e,t,r,n,a){var i=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var o=n.tag;if(3===o||4===o){var s=n.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=n.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=va(s)))return;if(5===(l=o.tag)||6===l){n=i=o;continue e}s=s.parentNode}}n=n.return}Ne((function(){var n=i,a=we(r),o=[];e:{var s=An.get(e);if(void 0!==s){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=jr;break;case"focusin":c="focus",l=fr;break;case"focusout":c="blur",l=fr;break;case"beforeblur":case"afterblur":l=fr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kr;break;case jn:case Cn:case kn:l=yr;break;case In:l=Ir;break;case"scroll":l=ur;break;case"wheel":l=Nr;break;case"copy":case"cut":case"paste":l=vr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cr}var d=0!==(4&t),u=!d&&"scroll"===e,p=d?null!==s?s+"Capture":null:s;d=[];for(var h,m=n;null!==m;){var f=(h=m).stateNode;if(5===h.tag&&null!==f&&(h=f,null!==p&&(null!=(f=De(m,p))&&d.push(Wn(m,f,h)))),u)break;m=m.return}0<d.length&&(s=new l(s,c,null,r,a),o.push({event:s,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===be||!(c=r.relatedTarget||r.fromElement)||!va(c)&&!c[ma])&&(l||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?va(c):null)&&(c!==(u=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(d=hr,f="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=Cr,f="onPointerLeave",p="onPointerEnter",m="pointer"),u=null==l?s:ba(l),h=null==c?s:ba(c),(s=new d(f,m+"leave",l,r,a)).target=u,s.relatedTarget=h,f=null,va(a)===n&&((d=new d(p,m+"enter",c,r,a)).target=h,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(p=c,m=0,h=d=l;h;h=Vn(h))m++;for(h=0,f=p;f;f=Vn(f))h++;for(;0<m-h;)d=Vn(d),m--;for(;0<h-m;)p=Vn(p),h--;for(;m--;){if(d===p||null!==p&&d===p.alternate)break e;d=Vn(d),p=Vn(p)}d=null}else d=null;null!==l&&Qn(o,s,l,d,!1),null!==c&&null!==u&&Qn(o,u,c,d,!0)}if("select"===(l=(s=n?ba(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var y=Yr;else if(Br(s))if(Kr)y=on;else{y=nn;var g=rn}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(y=an);switch(y&&(y=y(e,n))?Gr(o,y,r,a):(g&&g(e,s,n),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=n?ba(n):window,e){case"focusin":(Br(g)||"true"===g.contentEditable)&&(yn=g,gn=n,vn=null);break;case"focusout":vn=gn=yn=null;break;case"mousedown":xn=!0;break;case"contextmenu":case"mouseup":case"dragend":xn=!1,bn(o,r,a);break;case"selectionchange":if(fn)break;case"keydown":case"keyup":bn(o,r,a)}var v;if(Mr)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Fr?qr(e,r)&&(x="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(x="onCompositionStart");x&&(Lr&&"ko"!==r.locale&&(Fr||"onCompositionStart"!==x?"onCompositionEnd"===x&&Fr&&(v=er()):(Jt="value"in(Xt=a)?Xt.value:Xt.textContent,Fr=!0)),0<(g=Hn(n,x)).length&&(x=new xr(x,e,null,r,a),o.push({event:x,listeners:g}),v?x.data=v:null!==(v=Ur(r))&&(x.data=v))),(v=Pr?function(e,t){switch(e){case"compositionend":return Ur(t);case"keypress":return 32!==t.which?null:(Or=!0,$r);case"textInput":return(e=t.data)===$r&&Or?null:e;default:return null}}(e,r):function(e,t){if(Fr)return"compositionend"===e||!Mr&&qr(e,t)?(e=er(),Zt=Jt=Xt=null,Fr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Lr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Hn(n,"onBeforeInput")).length&&(a=new xr("onBeforeInput","beforeinput",null,r,a),o.push({event:a,listeners:n}),a.data=v))}On(o,t)}))}function Wn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Hn(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=De(e,r))&&n.unshift(Wn(e,i,a)),null!=(i=De(e,t))&&n.push(Wn(e,i,a))),e=e.return}return n}function Vn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qn(e,t,r,n,a){for(var i=t._reactName,o=[];null!==r&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(null!==l&&l===n)break;5===s.tag&&null!==c&&(s=c,a?null!=(l=De(r,i))&&o.unshift(Wn(r,l,s)):a||null!=(l=De(r,i))&&o.push(Wn(r,l,s))),r=r.return}0!==o.length&&e.push({event:t,listeners:o})}var Yn=/\r\n?/g,Kn=/\u0000|\uFFFD/g;function Xn(e){return("string"===typeof e?e:""+e).replace(Yn,"\n").replace(Kn,"")}function Jn(e,t,r){if(t=Xn(t),Xn(e)!==t&&r)throw Error(i(425))}function Zn(){}var ea=null,ta=null;function ra(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var na="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:na;function sa(e){setTimeout((function(){throw e}))}function la(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===n)return e.removeChild(a),void zt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=a}while(r);zt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),pa="__reactFiber$"+ua,ha="__reactProps$"+ua,ma="__reactContainer$"+ua,fa="__reactEvents$"+ua,ya="__reactListeners$"+ua,ga="__reactHandles$"+ua;function va(e){var t=e[pa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ma]||r[pa]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=da(e);null!==e;){if(r=e[pa])return r;e=da(e)}return t}r=(e=r).parentNode}return null}function xa(e){return!(e=e[pa]||e[ma])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ba(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[ha]||null}var _a=[],Ea=-1;function Ta(e){return{current:e}}function Sa(e){0>Ea||(e.current=_a[Ea],_a[Ea]=null,Ea--)}function ja(e,t){Ea++,_a[Ea]=e.current,e.current=t}var Ca={},ka=Ta(Ca),Ia=Ta(!1),Aa=Ca;function Na(e,t){var r=e.type.contextTypes;if(!r)return Ca;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in r)i[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Da(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ma(){Sa(Ia),Sa(ka)}function Ra(e,t,r){if(ka.current!==Ca)throw Error(i(168));ja(ka,t),ja(Ia,r)}function Pa(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in t))throw Error(i(108,B(e)||"Unknown",a));return $({},r,n)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ca,Aa=ka.current,ja(ka,e),ja(Ia,Ia.current),!0}function $a(e,t,r){var n=e.stateNode;if(!n)throw Error(i(169));r?(e=Pa(e,t,Aa),n.__reactInternalMemoizedMergedChildContext=e,Sa(Ia),Sa(ka),ja(ka,e)):Sa(Ia),ja(Ia,r)}var Oa=null,qa=!1,Ua=!1;function Fa(e){null===Oa?Oa=[e]:Oa.push(e)}function za(){if(!Ua&&null!==Oa){Ua=!0;var e=0,t=xt;try{var r=Oa;for(xt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Oa=null,qa=!1}catch(a){throw null!==Oa&&(Oa=Oa.slice(e+1)),Ve(Ze,za),a}finally{xt=t,Ua=!1}}return null}var Ba=[],Ga=0,Wa=null,Ha=0,Va=[],Qa=0,Ya=null,Ka=1,Xa="";function Ja(e,t){Ba[Ga++]=Ha,Ba[Ga++]=Wa,Wa=e,Ha=t}function Za(e,t,r){Va[Qa++]=Ka,Va[Qa++]=Xa,Va[Qa++]=Ya,Ya=e;var n=Ka;e=Xa;var a=32-ot(n)-1;n&=~(1<<a),r+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Ka=1<<32-ot(t)+a|r<<a|n,Xa=i+e}else Ka=1<<i|r<<a|n,Xa=e}function ei(e){null!==e.return&&(Ja(e,1),Za(e,1,0))}function ti(e){for(;e===Wa;)Wa=Ba[--Ga],Ba[Ga]=null,Ha=Ba[--Ga],Ba[Ga]=null;for(;e===Ya;)Ya=Va[--Qa],Va[Qa]=null,Xa=Va[--Qa],Va[Qa]=null,Ka=Va[--Qa],Va[Qa]=null}var ri=null,ni=null,ai=!1,ii=null;function oi(e,t){var r=Nc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function si(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ri=e,ni=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ri=e,ni=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Ya?{id:Ka,overflow:Xa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Nc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ri=e,ni=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ni;if(t){var r=t;if(!si(e,t)){if(li(e))throw Error(i(418));t=ca(r.nextSibling);var n=ri;t&&si(e,t)?oi(n,r):(e.flags=-4097&e.flags|2,ai=!1,ri=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ri=e}}}function di(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ri=e}function ui(e){if(e!==ri)return!1;if(!ai)return di(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ra(e.type,e.memoizedProps)),t&&(t=ni)){if(li(e))throw pi(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(di(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){ni=ca(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}ni=null}}else ni=ri?ca(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=ni;e;)e=ca(e.nextSibling)}function hi(){ni=ri=null,ai=!1}function mi(e){null===ii?ii=[e]:ii.push(e)}var fi=b.ReactCurrentBatchConfig;function yi(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(i(309));var n=r.stateNode}if(!n)throw Error(i(147,e));var a=n,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!r._owner)throw Error(i(290,e))}return e}function gi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vi(e){return(0,e._init)(e._payload)}function xi(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function o(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=$c(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function c(e,t,r,n){var i=r.type;return i===E?u(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===D&&vi(i)===t.type)?((n=a(t,r.props)).ref=yi(e,t,r),n.return=e,n):((n=Rc(r.type,r.key,r.props,null,e.mode,n)).ref=yi(e,t,r),n.return=e,n)}function d(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Oc(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function u(e,t,r,n,i){return null===t||7!==t.tag?((t=Pc(r,e.mode,n,i)).return=e,t):((t=a(t,r)).return=e,t)}function p(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=$c(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Rc(t.type,t.key,t.props,null,e.mode,r)).ref=yi(e,null,t),r.return=e,r;case _:return(t=Oc(t,e.mode,r)).return=e,t;case D:return p(e,(0,t._init)(t._payload),r)}if(te(t)||P(t))return(t=Pc(t,e.mode,r,null)).return=e,t;gi(e,t)}return null}function h(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==a?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===a?c(e,t,r,n):null;case _:return r.key===a?d(e,t,r,n):null;case D:return h(e,t,(a=r._init)(r._payload),n)}if(te(r)||P(r))return null!==a?null:u(e,t,r,n,null);gi(e,r)}return null}function m(e,t,r,n,a){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(r)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return c(t,e=e.get(null===n.key?r:n.key)||null,n,a);case _:return d(t,e=e.get(null===n.key?r:n.key)||null,n,a);case D:return m(e,t,r,(0,n._init)(n._payload),a)}if(te(n)||P(n))return u(t,e=e.get(r)||null,n,a,null);gi(t,n)}return null}function f(a,i,s,l){for(var c=null,d=null,u=i,f=i=0,y=null;null!==u&&f<s.length;f++){u.index>f?(y=u,u=null):y=u.sibling;var g=h(a,u,s[f],l);if(null===g){null===u&&(u=y);break}e&&u&&null===g.alternate&&t(a,u),i=o(g,i,f),null===d?c=g:d.sibling=g,d=g,u=y}if(f===s.length)return r(a,u),ai&&Ja(a,f),c;if(null===u){for(;f<s.length;f++)null!==(u=p(a,s[f],l))&&(i=o(u,i,f),null===d?c=u:d.sibling=u,d=u);return ai&&Ja(a,f),c}for(u=n(a,u);f<s.length;f++)null!==(y=m(u,a,f,s[f],l))&&(e&&null!==y.alternate&&u.delete(null===y.key?f:y.key),i=o(y,i,f),null===d?c=y:d.sibling=y,d=y);return e&&u.forEach((function(e){return t(a,e)})),ai&&Ja(a,f),c}function y(a,s,l,c){var d=P(l);if("function"!==typeof d)throw Error(i(150));if(null==(l=d.call(l)))throw Error(i(151));for(var u=d=null,f=s,y=s=0,g=null,v=l.next();null!==f&&!v.done;y++,v=l.next()){f.index>y?(g=f,f=null):g=f.sibling;var x=h(a,f,v.value,c);if(null===x){null===f&&(f=g);break}e&&f&&null===x.alternate&&t(a,f),s=o(x,s,y),null===u?d=x:u.sibling=x,u=x,f=g}if(v.done)return r(a,f),ai&&Ja(a,y),d;if(null===f){for(;!v.done;y++,v=l.next())null!==(v=p(a,v.value,c))&&(s=o(v,s,y),null===u?d=v:u.sibling=v,u=v);return ai&&Ja(a,y),d}for(f=n(a,f);!v.done;y++,v=l.next())null!==(v=m(f,a,y,v.value,c))&&(e&&null!==v.alternate&&f.delete(null===v.key?y:v.key),s=o(v,s,y),null===u?d=v:u.sibling=v,u=v);return e&&f.forEach((function(e){return t(a,e)})),ai&&Ja(a,y),d}return function e(n,i,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,d=i;null!==d;){if(d.key===c){if((c=o.type)===E){if(7===d.tag){r(n,d.sibling),(i=a(d,o.props.children)).return=n,n=i;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&vi(c)===d.type){r(n,d.sibling),(i=a(d,o.props)).ref=yi(n,d,o),i.return=n,n=i;break e}r(n,d);break}t(n,d),d=d.sibling}o.type===E?((i=Pc(o.props.children,n.mode,l,o.key)).return=n,n=i):((l=Rc(o.type,o.key,o.props,null,n.mode,l)).ref=yi(n,i,o),l.return=n,n=l)}return s(n);case _:e:{for(d=o.key;null!==i;){if(i.key===d){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){r(n,i.sibling),(i=a(i,o.children||[])).return=n,n=i;break e}r(n,i);break}t(n,i),i=i.sibling}(i=Oc(o,n.mode,l)).return=n,n=i}return s(n);case D:return e(n,i,(d=o._init)(o._payload),l)}if(te(o))return f(n,i,o,l);if(P(o))return y(n,i,o,l);gi(n,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(r(n,i.sibling),(i=a(i,o)).return=n,n=i):(r(n,i),(i=$c(o,n.mode,l)).return=n,n=i),s(n)):r(n,i)}}var bi=xi(!0),wi=xi(!1),_i=Ta(null),Ei=null,Ti=null,Si=null;function ji(){Si=Ti=Ei=null}function Ci(e){var t=_i.current;Sa(_i),e._currentValue=t}function ki(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ii(e,t){Ei=e,Si=Ti=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Ai(e){var t=e._currentValue;if(Si!==e)if(e={context:e,memoizedValue:t,next:null},null===Ti){if(null===Ei)throw Error(i(308));Ti=e,Ei.dependencies={lanes:0,firstContext:e}}else Ti=Ti.next=e;return t}var Ni=null;function Di(e){null===Ni?Ni=[e]:Ni.push(e)}function Mi(e,t,r,n){var a=t.interleaved;return null===a?(r.next=r,Di(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ri(e,n)}function Ri(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Pi=!1;function Li(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $i(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Oi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qi(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&kl)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ri(e,r)}return null===(a=n.interleaved)?(t.next=t,Di(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ri(e,r)}function Ui(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}function Fi(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===i?a=i=o:i=i.next=o,r=r.next}while(null!==r);null===i?a=i=t:i=i.next=t}else a=i=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function zi(e,t,r,n){var a=e.updateQueue;Pi=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?i=c:o.next=c,o=l;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(null!==i){var u=a.baseState;for(o=0,d=c=l=null,s=i;;){var p=s.lane,h=s.eventTime;if((n&p)===p){null!==d&&(d=d.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var m=e,f=s;switch(p=t,h=r,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(h,u,p);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(p="function"===typeof(m=f.payload)?m.call(h,u,p):m)||void 0===p)break e;u=$({},u,p);break e;case 2:Pi=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=a.effects)?a.effects=[s]:p.push(s))}else h={eventTime:h,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=h,l=u):d=d.next=h,o|=p;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(p=s).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Ll|=o,e.lanes=o,e.memoizedState=u}}function Bi(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=r,"function"!==typeof a)throw Error(i(191,a));a.call(n)}}}var Gi={},Wi=Ta(Gi),Hi=Ta(Gi),Vi=Ta(Gi);function Qi(e){if(e===Gi)throw Error(i(174));return e}function Yi(e,t){switch(ja(Vi,t),ja(Hi,e),ja(Wi,Gi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sa(Wi),ja(Wi,t)}function Ki(){Sa(Wi),Sa(Hi),Sa(Vi)}function Xi(e){Qi(Vi.current);var t=Qi(Wi.current),r=le(t,e.type);t!==r&&(ja(Hi,e),ja(Wi,r))}function Ji(e){Hi.current===e&&(Sa(Wi),Sa(Hi))}var Zi=Ta(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function ro(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var no=b.ReactCurrentDispatcher,ao=b.ReactCurrentBatchConfig,io=0,oo=null,so=null,lo=null,co=!1,uo=!1,po=0,ho=0;function mo(){throw Error(i(321))}function fo(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function yo(e,t,r,n,a,o){if(io=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,no.current=null===e||null===e.memoizedState?Zo:es,e=r(n,a),uo){o=0;do{if(uo=!1,po=0,25<=o)throw Error(i(301));o+=1,lo=so=null,t.updateQueue=null,no.current=ts,e=r(n,a)}while(uo)}if(no.current=Jo,t=null!==so&&null!==so.next,io=0,lo=so=oo=null,co=!1,t)throw Error(i(300));return e}function go(){var e=0!==po;return po=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function xo(){if(null===so){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=so.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,so=e;else{if(null===e)throw Error(i(310));e={memoizedState:(so=e).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function bo(e,t){return"function"===typeof t?t(e):t}function wo(e){var t=xo(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=so,a=n.baseQueue,o=r.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}n.baseQueue=a=o,r.pending=null}if(null!==a){o=a.next,n=n.baseState;var l=s=null,c=null,d=o;do{var u=d.lane;if((io&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=p,s=n):c=c.next=p,oo.lanes|=u,Ll|=u}d=d.next}while(null!==d&&d!==o);null===c?s=n:c.next=l,sn(n,t.memoizedState)||(xs=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){a=e;do{o=a.lane,oo.lanes|=o,Ll|=o,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function _o(e){var t=xo(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,o=t.memoizedState;if(null!==a){r.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sn(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function Eo(){}function To(e,t){var r=oo,n=xo(),a=t(),o=!sn(n.memoizedState,a);if(o&&(n.memoizedState=a,xs=!0),n=n.queue,Lo(Co.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(r.flags|=2048,No(9,jo.bind(null,r,n,a,t),void 0,null),null===Il)throw Error(i(349));0!==(30&io)||So(r,t,a)}return a}function So(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function jo(e,t,r,n){t.value=r,t.getSnapshot=n,ko(t)&&Io(e)}function Co(e,t,r){return r((function(){ko(t)&&Io(e)}))}function ko(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sn(e,r)}catch(n){return!0}}function Io(e){var t=Ri(e,1);null!==t&&rc(t,e,1,-1)}function Ao(e){var t=vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:e},t.queue=e,e=e.dispatch=Qo.bind(null,oo,e),[t.memoizedState,e]}function No(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Do(){return xo().memoizedState}function Mo(e,t,r,n){var a=vo();oo.flags|=e,a.memoizedState=No(1|t,r,void 0,void 0===n?null:n)}function Ro(e,t,r,n){var a=xo();n=void 0===n?null:n;var i=void 0;if(null!==so){var o=so.memoizedState;if(i=o.destroy,null!==n&&fo(n,o.deps))return void(a.memoizedState=No(t,r,i,n))}oo.flags|=e,a.memoizedState=No(1|t,r,i,n)}function Po(e,t){return Mo(8390656,8,e,t)}function Lo(e,t){return Ro(2048,8,e,t)}function $o(e,t){return Ro(4,2,e,t)}function Oo(e,t){return Ro(4,4,e,t)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Uo(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Ro(4,4,qo.bind(null,t,e),r)}function Fo(){}function zo(e,t){var r=xo();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&fo(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Bo(e,t){var r=xo();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&fo(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Go(e,t,r){return 0===(21&io)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=r):(sn(r,t)||(r=ft(),oo.lanes|=r,Ll|=r,e.baseState=!0),t)}function Wo(e,t){var r=xt;xt=0!==r&&4>r?r:4,e(!0);var n=ao.transition;ao.transition={};try{e(!1),t()}finally{xt=r,ao.transition=n}}function Ho(){return xo().memoizedState}function Vo(e,t,r){var n=tc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Yo(e))Ko(t,r);else if(null!==(r=Mi(e,t,r,n))){rc(r,e,n,ec()),Xo(r,t,n)}}function Qo(e,t,r){var n=tc(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Yo(e))Ko(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,r);if(a.hasEagerState=!0,a.eagerState=s,sn(s,o)){var l=t.interleaved;return null===l?(a.next=a,Di(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(r=Mi(e,t,a,n))&&(rc(r,e,n,a=ec()),Xo(r,t,n))}}function Yo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Ko(e,t){uo=co=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Xo(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}var Jo={readContext:Ai,useCallback:mo,useContext:mo,useEffect:mo,useImperativeHandle:mo,useInsertionEffect:mo,useLayoutEffect:mo,useMemo:mo,useReducer:mo,useRef:mo,useState:mo,useDebugValue:mo,useDeferredValue:mo,useTransition:mo,useMutableSource:mo,useSyncExternalStore:mo,useId:mo,unstable_isNewReconciler:!1},Zo={readContext:Ai,useCallback:function(e,t){return vo().memoizedState=[e,void 0===t?null:t],e},useContext:Ai,useEffect:Po,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Mo(4194308,4,qo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mo(4,2,e,t)},useMemo:function(e,t){var r=vo();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=vo();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Vo.bind(null,oo,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},vo().memoizedState=e},useState:Ao,useDebugValue:Fo,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=Ao(!1),t=e[0];return e=Wo.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=oo,a=vo();if(ai){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===Il)throw Error(i(349));0!==(30&io)||So(n,t,r)}a.memoizedState=r;var o={value:r,getSnapshot:t};return a.queue=o,Po(Co.bind(null,n,o,e),[e]),n.flags|=2048,No(9,jo.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=vo(),t=Il.identifierPrefix;if(ai){var r=Xa;t=":"+t+"R"+(r=(Ka&~(1<<32-ot(Ka)-1)).toString(32)+r),0<(r=po++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ho++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Ai,useCallback:zo,useContext:Ai,useEffect:Lo,useImperativeHandle:Uo,useInsertionEffect:$o,useLayoutEffect:Oo,useMemo:Bo,useReducer:wo,useRef:Do,useState:function(){return wo(bo)},useDebugValue:Fo,useDeferredValue:function(e){return Go(xo(),so.memoizedState,e)},useTransition:function(){return[wo(bo)[0],xo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:To,useId:Ho,unstable_isNewReconciler:!1},ts={readContext:Ai,useCallback:zo,useContext:Ai,useEffect:Lo,useImperativeHandle:Uo,useInsertionEffect:$o,useLayoutEffect:Oo,useMemo:Bo,useReducer:_o,useRef:Do,useState:function(){return _o(bo)},useDebugValue:Fo,useDeferredValue:function(e){var t=xo();return null===so?t.memoizedState=e:Go(t,so.memoizedState,e)},useTransition:function(){return[_o(bo)[0],xo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:To,useId:Ho,unstable_isNewReconciler:!1};function rs(e,t){if(e&&e.defaultProps){for(var r in t=$({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ns(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:$({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var as={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ec(),a=tc(e),i=Oi(n,a);i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=qi(e,i,a))&&(rc(t,e,a,n),Ui(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ec(),a=tc(e),i=Oi(n,a);i.tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=qi(e,i,a))&&(rc(t,e,a,n),Ui(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),n=tc(e),a=Oi(r,n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=qi(e,a,n))&&(rc(t,e,n,r),Ui(t,e,n))}};function is(e,t,r,n,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ln(r,n)||!ln(a,i))}function os(e,t,r){var n=!1,a=Ca,i=t.contextType;return"object"===typeof i&&null!==i?i=Ai(i):(a=Da(t)?Aa:ka.current,i=(n=null!==(n=t.contextTypes)&&void 0!==n)?Na(e,a):Ca),t=new t(r,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=as,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function ss(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&as.enqueueReplaceState(t,t.state,null)}function ls(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Li(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ai(i):(i=Da(t)?Aa:ka.current,a.context=Na(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(ns(e,t,i,r),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&as.enqueueReplaceState(a,a.state,null),zi(e,r,a,n),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var r="",n=t;do{r+=F(n),n=n.return}while(n);var a=r}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function ds(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function us(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var ps="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,r){(r=Oi(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Gl||(Gl=!0,Wl=n),us(0,t)},r}function ms(e,t,r){(r=Oi(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){us(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(r.callback=function(){us(0,t),"function"!==typeof n&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function fs(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ps;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Sc.bind(null,e,t,r),t.then(e,e))}function ys(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gs(e,t,r,n,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Oi(-1,1)).tag=2,qi(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var vs=b.ReactCurrentOwner,xs=!1;function bs(e,t,r,n){t.child=null===e?wi(t,null,r,n):bi(t,e.child,r,n)}function ws(e,t,r,n,a){r=r.render;var i=t.ref;return Ii(t,a),n=yo(e,t,r,n,i,a),r=go(),null===e||xs?(ai&&r&&ei(t),t.flags|=1,bs(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function _s(e,t,r,n,a){if(null===e){var i=r.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Rc(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Es(e,t,i,n,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(o,n)&&e.ref===t.ref)return Gs(e,t,a)}return t.flags|=1,(e=Mc(i,n)).ref=t.ref,e.return=t,t.child=e}function Es(e,t,r,n,a){if(null!==e){var i=e.memoizedProps;if(ln(i,n)&&e.ref===t.ref){if(xs=!1,t.pendingProps=n=i,0===(e.lanes&a))return t.lanes=e.lanes,Gs(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return js(e,t,r,n,a)}function Ts(e,t,r){var n=t.pendingProps,a=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ja(Ml,Dl),Dl|=r;else{if(0===(1073741824&r))return e=null!==i?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ja(Ml,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==i?i.baseLanes:r,ja(Ml,Dl),Dl|=n}else null!==i?(n=i.baseLanes|r,t.memoizedState=null):n=r,ja(Ml,Dl),Dl|=n;return bs(e,t,a,r),t.child}function Ss(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function js(e,t,r,n,a){var i=Da(r)?Aa:ka.current;return i=Na(t,i),Ii(t,a),r=yo(e,t,r,n,i,a),n=go(),null===e||xs?(ai&&n&&ei(t),t.flags|=1,bs(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Cs(e,t,r,n,a){if(Da(r)){var i=!0;La(t)}else i=!1;if(Ii(t,a),null===t.stateNode)Bs(e,t),os(t,r,n),ls(t,r,n,a),n=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=r.contextType;"object"===typeof c&&null!==c?c=Ai(c):c=Na(t,c=Da(r)?Aa:ka.current);var d=r.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==n||l!==c)&&ss(t,o,n,c),Pi=!1;var p=t.memoizedState;o.state=p,zi(t,n,o,a),l=t.memoizedState,s!==n||p!==l||Ia.current||Pi?("function"===typeof d&&(ns(t,r,d,n),l=t.memoizedState),(s=Pi||is(t,r,s,n,p,l,c))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,$i(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:rs(t.type,s),o.props=c,u=t.pendingProps,p=o.context,"object"===typeof(l=r.contextType)&&null!==l?l=Ai(l):l=Na(t,l=Da(r)?Aa:ka.current);var h=r.getDerivedStateFromProps;(d="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==u||p!==l)&&ss(t,o,n,l),Pi=!1,p=t.memoizedState,o.state=p,zi(t,n,o,a);var m=t.memoizedState;s!==u||p!==m||Ia.current||Pi?("function"===typeof h&&(ns(t,r,h,n),m=t.memoizedState),(c=Pi||is(t,r,c,n,p,m,l)||!1)?(d||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(n,m,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,m,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),o.props=n,o.state=m,o.context=l,n=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return ks(e,t,r,n,i,a)}function ks(e,t,r,n,a,i){Ss(e,t);var o=0!==(128&t.flags);if(!n&&!o)return a&&$a(t,r,!1),Gs(e,t,i);n=t.stateNode,vs.current=t;var s=o&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=bi(t,e.child,null,i),t.child=bi(t,null,s,i)):bs(e,t,s,i),t.memoizedState=n.state,a&&$a(t,r,!0),t.child}function Is(e){var t=e.stateNode;t.pendingContext?Ra(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ra(0,t.context,!1),Yi(e,t.containerInfo)}function As(e,t,r,n,a){return hi(),mi(a),t.flags|=256,bs(e,t,r,n),t.child}var Ns,Ds,Ms,Rs,Ps={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function $s(e,t,r){var n,a=t.pendingProps,o=Zi.current,s=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&o)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),ja(Zi,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,s?(a=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Lc(l,a,0,null),e=Pc(e,a,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(r),t.memoizedState=Ps,e):Os(t,l));if(null!==(o=e.memoizedState)&&null!==(n=o.dehydrated))return function(e,t,r,n,a,o,s){if(r)return 256&t.flags?(t.flags&=-257,qs(e,t,s,n=ds(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=n.fallback,a=t.mode,n=Lc({mode:"visible",children:n.children},a,0,null),(o=Pc(o,a,s,null)).flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,0!==(1&t.mode)&&bi(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Ps,o);if(0===(1&t.mode))return qs(e,t,s,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var l=n.dgst;return n=l,qs(e,t,s,n=ds(o=Error(i(419)),n,void 0))}if(l=0!==(s&e.childLanes),xs||l){if(null!==(n=Il)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ri(e,a),rc(n,e,a,-1))}return fc(),qs(e,t,s,n=ds(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ni=ca(a.nextSibling),ri=t,ai=!0,ii=null,null!==e&&(Va[Qa++]=Ka,Va[Qa++]=Xa,Va[Qa++]=Ya,Ka=e.id,Xa=e.overflow,Ya=t),t=Os(t,n.children),t.flags|=4096,t)}(e,t,l,a,n,o,r);if(s){s=a.fallback,l=t.mode,n=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Mc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==n?s=Mc(n,s):(s=Pc(s,l,r,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,l=null===(l=e.child.memoizedState)?Ls(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Ps,a}return e=(s=e.child).sibling,a=Mc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=r),a.return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Os(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function qs(e,t,r,n){return null!==n&&mi(n),bi(t,e.child,null,r),(e=Os(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ki(e.return,t,r)}function Fs(e,t,r,n,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function zs(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(bs(e,t,n.children,r),0!==(2&(n=Zi.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,r,t);else if(19===e.tag)Us(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ja(Zi,n),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===eo(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Fs(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===eo(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Fs(t,!0,r,null,i);break;case"together":Fs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=Mc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Mc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Ws(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Hs(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Vs(e,t,r){var n=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hs(t),null;case 1:case 17:return Da(t.type)&&Ma(),Hs(t),null;case 3:return n=t.stateNode,Ki(),Sa(Ia),Sa(ka),ro(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ui(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(oc(ii),ii=null))),Ds(e,t),Hs(t),null;case 5:Ji(t);var a=Qi(Vi.current);if(r=t.type,null!==e&&null!=t.stateNode)Ms(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(i(166));return Hs(t),null}if(e=Qi(Wi.current),ui(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[pa]=t,n[ha]=o,e=0!==(1&t.mode),r){case"dialog":qn("cancel",n),qn("close",n);break;case"iframe":case"object":case"embed":qn("load",n);break;case"video":case"audio":for(a=0;a<Pn.length;a++)qn(Pn[a],n);break;case"source":qn("error",n);break;case"img":case"image":case"link":qn("error",n),qn("load",n);break;case"details":qn("toggle",n);break;case"input":K(n,o),qn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},qn("invalid",n);break;case"textarea":ae(n,o),qn("invalid",n)}for(var l in ve(r,o),a=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jn(n.textContent,c,e),a=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jn(n.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&qn("scroll",n)}switch(r){case"input":H(n),Z(n,o,!0);break;case"textarea":H(n),oe(n);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(n.onclick=Zn)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[pa]=t,e[ha]=n,Ns(e,t,!1,!1),t.stateNode=e;e:{switch(l=xe(r,n),r){case"dialog":qn("cancel",e),qn("close",e),a=n;break;case"iframe":case"object":case"embed":qn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Pn.length;a++)qn(Pn[a],e);a=n;break;case"source":qn("error",e),a=n;break;case"img":case"image":case"link":qn("error",e),qn("load",e),a=n;break;case"details":qn("toggle",e),a=n;break;case"input":K(e,n),a=Y(e,n),qn("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=$({},n,{value:void 0}),qn("invalid",e);break;case"textarea":ae(e,n),a=ne(e,n),qn("invalid",e)}for(o in ve(r,a),c=a)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?ye(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===o?"string"===typeof d?("textarea"!==r||""!==d)&&pe(e,d):"number"===typeof d&&pe(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=d&&"onScroll"===o&&qn("scroll",e):null!=d&&x(e,o,d,l))}switch(r){case"input":H(e),Z(e,n,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=n.value&&e.setAttribute("value",""+G(n.value));break;case"select":e.multiple=!!n.multiple,null!=(o=n.value)?re(e,!!n.multiple,o,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Hs(t),null;case 6:if(e&&null!=t.stateNode)Rs(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(r=Qi(Vi.current),Qi(Wi.current),ui(t)){if(n=t.stateNode,r=t.memoizedProps,n[pa]=t,(o=n.nodeValue!==r)&&null!==(e=ri))switch(e.tag){case 3:Jn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jn(n.nodeValue,r,0!==(1&e.mode))}o&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[pa]=t,t.stateNode=n}return Hs(t),null;case 13:if(Sa(Zi),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ni&&0!==(1&t.mode)&&0===(128&t.flags))pi(),hi(),t.flags|=98560,o=!1;else if(o=ui(t),null!==n&&null!==n.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[pa]=t}else hi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Hs(t),o=!1}else null!==ii&&(oc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Rl&&(Rl=3):fc())),null!==t.updateQueue&&(t.flags|=4),Hs(t),null);case 4:return Ki(),Ds(e,t),null===e&&zn(t.stateNode.containerInfo),Hs(t),null;case 10:return Ci(t.type._context),Hs(t),null;case 19:if(Sa(Zi),null===(o=t.memoizedState))return Hs(t),null;if(n=0!==(128&t.flags),null===(l=o.rendering))if(n)Ws(o,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Ws(o,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(o=r).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ja(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>zl&&(t.flags|=128,n=!0,Ws(o,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=eo(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Ws(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ai)return Hs(t),null}else 2*Xe()-o.renderingStartTime>zl&&1073741824!==r&&(t.flags|=128,n=!0,Ws(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=o.last)?r.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,r=Zi.current,ja(Zi,n?1&r|2:1&r),t):(Hs(t),null);case 22:case 23:return uc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Hs(t),6&t.subtreeFlags&&(t.flags|=8192)):Hs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Qs(e,t){switch(ti(t),t.tag){case 1:return Da(t.type)&&Ma(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ki(),Sa(Ia),Sa(ka),ro(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ji(t),null;case 13:if(Sa(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sa(Zi),null;case 4:return Ki(),null;case 10:return Ci(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ns=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Ds=function(){},Ms=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Qi(Wi.current);var i,o=null;switch(r){case"input":a=Y(e,a),n=Y(e,n),o=[];break;case"select":a=$({},a,{value:void 0}),n=$({},n,{value:void 0}),o=[];break;case"textarea":a=ne(e,a),n=ne(e,n),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(d in ve(r,n),r=null,a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(s.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in n){var c=n[d];if(l=null!=a?a[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(o||(o=[]),o.push(d,r)),r=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(s.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&qn("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},Rs=function(e,t,r,n){r!==n&&(t.flags|=4)};var Ys=!1,Ks=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Js=null;function Zs(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){Tc(e,t,n)}else r.current=null}function el(e,t,r){try{r()}catch(n){Tc(e,t,n)}}var tl=!1;function rl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&el(t,r,i)}a=a.next}while(a!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function al(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pa],delete t[ha],delete t[fa],delete t[ya],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var dl=null,ul=!1;function pl(e,t,r){for(r=r.child;null!==r;)hl(e,t,r),r=r.sibling}function hl(e,t,r){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,r)}catch(s){}switch(r.tag){case 5:Ks||Zs(r,t);case 6:var n=dl,a=ul;dl=null,pl(e,t,r),ul=a,null!==(dl=n)&&(ul?(e=dl,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):dl.removeChild(r.stateNode));break;case 18:null!==dl&&(ul?(e=dl,r=r.stateNode,8===e.nodeType?la(e.parentNode,r):1===e.nodeType&&la(e,r),zt(e)):la(dl,r.stateNode));break;case 4:n=dl,a=ul,dl=r.stateNode.containerInfo,ul=!0,pl(e,t,r),dl=n,ul=a;break;case 0:case 11:case 14:case 15:if(!Ks&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&el(r,t,o),a=a.next}while(a!==n)}pl(e,t,r);break;case 1:if(!Ks&&(Zs(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Tc(r,t,s)}pl(e,t,r);break;case 21:pl(e,t,r);break;case 22:1&r.mode?(Ks=(n=Ks)||null!==r.memoizedState,pl(e,t,r),Ks=n):pl(e,t,r);break;default:pl(e,t,r)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Xs),t.forEach((function(t){var n=kc.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function fl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(i(160));hl(o,s,a),dl=null,ul=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){Tc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),gl(e),4&n){try{rl(3,e,e.return),nl(3,e)}catch(y){Tc(e,e.return,y)}try{rl(5,e,e.return)}catch(y){Tc(e,e.return,y)}}break;case 1:fl(t,e),gl(e),512&n&&null!==r&&Zs(r,r.return);break;case 5:if(fl(t,e),gl(e),512&n&&null!==r&&Zs(r,r.return),32&e.flags){var a=e.stateNode;try{pe(a,"")}catch(y){Tc(e,e.return,y)}}if(4&n&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==r?r.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&X(a,o),xe(l,s);var d=xe(l,o);for(s=0;s<c.length;s+=2){var u=c[s],p=c[s+1];"style"===u?ye(a,p):"dangerouslySetInnerHTML"===u?ue(a,p):"children"===u?pe(a,p):x(a,u,p,d)}switch(l){case"input":J(a,o);break;case"textarea":ie(a,o);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var m=o.value;null!=m?re(a,!!o.multiple,m,!1):h!==!!o.multiple&&(null!=o.defaultValue?re(a,!!o.multiple,o.defaultValue,!0):re(a,!!o.multiple,o.multiple?[]:"",!1))}a[ha]=o}catch(y){Tc(e,e.return,y)}}break;case 6:if(fl(t,e),gl(e),4&n){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(y){Tc(e,e.return,y)}}break;case 3:if(fl(t,e),gl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(y){Tc(e,e.return,y)}break;case 4:default:fl(t,e),gl(e);break;case 13:fl(t,e),gl(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Fl=Xe())),4&n&&ml(e);break;case 22:if(u=null!==r&&null!==r.memoizedState,1&e.mode?(Ks=(d=Ks)||u,fl(t,e),Ks=d):fl(t,e),gl(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Js=e,u=e.child;null!==u;){for(p=Js=u;null!==Js;){switch(m=(h=Js).child,h.tag){case 0:case 11:case 14:case 15:rl(4,h,h.return);break;case 1:Zs(h,h.return);var f=h.stateNode;if("function"===typeof f.componentWillUnmount){n=h,r=h.return;try{t=n,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(y){Tc(n,r,y)}}break;case 5:Zs(h,h.return);break;case 22:if(null!==h.memoizedState){wl(p);continue}}null!==m?(m.return=h,Js=m):wl(p)}u=u.sibling}e:for(u=null,p=e;;){if(5===p.tag){if(null===u){u=p;try{a=p.stateNode,d?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",s))}catch(y){Tc(e,e.return,y)}}}else if(6===p.tag){if(null===u)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(y){Tc(e,e.return,y)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:fl(t,e),gl(e),4&n&&ml(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(ol(r)){var n=r;break e}r=r.return}throw Error(i(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(pe(a,""),n.flags&=-33),cl(e,sl(e),a);break;case 3:case 4:var o=n.stateNode.containerInfo;ll(e,sl(e),o);break;default:throw Error(i(161))}}catch(s){Tc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,r){Js=e,xl(e,t,r)}function xl(e,t,r){for(var n=0!==(1&e.mode);null!==Js;){var a=Js,i=a.child;if(22===a.tag&&n){var o=null!==a.memoizedState||Ys;if(!o){var s=a.alternate,l=null!==s&&null!==s.memoizedState||Ks;s=Ys;var c=Ks;if(Ys=o,(Ks=l)&&!c)for(Js=a;null!==Js;)l=(o=Js).child,22===o.tag&&null!==o.memoizedState?_l(a):null!==l?(l.return=o,Js=l):_l(a);for(;null!==i;)Js=i,xl(i,t,r),i=i.sibling;Js=a,Ys=s,Ks=c}bl(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Js=i):bl(e)}}function bl(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ks||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ks)if(null===r)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:rs(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Bi(t,o,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Bi(t,s,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var p=u.dehydrated;null!==p&&zt(p)}}}break;default:throw Error(i(163))}Ks||512&t.flags&&al(t)}catch(h){Tc(t,t.return,h)}}if(t===e){Js=null;break}if(null!==(r=t.sibling)){r.return=t.return,Js=r;break}Js=t.return}}function wl(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Js=r;break}Js=t.return}}function _l(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nl(4,t)}catch(l){Tc(t,r,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(l){Tc(t,a,l)}}var i=t.return;try{al(t)}catch(l){Tc(t,i,l)}break;case 5:var o=t.return;try{al(t)}catch(l){Tc(t,o,l)}}}catch(l){Tc(t,t.return,l)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var El,Tl=Math.ceil,Sl=b.ReactCurrentDispatcher,jl=b.ReactCurrentOwner,Cl=b.ReactCurrentBatchConfig,kl=0,Il=null,Al=null,Nl=0,Dl=0,Ml=Ta(0),Rl=0,Pl=null,Ll=0,$l=0,Ol=0,ql=null,Ul=null,Fl=0,zl=1/0,Bl=null,Gl=!1,Wl=null,Hl=null,Vl=!1,Ql=null,Yl=0,Kl=0,Xl=null,Jl=-1,Zl=0;function ec(){return 0!==(6&kl)?Xe():-1!==Jl?Jl:Jl=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==Nl?Nl&-Nl:null!==fi.transition?(0===Zl&&(Zl=ft()),Zl):0!==(e=xt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function rc(e,t,r,n){if(50<Kl)throw Kl=0,Xl=null,Error(i(185));gt(e,r,n),0!==(2&kl)&&e===Il||(e===Il&&(0===(2&kl)&&($l|=r),4===Rl&&sc(e,Nl)),nc(e,n),1===r&&0===kl&&0===(1&t.mode)&&(zl=Xe()+500,qa&&za()))}function nc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,l=a[o];-1===l?0!==(s&r)&&0===(s&n)||(a[o]=ht(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var n=pt(e,e===Il?Nl:0);if(0===n)null!==r&&Qe(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Qe(r),1===t)0===e.tag?function(e){qa=!0,Fa(e)}(lc.bind(null,e)):Fa(lc.bind(null,e)),oa((function(){0===(6&kl)&&za()})),r=null;else{switch(bt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Ic(r,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ac(e,t){if(Jl=-1,Zl=0,0!==(6&kl))throw Error(i(327));var r=e.callbackNode;if(_c()&&e.callbackNode!==r)return null;var n=pt(e,e===Il?Nl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=yc(e,n);else{t=n;var a=kl;kl|=2;var o=mc();for(Il===e&&Nl===t||(Bl=null,zl=Xe()+500,pc(e,t));;)try{vc();break}catch(l){hc(e,l)}ji(),Sl.current=o,kl=a,null!==Al?t=0:(Il=null,Nl=0,t=Rl)}if(0!==t){if(2===t&&(0!==(a=mt(e))&&(n=a,t=ic(e,a))),1===t)throw r=Pl,pc(e,0),sc(e,n),nc(e,Xe()),r;if(6===t)sc(e,n);else{if(a=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!sn(i(),a))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=yc(e,n))&&(0!==(o=mt(e))&&(n=o,t=ic(e,o))),1===t))throw r=Pl,pc(e,0),sc(e,n),nc(e,Xe()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,Ul,Bl);break;case 3:if(sc(e,n),(130023424&n)===n&&10<(t=Fl+500-Xe())){if(0!==pt(e,0))break;if(((a=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=na(wc.bind(null,e,Ul,Bl),t);break}wc(e,Ul,Bl);break;case 4:if(sc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-ot(n);o=1<<s,(s=t[s])>a&&(a=s),n&=~o}if(n=a,10<(n=(120>(n=Xe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Tl(n/1960))-n)){e.timeoutHandle=na(wc.bind(null,e,Ul,Bl),n);break}wc(e,Ul,Bl);break;default:throw Error(i(329))}}}return nc(e,Xe()),e.callbackNode===r?ac.bind(null,e):null}function ic(e,t){var r=ql;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=Ul,Ul=r,null!==t&&oc(t)),e}function oc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function sc(e,t){for(t&=~Ol,t&=~$l,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ot(t),n=1<<r;e[r]=-1,t&=~n}}function lc(e){if(0!==(6&kl))throw Error(i(327));_c();var t=pt(e,0);if(0===(1&t))return nc(e,Xe()),null;var r=yc(e,t);if(0!==e.tag&&2===r){var n=mt(e);0!==n&&(t=n,r=ic(e,n))}if(1===r)throw r=Pl,pc(e,0),sc(e,t),nc(e,Xe()),r;if(6===r)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,Bl),nc(e,Xe()),null}function cc(e,t){var r=kl;kl|=1;try{return e(t)}finally{0===(kl=r)&&(zl=Xe()+500,qa&&za())}}function dc(e){null!==Ql&&0===Ql.tag&&0===(6&kl)&&_c();var t=kl;kl|=1;var r=Cl.transition,n=xt;try{if(Cl.transition=null,xt=1,e)return e()}finally{xt=n,Cl.transition=r,0===(6&(kl=t))&&za()}}function uc(){Dl=Ml.current,Sa(Ml)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,aa(r)),null!==Al)for(r=Al.return;null!==r;){var n=r;switch(ti(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Ma();break;case 3:Ki(),Sa(Ia),Sa(ka),ro();break;case 5:Ji(n);break;case 4:Ki();break;case 13:case 19:Sa(Zi);break;case 10:Ci(n.type._context);break;case 22:case 23:uc()}r=r.return}if(Il=e,Al=e=Mc(e.current,null),Nl=Dl=t,Rl=0,Pl=null,Ol=$l=Ll=0,Ul=ql=null,null!==Ni){for(t=0;t<Ni.length;t++)if(null!==(n=(r=Ni[t]).interleaved)){r.interleaved=null;var a=n.next,i=r.pending;if(null!==i){var o=i.next;i.next=a,n.next=o}r.pending=n}Ni=null}return e}function hc(e,t){for(;;){var r=Al;try{if(ji(),no.current=Jo,co){for(var n=oo.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}co=!1}if(io=0,lo=so=oo=null,uo=!1,po=0,jl.current=null,null===r||null===r.return){Rl=1,Pl=t,Al=null;break}e:{var o=e,s=r.return,l=r,c=t;if(t=Nl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,p=u.tag;if(0===(1&u.mode)&&(0===p||11===p||15===p)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=ys(s);if(null!==m){m.flags&=-257,gs(m,s,l,0,t),1&m.mode&&fs(o,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var y=new Set;y.add(c),t.updateQueue=y}else f.add(c);break e}if(0===(1&t)){fs(o,d,t),fc();break e}c=Error(i(426))}else if(ai&&1&l.mode){var g=ys(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),gs(g,s,l,0,t),mi(cs(c,l));break e}}o=c=cs(c,l),4!==Rl&&(Rl=2),null===ql?ql=[o]:ql.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Fi(o,hs(0,c,t));break e;case 1:l=c;var v=o.type,x=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Hl||!Hl.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t,Fi(o,ms(o,l,t));break e}}o=o.return}while(null!==o)}bc(r)}catch(b){t=b,Al===r&&null!==r&&(Al=r=r.return);continue}break}}function mc(){var e=Sl.current;return Sl.current=Jo,null===e?Jo:e}function fc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Il||0===(268435455&Ll)&&0===(268435455&$l)||sc(Il,Nl)}function yc(e,t){var r=kl;kl|=2;var n=mc();for(Il===e&&Nl===t||(Bl=null,pc(e,t));;)try{gc();break}catch(a){hc(e,a)}if(ji(),kl=r,Sl.current=n,null!==Al)throw Error(i(261));return Il=null,Nl=0,Rl}function gc(){for(;null!==Al;)xc(Al)}function vc(){for(;null!==Al&&!Ye();)xc(Al)}function xc(e){var t=El(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?bc(e):Al=t,jl.current=null}function bc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Vs(r,t,Dl)))return void(Al=r)}else{if(null!==(r=Qs(r,t)))return r.flags&=32767,void(Al=r);if(null===e)return Rl=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Rl&&(Rl=5)}function wc(e,t,r){var n=xt,a=Cl.transition;try{Cl.transition=null,xt=1,function(e,t,r,n){do{_c()}while(null!==Ql);if(0!==(6&kl))throw Error(i(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ot(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}(e,o),e===Il&&(Al=Il=null,Nl=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Vl||(Vl=!0,Ic(tt,(function(){return _c(),null}))),o=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var s=xt;xt=1;var l=kl;kl|=4,jl.current=null,function(e,t){if(ea=Gt,hn(e=pn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch(w){r=null;break e}var s=0,l=-1,c=-1,d=0,u=0,p=e,h=null;t:for(;;){for(var m;p!==r||0!==a&&3!==p.nodeType||(l=s+a),p!==o||0!==n&&3!==p.nodeType||(c=s+n),3===p.nodeType&&(s+=p.nodeValue.length),null!==(m=p.firstChild);)h=p,p=m;for(;;){if(p===e)break t;if(h===r&&++d===a&&(l=s),h===o&&++u===n&&(c=s),null!==(m=p.nextSibling))break;h=(p=h).parentNode}p=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ta={focusedElem:e,selectionRange:r},Gt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var y=f.memoizedProps,g=f.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?y:rs(t.type,y),g);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(i(163))}}catch(w){Tc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}f=tl,tl=!1}(e,r),yl(r,e),mn(ta),Gt=!!ea,ta=ea=null,e.current=r,vl(r,e,a),Ke(),kl=l,xt=s,Cl.transition=o}else e.current=r;if(Vl&&(Vl=!1,Ql=e,Yl=a),o=e.pendingLanes,0===o&&(Hl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),nc(e,Xe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Gl)throw Gl=!1,e=Wl,Wl=null,e;0!==(1&Yl)&&0!==e.tag&&_c(),o=e.pendingLanes,0!==(1&o)?e===Xl?Kl++:(Kl=0,Xl=e):Kl=0,za()}(e,t,r,n)}finally{Cl.transition=a,xt=n}return null}function _c(){if(null!==Ql){var e=bt(Yl),t=Cl.transition,r=xt;try{if(Cl.transition=null,xt=16>e?16:e,null===Ql)var n=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&kl))throw Error(i(331));var a=kl;for(kl|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Js=d;null!==Js;){var u=Js;switch(u.tag){case 0:case 11:case 15:rl(8,u,o)}var p=u.child;if(null!==p)p.return=u,Js=p;else for(;null!==Js;){var h=(u=Js).sibling,m=u.return;if(il(u),u===d){Js=null;break}if(null!==h){h.return=m,Js=h;break}Js=m}}}var f=o.alternate;if(null!==f){var y=f.child;if(null!==y){f.child=null;do{var g=y.sibling;y.sibling=null,y=g}while(null!==y)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:rl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Js=v;break e}Js=o.return}}var x=e.current;for(Js=x;null!==Js;){var b=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Js=b;else e:for(s=x;null!==Js;){if(0!==(2048&(l=Js).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(_){Tc(l,l.return,_)}if(l===s){Js=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Js=w;break e}Js=l.return}}if(kl=a,za(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(_){}n=!0}return n}finally{xt=r,Cl.transition=t}}return!1}function Ec(e,t,r){e=qi(e,t=hs(0,t=cs(r,t),1),1),t=ec(),null!==e&&(gt(e,1,t),nc(e,t))}function Tc(e,t,r){if(3===e.tag)Ec(e,e,r);else for(;null!==t;){if(3===t.tag){Ec(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Hl||!Hl.has(n))){t=qi(t,e=ms(t,e=cs(r,e),1),1),e=ec(),null!==t&&(gt(t,1,e),nc(t,e));break}}t=t.return}}function Sc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Il===e&&(Nl&r)===r&&(4===Rl||3===Rl&&(130023424&Nl)===Nl&&500>Xe()-Fl?pc(e,0):Ol|=r),nc(e,t)}function jc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var r=ec();null!==(e=Ri(e,t))&&(gt(e,t,r),nc(e,r))}function Cc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),jc(e,r)}function kc(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(i(314))}null!==n&&n.delete(t),jc(e,r)}function Ic(e,t){return Ve(e,t)}function Ac(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nc(e,t,r,n){return new Ac(e,t,r,n)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var r=e.alternate;return null===r?((r=Nc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Rc(e,t,r,n,a,o){var s=2;if(n=e,"function"===typeof e)Dc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case E:return Pc(r.children,a,o,t);case T:s=8,a|=8;break;case S:return(e=Nc(12,r,t,2|a)).elementType=S,e.lanes=o,e;case I:return(e=Nc(13,r,t,a)).elementType=I,e.lanes=o,e;case A:return(e=Nc(19,r,t,a)).elementType=A,e.lanes=o,e;case M:return Lc(r,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case j:s=10;break e;case C:s=9;break e;case k:s=11;break e;case N:s=14;break e;case D:s=16,n=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Nc(s,r,t,a)).elementType=e,t.type=n,t.lanes=o,t}function Pc(e,t,r,n){return(e=Nc(7,e,n,t)).lanes=r,e}function Lc(e,t,r,n){return(e=Nc(22,e,n,t)).elementType=M,e.lanes=r,e.stateNode={isHidden:!1},e}function $c(e,t,r){return(e=Nc(6,e,null,t)).lanes=r,e}function Oc(e,t,r){return(t=Nc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qc(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yt(0),this.expirationTimes=yt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yt(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Uc(e,t,r,n,a,i,o,s,l){return e=new qc(e,t,r,s,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Nc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Li(i),e}function Fc(e){if(!e)return Ca;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Da(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var r=e.type;if(Da(r))return Pa(e,r,t)}return t}function zc(e,t,r,n,a,i,o,s,l){return(e=Uc(r,n,!0,e,0,i,0,s,l)).context=Fc(null),r=e.current,(i=Oi(n=ec(),a=tc(r))).callback=void 0!==t&&null!==t?t:null,qi(r,i,a),e.current.lanes=a,gt(e,a,n),nc(e,n),e}function Bc(e,t,r,n){var a=t.current,i=ec(),o=tc(a);return r=Fc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Oi(i,o)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=qi(a,t,o))&&(rc(e,a,o,i),Ui(e,a,o)),o}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Hc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}El=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ia.current)xs=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return xs=!1,function(e,t,r){switch(t.tag){case 3:Is(t),hi();break;case 5:Xi(t);break;case 1:Da(t.type)&&La(t);break;case 4:Yi(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;ja(_i,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(ja(Zi,1&Zi.current),t.flags|=128,null):0!==(r&t.child.childLanes)?$s(e,t,r):(ja(Zi,1&Zi.current),null!==(e=Gs(e,t,r))?e.sibling:null);ja(Zi,1&Zi.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return zs(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),ja(Zi,Zi.current),n)break;return null;case 22:case 23:return t.lanes=0,Ts(e,t,r)}return Gs(e,t,r)}(e,t,r);xs=0!==(131072&e.flags)}else xs=!1,ai&&0!==(1048576&t.flags)&&Za(t,Ha,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Bs(e,t),e=t.pendingProps;var a=Na(t,ka.current);Ii(t,r),a=yo(null,t,n,e,a,r);var o=go();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Da(n)?(o=!0,La(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Li(t),a.updater=as,t.stateNode=a,a._reactInternals=t,ls(t,n,e,r),t=ks(null,t,n,!0,o,r)):(t.tag=0,ai&&o&&ei(t),bs(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Bs(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===N)return 14}return 2}(n),e=rs(n,e),a){case 0:t=js(null,t,n,e,r);break e;case 1:t=Cs(null,t,n,e,r);break e;case 11:t=ws(null,t,n,e,r);break e;case 14:t=_s(null,t,n,rs(n.type,e),r);break e}throw Error(i(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,js(e,t,n,a=t.elementType===n?a:rs(n,a),r);case 1:return n=t.type,a=t.pendingProps,Cs(e,t,n,a=t.elementType===n?a:rs(n,a),r);case 3:e:{if(Is(t),null===e)throw Error(i(387));n=t.pendingProps,a=(o=t.memoizedState).element,$i(e,t),zi(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated){if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=As(e,t,n,r,a=cs(Error(i(423)),t));break e}if(n!==a){t=As(e,t,n,r,a=cs(Error(i(424)),t));break e}for(ni=ca(t.stateNode.containerInfo.firstChild),ri=t,ai=!0,ii=null,r=wi(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(hi(),n===a){t=Gs(e,t,r);break e}bs(e,t,n,r)}t=t.child}return t;case 5:return Xi(t),null===e&&ci(t),n=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,ra(n,a)?s=null:null!==o&&ra(n,o)&&(t.flags|=32),Ss(e,t),bs(e,t,s,r),t.child;case 6:return null===e&&ci(t),null;case 13:return $s(e,t,r);case 4:return Yi(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=bi(t,null,n,r):bs(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,ws(e,t,n,a=t.elementType===n?a:rs(n,a),r);case 7:return bs(e,t,t.pendingProps,r),t.child;case 8:case 12:return bs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,ja(_i,n._currentValue),n._currentValue=s,null!==o)if(sn(o.value,s)){if(o.children===a.children&&!Ia.current){t=Gs(e,t,r);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===o.tag){(c=Oi(-1,r&-r)).tag=2;var d=o.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=r,null!==(c=o.alternate)&&(c.lanes|=r),ki(o.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),ki(s,r,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}bs(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ii(t,r),n=n(a=Ai(a)),t.flags|=1,bs(e,t,n,r),t.child;case 14:return a=rs(n=t.type,t.pendingProps),_s(e,t,n,a=rs(n.type,a),r);case 15:return Es(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:rs(n,a),Bs(e,t),t.tag=1,Da(n)?(e=!0,La(t)):e=!1,Ii(t,r),os(t,n,a),ls(t,n,a,r),ks(null,t,n,!0,e,r);case 19:return zs(e,t,r);case 22:return Ts(e,t,r)}throw Error(i(156,t.tag))};var Vc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Gc(o);s.call(e)}}Bc(t,o,e,a)}else o=function(e,t,r,n,a){if(a){if("function"===typeof n){var i=n;n=function(){var e=Gc(o);i.call(e)}}var o=zc(t,n,e,0,null,!1,0,"",Jc);return e._reactRootContainer=o,e[ma]=o.current,zn(8===e.nodeType?e.parentNode:e),dc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof n){var s=n;n=function(){var e=Gc(l);s.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[ma]=l.current,zn(8===e.nodeType?e.parentNode:e),dc((function(){Bc(t,l,r,n)})),l}(r,t,e,a,n);return Gc(o)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Bc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Bc(null,e,null,null)})),t[ma]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Mt.length&&0!==t&&t<Mt[r].priority;r++);Mt.splice(r,0,e),0===r&&$t(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ut(t.pendingLanes);0!==r&&(vt(t,1|r),nc(t,Xe()),0===(6&kl)&&(zl=Xe()+500,za()))}break;case 13:dc((function(){var t=Ri(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}})),Hc(e,1)}},_t=function(e){if(13===e.tag){var t=Ri(e,134217728);if(null!==t)rc(t,e,134217728,ec());Hc(e,134217728)}},Et=function(e){if(13===e.tag){var t=tc(e),r=Ri(e,t);if(null!==r)rc(r,e,t,ec());Hc(e,t)}},Tt=function(){return xt},St=function(e,t){var r=xt;try{return xt=e,t()}finally{xt=r}},_e=function(e,t,r){switch(t){case"input":if(J(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=wa(n);if(!a)throw Error(i(90));V(n),J(n,a)}}}break;case"textarea":ie(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},ke=cc,Ie=dc;var ed={usingClientEntryPoint:!1,Events:[xa,ba,wa,je,Ce,cc]},td={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{at=nd.inject(rd),it=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(i(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Kc(e))throw Error(i(299));var r=!1,n="",a=Vc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Uc(e,1,!1,null,0,r,0,n,a),e[ma]=t.current,zn(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,r){if(!Xc(t))throw Error(i(200));return Zc(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Kc(e))throw Error(i(405));var n=null!=r&&r.hydratedSources||null,a=!1,o="",s=Vc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(o=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=zc(t,null,e,1,null!=r?r:null,a,0,o,s),e[ma]=t.current,zn(e),n)for(e=0;e<n.length;e++)a=(a=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Yc(t)},t.render=function(e,t,r){if(!Xc(t))throw Error(i(200));return Zc(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(i(40));return!!e._reactRootContainer&&(dc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[ma]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Xc(r))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,r,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},3010:(e,t,r)=>{"use strict";r.r(t),r.d(t,{getBreakthroughResources:()=>y,getResourceById:()=>u,getResourceByIdAsync:()=>d,getResourcesByRarity:()=>f,getResourcesByRarityAsync:()=>m,getResourcesByType:()=>h,getResourcesByTypeAsync:()=>p,loadResources:()=>c,resources:()=>l});const{unifiedDatabase:n,initializeDatabaseConnection:a}=r(8153),{Sequelize:i}=r(8568);let o;async function s(){if(!o){const{db:e}=await a();o=e}return o}let l=[];async function c(){try{const e=await s(),t=(await n.query("SELECT * FROM resources",{type:e.QueryTypes.SELECT})).map((e=>({id:e.id,name:e.name,type:e.type,rarity:e.rarity,description:e.description||"",effects:e.effects||{},value:e.value||0,stackable:e.stackable||!0,maxStack:e.max_stack||99})));return l=t,t}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0438\u0437 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445:",e),l}}async function d(e){try{const t=await s(),r=await n.query("SELECT * FROM resources WHERE id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT});if(0===r.length)return null;const a=r[0];return{id:a.id,name:a.name,type:a.type,rarity:a.rarity,description:a.description||"",effects:a.effects||{},value:a.value||0,stackable:a.stackable||!0,maxStack:a.max_stack||99}}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u0430 \u0441 ID ${e}:`,t),l.find((t=>t.id===e))||null}}function u(e){return l.find((t=>t.id===e))||null}async function p(e){try{const t=await s();return(await n.query("SELECT * FROM resources WHERE type = :type",{replacements:{type:e},type:t.QueryTypes.SELECT})).map((e=>({id:e.id,name:e.name,type:e.type,rarity:e.rarity,description:e.description||"",effects:e.effects||{},value:e.value||0,stackable:e.stackable||!0,maxStack:e.max_stack||99})))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0442\u0438\u043f\u0430 ${e}:`,t),l.filter((t=>t.type===e))}}function h(e){return l.filter((t=>t.type===e))}async function m(e){try{const t=await s();return(await n.query("SELECT * FROM resources WHERE rarity = :rarity",{replacements:{rarity:e},type:t.QueryTypes.SELECT})).map((e=>({id:e.id,name:e.name,type:e.type,rarity:e.rarity,description:e.description||"",effects:e.effects||{},value:e.value||0,stackable:e.stackable||!0,maxStack:e.max_stack||99})))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0440\u0435\u0434\u043a\u043e\u0441\u0442\u0438 ${e}:`,t),l.filter((t=>t.rarity===e))}}function f(e){return l.filter((t=>t.rarity===e))}function y(e,t){switch(e.toLowerCase()){case"\u0437\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430":const e={low_grade_herb:Math.floor(5*t+5*Math.random()),basic_pill:Math.floor(2*t+3*Math.random())};return t>=7&&(e.spirit_stone=Math.floor(2*(t-6))),e;case"\u043e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0446\u0438":const r={medium_grade_herb:Math.floor(4*t+6*Math.random()),qi_pill:Math.floor(3*t+3*Math.random()),spirit_stone:Math.floor(3*t+5*Math.random())};return t>=5&&(r.spirit_mineral=Math.floor(2*(t-4))),r;case"\u0437\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e":return{rare_herb:Math.floor(3*t+7*Math.random()),high_quality_pill:Math.floor(2*t+4*Math.random()),spirit_mineral:Math.floor(4*t+6*Math.random()),spirit_stone:Math.floor(10*t+10*Math.random())};case"\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438":return{exotic_herb:Math.floor(2*t+8*Math.random()),spirit_essence:Math.floor(3*t+5*Math.random()),beast_soul:Math.floor(1*t+3*Math.random()),spirit_mineral:Math.floor(8*t+12*Math.random()),spirit_stone:Math.floor(20*t+20*Math.random())};default:return{low_grade_herb:Math.floor(5*t+5*Math.random()),basic_pill:Math.floor(2*t+3*Math.random())}}}c().catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0443\u043b\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432:",e)}))},3249:(e,t,r)=>{const n=r(6909),a=(r(3382),"undefined"!==typeof window);let i={};e.exports=class{static async getInventoryItems(e){try{if(a)return i[e]||(i[e]=[]),i[e].map((e=>({id:e.itemId,name:e.name,type:e.type,rarity:e.rarity,quantity:e.quantity,equipped:e.equipped,...e.properties})));return(await n.findAll({where:{userId:e}})).map((e=>({id:e.itemId,name:e.name,type:e.type,rarity:e.rarity,quantity:e.quantity,equipped:e.equipped,...e.properties})))}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044f:",t),t}}static async addInventoryItem(e,t){try{if(a){i[e]||(i[e]=[]);const r=i[e].findIndex((e=>e.itemId===t.id));if(r>=0&&!1!==t.stackable){i[e][r].quantity+=t.quantity||1;const n=i[e][r];return{id:n.itemId,name:n.name,type:n.type,rarity:n.rarity,quantity:n.quantity,equipped:n.equipped,...n.properties}}{const r={userId:e,itemId:t.id,name:t.name,type:t.type||"misc",rarity:t.rarity||"common",quantity:t.quantity||1,equipped:t.equipped||!1,properties:{description:t.description,effects:t.effects,requirements:t.requirements,value:t.value,...t}};return i[e].push(r),{id:r.itemId,name:r.name,type:r.type,rarity:r.rarity,quantity:r.quantity,equipped:r.equipped,...r.properties}}}{const r=await n.findOne({where:{userId:e,itemId:t.id}});if(r&&!1!==t.stackable)return r.quantity+=t.quantity||1,await r.save(),{id:r.itemId,name:r.name,type:r.type,rarity:r.rarity,quantity:r.quantity,equipped:r.equipped,...r.properties};{const r=await n.create({userId:e,itemId:t.id,name:t.name,type:t.type||"misc",rarity:t.rarity||"common",quantity:t.quantity||1,equipped:t.equipped||!1,properties:{description:t.description,effects:t.effects,requirements:t.requirements,value:t.value,...t}});return{id:r.itemId,name:r.name,type:r.type,rarity:r.rarity,quantity:r.quantity,equipped:r.equipped,...r.properties}}}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044c:",r),r}}static async removeInventoryItem(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;try{if(a){i[e]||(i[e]=[]);const n=i[e].findIndex((e=>e.itemId===t));if(-1===n)throw new Error("\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u0435");const a=i[e][n];return a.quantity>r?a.quantity-=r:i[e].splice(n,1),!0}{const a=await n.findOne({where:{userId:e,itemId:t}});if(!a)throw new Error("\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u0435");return a.quantity>r?(a.quantity-=r,await a.save()):await a.destroy(),!0}}catch(o){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 \u0438\u0437 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044f:",o),o}}static async toggleEquipItem(e,t,r){try{if(a){i[e]||(i[e]=[]);const n=i[e].findIndex((e=>e.itemId===t));if(-1===n)throw new Error("\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u0435");i[e][n].equipped=r;const a=i[e][n];return{id:a.itemId,name:a.name,type:a.type,rarity:a.rarity,quantity:a.quantity,equipped:a.equipped,...a.properties}}{const a=await n.findOne({where:{userId:e,itemId:t}});if(!a)throw new Error("\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u0435");return a.equipped=r,await a.save(),{id:a.itemId,name:a.name,type:a.type,rarity:a.rarity,quantity:a.quantity,equipped:a.equipped,...a.properties}}}catch(o){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0435/\u0441\u043d\u044f\u0442\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430:",o),o}}}},3382:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,getInitializedUserModel:()=>l});var n=r(2342),a=r(8153);class i extends n.Model{static associate(e){i.hasOne(e.CultivationProgress,{foreignKey:"userId",as:"cultivationProgress"})}}let o=null,s=null;async function l(){return o||(s||(s=async function(){try{const e=(await a.unifiedDatabase.getSequelizeInstance()).db;return n.Model.init.call(i,{id:{type:n.DataTypes.INTEGER,autoIncrement:!0,primaryKey:!0},username:{type:n.DataTypes.STRING,allowNull:!1,unique:!0},email:{type:n.DataTypes.STRING,allowNull:!1,unique:!0},passwordHash:{type:n.DataTypes.STRING,allowNull:!1,field:"password_hash"},cultivationLevel:{type:n.DataTypes.INTEGER,defaultValue:1},experience:{type:n.DataTypes.INTEGER,defaultValue:0},lastLogin:{type:n.DataTypes.DATE}},{sequelize:e,modelName:"User",tableName:"users",timestamps:!0,underscored:!0}),console.log("User \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430"),o=i,i}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 User:",e),console.error(e.stack),e}}(),s))}l().catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 User:",e)}));const c=i},3574:(e,t,r)=>{"use strict";r.r(t),r.d(t,{equipmentItems:()=>l,getEquipmentItemById:()=>p,getEquipmentItemByIdAsync:()=>u,getEquipmentItemsByLevel:()=>y,getEquipmentItemsByLevelAsync:()=>f,getEquipmentItemsByRarity:()=>v,getEquipmentItemsByRarityAsync:()=>g,getEquipmentItemsByType:()=>m,getEquipmentItemsByTypeAsync:()=>h,loadEquipmentItems:()=>d});const{unifiedDatabase:n,initializeDatabaseConnection:a}=r(8153),{Sequelize:i}=r(8568);let o;async function s(){if(!o){const{db:e}=await a();o=e}return o}let l=[];function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const a={id:e.id,name:e.name,description:e.description||"",type:e.type,subType:e.sub_type,rarity:e.rarity,level:e.level||1,value:e.value||0,icon:e.icon};if(t.length>0&&(a.effects={},t.forEach((e=>{const t=e.stat_name,r=e.value,n=e.is_percentage;a.effects[t]={value:r,isPercentage:n}}))),r.length>0&&(a.requirements={},r.forEach((e=>{const t=e.requirement_type,r=e.value;a.requirements[t]=r}))),n.length>0&&(a.specialEffects=[],n.forEach((e=>{a.specialEffects.push({name:e.name,description:e.description,triggerCondition:e.trigger_condition,effects:JSON.parse(e.effects||"{}")})}))),e.calculated_bonuses)try{a.calculatedBonuses=JSON.parse(e.calculated_bonuses)}catch(i){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0435 \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c\u044b\u0445 \u0431\u043e\u043d\u0443\u0441\u043e\u0432:",i)}return a}async function d(){try{const e=await s(),t=await n.query("SELECT * FROM equipment_items",{type:e.QueryTypes.SELECT});if(0===t.length)return[];const r=t.map((e=>e.id)),a=`\n      SELECT * FROM equipment_item_effects \n      WHERE item_id IN (${r.map((e=>`'${e}'`)).join(",")})\n    `,i=await n.query(a,{type:e.QueryTypes.SELECT}),o=`\n      SELECT * FROM equipment_item_requirements \n      WHERE item_id IN (${r.map((e=>`'${e}'`)).join(",")})\n    `,d=await n.query(o,{type:e.QueryTypes.SELECT}),u=`\n      SELECT * FROM equipment_item_special_effects \n      WHERE item_id IN (${r.map((e=>`'${e}'`)).join(",")})\n    `,p=await n.query(u,{type:e.QueryTypes.SELECT}),h={};i.forEach((e=>{h[e.item_id]||(h[e.item_id]=[]),h[e.item_id].push(e)}));const m={};d.forEach((e=>{m[e.item_id]||(m[e.item_id]=[]),m[e.item_id].push(e)}));const f={};p.forEach((e=>{f[e.item_id]||(f[e.item_id]=[]),f[e.item_id].push(e)}));const y=t.map((e=>c(e,h[e.id]||[],m[e.id]||[],f[e.id]||[])));return l=y,y}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u0438\u0437 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445:",e),l}}async function u(e){try{const t=await s(),r=await n.query("SELECT * FROM equipment_items WHERE id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT});if(0===r.length)return null;const[a,i,o]=await Promise.all([n.query("SELECT * FROM equipment_item_effects WHERE item_id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT}),n.query("SELECT * FROM equipment_item_requirements WHERE item_id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT}),n.query("SELECT * FROM equipment_item_special_effects WHERE item_id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT})]);return c(r[0],a,i,o)}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u0441 ID ${e}:`,t),p(e)}}function p(e){return l.find((t=>t.id===e))||null}async function h(e){try{const t=await s(),r=await n.query("SELECT * FROM equipment_items WHERE type = :type",{replacements:{type:e},type:t.QueryTypes.SELECT});if(0===r.length)return[];const a=r.map((e=>e.id)),[i,o,l]=await Promise.all([n.query(`SELECT * FROM equipment_item_effects WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM equipment_item_requirements WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM equipment_item_special_effects WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT})]),d={};i.forEach((e=>{d[e.item_id]||(d[e.item_id]=[]),d[e.item_id].push(e)}));const u={};o.forEach((e=>{u[e.item_id]||(u[e.item_id]=[]),u[e.item_id].push(e)}));const p={};return l.forEach((e=>{p[e.item_id]||(p[e.item_id]=[]),p[e.item_id].push(e)})),r.map((e=>c(e,d[e.id]||[],u[e.id]||[],p[e.id]||[])))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u0442\u0438\u043f\u0430 ${e}:`,t),m(e)}}function m(e){return l.filter((t=>t.type===e))}async function f(e){try{const t=await s(),r=await n.query("SELECT * FROM equipment_items WHERE level = :level",{replacements:{level:e},type:t.QueryTypes.SELECT});if(0===r.length)return[];const a=r.map((e=>e.id)),[i,o,l]=await Promise.all([n.query(`SELECT * FROM equipment_item_effects WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM equipment_item_requirements WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM equipment_item_special_effects WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT})]),d={};i.forEach((e=>{d[e.item_id]||(d[e.item_id]=[]),d[e.item_id].push(e)}));const u={};o.forEach((e=>{u[e.item_id]||(u[e.item_id]=[]),u[e.item_id].push(e)}));const p={};return l.forEach((e=>{p[e.item_id]||(p[e.item_id]=[]),p[e.item_id].push(e)})),r.map((e=>c(e,d[e.id]||[],u[e.id]||[],p[e.id]||[])))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u0443\u0440\u043e\u0432\u043d\u044f ${e}:`,t),y(e)}}function y(e){return l.filter((t=>t.level===e))}async function g(e){try{const t=await s(),r=await n.query("SELECT * FROM equipment_items WHERE rarity = :rarity",{replacements:{rarity:e},type:t.QueryTypes.SELECT});if(0===r.length)return[];const a=r.map((e=>e.id)),[i,o,l]=await Promise.all([n.query(`SELECT * FROM equipment_item_effects WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM equipment_item_requirements WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM equipment_item_special_effects WHERE item_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT})]),d={};i.forEach((e=>{d[e.item_id]||(d[e.item_id]=[]),d[e.item_id].push(e)}));const u={};o.forEach((e=>{u[e.item_id]||(u[e.item_id]=[]),u[e.item_id].push(e)}));const p={};return l.forEach((e=>{p[e.item_id]||(p[e.item_id]=[]),p[e.item_id].push(e)})),r.map((e=>c(e,d[e.id]||[],u[e.id]||[],p[e.id]||[])))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u0440\u0435\u0434\u043a\u043e\u0441\u0442\u0438 ${e}:`,t),v(e)}}function v(e){return l.filter((t=>t.rarity===e))}d().catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0443\u043b\u044f \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:",e)}))},3603:(e,t,r)=>{const n=r(5043),a=e=>{if("number"!==typeof e||e<0)return 0;if(e>=50){const t=Math.floor(e/10);return Math.min(50,t)}return e<=20?-10:0},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;if(!t||void 0===r||null===r)return console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441 \u0441\u0435\u043a\u0442\u043e\u0439: \u043d\u0435\u043f\u043e\u043b\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0441\u0435\u043a\u0442\u0435"),e;Array.isArray(e)||(console.warn("\u26a0\ufe0f \u041e\u0431\u044a\u0435\u043a\u0442 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c, \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u043c\u0430\u0441\u0441\u0438\u0432"),e=[]);const n=e.findIndex((e=>e.name===t.name));if(n>=0){const a=[...e];return a[n]={...a[n],level:r},console.log(`\u2705 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441 \u0441\u0435\u043a\u0442\u043e\u0439 "${t.name}" \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f ${r}`),a}{const n={id:Date.now(),name:t.name,role:"\u0421\u0435\u043a\u0442\u0430",level:r,events:[`\u0412\u044b \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u043b\u0438\u0441\u044c \u043a \u0441\u0435\u043a\u0442\u0435 "${t.name}"`]};return console.log(`\u2705 \u0421\u043e\u0437\u0434\u0430\u043d\u0430 \u043d\u043e\u0432\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 \u0441\u0435\u043a\u0442\u043e\u0439 "${t.name}" \u0441 \u0443\u0440\u043e\u0432\u043d\u0435\u043c ${r}`),[...e,n]}};e.exports={calculateMerchantDiscount:a,applyLoyaltyDiscount:(e,t)=>{const r=a(t);if(0===r)return{finalPrice:e,discount:0};let n;if(r<0){const t=Math.abs(r);n=Math.floor(e*(1+t/100))}else n=Math.floor(e*(1-r/100));return n=Math.max(1,n),{finalPrice:n,discount:r}},syncSectRelationships:e=>(console.log("\ud83d\udd04 \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0430. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 updateRelationshipAndLoyalty \u0434\u043b\u044f \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f"),e),syncRelationshipsFromLoyalty:e=>{if(!e.player||!e.player.social||!e.sect||!e.sect.sect)return console.warn("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441\u0435\u043a\u0442: \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u0430\u043d\u043d\u044b\u0445"),e;const{player:t,sect:r}=e,{relationships:n=[]}=t.social,{members:a=[]}=r.sect;let o=[...n];return void 0!==r.sect.loyalty&&(o=i(o,r.sect,r.sect.loyalty)),a.forEach((e=>{if(!e.name)return;const t=o.findIndex((t=>t.name===e.name));-1!==t?o[t]={...o[t],level:e.loyalty||0,lastUpdated:Date.now()}:o.push({id:`sect_member_${e.id||Date.now()}`,name:e.name,type:"sect_member",level:e.loyalty||0,lastUpdated:Date.now()})})),{...e,player:{...t,social:{...t.social,relationships:o}}}},syncLoyaltyFromRelationships:e=>{if(!e.player||!e.player.social||!e.sect||!e.sect.sect)return console.warn("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0447\u043b\u0435\u043d\u043e\u0432 \u0441\u0435\u043a\u0442\u044b: \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u0430\u043d\u043d\u044b\u0445"),e;const{player:t,sect:r}=e,{relationships:n=[]}=t.social;let{members:a=[]}=r.sect;const i=[...a],o=n.find((e=>e.name===r.sect.name));if(o&&void 0!==o.level){const t={...r.sect,loyalty:o.level};return console.log(`\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0435\u043a\u0442\u044b ${r.sect.name}: ${o.level}`),n.forEach((e=>{if(!e.name)return;const t=i.findIndex((t=>t.name===e.name));-1!==t&&(i[t]={...i[t],loyalty:e.level||0})})),{...e,sect:{...r,sect:t,members:i}}}return n.forEach((e=>{if(!e.name)return;const t=i.findIndex((t=>t.name===e.name));-1!==t&&(i[t]={...i[t],loyalty:e.level||0})})),{...e,sect:{...r,sect:{...r.sect,members:i}}}},syncSectRelationshipToSocial:i,syncSocialToSectRelationship:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!t)return console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c: \u0441\u0435\u043a\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"),null;if(!Array.isArray(e))return console.warn("\u26a0\ufe0f \u041e\u0431\u044a\u0435\u043a\u0442 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c"),null;const r=e.find((e=>e.name===t.name));return r&&void 0!==r.level?(console.log(`\u2705 \u041d\u0430\u0439\u0434\u0435\u043d\u0430 \u0437\u0430\u043f\u0438\u0441\u044c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 \u0441\u0435\u043a\u0442\u043e\u0439 "${t.name}" \u0441 \u0443\u0440\u043e\u0432\u043d\u0435\u043c ${r.level}`),r.level):(console.log(`\u26a0\ufe0f \u0417\u0430\u043f\u0438\u0441\u044c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 \u0441\u0435\u043a\u0442\u043e\u0439 "${t.name}" \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430`),null)},findRelatedMerchantId:(e,t)=>{if(!e||!Array.isArray(t))return null;const r=t.find((t=>t.name.includes(e)||t.affiliation&&t.affiliation.includes(e)));return r?r.id:null},syncSingleMember:function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||!e.name||!Array.isArray(t))return{member:e,relationships:t};const n=t.findIndex((t=>t.name===e.name));if(!r){const r=[...t];return n>=0?r[n]={...r[n],level:e.loyalty||0,lastUpdated:Date.now()}:r.push({id:`sect_member_${e.id||Date.now()}`,name:e.name,type:"sect_member",role:e.role||"\u0427\u043b\u0435\u043d \u0441\u0435\u043a\u0442\u044b",level:e.loyalty||0,lastUpdated:Date.now()}),{member:e,relationships:r}}return n>=0&&void 0!==t[n].level?{member:{...e,loyalty:t[n].level},relationships:t}:{member:e,relationships:t}},initRelationshipSync:e=>{e&&"function"===typeof e.getState&&"function"===typeof e.dispatch?console.log("\u2705 \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0433\u043e\u0442\u043e\u0432\u0430. \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0430."):console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430: initRelationshipSync \u0432\u044b\u0437\u0432\u0430\u043d \u0441 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u043c \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u043e\u043c")},updateRelationshipAndLoyalty:(e,t,r)=>{if(!e||!t||void 0===r||null===r)return console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f/\u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c: \u043d\u0435\u043f\u043e\u043b\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"),e;console.log(`\ud83d\udd04 \u041f\u0440\u044f\u043c\u043e\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0434\u043b\u044f "${t}" \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f ${r}`);let n={...e};if(n.sect&&n.sect.sect&&(n.sect.sect.name===t&&(console.log(`\u2705 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0435\u043a\u0442\u044b "${t}" \u0434\u043e ${r}`),n={...n,sect:{...n.sect,sect:{...n.sect.sect,loyalty:r}}}),n.sect.sect.members&&Array.isArray(n.sect.sect.members))){const e=n.sect.sect.members.findIndex((e=>e.name===t));if(-1!==e){console.log(`\u2705 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b "${t}" \u0434\u043e ${r}`);const a=[...n.sect.sect.members];a[e]={...a[e],loyalty:r},n={...n,sect:{...n.sect,sect:{...n.sect.sect,members:a}}}}}if(n.player&&n.player.social&&Array.isArray(n.player.social.relationships)){const e=n.player.social.relationships.findIndex((e=>e.name===t));if(-1!==e){console.log(`\u2705 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441 "${t}" \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f ${r}`);const a=[...n.player.social.relationships];a[e]={...a[e],level:r,lastUpdated:Date.now()},n={...n,player:{...n.player,social:{...n.player.social,relationships:a}}}}else if(n.sect&&n.sect.sect&&n.sect.sect.name===t||n.sect&&n.sect.sect&&n.sect.sect.members&&n.sect.sect.members.some((e=>e.name===t))){const e=n.sect.sect.name===t,a=e?"\u0421\u0435\u043a\u0442\u0430":"\u0427\u043b\u0435\u043d \u0441\u0435\u043a\u0442\u044b",i={id:`relation_${Date.now()}`,name:t,role:a,level:r,lastUpdated:Date.now(),events:e?[`\u0412\u044b \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u043b\u0438\u0441\u044c \u043a \u0441\u0435\u043a\u0442\u0435 "${t}"`]:[]};console.log(`\u2705 \u0421\u043e\u0437\u0434\u0430\u043d\u0430 \u043d\u043e\u0432\u0430\u044f \u0437\u0430\u043f\u0438\u0441\u044c \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 "${t}" \u0441 \u0443\u0440\u043e\u0432\u043d\u0435\u043c ${r}`),n={...n,player:{...n.player,social:{...n.player.social,relationships:[...n.player.social.relationships,i]}}}}}if(n.player&&Array.isArray(n.player.relationships)){const e=n.player.relationships.findIndex((e=>e.name===t));if(-1!==e){const t=[...n.player.relationships];t[e]={...t[e],level:r,lastUpdated:Date.now()},n={...n,player:{...n.player,relationships:t}}}}return n},integrateRelationshipSyncer:e=>function(t){return console.log("\u2705 \u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0430"),n.createElement(e,t)}}},3763:(e,t,r)=>{"use strict";e.exports=r(4983)},4128:()=>{},4202:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,y={};function g(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||m}function v(){}function x(e,t,r){this.props=e,this.context=t,this.refs=y,this.updater=r||m}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=g.prototype;var b=x.prototype=new v;b.constructor=x,f(b,g.prototype),b.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,E={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)_.call(t,a)&&!T.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===i[a]&&(i[a]=l[a]);return{$$typeof:r,type:e,key:o,ref:s,props:i,_owner:E.current}}function j(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var C=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return o=o(l=e),e=""===i?"."+k(l,0):i,w(o)?(a="",null!=e&&(a=e.replace(C,"$&/")+"/"),I(o,t,a,"",(function(e){return e}))):null!=o&&(j(o)&&(o=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+e)),t.push(o)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var d=i+k(s=e[c],c);l+=I(s,t,a,d,o)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(s=e.next()).done;)l+=I(s=s.value,t,a,d=i+k(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,r){if(null==e)return e;var n=[],a=0;return I(e,n,"","",(function(e){return t.call(r,e,a++)})),n}function N(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},M={transition:null},R={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:M,ReactCurrentOwner:E};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,r){A(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!j(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=o,t.PureComponent=x,t.StrictMode=i,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=P,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=f({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=E.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!T.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:r,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=j,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,r){return D.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,r){return D.current.useReducer(e,t,r)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return D.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},4391:(e,t,r)=>{"use strict";var n=r(7950);t.H=n.createRoot,n.hydrateRoot},4953:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});class n{static updateMultiplier(e){return console.log(`\ud83d\udd04 WeatherService - \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044f \u0441 ${n.TIME_MULTIPLIER} \u043d\u0430 ${e}`),"number"===typeof e&&!isNaN(e)&&e>0?(n.TIME_MULTIPLIER=e,!0):(console.warn("\u26a0\ufe0f \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044f:",e),!1)}constructor(){this.SEASON_LENGTH=30,this.SEASON_ORDER=["spring","summer","autumn","winter"],this.weatherTypes={clear:{name:"\u042f\u0441\u043d\u043e",baseChance:.4},cloudy:{name:"\u041e\u0431\u043b\u0430\u0447\u043d\u043e",baseChance:.2},rain:{name:"\u0414\u043e\u0436\u0434\u044c",baseChance:.2},thunderstorm:{name:"\u0413\u0440\u043e\u0437\u0430",baseChance:.1},fog:{name:"\u0422\u0443\u043c\u0430\u043d",baseChance:.05},snow:{name:"\u0421\u043d\u0435\u0433",baseChance:.05}},this.seasons={spring:{name:"\u0412\u0435\u0441\u043d\u0430",weatherModifiers:{clear:1.2,cloudy:1.1,rain:1.5,thunderstorm:1.2,fog:.8,snow:.3},resourceModifiers:{herbs:1.5,cultivation:1.2},specialEvents:["bloom","spirit_tide"]},summer:{name:"\u041b\u0435\u0442\u043e",weatherModifiers:{clear:1.7,cloudy:1,rain:.8,thunderstorm:1.5,fog:.5,snow:0},resourceModifiers:{minerals:1.3,cultivation:1.3},specialEvents:["solstice","meteor_shower"]},autumn:{name:"\u041e\u0441\u0435\u043d\u044c",weatherModifiers:{clear:1,cloudy:1.3,rain:1.2,thunderstorm:.8,fog:1.7,snow:.4},resourceModifiers:{herbs:1.4,food:1.5},specialEvents:["harvest","spirit_wind"]},winter:{name:"\u0417\u0438\u043c\u0430",weatherModifiers:{clear:.7,cloudy:1,rain:.4,thunderstorm:.2,fog:1,snow:2},resourceModifiers:{minerals:1.2,cultivation:.8},specialEvents:["ice_tribulation","blizzard"]}},this.specialEvents={bloom:{name:"\u0426\u0432\u0435\u0442\u0435\u043d\u0438\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u0442\u0440\u0430\u0432",duration:180,effects:[{type:"resource_bonus",target:"herbs",modifier:50},{type:"special_resources",resources:["divine_petal","spirit_bud"]}],visualEffects:{filter:"saturate(1.2) brightness(1.1)"}},spirit_tide:{name:"\u041f\u0440\u0438\u043b\u0438\u0432 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",duration:120,effects:[{type:"cultivation_bonus",modifier:30},{type:"energy_regen",modifier:20}],visualEffects:{filter:"brightness(1.15) contrast(1.1)"}},solstice:{name:"\u0421\u043e\u043b\u043d\u0446\u0435\u0441\u0442\u043e\u044f\u043d\u0438\u0435",duration:60,effects:[{type:"fire_cultivation",modifier:50},{type:"special_encounters",encounters:["phoenix_sighting","sun_elemental"]}],visualEffects:{filter:"brightness(1.3) sepia(0.3)"}},meteor_shower:{name:"\u041c\u0435\u0442\u0435\u043e\u0440\u0438\u0442\u043d\u044b\u0439 \u0434\u043e\u0436\u0434\u044c",duration:90,effects:[{type:"mineral_bonus",modifier:40},{type:"special_resources",resources:["star_fragment","cosmic_dust"]}],visualEffects:{filter:"brightness(0.7) contrast(1.2)"}},harvest:{name:"\u0421\u0431\u043e\u0440 \u0443\u0440\u043e\u0436\u0430\u044f",duration:240,effects:[{type:"market_discount",modifier:20},{type:"double_loot",chance:.2}],visualEffects:{filter:"sepia(0.2) contrast(1.1)"}},spirit_wind:{name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u0432\u0435\u0442\u0435\u0440",duration:120,effects:[{type:"movement_speed",modifier:30},{type:"reduced_encounter",modifier:-30}],visualEffects:{filter:"hue-rotate(10deg) blur(0.5px)"}},ice_tribulation:{name:"\u041b\u0435\u0434\u044f\u043d\u0430\u044f \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f",duration:120,effects:[{type:"water_cultivation",modifier:50},{type:"resistance_required",element:"ice",value:20}],visualEffects:{filter:"brightness(1.2) contrast(1.3) saturate(0.8)"}},blizzard:{name:"\u041c\u0435\u0442\u0435\u043b\u044c",duration:180,effects:[{type:"movement_penalty",modifier:-50},{type:"energy_drain",value:1}],visualEffects:{filter:"brightness(0.8) contrast(0.9) blur(1px)"}}},this.daytimeEffects={dawn:{name:"\u0420\u0430\u0441\u0441\u0432\u0435\u0442",effects:[{type:"perception",modifier:10},{type:"energy_regen",modifier:5}],visualEffects:{filter:"brightness(0.9) sepia(0.2)"}},morning:{name:"\u0423\u0442\u0440\u043e",effects:[{type:"cultivation_speed",modifier:10},{type:"gathering_speed",modifier:15}],visualEffects:{filter:"brightness(1.1) contrast(1.05)"}},noon:{name:"\u041f\u043e\u043b\u0434\u0435\u043d\u044c",effects:[{type:"fire_cultivation",modifier:20},{type:"water_cultivation",modifier:-10}],visualEffects:{filter:"brightness(1.2) contrast(1.1)"}},afternoon:{name:"\u0414\u0435\u043d\u044c",effects:[{type:"combat_damage",modifier:5},{type:"gathering_speed",modifier:10}],visualEffects:{filter:"brightness(1.15) contrast(1.05)"}},evening:{name:"\u0412\u0435\u0447\u0435\u0440",effects:[{type:"stealth",modifier:10},{type:"perception",modifier:-5}],visualEffects:{filter:"brightness(0.9) sepia(0.15)"}},night:{name:"\u041d\u043e\u0447\u044c",effects:[{type:"dark_cultivation",modifier:20},{type:"light_cultivation",modifier:-10},{type:"stealth",modifier:20}],visualEffects:{filter:"brightness(0.7) contrast(1.2) saturate(0.8)"}},deepNight:{name:"\u0413\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c",effects:[{type:"cultivation_insight",chance:.05},{type:"perception",modifier:-15},{type:"stealth",modifier:30}],visualEffects:{filter:"brightness(0.6) contrast(1.3) saturate(0.7)"}}}}initWeather(e){let t,r,n,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(i&&"object"===typeof i){if(t="number"===typeof i.hour?i.hour:(new Date).getHours(),r="number"===typeof i.minute?i.minute:(new Date).getMinutes(),a="number"===typeof i.day?i.day:1,i.season&&this.seasons[i.season])n=i.season;else{n=Object.keys(this.seasons)[Math.floor((new Date).getMonth()/3)%4]}console.log("\ud83c\udf24\ufe0f \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e\u0433\u043e\u0434\u044b \u0441 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c worldTime:",{hour:t,minute:r,dayCount:a,currentSeason:n})}else{const e=new Date;t=e.getHours(),r=e.getMinutes(),a=1;n=Object.keys(this.seasons)[Math.floor(e.getMonth()/3)%4],console.log("\ud83c\udf24\ufe0f \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e\u0433\u043e\u0434\u044b \u0431\u0435\u0437 worldTime, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0442\u0435\u043a\u0443\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f:",{hour:t,minute:r,dayCount:a,currentSeason:n})}const o=this._calculateWeather(n,e),s=this._generateForecast(o.type,n,e,3);let l,c;if(a>this.SEASON_LENGTH){l=(a-1)%this.SEASON_LENGTH+1;const e=Math.floor((a-1)/this.SEASON_LENGTH)%this.SEASON_ORDER.length;c=this.SEASON_ORDER[e],console.log("\ud83d\udcc5 \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e\u0433\u043e\u0434\u044b \u0441 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u043a\u043e\u0439 \u0441\u0435\u0437\u043e\u043d\u0430:",{"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":a,"\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":l,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":c,"\u0438\u0441\u0445\u043e\u0434\u043d\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":n}),n=c}else l=a;const d=t>=6&&t<20,u=this._getDaytimePeriod(t),p=this._collectWeatherEffects(o.type,n,u),h=60*t+r+o.duration;return{hour:t,minute:r,dayCount:a,isDayTime:d,currentWeather:o.type,weatherIntensity:o.intensity,weatherChangeAt:h,nextWeatherChange:o.duration,currentSeason:n,seasonDay:l,seasonLength:this.SEASON_LENGTH,activeEvent:null,eventRemainingTime:null,weatherEffects:p,forecast:s}}_getDaytimePeriod(e){return e>=5&&e<7?"dawn":e>=7&&e<11?"morning":e>=11&&e<14?"noon":e>=14&&e<17?"afternoon":e>=17&&e<20?"evening":e>=20&&e<23?"night":"deepNight"}_roundToMultipleOf5(e){return Math.round(e)}_collectWeatherEffects(e,t,r){const n=[],a={clear:[{type:"perception",modifier:10},{type:"fire_cultivation",modifier:15}],cloudy:[{type:"perception",modifier:-5},{type:"energy_regen",modifier:-5}],rain:[{type:"water_cultivation",modifier:20},{type:"fire_cultivation",modifier:-10},{type:"movement_speed",modifier:-10},{type:"resource_bonus",target:"herbs",modifier:20}],thunderstorm:[{type:"lightning_cultivation",modifier:30},{type:"perception",modifier:-15},{type:"movement_speed",modifier:-20},{type:"resource_bonus",target:"crystals",modifier:30}],fog:[{type:"perception",modifier:-30},{type:"stealth",modifier:20},{type:"water_cultivation",modifier:15}],snow:[{type:"water_cultivation",modifier:25},{type:"movement_speed",modifier:-30},{type:"fire_cultivation",modifier:-15},{type:"resource_bonus",target:"ores",modifier:15}]};if(a[e]){const t=a[e].map((e=>({...e,modifier:this._roundToMultipleOf5(e.modifier)})));n.push(...t)}if(this.daytimeEffects[r]){const e=this.daytimeEffects[r].effects.map((e=>({...e,modifier:this._roundToMultipleOf5(e.modifier)})));n.push(...e)}const i=this.seasons[t];if(i&&i.resourceModifiers)for(const[o,s]of Object.entries(i.resourceModifiers)){const e=100*(s-1);n.push({type:"resource_bonus",target:o,modifier:this._roundToMultipleOf5(e)})}return n}_generateForecast(e,t,r,n){const a=[];let i=0,o=e;const s=Object.keys(this.weatherTypes),l=new Set([e]);for(let c=0;c<n;c++){let e=this._calculateWeather(t,r),n=0;const d=10;for(;(e.type===o||l.has(e.type))&&n<d&&l.size<s.length;){if(n>5){const n=s.filter((e=>!l.has(e)));if(n.length>0){const a=n[Math.floor(Math.random()*n.length)],i=this._calculateWeather(t,r);e={type:a,intensity:i.intensity,duration:i.duration},console.log(`\ud83c\udf26\ufe0f \u041f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0440\u0430\u0437\u043d\u043e\u043e\u0431\u0440\u0430\u0437\u0438\u0435 \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430: \u0432\u044b\u0431\u0440\u0430\u043d \u043d\u043e\u0432\u044b\u0439 \u0442\u0438\u043f ${a}`);break}}else e=this._calculateWeather(t,r);n++}l.add(e.type);const u=.8+.4*Math.random(),p=Math.round(e.duration*u),h=Math.max(30,10*Math.ceil(p/10)),m=i;let f=0;c>0&&(f=5*Math.round(4*Math.random()));const y=10*Math.ceil((m+f)/10),g=.9+.2*Math.random();a.push({type:e.type,intensity:Math.min(1.5,Math.max(.5,e.intensity*g)),timeToOccur:y,duration:h}),o=e.type,i+=h}return console.log("\ud83c\udf24\ufe0f \u0421\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u0433\u043d\u043e\u0437 \u043f\u043e\u0433\u043e\u0434\u044b:",a.map((e=>`${e.type} \u0447\u0435\u0440\u0435\u0437 ${e.timeToOccur} \u043c\u0438\u043d. (\u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c ${e.duration} \u043c\u0438\u043d.)`))),a}forceWeatherChange(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return console.error("\u274c forceWeatherChange: \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d currentWeather"),{};console.log("\ud83c\udf24\ufe0f \u0412\u044b\u0437\u0432\u0430\u043d forceWeatherChange, \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043c\u0435\u043d\u044f\u0435\u043c \u043f\u043e\u0433\u043e\u0434\u0443",{currentSeason:e.currentSeason,dayCount:e.dayCount,seasonDay:e.seasonDay,"\u0441\u043e\u0431\u044b\u0442\u0438\u0435":r||"\u043d\u0435\u0442"});const n=e.currentSeason||"spring";if(r&&this.specialEvents[r]){const a=this.specialEvents[r];console.log(`\u0410\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u044f \u043e\u0441\u043e\u0431\u043e\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f: ${a.name}`);let i=this._calculateWeather(n,t),o=0;for(;i.type===e.currentWeather&&o<5;)i=this._calculateWeather(n,t),o++;const s=a.effects.map((e=>void 0!==e.modifier?{...e,modifier:this._roundToMultipleOf5(e.modifier)}:e));return{...e,currentWeather:i.type,weatherIntensity:i.intensity,activeEvent:r,eventRemainingTime:a.duration,weatherEffects:s}}let a=this._calculateWeather(n,t),i=0;for(;a.type===e.currentWeather&&i<5;)a=this._calculateWeather(n,t),i++;const o="number"===typeof e.hour?e.hour:12,s=60*o+("number"===typeof e.minute?e.minute:0)+a.duration,l=this._generateForecast(a.type,n,t,3),c=this._getDaytimePeriod(o),d=this._collectWeatherEffects(a.type,n,c);return console.log("\u2705 forceWeatherChange: \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u043d\u043e\u0432\u0430\u044f \u043f\u043e\u0433\u043e\u0434\u0430",{"\u0442\u0438\u043f":a.type,"\u0438\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c":a.intensity,"\u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c":a.duration,"\u0432\u0440\u0435\u043c\u044f_\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439_\u0441\u043c\u0435\u043d\u044b":s}),{...e,currentWeather:a.type,weatherIntensity:a.intensity,weatherChangeAt:s,nextWeatherChange:a.duration,weatherEffects:d,forecast:l}}_calculateWeather(e,t){const r={};for(const[s,l]of Object.entries(this.weatherTypes))r[s]=l.baseChance;const n=this.seasons[e];if(n)for(const[s,l]of Object.entries(n.weatherModifiers))r[s]*=l;if(null!==t&&void 0!==t&&t.weatherModifiers)for(const[s,l]of Object.entries(t.weatherModifiers))r[s]*=l;const a=Object.values(r).reduce(((e,t)=>e+t),0);for(const s in r)r[s]/=a;const i=Math.random();let o=0;for(const[s,l]of Object.entries(r))if(o+=l,i<=o){const e=.5+Math.random(),t=300+Math.floor(300*Math.random()),r={clear:1.5,cloudy:1.2,rain:.8,thunderstorm:.7,fog:1,snow:1.1};let n=Math.floor(t*(r[s]||1));return n=Math.max(300,10*Math.ceil(n/10)),{type:s,intensity:e,duration:n}}return{type:"clear",intensity:1,duration:120}}updateTime(e,t,r){let a,i,o,s,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e)return console.error("\u274c updateTime: \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d currentWeather"),{};console.log("\ud83d\udd52 \u0412\u044b\u0437\u0432\u0430\u043d updateTime:",{worldTime:r,realMinutesPassed:l,"\u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044c":n.TIME_MULTIPLIER}),r&&"object"===typeof r?(a="number"===typeof r.hour?r.hour:e.hour||0,i="number"===typeof r.minute?r.minute:e.minute||0,o="number"===typeof r.day?r.day:e.dayCount||1,s=r.season||e.currentSeason||"spring",console.log("\ud83d\udd52 \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e worldTime \u043a\u0430\u043a \u0438\u0441\u0442\u043e\u0447\u043d\u0438\u043a \u0438\u0441\u0442\u0438\u043d\u044b:",{hour:a,minute:i,dayCount:o,currentSeason:s})):(a=e.hour||0,i=e.minute||0,o=e.dayCount||1,s=e.currentSeason||"spring");const c=60*a+i,d=e.weatherChangeAt||c+60;console.log("\u23f1\ufe0f \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u0433\u043e\u0434\u044b:",{"\u0442\u0435\u043a\u0443\u0449\u0435\u0435_\u0430\u0431\u0441\u043e\u043b\u044e\u0442\u043d\u043e\u0435_\u0432\u0440\u0435\u043c\u044f":c,"\u0441\u043c\u0435\u043d\u0430_\u043f\u043e\u0433\u043e\u0434\u044b_\u0432":d,"\u0440\u0430\u0437\u043d\u0438\u0446\u0430":d-c,"\u0442\u0435\u043a\u0443\u0449\u0430\u044f_\u043f\u043e\u0433\u043e\u0434\u0430":e.currentWeather});let u={...e};u.hour=a,u.minute=i,u.dayCount=o;const p=e.seasonDay||1;if(o>this.SEASON_LENGTH){const e=(o-1)%this.SEASON_LENGTH+1,r=Math.floor((o-1)/this.SEASON_LENGTH)%this.SEASON_ORDER.length,n=this.SEASON_ORDER[r];console.log("\ud83c\udf08 \u0421\u041c\u0415\u041d\u0410 \u0421\u0415\u0417\u041e\u041d\u0410:",{"\u043f\u0440\u043e\u0448\u043b\u044b\u0439_\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":p,"\u043d\u043e\u0432\u044b\u0439_\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":e,"\u0442\u0435\u043a\u0443\u0449\u0438\u0439_\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":o,"\u043f\u0440\u043e\u0448\u043b\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":s,"\u043d\u043e\u0432\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":n,"\u0434\u043b\u0438\u043d\u0430_\u0441\u0435\u0437\u043e\u043d\u0430":this.SEASON_LENGTH}),u.currentSeason=n,u.seasonDay=e;let i=this._calculateWeather(n,t);u.currentWeather=i.type,u.weatherIntensity=i.intensity,u.weatherChangeAt=c+i.duration,u.nextWeatherChange=i.duration,u.forecast=this._generateForecast(i.type,n,t,3);const l=this._getDaytimePeriod(a);u.weatherEffects=this._collectWeatherEffects(i.type,n,l)}else u.seasonDay=o,u.currentSeason=s;if(0===e.nextWeatherChange||c>=d){console.log("\ud83c\udf26\ufe0f \u0412\u0440\u0435\u043c\u044f \u0441\u043c\u0435\u043d\u044b \u043f\u043e\u0433\u043e\u0434\u044b \u043d\u0430\u0441\u0442\u0443\u043f\u0438\u043b\u043e!",{"\u0442\u0435\u043a\u0443\u0449\u0435\u0435_\u0432\u0440\u0435\u043c\u044f":c,"\u0432\u0440\u0435\u043c\u044f_\u0441\u043c\u0435\u043d\u044b":d,"\u0441\u0442\u0430\u0440\u0430\u044f_\u043f\u043e\u0433\u043e\u0434\u0430":u.currentWeather,"\u0441\u0447\u0435\u0442\u0447\u0438\u043a_next_weather_change":e.nextWeatherChange,"\u043f\u0440\u0438\u0447\u0438\u043d\u0430":0===e.nextWeatherChange?"nextWeatherChange = 0":"absoluteMinutes >= weatherChangeAt"});let r=this._calculateWeather(s,t),n=0;for(;r.type===u.currentWeather&&n<5;)r=this._calculateWeather(s,t),n++;u.currentWeather=r.type,u.weatherIntensity=r.intensity,u.weatherChangeAt=c+r.duration,u.nextWeatherChange=r.duration,u.forecast=this._generateForecast(r.type,s,t,3);const i=this._getDaytimePeriod(a);u.weatherEffects=this._collectWeatherEffects(r.type,s,i),console.log("\ud83c\udf24\ufe0f \u041f\u043e\u0433\u043e\u0434\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0430:",{"\u043d\u043e\u0432\u0430\u044f_\u043f\u043e\u0433\u043e\u0434\u0430":u.currentWeather,"\u0438\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c":u.weatherIntensity,"\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f_\u0441\u043c\u0435\u043d\u0430_\u0447\u0435\u0440\u0435\u0437":r.duration,"\u0430\u0431\u0441\u043e\u043b\u044e\u0442\u043d\u043e\u0435_\u0432\u0440\u0435\u043c\u044f_\u0441\u043c\u0435\u043d\u044b":u.weatherChangeAt})}else{const e=d-c;if(u.nextWeatherChange=Math.max(0,e),console.log("\u23f3 \u0414\u043e \u0441\u043c\u0435\u043d\u044b \u043f\u043e\u0433\u043e\u0434\u044b \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c:",u.nextWeatherChange,"\u043c\u0438\u043d.",{weatherChangeAt:d,absoluteMinutes:c,"\u0440\u0430\u0437\u043d\u0438\u0446\u0430":d-c}),0===u.nextWeatherChange){console.log("\u26a0\ufe0f \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d \u0441\u0447\u0435\u0442\u0447\u0438\u043a \u0441 0 \u043c\u0438\u043d\u0443\u0442! \u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u041d\u0415\u041c\u0415\u0414\u041b\u0415\u041d\u041d\u0423\u042e \u0441\u043c\u0435\u043d\u0443 \u043f\u043e\u0433\u043e\u0434\u044b!");let e=this._calculateWeather(s,t),r=0;for(;e.type===u.currentWeather&&r<5;)e=this._calculateWeather(s,t),r++;u.currentWeather=e.type,u.weatherIntensity=e.intensity,u.weatherChangeAt=c+e.duration,u.nextWeatherChange=e.duration,u.forecast=this._generateForecast(e.type,s,t,3);const n=this._getDaytimePeriod(a);u.weatherEffects=this._collectWeatherEffects(e.type,s,n),console.log("\ud83c\udf24\ufe0f \u041f\u043e\u0433\u043e\u0434\u0430 \u041d\u0415\u041c\u0415\u0414\u041b\u0415\u041d\u041d\u041e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0430 \u0438\u0437-\u0437\u0430 \u043d\u0443\u043b\u0435\u0432\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u0430:",{"\u043d\u043e\u0432\u0430\u044f_\u043f\u043e\u0433\u043e\u0434\u0430":u.currentWeather,"\u0438\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c":u.weatherIntensity,"\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f_\u0441\u043c\u0435\u043d\u0430_\u0447\u0435\u0440\u0435\u0437":e.duration,"\u0430\u0431\u0441\u043e\u043b\u044e\u0442\u043d\u043e\u0435_\u0432\u0440\u0435\u043c\u044f_\u0441\u043c\u0435\u043d\u044b":u.weatherChangeAt})}}return u.isDayTime=a>=6&&a<20,u}}n.TIME_MULTIPLIER=120;const a=n},4983:(e,t)=>{"use strict";var r="function"===typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,a=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,o=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.async_mode"):60111,u=r?Symbol.for("react.concurrent_mode"):60111,p=r?Symbol.for("react.forward_ref"):60112,h=r?Symbol.for("react.suspense"):60113,m=r?Symbol.for("react.suspense_list"):60120,f=r?Symbol.for("react.memo"):60115,y=r?Symbol.for("react.lazy"):60116,g=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,x=r?Symbol.for("react.responder"):60118,b=r?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case d:case u:case i:case s:case o:case h:return e;default:switch(e=e&&e.$$typeof){case c:case p:case y:case f:case l:return e;default:return t}}case a:return t}}}function _(e){return w(e)===u}t.AsyncMode=d,t.ConcurrentMode=u,t.ContextConsumer=c,t.ContextProvider=l,t.Element=n,t.ForwardRef=p,t.Fragment=i,t.Lazy=y,t.Memo=f,t.Portal=a,t.Profiler=s,t.StrictMode=o,t.Suspense=h,t.isAsyncMode=function(e){return _(e)||w(e)===d},t.isConcurrentMode=_,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return w(e)===p},t.isFragment=function(e){return w(e)===i},t.isLazy=function(e){return w(e)===y},t.isMemo=function(e){return w(e)===f},t.isPortal=function(e){return w(e)===a},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===h},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===u||e===s||e===o||e===h||e===m||"object"===typeof e&&null!==e&&(e.$$typeof===y||e.$$typeof===f||e.$$typeof===l||e.$$typeof===c||e.$$typeof===p||e.$$typeof===v||e.$$typeof===x||e.$$typeof===b||e.$$typeof===g)},t.typeOf=w},5033:(e,t,r)=>{const n=r(7661),{resources:a,RESOURCE_TYPES:i,RARITY:o,getResourceById:s}=r(3010),l="undefined"!==typeof window;e.exports=class{static async initializeResources(){if(l)console.log("\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043c\u043e\u043a-\u0434\u0430\u043d\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0434\u043b\u044f \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0430");else try{const e=await n.count();if(0===e){console.log("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445...");for(const e of a)await n.create(e);console.log(`\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e ${a.length} \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0432 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445.`)}else console.log(`\u0412 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0443\u0436\u0435 \u0435\u0441\u0442\u044c ${e} \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432.`)}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432:",e),e}}static async getAllResources(){try{if(l)return a;return await n.findAll()}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432:",e),e}}static async getResourceById(e){try{if(l)return s(e);return await n.findByPk(e)}catch(t){throw console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u0430 \u0441 ID ${e}:`,t),t}}static async getResourcesByType(e){try{if(l)return a.filter((t=>t.type===e));return await n.findAll({where:{type:e}})}catch(t){throw console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0442\u0438\u043f\u0430 ${e}:`,t),t}}static async getResourcesByRarity(e){try{if(l)return a.filter((t=>t.rarity===e));return await n.findAll({where:{rarity:e}})}catch(t){throw console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0440\u0435\u0434\u043a\u043e\u0441\u0442\u0438 ${e}:`,t),t}}static getBreakthroughResources(e,t){switch(e.toLowerCase()){case"\u0437\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430":const e={low_grade_herb:Math.floor(5*t+5*Math.random()),basic_pill:Math.floor(2*t+3*Math.random())};return t>=7&&(e.spirit_stone=Math.floor(2*(t-6))),e;case"\u043e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0446\u0438":const r={medium_grade_herb:Math.floor(4*t+6*Math.random()),qi_pill:Math.floor(3*t+3*Math.random()),spirit_stone:Math.floor(3*t+5*Math.random())};return t>=5&&(r.spirit_mineral=Math.floor(2*(t-4))),r;case"\u0437\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e":return{rare_herb:Math.floor(3*t+7*Math.random()),high_quality_pill:Math.floor(2*t+4*Math.random()),spirit_mineral:Math.floor(4*t+6*Math.random()),spirit_stone:Math.floor(10*t+10*Math.random())};case"\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438":return{exotic_herb:Math.floor(2*t+8*Math.random()),spirit_essence:Math.floor(3*t+5*Math.random()),beast_soul:Math.floor(1*t+3*Math.random()),spirit_mineral:Math.floor(8*t+12*Math.random()),spirit_stone:Math.floor(20*t+20*Math.random())};default:return{low_grade_herb:Math.floor(5*t+5*Math.random()),basic_pill:Math.floor(2*t+3*Math.random())}}}static getResourceTypes(){return i}static getRarityTypes(){return o}}},5043:(e,t,r)=>{"use strict";e.exports=r(4202)},5105:(e,t,r)=>{const n=r(8448),a=r(4128),{getSequelizeInstance:i}=r(2342),o=r(8568),s=a.basename("/index.js"),l={Sequelize:o,sequelize:null};l.initializePromise=async function(){try{const t=await i();if(!t)throw new Error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 Sequelize");l.sequelize=t;const c=n.readdirSync("/").filter((e=>0!==e.indexOf(".")&&e!==s&&"fix-models.js"!==e&&".js"===e.slice(-3)&&-1===e.indexOf(".test.js")));for(const n of c)try{const e=r(6142)(a.join("/",n));if(e&&"function"===typeof e&&e.prototype instanceof o.Model){const r=e.modelName||e.name;r?"function"===typeof e.init&&"AsyncFunction"===e.init.constructor.name?(console.log(`\u0410\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u0430\u044f \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 ${r}...`),await e.init(),t.models[r]?(l[r]=t.models[r],console.log(`\u041c\u043e\u0434\u0435\u043b\u044c ${r} \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430.`)):(console.error(`\u041c\u043e\u0434\u0435\u043b\u044c ${r} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u0432 sequelize.models \u043f\u043e\u0441\u043b\u0435 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0433\u043e init.`),l[r]=e)):"function"===typeof e.init?(console.warn(`\u041c\u043e\u0434\u0435\u043b\u044c ${r} \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 init. \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f...`),e.init(t),l[r]=e,console.log(`\u041c\u043e\u0434\u0435\u043b\u044c ${r} \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430 (\u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438).`)):(console.warn(`\u041c\u043e\u0434\u0435\u043b\u044c ${r} \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u043c\u0435\u0442\u043e\u0434\u0430 init.`),l[r]=e):console.warn(`\u041c\u043e\u0434\u0435\u043b\u044c \u0432 ${n} \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 modelName \u0438\u043b\u0438 name.`)}else console.warn(`\u0424\u0430\u0439\u043b ${n} \u043d\u0435 \u044d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u0442 \u043a\u043b\u0430\u0441\u0441 \u043c\u043e\u0434\u0435\u043b\u0438 Sequelize.`)}catch(e){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435/\u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0438\u0437 ${n}:`,e)}console.log("\u0412\u0441\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b \u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b."),Object.keys(l).forEach((e=>{if("Sequelize"!==e&&"sequelize"!==e&&"initializePromise"!==e&&l[e]&&l[e].associate){console.log(`\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0430\u0441\u0441\u043e\u0446\u0438\u0430\u0446\u0438\u0439 \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0438 ${e}...`);try{l[e].associate(l)}catch(t){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0441\u0441\u043e\u0446\u0438\u0430\u0446\u0438\u0438 \u0434\u043b\u044f ${e}:`,t)}}})),console.log("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u0430\u0441\u0441\u043e\u0446\u0438\u0430\u0446\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u044b.")}catch(e){console.error("\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0435\u0439:",e),l.sequelize=null}}(),e.exports=l},5513:(e,t,r)=>{const{techniques:n}=r(280),a=e=>e?e.replace(/_/g,"-"):e,i=e=>{if(!e)return null;const t=a(e);return n.find((e=>a(e.id)===t))||null},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return{};const r=1+.2*(t-1),n={damage:e.damage?Math.floor(e.damage*r):0,healing:e.healing?Math.floor(e.healing*r):0,energyCost:e.energyCost?Math.floor(e.energyCost*(1+.1*(t-1))):10};return Array.isArray(e.effects)&&(n.effects=e.effects.map((e=>{const t={...e};return t.damage&&(t.damage=Math.floor(t.damage*r)),t.healing&&(t.healing=Math.floor(t.healing*r)),t}))),n};e.exports={normalizeId:a,isSameId:(e,t)=>!(!e||!t)&&a(e)===a(t),normalizeTechniquesIds:e=>{if(!e)return e;if(Array.isArray(e))return e.map((e=>{if(e&&e.id&&"string"===typeof e.id&&e.id.includes("_")){const t=a(e.id);return console.log(`\u041d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d ID \u0442\u0435\u0445\u043d\u0438\u043a\u0438: ${e.id} -> ${t}`),{...e,id:t}}return e}));if("object"===typeof e){const t={};return Object.keys(e).forEach((r=>{if(r.includes("_")){const n=a(r);console.log(`\u041d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d \u043a\u043b\u044e\u0447 \u0442\u0435\u0445\u043d\u0438\u043a\u0438: ${r} -> ${n}`),t[n]=e[r]}else t[r]=e[r]})),t}return e},findBaseTechniqueById:i,calculateTechniqueStats:o,isTechniqueValid:e=>{if(!e||!e.id)return!1;const t=["name","description","type","icon","damage","damageType","energyCost","cooldown","level","maxLevel"];for(const r of t)if(void 0===e[r])return!1;return!!Array.isArray(e.effects)},repairTechniques:e=>{if(!Array.isArray(e)||0===e.length)return console.log("\u041d\u0435\u0442 \u0442\u0435\u0445\u043d\u0438\u043a \u0434\u043b\u044f \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f"),[];console.log(`\ud83d\udee0\ufe0f \u0417\u0430\u043f\u0443\u0449\u0435\u043d\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 ${e.length} \u0442\u0435\u0445\u043d\u0438\u043a...`);return e.map((e=>{console.log(`\ud83d\udd04 \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u0441 ID: ${e.id}...`);const t=i(e.id);if(!t)return console.warn(`\u26a0\ufe0f \u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0431\u0430\u0437\u043e\u0432\u043e\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u0441 ID: ${e.id}. \u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b.`),e;const r="number"===typeof e.level?e.level:1,n="number"===typeof e.experience?e.experience:0,a="number"===typeof e.masteryLevel?e.masteryLevel:0,s=e.lastUsed||null,l=e.requiredLevel||t.requiredLevel||1,c=o(t,r),d={...t,...c,id:e.id,level:r,experience:n,lastUsed:s,masteryLevel:a,requiredLevel:l};return console.log(`\u2705 \u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430: ${d.name} (\u0423\u0440\u043e\u0432\u0435\u043d\u044c: ${r}, \u0423\u0440\u043e\u043d: ${d.damage}, \u041a\u0443\u043b\u0434\u0430\u0443\u043d: ${d.cooldown})`),d}))}}},6142:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=6142,e.exports=t},6433:(e,t,r)=>{"use strict";r.r(t),r.d(t,{mergeEffects:()=>o,normalizePlayerEffects:()=>l,normalizeStatusEffects:()=>i,reindexEffects:()=>s});var n=r(685),a=r(592);const i=e=>Array.isArray(e)?e:e&&"object"===typeof e?Object.values(e):[],o=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=t.map((e=>Array.isArray(e)?(0,a.cleanEffects)(e):[])),o=[].concat(...i),s={},l={};o.forEach((e=>{const t=(0,n.N9)(e),r=t.type;s[r]||(s[r]=0,l[r]=e.name||""),s[r]+=t.modifier,e.name&&e.name.length>l[r].length&&(l[r]=e.name)}));return Object.entries(s).map((e=>{let[t,r]=e;return(0,a.createCleanEffect)(t,r,{name:l[t]||""})}))},s=e=>{if(!Array.isArray(e))return[];const t={};return e.forEach(((e,r)=>{t[r]=e})),Object.values(t)},l=(e,t)=>{if(!e)return e;const r=i(e.statusEffects),n=(0,a.cleanEffects)(r);let l=[];t&&t.benefits?l=Array.isArray(t.benefits)?t.benefits:Object.values(t.benefits):e.sect&&e.sect.benefits&&(l=Array.isArray(e.sect.benefits)?e.sect.benefits:Object.values(e.sect.benefits));const c=(0,a.sectBenefitsToEffects)(l),d=o(n,c),u=s(d);return{...e,statusEffects:u}}},6617:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){s.belongsTo(e.Technique,{foreignKey:"technique_id",as:"technique"})}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{id:{type:a.INTEGER,autoIncrement:!0,primaryKey:!0,allowNull:!1},techniqueId:{type:a.STRING(30),allowNull:!1,field:"technique_id",references:{model:"techniques",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE"},type:{type:a.STRING(30),allowNull:!1},name:{type:a.STRING(100),allowNull:!1},duration:{type:a.INTEGER,defaultValue:0},damage:{type:a.INTEGER},damageType:{type:a.STRING(20),field:"damage_type"},healing:{type:a.INTEGER}},{sequelize:e,modelName:"TechniqueEffect",tableName:"technique_effects",timestamps:!1})},(async()=>{try{await s.init(),console.log("TechniqueEffect \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 TechniqueEffect:",e),console.error(e.stack)}})(),e.exports=s},6771:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){s.hasMany(e.TechniqueEffect,{foreignKey:"technique_id",as:"effects"}),s.hasMany(e.LearnedTechnique,{foreignKey:"techniqueId",as:"learnedBy"})}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{id:{type:a.STRING(30),primaryKey:!0,allowNull:!1},name:{type:a.STRING(100),allowNull:!1},description:{type:a.TEXT},icon:{type:a.STRING(10)},level:{type:a.INTEGER,defaultValue:1},damage:{type:a.INTEGER,defaultValue:0},damageType:{type:a.STRING(20),field:"damage_type"},energyCost:{type:a.INTEGER,defaultValue:0,field:"energy_cost"},cooldown:{type:a.INTEGER,defaultValue:0},maxLevel:{type:a.INTEGER,defaultValue:5,field:"max_level"},type:{type:a.STRING(20)},requiredLevel:{type:a.INTEGER,defaultValue:1,field:"required_level"},healing:{type:a.INTEGER,defaultValue:0}},{sequelize:e,modelName:"Technique",tableName:"techniques",timestamps:!1})},(async()=>{try{await s.init(),console.log("Technique \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 Technique:",e),console.error(e.stack)}})(),e.exports=s},6909:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){s.belongsTo(e.User,{foreignKey:"userId",as:"user"})}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{id:{type:a.INTEGER,autoIncrement:!0,primaryKey:!0,allowNull:!1},userId:{type:a.INTEGER,references:{model:"users",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE"},name:{type:a.STRING,allowNull:!1},description:{type:a.TEXT},type:{type:a.ENUM("\u043e\u0440\u0443\u0436\u0438\u0435","\u0431\u0440\u043e\u043d\u044f","\u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442","\u0440\u0430\u0441\u0445\u043e\u0434\u043d\u0438\u043a","\u0440\u0435\u0441\u0443\u0440\u0441"),allowNull:!1},rarity:{type:a.ENUM("\u043e\u0431\u044b\u0447\u043d\u044b\u0439","\u043d\u0435\u043e\u0431\u044b\u0447\u043d\u044b\u0439","\u0440\u0435\u0434\u043a\u0438\u0439","\u044d\u043f\u0438\u0447\u0435\u0441\u043a\u0438\u0439","\u043b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0439"),defaultValue:"\u043e\u0431\u044b\u0447\u043d\u044b\u0439"},stats:{type:a.JSONB,defaultValue:{}},quantity:{type:a.INTEGER,defaultValue:1},equipped:{type:a.BOOLEAN,defaultValue:!1}},{sequelize:e,modelName:"InventoryItem",tableName:"inventory_items",timestamps:!0,underscored:!0})},(async()=>{try{await s.init(),console.log("InventoryItem \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 InventoryItem:",e),console.error(e.stack)}})(),e.exports=s},6963:(e,t,r)=>{const n=r(8843),a=r(8547);r(3382);e.exports=class{static async getQuests(e){try{const t=await n.findAll({where:{userId:e},include:[{model:a,as:"quest"}]}),r={available:[],active:[],completed:[]};return t.forEach((e=>{const t={id:e.quest.id,title:e.quest.title,description:e.quest.description,type:e.quest.type,level:e.quest.level,rewards:e.quest.rewards,objectives:e.quest.objectives,status:e.status,progress:e.progress,startedAt:e.startedAt,completedAt:e.completedAt};"available"===e.status?r.available.push(t):"active"===e.status?r.active.push(t):"completed"===e.status&&r.completed.push(t)})),r}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0437\u0430\u0434\u0430\u043d\u0438\u0439:",t),t}}static async acceptQuest(e,t){try{const r=await a.findByPk(t);if(!r)throw new Error("\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e");const i=await n.findOne({where:{userId:e,questId:t}});if(i&&"available"!==i.status)throw new Error("\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u0443\u0436\u0435 \u043f\u0440\u0438\u043d\u044f\u0442\u043e \u0438\u043b\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e");let o;return i?(i.status="active",i.startedAt=new Date,await i.save(),o=i):o=await n.create({userId:e,questId:t,status:"active",progress:{},startedAt:new Date}),{id:r.id,title:r.title,description:r.description,type:r.type,level:r.level,rewards:r.rewards,objectives:r.objectives,status:o.status,progress:o.progress,startedAt:o.startedAt}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u0438 \u0437\u0430\u0434\u0430\u043d\u0438\u044f:",r),r}}static async updateQuestProgress(e,t,r){try{const i=await n.findOne({where:{userId:e,questId:t},include:[{model:a,as:"quest"}]});if(!i)throw new Error("\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0438\u043b\u0438 \u043d\u0435 \u043f\u0440\u0438\u043d\u044f\u0442\u043e");if("active"!==i.status)throw new Error("\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e");return i.progress={...i.progress,...r},await i.save(),{id:i.quest.id,title:i.quest.title,description:i.quest.description,type:i.quest.type,level:i.quest.level,rewards:i.quest.rewards,objectives:i.quest.objectives,status:i.status,progress:i.progress,startedAt:i.startedAt}}catch(i){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 \u0437\u0430\u0434\u0430\u043d\u0438\u044f:",i),i}}static async completeQuest(e,t){try{const r=await n.findOne({where:{userId:e,questId:t},include:[{model:a,as:"quest"}]});if(!r)throw new Error("\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0438\u043b\u0438 \u043d\u0435 \u043f\u0440\u0438\u043d\u044f\u0442\u043e");if("active"!==r.status)throw new Error("\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e");return r.status="completed",r.completedAt=new Date,await r.save(),{id:r.quest.id,title:r.quest.title,description:r.quest.description,type:r.quest.type,level:r.quest.level,rewards:r.quest.rewards,objectives:r.quest.objectives,status:r.status,progress:r.progress,startedAt:r.startedAt,completedAt:r.completedAt}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0437\u0430\u0434\u0430\u043d\u0438\u044f:",r),r}}}},7109:e=>{"use strict";e.exports=JSON.parse('{"development":{"username":"postgres","password":"root","database":"game","host":"localhost","dialect":"postgres","port":5432},"test":{"username":"postgres","password":"root","database":"game","host":"localhost","dialect":"postgres","port":5432},"production":{"username":"postgres","password":"root","database":"game","host":"localhost","dialect":"postgres","port":5432,"dialectOptions":{"ssl":{"require":true,"rejectUnauthorized":false}}}}')},7234:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(!(0<i(a,t)))break e;e[n]=t,e[r]=a,r=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,o=a>>>1;n<o;){var s=2*(n+1)-1,l=e[s],c=s+1,d=e[c];if(0>i(l,r))c<a&&0>i(d,l)?(e[n]=d,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else{if(!(c<a&&0>i(d,r)))break e;e[n]=d,e[c]=r,n=c}}}return t}function i(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],d=[],u=1,p=null,h=3,m=!1,f=!1,y=!1,g="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=n(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,r(c,t)}t=n(d)}}function w(e){if(y=!1,b(e),!f)if(null!==n(c))f=!0,M(_);else{var t=n(d);null!==t&&R(w,t.startTime-e)}}function _(e,r){f=!1,y&&(y=!1,v(j),j=-1),m=!0;var i=h;try{for(b(r),p=n(c);null!==p&&(!(p.expirationTime>r)||e&&!I());){var o=p.callback;if("function"===typeof o){p.callback=null,h=p.priorityLevel;var s=o(p.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?p.callback=s:p===n(c)&&a(c),b(r)}else a(c);p=n(c)}if(null!==p)var l=!0;else{var u=n(d);null!==u&&R(w,u.startTime-r),l=!1}return l}finally{p=null,h=i,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,T=!1,S=null,j=-1,C=5,k=-1;function I(){return!(t.unstable_now()-k<C)}function A(){if(null!==S){var e=t.unstable_now();k=e;var r=!0;try{r=S(!0,e)}finally{r?E():(T=!1,S=null)}}else T=!1}if("function"===typeof x)E=function(){x(A)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,D=N.port2;N.port1.onmessage=A,E=function(){D.postMessage(null)}}else E=function(){g(A,0)};function M(e){S=e,T||(T=!0,E())}function R(e,r){j=g((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,M(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var r=h;h=t;try{return e()}finally{h=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=h;h=e;try{return t()}finally{h=r}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,r(d,e),null===n(c)&&e===n(d)&&(y?(v(j),j=-1):y=!0,R(w,i-o))):(e.sortIndex=s,r(c,e),f||m||(f=!0,M(_))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=h;return function(){var r=h;h=t;try{return e.apply(this,arguments)}finally{h=r}}}},7324:e=>{e.exports=function(e,t,r,n){var a=r?r.call(n,e,t):void 0;if(void 0!==a)return!!a;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<i.length;l++){var c=i[l];if(!s(c))return!1;var d=e[c],u=t[c];if(!1===(a=r?r.call(n,d,u,c):void 0)||void 0===a&&d!==u)return!1}return!0}},7456:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){s.belongsTo(e.User,{foreignKey:"userId",as:"user"})}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{userId:{type:a.INTEGER,references:{model:"Users",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE",unique:!0},strength:{type:a.INTEGER,defaultValue:10},intellect:{type:a.INTEGER,defaultValue:10},spirit:{type:a.INTEGER,defaultValue:10},agility:{type:a.INTEGER,defaultValue:10},health:{type:a.INTEGER,defaultValue:10},physicalDefense:{type:a.INTEGER,defaultValue:0},spiritualDefense:{type:a.INTEGER,defaultValue:0},attackSpeed:{type:a.INTEGER,defaultValue:0},criticalChance:{type:a.INTEGER,defaultValue:0},movementSpeed:{type:a.INTEGER,defaultValue:0},luck:{type:a.INTEGER,defaultValue:0}},{sequelize:e,modelName:"CharacterStats",tableName:"CharacterStats"})},(async()=>{try{await s.init(),console.log("CharacterStats \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 CharacterStats:",e),console.error(e.stack)}})(),e.exports=s},7661:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{id:{type:a.STRING,primaryKey:!0,allowNull:!1},name:{type:a.STRING,allowNull:!1},type:{type:a.STRING,allowNull:!1},rarity:{type:a.STRING,allowNull:!1},description:{type:a.TEXT},effects:{type:a.JSON,defaultValue:{}},value:{type:a.INTEGER,defaultValue:0},stackable:{type:a.BOOLEAN,defaultValue:!0},maxStack:{type:a.INTEGER,defaultValue:99}},{sequelize:e,modelName:"Resource",tableName:"resources",timestamps:!0,underscored:!0})},(async()=>{try{await s.init(),console.log("Resource \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 Resource:",e),console.error(e.stack)}})(),e.exports=s},7950:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(2730)},8153:(e,t,r)=>{const n=r(8568),a=r(7109);let i=null;function o(e,t,r){let n;const a=new Promise(((e,a)=>{n=setTimeout((()=>{a(new Error(r||"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b\u0430 \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f"))}),t)}));return Promise.race([e,a]).finally((()=>clearTimeout(n)))}async function s(){try{const t=a["production"];console.log(`\u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a PostgreSQL (${t.host}:${t.port})...`);try{await async function(e){console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a PostgreSQL...");try{try{r(9398)}catch(t){throw console.error("\u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0428\u0418\u0411\u041a\u0410: \u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0434\u0440\u0430\u0439\u0432\u0435\u0440 PostgreSQL"),console.error("\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0434\u0440\u0430\u0439\u0432\u0435\u0440 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u0443: npm install pg"),new Error("\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u043a\u0435\u0442 pg \u0434\u043b\u044f \u0440\u0430\u0431\u043e\u0442\u044b \u0441 PostgreSQL. \u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435: npm install pg")}const{Client:n}=r(9398),a=new n({host:e.host,port:e.port,database:e.database,user:e.username,password:e.password,connectionTimeoutMillis:5e3});console.log("\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f:",{host:e.host,port:e.port,database:e.database,user:e.username}),await o(a.connect(),5e3,"\u041f\u0440\u044f\u043c\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a PostgreSQL \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b\u043e \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f"),console.log("\u041f\u0440\u044f\u043c\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a PostgreSQL \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e");const i=await o(a.query("SELECT NOW() as current_time"),3e3,"\u0422\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441 \u043a PostgreSQL \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f");return console.log(`\u0422\u0435\u043a\u0443\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 PostgreSQL: ${i.rows[0].current_time}`),await a.end(),console.log("\u041f\u0440\u044f\u043c\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a PostgreSQL \u0437\u0430\u043a\u0440\u044b\u0442\u043e"),!0}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a PostgreSQL:",n.message);try{client&&await client.end()}catch(t){}throw new Error(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a PostgreSQL: ${n.message}`)}}(t)}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a PostgreSQL:",e.message),e}return i=new n(t.database,t.username,t.password,{host:t.host,port:t.port,dialect:t.dialect,logging:!1,pool:{max:5,min:0,acquire:3e4,idle:1e4},dialectOptions:{connectTimeout:5e3,statement_timeout:1e4,idle_in_transaction_session_timeout:1e4}}),console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0441 PostgreSQL \u0447\u0435\u0440\u0435\u0437 Sequelize..."),await o(i.query("SELECT 1+1 AS result"),5e3,"\u0422\u0435\u0441\u0442\u043e\u0432\u044b\u0439 SQL-\u0437\u0430\u043f\u0440\u043e\u0441 \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f"),await o(i.authenticate(),5e3,"\u0410\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f Sequelize \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b\u0430 \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f"),console.log("\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a PostgreSQL \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d\u043e"),{db:i}}catch(t){throw console.error("\u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0428\u0418\u0411\u041a\u0410: \u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a PostgreSQL:",t.message),console.error("\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f:",t),new Error(`\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443 \u0431\u0435\u0437 PostgreSQL: ${t.message}`)}}let l=null;const c={async getCollection(e){l||(l=s());const{db:t}=await l;try{return t.model(e)}catch(r){throw console.error(`\u041c\u043e\u0434\u0435\u043b\u044c ${e} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430:`,r),new Error(`\u041c\u043e\u0434\u0435\u043b\u044c ${e} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430`)}},async transaction(e){l||(l=s());const{db:t}=await l;return t.transaction(e)},checkStatus:async()=>({connected:!0,using:"postgresql"}),async getSequelizeInstance(){try{let t;l||(console.log("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445..."),l=o(s(),15e3,"\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b\u0430 \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f"));try{t=await o(l,1e4,"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 Sequelize \u043f\u0440\u0435\u0432\u044b\u0441\u0438\u043b\u043e \u0432\u0440\u0435\u043c\u044f \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f")}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0442\u0430\u0439\u043c\u0430\u0443\u0442\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 Sequelize:",e.message),l=null,e}if(!t||!t.db)throw console.error("\u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0428\u0418\u0411\u041a\u0410: getSequelizeInstance: \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u0443\u0441\u0442"),l=null,new Error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445");return t}catch(t){throw console.error("\u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0428\u0418\u0411\u041a\u0410 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 Sequelize:",t.message),t}},async query(e,t){l||(l=s());const{db:r}=await l;return r.query(e,t)}};e.exports={unifiedDatabase:c,initializeDatabaseConnection:s}},8317:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ensureEquipmentHasCalculatedBonuses:()=>i,ensureItemHasCalculatedBonuses:()=>a,ensureItemsHaveCalculatedBonuses:()=>o});var n=r(3574);function a(e){if(!e)return e;if(e.calculatedBonuses)return e;const t=e.itemId||e.id;if(!t)return console.warn("\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430:",e),e;try{const r=(0,n.getEquipmentItemById)(parseInt(t));if(r&&r.calculatedBonuses)return{...e,calculatedBonuses:r.calculatedBonuses}}catch(r){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0435\u0434\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0445 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 ID=${t}:`,r)}return e}function i(e){if(!e)return{};const t={...e};return Object.keys(t).forEach((e=>{t[e]&&(t[e]=a(t[e]))})),t}function o(e){return e&&Array.isArray(e)?e.map((e=>a(e))):e}},8448:()=>{},8543:(e,t,r)=>{const n=r(9161),a=r(6771),i=r(6617),o=(r(3382),"undefined"!==typeof window);let s=[],l={};e.exports=class{static async getAllTechniques(){try{if(o)return s;return await a.findAll({include:[{model:i,as:"effects"}]})}catch(e){throw e}}static async getTechniqueById(e){try{const t=await a.findOne({where:{techniqueId:e},include:[{model:i,as:"effects"}]});if(!t)throw new Error(`\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0441 ID ${e} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430`);return t}catch(t){throw t}}static async getLearnedTechniques(e){try{if(o)return l[e]||(l[e]=[]),l[e];return(await n.findAll({where:{userId:e},include:[{model:a,as:"technique",include:[{model:i,as:"effects"}]}]})).map((e=>({id:e.technique.techniqueId,name:e.technique.name,description:e.technique.description,type:e.technique.type,element:e.technique.element,icon:e.technique.icon,level:e.level,experience:e.experience,masteryLevel:e.masteryLevel,energyCost:e.technique.energyCost,damage:e.technique.damage,damageType:e.technique.damageType,healing:e.technique.healing,cooldown:e.technique.cooldown,maxLevel:e.technique.maxLevel,lastUsed:e.lastUsed,effects:e.technique.effects})))}catch(t){throw t}}static async learnTechnique(e,t){try{if(o){l[e]||(l[e]=[]);const r=s.find((e=>e.techniqueId===t));if(r){if(l[e].find((e=>e.id===t)))throw new Error("\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0443\u0436\u0435 \u0438\u0437\u0443\u0447\u0435\u043d\u0430");const n={id:r.techniqueId,name:r.name,description:r.description,type:r.type,element:r.element,icon:r.icon,level:1,experience:0,masteryLevel:0,energyCost:r.energyCost,damage:r.damage,damageType:r.damageType,healing:r.healing,cooldown:r.cooldown,maxLevel:r.maxLevel,lastUsed:null,effects:r.effects};return l[e].push(n),n}{const r={techniqueId:t,name:`\u0422\u0435\u0445\u043d\u0438\u043a\u0430 ${t}`,description:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u0435\u0445\u043d\u0438\u043a\u0438",type:"attack",element:"fire",icon:"fire_icon",energyCost:10,damage:50,damageType:"fire",healing:0,cooldown:5,maxLevel:10,effects:[]};s.push(r);if(l[e].find((e=>e.id===t)))throw new Error("\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0443\u0436\u0435 \u0438\u0437\u0443\u0447\u0435\u043d\u0430");const n={id:r.techniqueId,name:r.name,description:r.description,type:r.type,element:r.element,icon:r.icon,level:1,experience:0,masteryLevel:0,energyCost:r.energyCost,damage:r.damage,damageType:r.damageType,healing:r.healing,cooldown:r.cooldown,maxLevel:r.maxLevel,lastUsed:null,effects:r.effects};return l[e].push(n),n}}{const r=await a.findOne({where:{techniqueId:t},include:[{model:i,as:"effects"}]});if(!r)throw new Error(`\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0441 ID ${t} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430`);if(await n.findOne({where:{userId:e,techniqueId:r.id}}))throw new Error("\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0443\u0436\u0435 \u0438\u0437\u0443\u0447\u0435\u043d\u0430");const o=await n.create({userId:e,techniqueId:r.id,level:1,experience:0,masteryLevel:0,lastUsed:null});return{id:r.techniqueId,name:r.name,description:r.description,type:r.type,element:r.element,icon:r.icon,level:o.level,experience:o.experience,masteryLevel:o.masteryLevel,energyCost:r.energyCost,damage:r.damage,damageType:r.damageType,healing:r.healing,cooldown:r.cooldown,maxLevel:r.maxLevel,effects:r.effects}}}catch(r){throw r}}static async upgradeTechnique(e,t){try{const r=await a.findOne({where:{techniqueId:t},include:[{model:i,as:"effects"}]});if(!r)throw new Error(`\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0441 ID ${t} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430`);const o=await n.findOne({where:{userId:e,techniqueId:r.id}});if(!o)throw new Error("\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u043d\u0435 \u0438\u0437\u0443\u0447\u0435\u043d\u0430");if(o.level>=r.maxLevel)throw new Error("\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0442\u0435\u0445\u043d\u0438\u043a\u0438");return o.level+=1,o.experience=0,await o.save(),{id:r.techniqueId,name:r.name,description:r.description,type:r.type,element:r.element,icon:r.icon,level:o.level,experience:o.experience,masteryLevel:o.masteryLevel,energyCost:r.energyCost,damage:r.damage,damageType:r.damageType,healing:r.healing,cooldown:r.cooldown,maxLevel:r.maxLevel,lastUsed:o.lastUsed,effects:r.effects}}catch(r){throw r}}static async useTechnique(e,t){try{const r=await a.findOne({where:{techniqueId:t},include:[{model:i,as:"effects"}]});if(!r)throw new Error(`\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0441 ID ${t} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430`);const o=await n.findOne({where:{userId:e,techniqueId:r.id}});if(!o)throw new Error("\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u043d\u0435 \u0438\u0437\u0443\u0447\u0435\u043d\u0430");o.lastUsed=new Date,o.experience+=1;const s=100*(o.masteryLevel+1);o.experience>=s&&(o.masteryLevel+=1,o.experience-=s),await o.save();const l=r.effects.map((e=>{const t={...e.toJSON()};return t.damage>0&&(t.damage=Math.floor(t.damage*(1+.1*o.level+.05*o.masteryLevel))),t.healing>0&&(t.healing=Math.floor(t.healing*(1+.1*o.level+.05*o.masteryLevel))),t.duration>0&&(t.duration=Math.floor(t.duration*(1+.05*o.masteryLevel))),t})),c=r.damage>0?Math.floor(r.damage*(1+.1*o.level+.05*o.masteryLevel)):0,d=r.healing>0?Math.floor(r.healing*(1+.1*o.level+.05*o.masteryLevel)):0;return{id:r.techniqueId,name:r.name,level:o.level,experience:o.experience,masteryLevel:o.masteryLevel,lastUsed:o.lastUsed,damage:c,damageType:r.damageType,healing:d,effects:l}}catch(r){throw r}}static async getTechniqueByName(e){try{const t=await a.findOne({where:{name:e},include:[{model:i,as:"effects"}]});if(!t)throw new Error(`\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0441 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435\u043c "${e}" \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430`);return t}catch(t){throw t}}}},8547:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){s.hasMany(e.QuestObjective,{foreignKey:"quest_id",as:"objectives"}),s.hasMany(e.QuestReward,{foreignKey:"quest_id",as:"rewards"})}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{id:{type:a.STRING(20),primaryKey:!0},title:{type:a.STRING(100),allowNull:!1},category:{type:a.STRING(50)},difficulty:{type:a.STRING(20)},description:{type:a.TEXT},status:{type:a.STRING(20)},requiredLevel:{type:a.INTEGER,defaultValue:0,field:"required_level"},repeatable:{type:a.BOOLEAN,defaultValue:!1}},{sequelize:e,modelName:"Quest",tableName:"quests",timestamps:!1})},(async()=>{try{await s.init(),console.log("Quest \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 Quest:",e),console.error(e.stack)}})(),e.exports=s},8568:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DataTypes:()=>o,Model:()=>s,Sequelize:()=>i,isServerEnvironment:()=>a});var n=r(2285);const a="undefined"===typeof window&&"undefined"!==typeof n&&n.versions&&n.versions.node;let i=function(){return console.error("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c Sequelize \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e.\n\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 client-api.js \u0432\u043c\u0435\u0441\u0442\u043e \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445.\n\u042d\u0442\u0430 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u0435."),{}},o={STRING:"STRING",TEXT:"TEXT",INTEGER:"INTEGER",FLOAT:"FLOAT",BOOLEAN:"BOOLEAN",DATE:"DATE",JSON:"JSON",JSONB:"JSONB",UUID:"UUID",ENUM:function(){return"ENUM"},ARRAY:e=>`ARRAY(${e})`,DECIMAL:"DECIMAL",VIRTUAL:"VIRTUAL",ABSTRACT:function(){return"ABSTRACT"}},s=class{static init(){return console.error("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c Model.init \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435.\n\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 client-api.js \u0432\u043c\u0435\u0441\u0442\u043e \u043f\u0440\u044f\u043c\u043e\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445.\n"),this}static findOne(){return console.error("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 (findOne)"),Promise.reject(new Error("\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435"))}static findAll(){return console.error("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 (findAll)"),Promise.reject(new Error("\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435"))}static findByPk(){return console.error("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 (findByPk)"),Promise.reject(new Error("\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435"))}static create(){return console.error("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 (create)"),Promise.reject(new Error("\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435"))}static update(){return console.error("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 (update)"),Promise.reject(new Error("\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435"))}static destroy(){return console.error("\u041e\u0428\u0418\u0411\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 (destroy)"),Promise.reject(new Error("\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435"))}};if(a)try{Function('return import("sequelize")')().then((e=>{i=e.Sequelize,o=e.DataTypes,s=e.Model,console.log("Sequelize \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d \u0432 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u043e\u0439 \u0441\u0440\u0435\u0434\u0435")})).catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u043c \u0438\u043c\u043f\u043e\u0440\u0442\u0435 Sequelize:",e)}))}catch(l){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0435 \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c Sequelize:",l)}},8790:e=>{function t(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||{stats:{strength:0,dexterity:0,vitality:0,intelligence:0,perception:0,luck:0},combat:{physicalDamage:0,magicDamage:0,physicalDefense:0,magicDefense:0,critChance:0,critDamage:0,dodgeChance:0},cultivation:{energyMax:0,energyRegen:0,comprehensionRate:0,breakthroughChance:0},elemental:{fire:0,water:0,earth:0,air:0,light:0,dark:0},special:[]};return e.forEach((e=>{e&&(Object.keys(t.stats).forEach((r=>{e.stats&&void 0!==e.stats[r]&&(t.stats[r]+=e.stats[r])})),Object.keys(t.combat).forEach((r=>{e.combat&&void 0!==e.combat[r]&&(t.combat[r]+=e.combat[r])})),Object.keys(t.cultivation).forEach((r=>{e.cultivation&&void 0!==e.cultivation[r]&&(t.cultivation[r]+=e.cultivation[r])})),Object.keys(t.elemental).forEach((r=>{e.elemental&&void 0!==e.elemental[r]&&(t.elemental[r]+=e.elemental[r])})),e.special&&Array.isArray(e.special)&&(t.special=[...t.special,...e.special]))})),t}e.exports={getItemBonuses:function(e){return e&&e.calculatedBonuses||null},getEquipmentTotalBonuses:function(e){return t((Array.isArray(e)?e:Object.values(e).filter((e=>null!==e))).map((e=>e.calculatedBonuses)).filter((e=>null!==e&&void 0!==e)),{stats:{strength:0,dexterity:0,vitality:0,intelligence:0,perception:0,luck:0},combat:{physicalDamage:0,magicDamage:0,physicalDefense:0,magicDefense:0,critChance:0,critDamage:0,dodgeChance:0},cultivation:{energyMax:0,energyRegen:0,comprehensionRate:0,breakthroughChance:0},elemental:{fire:0,water:0,earth:0,air:0,light:0,dark:0},special:[]})},aggregateBonuses:t,hasCalculatedBonuses:function(e){return e&&void 0!==e.calculatedBonuses&&null!==e.calculatedBonuses},createEmptyBonusStructure:function(){return{stats:{strength:0,dexterity:0,vitality:0,intelligence:0,perception:0,luck:0},combat:{physicalDamage:0,magicDamage:0,physicalDefense:0,magicDefense:0,critChance:0,critDamage:0,dodgeChance:0},cultivation:{energyMax:0,energyRegen:0,comprehensionRate:0,breakthroughChance:0},elemental:{fire:0,water:0,earth:0,air:0,light:0,dark:0},special:[]}}}},8843:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){s.belongsTo(e.User,{foreignKey:"userId",as:"user"}),s.belongsTo(e.Quest,{foreignKey:"questId",as:"quest"})}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{id:{type:a.INTEGER,autoIncrement:!0,primaryKey:!0,allowNull:!1},userId:{type:a.INTEGER,references:{model:"users",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE"},questId:{type:a.STRING(20),references:{model:"quests",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE"},status:{type:a.ENUM("\u043d\u0435 \u043d\u0430\u0447\u0430\u0442\u043e","\u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435","\u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e","\u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043e"),defaultValue:"\u043d\u0435 \u043d\u0430\u0447\u0430\u0442\u043e"},progress:{type:a.INTEGER,defaultValue:0},completedObjectives:{type:a.JSONB,defaultValue:[]},startedAt:{type:a.DATE},completedAt:{type:a.DATE}},{sequelize:e,modelName:"QuestProgress",tableName:"quest_progress",timestamps:!0,underscored:!0})},(async()=>{try{await s.init(),console.log("QuestProgress \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 QuestProgress:",e),console.error(e.stack)}})(),e.exports=s},8853:(e,t,r)=>{"use strict";e.exports=r(7234)},9161:(e,t,r)=>{const{Model:n,DataTypes:a}=r(2342),{unifiedDatabase:i}=r(8153);let o=null;class s extends n{static associate(e){s.belongsTo(e.User,{foreignKey:"userId",as:"user"}),s.belongsTo(e.Technique,{foreignKey:"techniqueId",as:"technique"})}}s.init=async function(){const e=await async function(){if(!o){const e=await i.getSequelizeInstance();o=e.db}return o}();return n.init.call(this,{id:{type:a.INTEGER,autoIncrement:!0,primaryKey:!0,allowNull:!1},userId:{type:a.INTEGER,references:{model:"users",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE"},techniqueId:{type:a.INTEGER,references:{model:"techniques",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE"},masteryLevel:{type:a.INTEGER,defaultValue:1},experience:{type:a.INTEGER,defaultValue:0},isEquipped:{type:a.BOOLEAN,defaultValue:!1},learnedAt:{type:a.DATE,defaultValue:a.NOW},lastUsed:{type:a.DATE}},{sequelize:e,modelName:"LearnedTechnique",tableName:"learned_techniques",timestamps:!0,underscored:!0})},(async()=>{try{await s.init(),console.log("LearnedTechnique \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 LearnedTechnique:",e),console.error(e.stack)}})(),e.exports=s},9193:(e,t,r)=>{const{unifiedDatabase:n,initializeDatabaseConnection:a}=r(8153),{Sequelize:i}=r(8568);let o;async function s(){if(!o){const{db:e}=await a();o=e}return o}let l=[];function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{id:e.id,name:e.name,description:e.description,type:e.type,element:e.element,rarity:e.rarity,unlockCondition:e.unlock_condition,maxLevel:e.max_level||100,evolutionPath:e.evolution_path||[],abilities:t.map((e=>({name:e.name,description:e.description,unlockLevel:e.unlock_level,cooldown:e.cooldown,energyCost:e.energy_cost,effects:JSON.parse(e.effects||"{}")}))),baseStats:r,growthRates:n,icon:e.icon}}async function d(){try{const e=await s(),t=await n.query("SELECT * FROM spirit_pets",{type:e.QueryTypes.SELECT});if(0===t.length)return[];const r=t.map((e=>e.id)),a=`\n      SELECT * FROM spirit_pet_abilities \n      WHERE pet_id IN (${r.map((e=>`'${e}'`)).join(",")})\n    `,i=await n.query(a,{type:e.QueryTypes.SELECT}),o=`\n      SELECT * FROM spirit_pet_stats \n      WHERE pet_id IN (${r.map((e=>`'${e}'`)).join(",")})\n    `,d=await n.query(o,{type:e.QueryTypes.SELECT}),u=`\n      SELECT * FROM spirit_pet_growth_rates \n      WHERE pet_id IN (${r.map((e=>`'${e}'`)).join(",")})\n    `,p=await n.query(u,{type:e.QueryTypes.SELECT}),h={};i.forEach((e=>{h[e.pet_id]||(h[e.pet_id]=[]),h[e.pet_id].push(e)}));const m={};d.forEach((e=>{m[e.pet_id]||(m[e.pet_id]={}),m[e.pet_id][e.stat_name]=e.stat_value}));const f={};p.forEach((e=>{f[e.pet_id]||(f[e.pet_id]={}),f[e.pet_id][e.stat_name]=e.growth_rate}));const y=t.map((e=>c(e,h[e.id]||[],m[e.id]||{},f[e.id]||{})));return l=y,y}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432 \u0438\u0437 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445:",e),l}}function u(e){return l.find((t=>t.id===e))||null}function p(e){return l.filter((t=>t.type===e))}function h(e){return l.filter((t=>t.element===e))}function m(e){return l.filter((t=>t.rarity===e))}d().catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0443\u043b\u044f \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432:",e)})),e.exports={PET_TYPES:{ELEMENTAL:"elemental",BEAST:"beast",MYTHICAL:"mythical",CELESTIAL:"celestial",DEMONIC:"demonic"},PET_RARITY:{COMMON:"common",UNCOMMON:"uncommon",RARE:"rare",EPIC:"epic",LEGENDARY:"legendary",MYTHIC:"mythic"},spiritPets:l,loadSpiritPets:d,getSpiritPetById:u,getSpiritPetByIdAsync:async function(e){try{const t=await s(),r=await n.query("SELECT * FROM spirit_pets WHERE id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT});if(0===r.length)return null;const[a,i,o]=await Promise.all([n.query("SELECT * FROM spirit_pet_abilities WHERE pet_id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT}),n.query("SELECT * FROM spirit_pet_stats WHERE pet_id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT}),n.query("SELECT * FROM spirit_pet_growth_rates WHERE pet_id = :id",{replacements:{id:e},type:t.QueryTypes.SELECT})]),l={};i.forEach((e=>{l[e.stat_name]=e.stat_value}));const d={};return o.forEach((e=>{d[e.stat_name]=e.growth_rate})),c(r[0],a,l,d)}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0433\u043e \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u0441 ID ${e}:`,t),u(e)}},getSpiritPetsByType:p,getSpiritPetsByTypeAsync:async function(e){try{const t=await s(),r=await n.query("SELECT * FROM spirit_pets WHERE type = :type",{replacements:{type:e},type:t.QueryTypes.SELECT});if(0===r.length)return[];const a=r.map((e=>e.id)),i=`\n      SELECT * FROM spirit_pet_abilities \n      WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})\n    `,o=await n.query(i,{type:t.QueryTypes.SELECT}),l=`\n      SELECT * FROM spirit_pet_stats \n      WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})\n    `,d=await n.query(l,{type:t.QueryTypes.SELECT}),u=`\n      SELECT * FROM spirit_pet_growth_rates \n      WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})\n    `,p=await n.query(u,{type:t.QueryTypes.SELECT}),h={};o.forEach((e=>{h[e.pet_id]||(h[e.pet_id]=[]),h[e.pet_id].push(e)}));const m={};d.forEach((e=>{m[e.pet_id]||(m[e.pet_id]={}),m[e.pet_id][e.stat_name]=e.stat_value}));const f={};return p.forEach((e=>{f[e.pet_id]||(f[e.pet_id]={}),f[e.pet_id][e.stat_name]=e.growth_rate})),r.map((e=>c(e,h[e.id]||[],m[e.id]||{},f[e.id]||{})))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432 \u0442\u0438\u043f\u0430 ${e}:`,t),p(e)}},getSpiritPetsByElement:h,getSpiritPetsByElementAsync:async function(e){try{const t=await s(),r=await n.query("SELECT * FROM spirit_pets WHERE element = :element",{replacements:{element:e},type:t.QueryTypes.SELECT});if(0===r.length)return[];const a=r.map((e=>e.id)),[i,o,l]=await Promise.all([n.query(`SELECT * FROM spirit_pet_abilities WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM spirit_pet_stats WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM spirit_pet_growth_rates WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT})]),d={};i.forEach((e=>{d[e.pet_id]||(d[e.pet_id]=[]),d[e.pet_id].push(e)}));const u={};o.forEach((e=>{u[e.pet_id]||(u[e.pet_id]={}),u[e.pet_id][e.stat_name]=e.stat_value}));const p={};return l.forEach((e=>{p[e.pet_id]||(p[e.pet_id]={}),p[e.pet_id][e.stat_name]=e.growth_rate})),r.map((e=>c(e,d[e.id]||[],u[e.id]||{},p[e.id]||{})))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 ${e}:`,t),h(e)}},getSpiritPetsByRarity:m,getSpiritPetsByRarityAsync:async function(e){try{const t=await s(),r=await n.query("SELECT * FROM spirit_pets WHERE rarity = :rarity",{replacements:{rarity:e},type:t.QueryTypes.SELECT});if(0===r.length)return[];const a=r.map((e=>e.id)),[i,o,l]=await Promise.all([n.query(`SELECT * FROM spirit_pet_abilities WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM spirit_pet_stats WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT}),n.query(`SELECT * FROM spirit_pet_growth_rates WHERE pet_id IN (${a.map((e=>`'${e}'`)).join(",")})`,{type:t.QueryTypes.SELECT})]),d={};i.forEach((e=>{d[e.pet_id]||(d[e.pet_id]=[]),d[e.pet_id].push(e)}));const u={};o.forEach((e=>{u[e.pet_id]||(u[e.pet_id]={}),u[e.pet_id][e.stat_name]=e.stat_value}));const p={};return l.forEach((e=>{p[e.pet_id]||(p[e.pet_id]={}),p[e.pet_id][e.stat_name]=e.growth_rate})),r.map((e=>c(e,d[e.id]||[],u[e.id]||{},p[e.id]||{})))}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432 \u0440\u0435\u0434\u043a\u043e\u0441\u0442\u0438 ${e}:`,t),m(e)}},petTypeNames:{fire:"\u041e\u0433\u043d\u0435\u043d\u043d\u044b\u0439",water:"\u0412\u043e\u0434\u043d\u044b\u0439",earth:"\u0417\u0435\u043c\u043b\u044f\u043d\u043e\u0439",wind:"\u0412\u043e\u0437\u0434\u0443\u0448\u043d\u044b\u0439",lightning:"\u041c\u043e\u043b\u043d\u0438\u0435\u0432\u044b\u0439",wood:"\u0414\u0440\u0435\u0432\u0435\u0441\u043d\u044b\u0439",metal:"\u041c\u0435\u0442\u0430\u043b\u043b\u0438\u0447\u0435\u0441\u043a\u0438\u0439",darkness:"\u0422\u0451\u043c\u043d\u044b\u0439",light:"\u0421\u0432\u0435\u0442\u043b\u044b\u0439",beast:"\u0417\u0432\u0435\u0440\u044c",elemental:"\u042d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0439",mythical:"\u041c\u0438\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0439",celestial:"\u041d\u0435\u0431\u0435\u0441\u043d\u044b\u0439",demonic:"\u0414\u0435\u043c\u043e\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0439"},petTypeDescriptions:{fire:"\u041e\u0433\u043d\u0435\u043d\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u043e\u0431\u043b\u0430\u0434\u0430\u044e\u0442 \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0441\u0438\u043b\u043e\u0439 \u0430\u0442\u0430\u043a\u0438 \u0438 \u0441\u043a\u043b\u043e\u043d\u043d\u044b \u043a \u0430\u0433\u0440\u0435\u0441\u0441\u0438\u0432\u043d\u044b\u043c \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c.",water:"\u0412\u043e\u0434\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u0445\u043e\u0440\u043e\u0448\u043e \u043f\u0440\u0438\u0441\u043f\u043e\u0441\u0430\u0431\u043b\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u0438 \u043c\u043e\u0433\u0443\u0442 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c \u044d\u043d\u0435\u0440\u0433\u0438\u044e.",earth:"\u0417\u0435\u043c\u043b\u044f\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u043e\u0442\u043b\u0438\u0447\u0430\u044e\u0442\u0441\u044f \u0432\u044b\u0441\u043e\u043a\u043e\u0439 \u0436\u0438\u0432\u0443\u0447\u0435\u0441\u0442\u044c\u044e \u0438 \u0441\u0442\u043e\u0439\u043a\u043e\u0441\u0442\u044c\u044e.",wind:"\u0412\u043e\u0437\u0434\u0443\u0448\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u0431\u044b\u0441\u0442\u0440\u044b \u0438 \u043f\u0440\u043e\u0432\u043e\u0440\u043d\u044b, \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u044b \u0443\u043a\u043b\u043e\u043d\u044f\u0442\u044c\u0441\u044f \u043e\u0442 \u0430\u0442\u0430\u043a.",lightning:"\u041c\u043e\u043b\u043d\u0438\u0435\u0432\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u043d\u0430\u043d\u043e\u0441\u044f\u0442 \u0441\u0442\u0438\u0445\u0438\u0439\u043d\u044b\u0439 \u0443\u0440\u043e\u043d \u0438 \u043c\u043e\u0433\u0443\u0442 \u043e\u0433\u043b\u0443\u0448\u0430\u0442\u044c \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u043e\u0432.",wood:"\u0414\u0440\u0435\u0432\u0435\u0441\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u043d\u0430 \u0438\u0441\u0446\u0435\u043b\u0435\u043d\u0438\u0438 \u0438 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0435.",metal:"\u041c\u0435\u0442\u0430\u043b\u043b\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u0438\u043c\u0435\u044e\u0442 \u0432\u044b\u0441\u043e\u043a\u0443\u044e \u0437\u0430\u0449\u0438\u0442\u0443 \u0438 \u043c\u043e\u0433\u0443\u0442 \u043e\u0442\u0440\u0430\u0436\u0430\u0442\u044c \u0443\u0440\u043e\u043d.",darkness:"\u0422\u0451\u043c\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u043c\u043e\u0433\u0443\u0442 \u043e\u0441\u043b\u0430\u0431\u043b\u044f\u0442\u044c \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u043e\u0432 \u0438 \u043a\u0440\u0430\u0441\u0442\u044c \u0436\u0438\u0437\u043d\u0435\u043d\u043d\u0443\u044e \u0441\u0438\u043b\u0443.",light:"\u0421\u0432\u0435\u0442\u043b\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u043d\u0430 \u0437\u0430\u0449\u0438\u0442\u0435 \u0438 \u043e\u0447\u0438\u0449\u0435\u043d\u0438\u0438 \u043e\u0442 \u043d\u0435\u0433\u0430\u0442\u0438\u0432\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432.",beast:'\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u0442\u0438\u043f\u0430 "\u0437\u0432\u0435\u0440\u044c" \u043e\u0442\u043b\u0438\u0447\u0430\u044e\u0442\u0441\u044f \u0445\u043e\u0440\u043e\u0448\u0438\u043c \u0431\u0430\u043b\u0430\u043d\u0441\u043e\u043c \u0430\u0442\u0430\u043a\u0438 \u0438 \u0437\u0430\u0449\u0438\u0442\u044b.',elemental:"\u042d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u0438\u043c\u0435\u044e\u0442 \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u044b\u0439 \u0443\u0440\u043e\u043d \u043e\u0442 \u0441\u0432\u043e\u0435\u0433\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430.",mythical:"\u041c\u0438\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u043e\u0431\u043b\u0430\u0434\u0430\u044e\u0442 \u0440\u0435\u0434\u043a\u0438\u043c\u0438 \u0438 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044f\u043c\u0438.",celestial:"\u041d\u0435\u0431\u0435\u0441\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u043e\u0431\u043b\u0430\u0434\u0430\u044e\u0442 \u0432\u044b\u0441\u043e\u043a\u0438\u043c \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u043c \u043f\u043e\u0442\u0435\u043d\u0446\u0438\u0430\u043b\u043e\u043c \u0438 \u0437\u0430\u0449\u0438\u0442\u043d\u044b\u043c\u0438 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044f\u043c\u0438.",demonic:"\u0414\u0435\u043c\u043e\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u044e\u0442\u0441\u044f \u043d\u0430 \u0441\u0438\u043b\u043e\u0432\u044b\u0445 \u0430\u0442\u0430\u043a\u0430\u0445 \u0438 \u043e\u0441\u043b\u0430\u0431\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430."},petTypeBaseStats:{fire:{strength:8,intelligence:5,agility:6,vitality:5,spirit:6},water:{strength:5,intelligence:8,agility:6,vitality:7,spirit:4},earth:{strength:7,intelligence:4,agility:3,vitality:10,spirit:6},wind:{strength:4,intelligence:6,agility:10,vitality:4,spirit:6},lightning:{strength:7,intelligence:7,agility:7,vitality:3,spirit:6},wood:{strength:5,intelligence:6,agility:5,vitality:7,spirit:7},metal:{strength:6,intelligence:5,agility:4,vitality:9,spirit:6},darkness:{strength:6,intelligence:8,agility:5,vitality:5,spirit:6},light:{strength:5,intelligence:7,agility:6,vitality:6,spirit:8},beast:{strength:7,intelligence:5,agility:7,vitality:6,spirit:5},elemental:{strength:6,intelligence:8,agility:6,vitality:5,spirit:7},mythical:{strength:8,intelligence:8,agility:7,vitality:7,spirit:8},celestial:{strength:6,intelligence:9,agility:7,vitality:7,spirit:10},demonic:{strength:10,intelligence:7,agility:5,vitality:6,spirit:4}},petTypeAbilities:{fire:[{id:"fire_breath",name:"\u041e\u0433\u043d\u0435\u043d\u043d\u043e\u0435 \u0434\u044b\u0445\u0430\u043d\u0438\u0435",type:"attack",description:"\u041d\u0430\u043d\u043e\u0441\u0438\u0442 \u0443\u0440\u043e\u043d \u043e\u0433\u043d\u0435\u043c \u0432\u0441\u0435\u043c \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430\u043c.",cooldown:3,damageMultiplier:1.5,damageType:"fire"},{id:"fire_shield",name:"\u041e\u0433\u043d\u0435\u043d\u043d\u044b\u0439 \u0449\u0438\u0442",type:"buff",description:"\u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0449\u0438\u0442 \u0438\u0437 \u043e\u0433\u043d\u044f, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0430\u043d\u043e\u0441\u0438\u0442 \u0443\u0440\u043e\u043d \u0430\u0442\u0430\u043a\u0443\u044e\u0449\u0438\u043c.",cooldown:4},{id:"fire_burst",name:"\u041e\u0433\u043d\u0435\u043d\u043d\u044b\u0439 \u0432\u0437\u0440\u044b\u0432",type:"attack",description:"\u041d\u0430\u043d\u043e\u0441\u0438\u0442 \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0443\u0440\u043e\u043d \u043e\u0434\u043d\u043e\u043c\u0443 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0443.",cooldown:2,damageMultiplier:2,damageType:"fire"}],water:[{id:"water_heal",name:"\u0418\u0441\u0446\u0435\u043b\u044f\u044e\u0449\u0438\u0435 \u0432\u043e\u0434\u044b",type:"buff",description:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435 \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0443.",cooldown:4},{id:"water_wave",name:"\u0412\u043e\u0434\u043d\u0430\u044f \u0432\u043e\u043b\u043d\u0430",type:"attack",description:"\u041d\u0430\u043d\u043e\u0441\u0438\u0442 \u0443\u0440\u043e\u043d \u0432\u0441\u0435\u043c \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430\u043c \u0438 \u0441\u043d\u0438\u0436\u0430\u0435\u0442 \u0438\u0445 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c.",cooldown:3,damageMultiplier:1.2,damageType:"water"},{id:"water_shield",name:"\u0412\u043e\u0434\u043d\u044b\u0439 \u0449\u0438\u0442",type:"buff",description:"\u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0437\u0430\u0449\u0438\u0442\u043d\u044b\u0439 \u0431\u0430\u0440\u044c\u0435\u0440, \u0441\u043d\u0438\u0436\u0430\u044e\u0449\u0438\u0439 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c\u044b\u0439 \u0443\u0440\u043e\u043d.",cooldown:5}],earth:[{id:"earth_barrier",name:"\u0417\u0435\u043c\u043b\u044f\u043d\u043e\u0439 \u0431\u0430\u0440\u044c\u0435\u0440",type:"buff",description:"\u0417\u043d\u0430\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0437\u0430\u0449\u0438\u0442\u0443 \u043d\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0445\u043e\u0434\u043e\u0432.",cooldown:4},{id:"rock_throw",name:"\u041c\u0435\u0442\u0430\u043d\u0438\u0435 \u043a\u0430\u043c\u043d\u0435\u0439",type:"attack",description:"\u041d\u0430\u043d\u043e\u0441\u0438\u0442 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0440\u043e\u043d \u043e\u0434\u043d\u043e\u043c\u0443 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0443.",cooldown:2,damageMultiplier:1.3,damageType:"earth"},{id:"earthquake",name:"\u0417\u0435\u043c\u043b\u0435\u0442\u0440\u044f\u0441\u0435\u043d\u0438\u0435",type:"attack",description:"\u041d\u0430\u043d\u043e\u0441\u0438\u0442 \u0443\u0440\u043e\u043d \u0432\u0441\u0435\u043c \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430\u043c \u0438 \u0438\u043c\u0435\u0435\u0442 \u0448\u0430\u043d\u0441 \u043e\u0433\u043b\u0443\u0448\u0438\u0442\u044c.",cooldown:5,damageMultiplier:1.8,damageType:"earth"}],wind:[{id:"wind_slash",name:"\u0412\u0435\u0442\u0440\u044f\u043d\u043e\u0439 \u043a\u043b\u0438\u043d\u043e\u043a",type:"attack",description:"\u041d\u0430\u043d\u043e\u0441\u0438\u0442 \u0443\u0440\u043e\u043d \u0441 \u0432\u044b\u0441\u043e\u043a\u0438\u043c \u0448\u0430\u043d\u0441\u043e\u043c \u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0443\u0434\u0430\u0440\u0430.",cooldown:2,damageMultiplier:1.2,damageType:"wind"},{id:"wind_boost",name:"\u0423\u0441\u043a\u043e\u0440\u0435\u043d\u0438\u0435 \u0432\u0435\u0442\u0440\u043e\u043c",type:"buff",description:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0438 \u0448\u0430\u043d\u0441 \u0443\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f.",cooldown:3},{id:"tornado",name:"\u0422\u043e\u0440\u043d\u0430\u0434\u043e",type:"attack",description:"\u0421\u043e\u0437\u0434\u0430\u0435\u0442 \u0442\u043e\u0440\u043d\u0430\u0434\u043e, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0430\u0442\u0430\u043a\u0443\u0435\u0442 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0445 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u043e\u0432 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437.",cooldown:4,damageMultiplier:1.6,damageType:"wind"},{id:"wind_breath",name:"\u0412\u0435\u0442\u0440\u044f\u043d\u043e\u0435 \u0434\u044b\u0445\u0430\u043d\u0438\u0435",type:"attack",description:"\u0412\u044b\u0434\u044b\u0445\u0430\u0435\u0442 \u043f\u043e\u0442\u043e\u043a \u0432\u0435\u0442\u0440\u0430, \u043d\u0430\u043d\u043e\u0441\u044f\u0449\u0438\u0439 \u0443\u0440\u043e\u043d \u0438 \u043e\u0442\u0442\u0430\u043b\u043a\u0438\u0432\u0430\u044e\u0449\u0438\u0439 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u043e\u0432.",cooldown:3,damageMultiplier:1.4,damageType:"wind"}],lightning:[{id:"lightning_strike",name:"\u0423\u0434\u0430\u0440 \u043c\u043e\u043b\u043d\u0438\u0438",type:"attack",description:"\u041d\u0430\u043d\u043e\u0441\u0438\u0442 \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u0443\u0440\u043e\u043d \u043e\u0434\u043d\u043e\u043c\u0443 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0443 \u0441 \u0448\u0430\u043d\u0441\u043e\u043c \u043e\u0433\u043b\u0443\u0448\u0438\u0442\u044c.",cooldown:3,damageMultiplier:1.7,damageType:"lightning"},{id:"static_charge",name:"\u0421\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0437\u0430\u0440\u044f\u0434",type:"buff",description:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u0430\u0442\u0430\u043a\u0438 \u0438 \u0448\u0430\u043d\u0441 \u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0443\u0434\u0430\u0440\u0430.",cooldown:4},{id:"chain_lightning",name:"\u0426\u0435\u043f\u043d\u0430\u044f \u043c\u043e\u043b\u043d\u0438\u044f",type:"attack",description:"\u0410\u0442\u0430\u043a\u0443\u0435\u0442 \u043e\u0441\u043d\u043e\u0432\u043d\u0443\u044e \u0446\u0435\u043b\u044c \u0438 \u043f\u0435\u0440\u0435\u0441\u043a\u0430\u043a\u0438\u0432\u0430\u0435\u0442 \u043d\u0430 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0438\u0445 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u043e\u0432.",cooldown:4,damageMultiplier:1.5,damageType:"lightning"}],beast:[{id:"beast_charge",name:"\u0417\u0432\u0435\u0440\u0438\u043d\u0430\u044f \u0430\u0442\u0430\u043a\u0430",type:"attack",description:"\u0421\u0442\u0440\u0435\u043c\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0430\u0442\u0430\u043a\u0443\u0435\u0442 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430, \u043d\u0430\u043d\u043e\u0441\u044f \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0440\u043e\u043d.",cooldown:2,damageMultiplier:1.6,damageType:"physical"},{id:"feral_instinct",name:"\u0414\u0438\u043a\u0438\u0439 \u0438\u043d\u0441\u0442\u0438\u043d\u043a\u0442",type:"buff",description:"\u041f\u043e\u0432\u044b\u0448\u0430\u0435\u0442 \u0432\u0441\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u043d\u0430 \u043a\u043e\u0440\u043e\u0442\u043a\u043e\u0435 \u0432\u0440\u0435\u043c\u044f.",cooldown:4}],elemental:[{id:"elemental_blast",name:"\u0423\u0434\u0430\u0440 \u0441\u0442\u0438\u0445\u0438\u0438",type:"attack",description:"\u041d\u0430\u043d\u043e\u0441\u0438\u0442 \u0441\u0442\u0438\u0445\u0438\u0439\u043d\u044b\u0439 \u0443\u0440\u043e\u043d \u0432 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u043f\u0438\u0442\u043e\u043c\u0446\u0430.",cooldown:3,damageMultiplier:1.8},{id:"elemental_harmony",name:"\u0413\u0430\u0440\u043c\u043e\u043d\u0438\u044f \u0441\u0442\u0438\u0445\u0438\u0439",type:"buff",description:"\u0423\u0441\u0438\u043b\u0438\u0432\u0430\u0435\u0442 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u043b\u044c\u043d\u044b\u0439 \u0443\u0440\u043e\u043d \u0438 \u0437\u0430\u0449\u0438\u0442\u0443.",cooldown:4}]},evolutionStages:{1:{name:"\u0414\u0435\u0442\u0451\u043d\u044b\u0448",description:"\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f \u0441\u0442\u0430\u0434\u0438\u044f \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u044f \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0433\u043e \u043f\u0438\u0442\u043e\u043c\u0446\u0430. \u0418\u043c\u0435\u0435\u0442 \u0431\u0430\u0437\u043e\u0432\u044b\u0435 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438."},2:{name:"\u041f\u043e\u0434\u0440\u043e\u0441\u0442\u043e\u043a",description:"\u0412\u0442\u043e\u0440\u0430\u044f \u0441\u0442\u0430\u0434\u0438\u044f \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u044f. \u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044f\u043c."},3:{name:"\u0412\u0437\u0440\u043e\u0441\u043b\u044b\u0439",description:"\u041f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0440\u0430\u0437\u0432\u0438\u0442\u044b\u0439 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043f\u0438\u0442\u043e\u043c\u0435\u0446 \u0441 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u043f\u043e\u0442\u0435\u043d\u0446\u0438\u0430\u043b\u043e\u043c."},4:{name:"\u0414\u0440\u0435\u0432\u043d\u0438\u0439",description:"\u0420\u0435\u0434\u043a\u0430\u044f \u0441\u0442\u0430\u0434\u0438\u044f \u044d\u0432\u043e\u043b\u044e\u0446\u0438\u0438. \u041e\u0431\u043b\u0430\u0434\u0430\u0435\u0442 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044f\u043c\u0438."}},calculateExpForLevel:function(e){return Math.floor(100*Math.pow(1.5,e-1))},calculateStatBonus:function(e,t){return Math.floor(e*(1+.05*(t-1)))},calculateCombatBonus:function(e){return{attack:Math.floor(.8*(e.strength||0)+.2*(e.intelligence||0)),defense:Math.floor(.7*(e.vitality||0)+.3*(e.strength||0)),speed:Math.floor(.9*(e.agility||0)+.1*(e.intelligence||0)),critChance:Math.min(.5,.01*(e.agility||0)+.005*(e.intelligence||0)),healthBonus:Math.floor(5*(e.vitality||0)),energyBonus:Math.floor(3*(e.spirit||0))}}}},9398:e=>{"use strict";if("undefined"===typeof pg){var t=new Error("Cannot find module 'pg'");throw t.code="MODULE_NOT_FOUND",t}e.exports=pg},9892:(e,t,r)=>{const{unifiedDatabase:n,initializeDatabaseConnection:a}=r(8153),{Sequelize:i}=r(8568);let o;function s(e){try{return JSON.parse(e.steps||"[]").map((t=>({id:`q${e.id}_obj${t.id}`,text:t.description,completed:t.completed||!1})))}catch(t){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0435 \u0437\u0430\u0434\u0430\u0447 \u043a\u0432\u0435\u0441\u0442\u0430:",t),[]}}function l(e){try{const t=JSON.parse(e.rewards||"{}"),r=[];if(t.experience&&r.push({type:"experience",amount:t.experience,icon:"\u2728"}),t.items&&Array.isArray(t.items)&&t.items.forEach((e=>{r.push({type:"item",name:e.name,icon:c(e.type)})})),t.gold){const e=Math.floor(t.gold),n=Math.round(10*(t.gold-e));r.push({type:"currency",amount:{gold:e,silver:n},icon:"\ud83e\ude99"})}return t.technique&&r.push({type:"technique",name:t.technique.name,icon:d(t.technique.id)}),r}catch(t){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0435 \u043d\u0430\u0433\u0440\u0430\u0434 \u043a\u0432\u0435\u0441\u0442\u0430:",t),[]}}function c(e){return{weapon:"\ud83d\udde1\ufe0f",armor:"\ud83d\udee1\ufe0f",pill:"\ud83d\udc8a",resource:"\ud83d\udd2e",artifact:"\ud83d\udcdc",accessory:"\ud83d\udcff"}[e]||"\ud83d\udce6"}function d(e){const t={4:"\ud83d\udee1\ufe0f",8:"\ud83d\udd25",12:"\u2694\ufe0f",default:"\ud83d\udcda"};return t[e]||t.default}async function u(){try{const e=await async function(){if(!o){const{db:e}=await a();o=e}return o}();return(await n.query("SELECT * FROM quests",{type:e.QueryTypes.SELECT})).map((e=>({id:e.id,title:e.title,category:e.type||"\u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435",difficulty:e.difficulty||"\u041b\u0435\u0433\u043a\u043e",description:e.description,objectives:s(e),rewards:l(e),status:p(e.status),requiredLevel:e.required_cultivation_level||0})))}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043a\u0432\u0435\u0441\u0442\u043e\u0432 \u0438\u0437 \u0411\u0414:",e),[]}}function p(e){return{"\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e":"available","\u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435":"active","\u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e":"completed","\u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043d\u043e":"failed"}[e]||"available"}let h=[];async function m(){return h=await u(),h}m().catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u0432\u0435\u0441\u0442\u043e\u0432:",e)}));e.exports={quests:h,initQuestData:m,getQuests:u,questCategories:[{id:"all",name:"\u0432\u0441\u0435"},{id:"main",name:"\u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435"},{id:"side",name:"\u043f\u043e\u0431\u043e\u0447\u043d\u044b\u0435"},{id:"sect",name:"\u0441\u0435\u043a\u0442\u044b"},{id:"daily",name:"\u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0435"}]}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"===typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"===typeof n.then)return n}var i=Object.create(null);r.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,r.d(i,o),i}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>"static/js/"+e+".e2d741cf.chunk.js",r.miniCssF=e=>{},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="immortal-path:";r.l=(n,a,i,o)=>{if(e[n])e[n].push(a);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+i){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",t+i),s.src=n),e[n]=[a];var p=(t,r)=>{s.onerror=s.onload=null,clearTimeout(h);var a=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((e=>e(r))),t)return t(r)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/",(()=>{var e={792:0};r.f.j=(t,n)=>{var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise(((r,n)=>a=e[t]=[r,n]));n.push(a[2]=i);var o=r.p+r.u(t),s=new Error;r.l(o,(n=>{if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var a,i,o=n[0],s=n[1],l=n[2],c=0;if(o.some((t=>0!==e[t]))){for(a in s)r.o(s,a)&&(r.m[a]=s[a]);if(l)l(r)}for(t&&t(n);c<o.length;c++)i=o[c],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunkimmortal_path=self.webpackChunkimmortal_path||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.nc=void 0,(()=>{"use strict";var e,t,n=r(5043),a=r.t(n,2),i=r(4391),o=r(7950),s=r.t(o,2);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l.apply(this,arguments)}(t=e||(e={})).Pop="POP",t.Push="PUSH",t.Replace="REPLACE";const c="popstate";function d(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function p(e,t){return{usr:e.state,key:e.key,idx:t}}function h(e,t,r,n){return void 0===r&&(r=null),l({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function m(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function f(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function y(t,r,n,a){void 0===a&&(a={});let{window:i=document.defaultView,v5Compat:o=!1}=a,s=i.history,u=e.Pop,f=null,y=g();function g(){return(s.state||{idx:null}).idx}function v(){u=e.Pop;let t=g(),r=null==t?null:t-y;y=t,f&&f({action:u,location:b.location,delta:r})}function x(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,r="string"===typeof e?e:m(e);return r=r.replace(/ $/,"%20"),d(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==y&&(y=0,s.replaceState(l({},s.state,{idx:y}),""));let b={get action(){return u},get location(){return t(i,s)},listen(e){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(c,v),f=e,()=>{i.removeEventListener(c,v),f=null}},createHref:e=>r(i,e),createURL:x,encodeLocation(e){let t=x(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,r){u=e.Push;let a=h(b.location,t,r);n&&n(a,t),y=g()+1;let l=p(a,y),c=b.createHref(a);try{s.pushState(l,"",c)}catch(d){if(d instanceof DOMException&&"DataCloneError"===d.name)throw d;i.location.assign(c)}o&&f&&f({action:u,location:b.location,delta:1})},replace:function(t,r){u=e.Replace;let a=h(b.location,t,r);n&&n(a,t),y=g();let i=p(a,y),l=b.createHref(a);s.replaceState(i,"",l),o&&f&&f({action:u,location:b.location,delta:0})},go:e=>s.go(e)};return b}var g,v;(v=g||(g={})).data="data",v.deferred="deferred",v.redirect="redirect",v.error="error";new Set(["lazy","caseSensitive","path","id","index","children"]);function x(e,t,r){return void 0===r&&(r="/"),b(e,t,r,!1)}function b(e,t,r,n){let a=R(("string"===typeof t?f(t):t).pathname||"/",r);if(null==a)return null;let i=w(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let o=null;for(let s=0;null==o&&s<i.length;++s){let e=M(a);o=N(i[s],e,n)}return o}function w(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");let a=(e,a,i)=>{let o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(d(o.relativePath.startsWith(n),'Absolute route path "'+o.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(n.length));let s=q([n,o.relativePath]),l=r.concat(o);e.children&&e.children.length>0&&(d(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),w(e.children,t,l,s)),(null!=e.path||e.index)&&t.push({path:s,score:A(s,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let n of _(e.path))a(e,t,n);else a(e,t)})),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(0===n.length)return a?[i,""]:[i];let o=_(n.join("/")),s=[];return s.push(...o.map((e=>""===e?i:[i,e].join("/")))),a&&s.push(...o),s.map((t=>e.startsWith("/")&&""===t?"/":t))}const E=/^:[\w-]+$/,T=3,S=2,j=1,C=10,k=-2,I=e=>"*"===e;function A(e,t){let r=e.split("/"),n=r.length;return r.some(I)&&(n+=k),t&&(n+=S),r.filter((e=>!I(e))).reduce(((e,t)=>e+(E.test(t)?T:""===t?j:C)),n)}function N(e,t,r){void 0===r&&(r=!1);let{routesMeta:n}=e,a={},i="/",o=[];for(let s=0;s<n.length;++s){let e=n[s],l=s===n.length-1,c="/"===i?t:t.slice(i.length)||"/",d=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&r&&!n[n.length-1].route.index&&(d=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),o.push({params:a,pathname:q([i,d.pathname]),pathnameBase:U(q([i,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(i=q([i,d.pathnameBase]))}return o}function D(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);u("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,n]}(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:n.reduce(((e,t,r)=>{let{paramName:n,isOptional:a}=t;if("*"===n){let e=s[r]||"";o=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[r];return e[n]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:o,pattern:e}}function M(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return u(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function P(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function L(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function $(e,t){let r=L(e);return t?r.map(((e,t)=>t===r.length-1?e.pathname:e.pathnameBase)):r.map((e=>e.pathnameBase))}function O(e,t,r,n){let a;void 0===n&&(n=!1),"string"===typeof e?a=f(e):(a=l({},e),d(!a.pathname||!a.pathname.includes("?"),P("?","pathname","search",a)),d(!a.pathname||!a.pathname.includes("#"),P("#","pathname","hash",a)),d(!a.search||!a.search.includes("#"),P("#","search","hash",a)));let i,o=""===e||""===a.pathname,s=o?"/":a.pathname;if(null==s)i=r;else{let e=t.length-1;if(!n&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let c=function(e,t){void 0===t&&(t="/");let{pathname:r,search:n="",hash:a=""}="string"===typeof e?f(e):e,i=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:i,search:F(n),hash:z(a)}}(a,i),u=s&&"/"!==s&&s.endsWith("/"),p=(o||"."===s)&&r.endsWith("/");return c.pathname.endsWith("/")||!u&&!p||(c.pathname+="/"),c}const q=e=>e.join("/").replace(/\/\/+/g,"/"),U=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),F=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",z=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function B(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const G=["post","put","patch","delete"],W=(new Set(G),["get",...G]);new Set(W),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},H.apply(this,arguments)}const V=n.createContext(null);const Q=n.createContext(null);const Y=n.createContext(null);const K=n.createContext(null);const X=n.createContext({outlet:null,matches:[],isDataRoute:!1});const J=n.createContext(null);function Z(){return null!=n.useContext(K)}function ee(){return Z()||d(!1),n.useContext(K).location}function te(e){n.useContext(Y).static||n.useLayoutEffect(e)}function re(){let{isDataRoute:e}=n.useContext(X);return e?function(){let{router:e}=ue(ce.UseNavigateStable),t=he(de.UseNavigateStable),r=n.useRef(!1);return te((()=>{r.current=!0})),n.useCallback((function(n,a){void 0===a&&(a={}),r.current&&("number"===typeof n?e.navigate(n):e.navigate(n,H({fromRouteId:t},a)))}),[e,t])}():function(){Z()||d(!1);let e=n.useContext(V),{basename:t,future:r,navigator:a}=n.useContext(Y),{matches:i}=n.useContext(X),{pathname:o}=ee(),s=JSON.stringify($(i,r.v7_relativeSplatPath)),l=n.useRef(!1);return te((()=>{l.current=!0})),n.useCallback((function(r,n){if(void 0===n&&(n={}),!l.current)return;if("number"===typeof r)return void a.go(r);let i=O(r,JSON.parse(s),o,"path"===n.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:q([t,i.pathname])),(n.replace?a.replace:a.push)(i,n.state,n)}),[t,a,s,o,e])}()}function ne(t,r,a,i){Z()||d(!1);let{navigator:o,static:s}=n.useContext(Y),{matches:l}=n.useContext(X),c=l[l.length-1],u=c?c.params:{},p=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let h,m=ee();if(r){var y;let e="string"===typeof r?f(r):r;"/"===p||(null==(y=e.pathname)?void 0:y.startsWith(p))||d(!1),h=e}else h=m;let g=h.pathname||"/",v=g;if("/"!==p){let e=p.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=!s&&a&&a.matches&&a.matches.length>0?a.matches:x(t,{pathname:v});let w=le(b&&b.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:q([p,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?p:q([p,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,a,i);return r&&w?n.createElement(K.Provider,{value:{location:H({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:e.Pop}},w):w}function ae(){let e=function(){var e;let t=n.useContext(J),r=pe(de.UseRouteError),a=he(de.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[a]}(),t=B(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a};return n.createElement(n.Fragment,null,n.createElement("h2",null,"Unexpected Application Error!"),n.createElement("h3",{style:{fontStyle:"italic"}},t),r?n.createElement("pre",{style:i},r):null,null)}const ie=n.createElement(ae,null);class oe extends n.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?n.createElement(X.Provider,{value:this.props.routeContext},n.createElement(J.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function se(e){let{routeContext:t,match:r,children:a}=e,i=n.useContext(V);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),n.createElement(X.Provider,{value:t},a)}function le(e,t,r,a){var i;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===a&&(a=null),null==e){var o;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(o=a)&&o.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let s=e,l=null==(i=r)?void 0:i.errors;if(null!=l){let e=s.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||d(!1),s=s.slice(0,Math.min(s.length,e+1))}let c=!1,u=-1;if(r&&a&&a.v7_partialHydration)for(let n=0;n<s.length;n++){let e=s[n];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=n),e.route.id){let{loaderData:t,errors:n}=r,a=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||a){c=!0,s=u>=0?s.slice(0,u+1):[s[0]];break}}}return s.reduceRight(((e,a,i)=>{let o,d=!1,p=null,h=null;var m;r&&(o=l&&a.route.id?l[a.route.id]:void 0,p=a.route.errorElement||ie,c&&(u<0&&0===i?(m="route-fallback",!1||me[m]||(me[m]=!0),d=!0,h=null):u===i&&(d=!0,h=a.route.hydrateFallbackElement||null)));let f=t.concat(s.slice(0,i+1)),y=()=>{let t;return t=o?p:d?h:a.route.Component?n.createElement(a.route.Component,null):a.route.element?a.route.element:e,n.createElement(se,{match:a,routeContext:{outlet:e,matches:f,isDataRoute:null!=r},children:t})};return r&&(a.route.ErrorBoundary||a.route.errorElement||0===i)?n.createElement(oe,{location:r.location,revalidation:r.revalidation,component:p,error:o,children:y(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):y()}),null)}var ce=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ce||{}),de=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(de||{});function ue(e){let t=n.useContext(V);return t||d(!1),t}function pe(e){let t=n.useContext(Q);return t||d(!1),t}function he(e){let t=function(){let e=n.useContext(X);return e||d(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||d(!1),r.route.id}const me={};function fe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}a.startTransition;function ye(e){d(!1)}function ge(t){let{basename:r="/",children:a=null,location:i,navigationType:o=e.Pop,navigator:s,static:l=!1,future:c}=t;Z()&&d(!1);let u=r.replace(/^\/*/,"/"),p=n.useMemo((()=>({basename:u,navigator:s,static:l,future:H({v7_relativeSplatPath:!1},c)})),[u,c,s,l]);"string"===typeof i&&(i=f(i));let{pathname:h="/",search:m="",hash:y="",state:g=null,key:v="default"}=i,x=n.useMemo((()=>{let e=R(h,u);return null==e?null:{location:{pathname:e,search:m,hash:y,state:g,key:v},navigationType:o}}),[u,h,m,y,g,v,o]);return null==x?null:n.createElement(Y.Provider,{value:p},n.createElement(K.Provider,{children:a,value:x}))}function ve(e){let{children:t,location:r}=e;return ne(xe(t),r)}new Promise((()=>{}));n.Component;function xe(e,t){void 0===t&&(t=[]);let r=[];return n.Children.forEach(e,((e,a)=>{if(!n.isValidElement(e))return;let i=[...t,a];if(e.type===n.Fragment)return void r.push.apply(r,xe(e.props.children,i));e.type!==ye&&d(!1),e.props.index&&e.props.children&&d(!1);let o={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=xe(e.props.children,i)),r.push(o)})),r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(Lg){}new Map;const be=a.startTransition;s.flushSync,a.useId;function we(e){let{basename:t,children:r,future:a,window:i}=e,o=n.useRef();var s;null==o.current&&(o.current=(void 0===(s={window:i,v5Compat:!0})&&(s={}),y((function(e,t){let{pathname:r="/",search:n="",hash:a=""}=f(e.location.hash.substr(1));return r.startsWith("/")||r.startsWith(".")||(r="/"+r),h("",{pathname:r,search:n,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let r=e.document.querySelector("base"),n="";if(r&&r.getAttribute("href")){let t=e.location.href,r=t.indexOf("#");n=-1===r?t:t.slice(0,r)}return n+"#"+("string"===typeof t?t:m(t))}),(function(e,t){u("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),s)));let l=o.current,[c,d]=n.useState({action:l.action,location:l.location}),{v7_startTransition:p}=a||{},g=n.useCallback((e=>{p&&be?be((()=>d(e))):d(e)}),[d,p]);return n.useLayoutEffect((()=>l.listen(g)),[l,g]),n.useEffect((()=>fe(a)),[a]),n.createElement(ge,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:l,future:a})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var _e,Ee,Te,Se;(Ee=_e||(_e={})).UseScrollRestoration="useScrollRestoration",Ee.UseSubmit="useSubmit",Ee.UseSubmitFetcher="useSubmitFetcher",Ee.UseFetcher="useFetcher",Ee.useViewTransitionState="useViewTransitionState",(Se=Te||(Te={})).UseFetcher="useFetcher",Se.UseFetchers="useFetchers",Se.UseScrollRestoration="useScrollRestoration";var je=r(528),Ce=r(7324),ke=r.n(Ce);const Ie=function(e){function t(e,n,l,c,p){for(var h,m,f,y,b,_=0,E=0,T=0,S=0,j=0,D=0,R=f=h=0,L=0,$=0,O=0,q=0,U=l.length,F=U-1,z="",B="",G="",W="";L<U;){if(m=l.charCodeAt(L),L===F&&0!==E+S+T+_&&(0!==E&&(m=47===E?10:47),S=T=_=0,U++,F++),0===E+S+T+_){if(L===F&&(0<$&&(z=z.replace(u,"")),0<z.trim().length)){switch(m){case 32:case 9:case 59:case 13:case 10:break;default:z+=l.charAt(L)}m=59}switch(m){case 123:for(h=(z=z.trim()).charCodeAt(0),f=1,q=++L;L<U;){switch(m=l.charCodeAt(L)){case 123:f++;break;case 125:f--;break;case 47:switch(m=l.charCodeAt(L+1)){case 42:case 47:e:{for(R=L+1;R<F;++R)switch(l.charCodeAt(R)){case 47:if(42===m&&42===l.charCodeAt(R-1)&&L+2!==R){L=R+1;break e}break;case 10:if(47===m){L=R+1;break e}}L=R}}break;case 91:m++;case 40:m++;case 34:case 39:for(;L++<F&&l.charCodeAt(L)!==m;);}if(0===f)break;L++}if(f=l.substring(q,L),0===h&&(h=(z=z.replace(d,"").trim()).charCodeAt(0)),64===h){switch(0<$&&(z=z.replace(u,"")),m=z.charCodeAt(1)){case 100:case 109:case 115:case 45:$=n;break;default:$=N}if(q=(f=t(n,$,f,m,p+1)).length,0<M&&(b=s(3,f,$=r(N,z,O),n,k,C,q,m,p,c),z=$.join(""),void 0!==b&&0===(q=(f=b.trim()).length)&&(m=0,f="")),0<q)switch(m){case 115:z=z.replace(w,o);case 100:case 109:case 45:f=z+"{"+f+"}";break;case 107:f=(z=z.replace(g,"$1 $2"))+"{"+f+"}",f=1===A||2===A&&i("@"+f,3)?"@-webkit-"+f+"@"+f:"@"+f;break;default:f=z+f,112===c&&(B+=f,f="")}else f=""}else f=t(n,r(n,z,O),f,c,p+1);G+=f,f=O=$=R=h=0,z="",m=l.charCodeAt(++L);break;case 125:case 59:if(1<(q=(z=(0<$?z.replace(u,""):z).trim()).length))switch(0===R&&(h=z.charCodeAt(0),45===h||96<h&&123>h)&&(q=(z=z.replace(" ",":")).length),0<M&&void 0!==(b=s(1,z,n,e,k,C,B.length,c,p,c))&&0===(q=(z=b.trim()).length)&&(z="\0\0"),h=z.charCodeAt(0),m=z.charCodeAt(1),h){case 0:break;case 64:if(105===m||99===m){W+=z+l.charAt(L);break}default:58!==z.charCodeAt(q-1)&&(B+=a(z,h,m,z.charCodeAt(2)))}O=$=R=h=0,z="",m=l.charCodeAt(++L)}}switch(m){case 13:case 10:47===E?E=0:0===1+h&&107!==c&&0<z.length&&($=1,z+="\0"),0<M*P&&s(0,z,n,e,k,C,B.length,c,p,c),C=1,k++;break;case 59:case 125:if(0===E+S+T+_){C++;break}default:switch(C++,y=l.charAt(L),m){case 9:case 32:if(0===S+_+E)switch(j){case 44:case 58:case 9:case 32:y="";break;default:32!==m&&(y=" ")}break;case 0:y="\\0";break;case 12:y="\\f";break;case 11:y="\\v";break;case 38:0===S+E+_&&($=O=1,y="\f"+y);break;case 108:if(0===S+E+_+I&&0<R)switch(L-R){case 2:112===j&&58===l.charCodeAt(L-3)&&(I=j);case 8:111===D&&(I=D)}break;case 58:0===S+E+_&&(R=L);break;case 44:0===E+T+S+_&&($=1,y+="\r");break;case 34:case 39:0===E&&(S=S===m?0:0===S?m:S);break;case 91:0===S+E+T&&_++;break;case 93:0===S+E+T&&_--;break;case 41:0===S+E+_&&T--;break;case 40:if(0===S+E+_){if(0===h)if(2*j+3*D===533);else h=1;T++}break;case 64:0===E+T+S+_+R+f&&(f=1);break;case 42:case 47:if(!(0<S+_+T))switch(E){case 0:switch(2*m+3*l.charCodeAt(L+1)){case 235:E=47;break;case 220:q=L,E=42}break;case 42:47===m&&42===j&&q+2!==L&&(33===l.charCodeAt(q+2)&&(B+=l.substring(q,L+1)),y="",E=0)}}0===E&&(z+=y)}D=j,j=m,L++}if(0<(q=B.length)){if($=n,0<M&&(void 0!==(b=s(2,B,$,e,k,C,q,c,p,c))&&0===(B=b).length))return W+B+G;if(B=$.join(",")+"{"+B+"}",0!==A*I){switch(2!==A||i(B,2)||(I=0),I){case 111:B=B.replace(x,":-moz-$1")+B;break;case 112:B=B.replace(v,"::-webkit-input-$1")+B.replace(v,"::-moz-$1")+B.replace(v,":-ms-input-$1")+B}I=0}}return W+B+G}function r(e,t,r){var a=t.trim().split(f);t=a;var i=a.length,o=e.length;switch(o){case 0:case 1:var s=0;for(e=0===o?"":e[0]+" ";s<i;++s)t[s]=n(e,t[s],r).trim();break;default:var l=s=0;for(t=[];s<i;++s)for(var c=0;c<o;++c)t[l++]=n(e[c]+" ",a[s],r).trim()}return t}function n(e,t,r){var n=t.charCodeAt(0);switch(33>n&&(n=(t=t.trim()).charCodeAt(0)),n){case 38:return t.replace(y,"$1"+e.trim());case 58:return e.trim()+t.replace(y,"$1"+e.trim());default:if(0<1*r&&0<t.indexOf("\f"))return t.replace(y,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+t}function a(e,t,r,n){var o=e+";",s=2*t+3*r+4*n;if(944===s){e=o.indexOf(":",9)+1;var l=o.substring(e,o.length-1).trim();return l=o.substring(0,e).trim()+l+";",1===A||2===A&&i(l,1)?"-webkit-"+l+l:l}if(0===A||2===A&&!i(o,1))return o;switch(s){case 1015:return 97===o.charCodeAt(10)?"-webkit-"+o+o:o;case 951:return 116===o.charCodeAt(3)?"-webkit-"+o+o:o;case 963:return 110===o.charCodeAt(5)?"-webkit-"+o+o:o;case 1009:if(100!==o.charCodeAt(4))break;case 969:case 942:return"-webkit-"+o+o;case 978:return"-webkit-"+o+"-moz-"+o+o;case 1019:case 983:return"-webkit-"+o+"-moz-"+o+"-ms-"+o+o;case 883:if(45===o.charCodeAt(8))return"-webkit-"+o+o;if(0<o.indexOf("image-set(",11))return o.replace(j,"$1-webkit-$2")+o;break;case 932:if(45===o.charCodeAt(4))switch(o.charCodeAt(5)){case 103:return"-webkit-box-"+o.replace("-grow","")+"-webkit-"+o+"-ms-"+o.replace("grow","positive")+o;case 115:return"-webkit-"+o+"-ms-"+o.replace("shrink","negative")+o;case 98:return"-webkit-"+o+"-ms-"+o.replace("basis","preferred-size")+o}return"-webkit-"+o+"-ms-"+o+o;case 964:return"-webkit-"+o+"-ms-flex-"+o+o;case 1023:if(99!==o.charCodeAt(8))break;return"-webkit-box-pack"+(l=o.substring(o.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+o+"-ms-flex-pack"+l+o;case 1005:return h.test(o)?o.replace(p,":-webkit-")+o.replace(p,":-moz-")+o:o;case 1e3:switch(t=(l=o.substring(13).trim()).indexOf("-")+1,l.charCodeAt(0)+l.charCodeAt(t)){case 226:l=o.replace(b,"tb");break;case 232:l=o.replace(b,"tb-rl");break;case 220:l=o.replace(b,"lr");break;default:return o}return"-webkit-"+o+"-ms-"+l+o;case 1017:if(-1===o.indexOf("sticky",9))break;case 975:switch(t=(o=e).length-10,s=(l=(33===o.charCodeAt(t)?o.substring(0,t):o).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|l.charCodeAt(7))){case 203:if(111>l.charCodeAt(8))break;case 115:o=o.replace(l,"-webkit-"+l)+";"+o;break;case 207:case 102:o=o.replace(l,"-webkit-"+(102<s?"inline-":"")+"box")+";"+o.replace(l,"-webkit-"+l)+";"+o.replace(l,"-ms-"+l+"box")+";"+o}return o+";";case 938:if(45===o.charCodeAt(5))switch(o.charCodeAt(6)){case 105:return l=o.replace("-items",""),"-webkit-"+o+"-webkit-box-"+l+"-ms-flex-"+l+o;case 115:return"-webkit-"+o+"-ms-flex-item-"+o.replace(E,"")+o;default:return"-webkit-"+o+"-ms-flex-line-pack"+o.replace("align-content","").replace(E,"")+o}break;case 973:case 989:if(45!==o.charCodeAt(3)||122===o.charCodeAt(4))break;case 931:case 953:if(!0===S.test(e))return 115===(l=e.substring(e.indexOf(":")+1)).charCodeAt(0)?a(e.replace("stretch","fill-available"),t,r,n).replace(":fill-available",":stretch"):o.replace(l,"-webkit-"+l)+o.replace(l,"-moz-"+l.replace("fill-",""))+o;break;case 962:if(o="-webkit-"+o+(102===o.charCodeAt(5)?"-ms-"+o:"")+o,211===r+n&&105===o.charCodeAt(13)&&0<o.indexOf("transform",10))return o.substring(0,o.indexOf(";",27)+1).replace(m,"$1-webkit-$2")+o}return o}function i(e,t){var r=e.indexOf(1===t?":":"{"),n=e.substring(0,3!==t?r:10);return r=e.substring(r+1,e.length-1),R(2!==t?n:n.replace(T,"$1"),r,t)}function o(e,t){var r=a(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return r!==t+";"?r.replace(_," or ($1)").substring(4):"("+t+")"}function s(e,t,r,n,a,i,o,s,l,d){for(var u,p=0,h=t;p<M;++p)switch(u=D[p].call(c,e,h,r,n,a,i,o,s,l,d)){case void 0:case!1:case!0:case null:break;default:h=u}if(h!==t)return h}function l(e){return void 0!==(e=e.prefix)&&(R=null,e?"function"!==typeof e?A=1:(A=2,R=e):A=0),l}function c(e,r){var n=e;if(33>n.charCodeAt(0)&&(n=n.trim()),n=[n],0<M){var a=s(-1,r,n,n,k,C,0,0,0,0);void 0!==a&&"string"===typeof a&&(r=a)}var i=t(N,n,r,0,0);return 0<M&&(void 0!==(a=s(-2,i,n,n,k,C,i.length,0,0,0))&&(i=a)),I=0,C=k=1,i}var d=/^\0+/g,u=/[\0\r\f]/g,p=/: */g,h=/zoo|gra/,m=/([,: ])(transform)/g,f=/,\r+?/g,y=/([\t\r\n ])*\f?&/g,g=/@(k\w+)\s*(\S*)\s*/,v=/::(place)/g,x=/:(read-only)/g,b=/[svh]\w+-[tblr]{2}/,w=/\(\s*(.*)\s*\)/g,_=/([\s\S]*?);/g,E=/-self|flex-/g,T=/[^]*?(:[rp][el]a[\w-]+)[^]*/,S=/stretch|:\s*\w+\-(?:conte|avail)/,j=/([^-])(image-set\()/,C=1,k=1,I=0,A=1,N=[],D=[],M=0,R=null,P=0;return c.use=function e(t){switch(t){case void 0:case null:M=D.length=0;break;default:if("function"===typeof t)D[M++]=t;else if("object"===typeof t)for(var r=0,n=t.length;r<n;++r)e(t[r]);else P=0|!!t}return e},c.set=l,void 0!==e&&l(e),c};const Ae={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function Ne(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var De=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Me=Ne((function(e){return De.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),Re=r(219),Pe=r.n(Re),Le=r(2285);function $e(){return($e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var Oe=function(e,t){for(var r=[e[0]],n=0,a=t.length;n<a;n+=1)r.push(t[n],e[n+1]);return r},qe=function(e){return null!==e&&"object"==typeof e&&"[object Object]"===(e.toString?e.toString():Object.prototype.toString.call(e))&&!(0,je.QP)(e)},Ue=Object.freeze([]),Fe=Object.freeze({});function ze(e){return"function"==typeof e}function Be(e){return e.displayName||e.name||"Component"}function Ge(e){return e&&"string"==typeof e.styledComponentId}var We="undefined"!=typeof Le&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_ATTR||{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_ATTR)||"data-styled",He="undefined"!=typeof window&&"HTMLElement"in window,Ve=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof Le&&void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&(void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY?"false"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY:void 0!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&("false"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY)));function Qe(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw new Error("An error occurred. See https://git.io/JUIaE#"+e+" for more information."+(r.length>0?" Args: "+r.join(", "):""))}var Ye=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var t=e.prototype;return t.indexOfGroup=function(e){for(var t=0,r=0;r<e;r++)t+=this.groupSizes[r];return t},t.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var r=this.groupSizes,n=r.length,a=n;e>=a;)(a<<=1)<0&&Qe(16,""+e);this.groupSizes=new Uint32Array(a),this.groupSizes.set(r),this.length=a;for(var i=n;i<a;i++)this.groupSizes[i]=0}for(var o=this.indexOfGroup(e+1),s=0,l=t.length;s<l;s++)this.tag.insertRule(o,t[s])&&(this.groupSizes[e]++,o++)},t.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],r=this.indexOfGroup(e),n=r+t;this.groupSizes[e]=0;for(var a=r;a<n;a++)this.tag.deleteRule(r)}},t.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var r=this.groupSizes[e],n=this.indexOfGroup(e),a=n+r,i=n;i<a;i++)t+=this.tag.getRule(i)+"/*!sc*/\n";return t},e}(),Ke=new Map,Xe=new Map,Je=1,Ze=function(e){if(Ke.has(e))return Ke.get(e);for(;Xe.has(Je);)Je++;var t=Je++;return Ke.set(e,t),Xe.set(t,e),t},et=function(e){return Xe.get(e)},tt=function(e,t){t>=Je&&(Je=t+1),Ke.set(e,t),Xe.set(t,e)},rt="style["+We+'][data-styled-version="5.3.11"]',nt=new RegExp("^"+We+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),at=function(e,t,r){for(var n,a=r.split(","),i=0,o=a.length;i<o;i++)(n=a[i])&&e.registerName(t,n)},it=function(e,t){for(var r=(t.textContent||"").split("/*!sc*/\n"),n=[],a=0,i=r.length;a<i;a++){var o=r[a].trim();if(o){var s=o.match(nt);if(s){var l=0|parseInt(s[1],10),c=s[2];0!==l&&(tt(c,l),at(e,c,s[3]),e.getTag().insertRules(l,n)),n.length=0}else n.push(o)}}},ot=function(){return r.nc},st=function(e){var t=document.head,r=e||t,n=document.createElement("style"),a=function(e){for(var t=e.childNodes,r=t.length;r>=0;r--){var n=t[r];if(n&&1===n.nodeType&&n.hasAttribute(We))return n}}(r),i=void 0!==a?a.nextSibling:null;n.setAttribute(We,"active"),n.setAttribute("data-styled-version","5.3.11");var o=ot();return o&&n.setAttribute("nonce",o),r.insertBefore(n,i),n},lt=function(){function e(e){var t=this.element=st(e);t.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,r=0,n=t.length;r<n;r++){var a=t[r];if(a.ownerNode===e)return a}Qe(17)}(t),this.length=0}var t=e.prototype;return t.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},t.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.getRule=function(e){var t=this.sheet.cssRules[e];return void 0!==t&&"string"==typeof t.cssText?t.cssText:""},e}(),ct=function(){function e(e){var t=this.element=st(e);this.nodes=t.childNodes,this.length=0}var t=e.prototype;return t.insertRule=function(e,t){if(e<=this.length&&e>=0){var r=document.createTextNode(t),n=this.nodes[e];return this.element.insertBefore(r,n||null),this.length++,!0}return!1},t.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),dt=function(){function e(e){this.rules=[],this.length=0}var t=e.prototype;return t.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},t.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),ut=He,pt={isServer:!He,useCSSOMInjection:!Ve},ht=function(){function e(e,t,r){void 0===e&&(e=Fe),void 0===t&&(t={}),this.options=$e({},pt,{},e),this.gs=t,this.names=new Map(r),this.server=!!e.isServer,!this.server&&He&&ut&&(ut=!1,function(e){for(var t=document.querySelectorAll(rt),r=0,n=t.length;r<n;r++){var a=t[r];a&&"active"!==a.getAttribute(We)&&(it(e,a),a.parentNode&&a.parentNode.removeChild(a))}}(this))}e.registerId=function(e){return Ze(e)};var t=e.prototype;return t.reconstructWithOptions=function(t,r){return void 0===r&&(r=!0),new e($e({},this.options,{},t),this.gs,r&&this.names||void 0)},t.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.getTag=function(){return this.tag||(this.tag=(r=(t=this.options).isServer,n=t.useCSSOMInjection,a=t.target,e=r?new dt(a):n?new lt(a):new ct(a),new Ye(e)));var e,t,r,n,a},t.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},t.registerName=function(e,t){if(Ze(e),this.names.has(e))this.names.get(e).add(t);else{var r=new Set;r.add(t),this.names.set(e,r)}},t.insertRules=function(e,t,r){this.registerName(e,t),this.getTag().insertRules(Ze(e),r)},t.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.clearRules=function(e){this.getTag().clearGroup(Ze(e)),this.clearNames(e)},t.clearTag=function(){this.tag=void 0},t.toString=function(){return function(e){for(var t=e.getTag(),r=t.length,n="",a=0;a<r;a++){var i=et(a);if(void 0!==i){var o=e.names.get(i),s=t.getGroup(a);if(o&&s&&o.size){var l=We+".g"+a+'[id="'+i+'"]',c="";void 0!==o&&o.forEach((function(e){e.length>0&&(c+=e+",")})),n+=""+s+l+'{content:"'+c+'"}/*!sc*/\n'}}}return n}(this)},e}(),mt=/(a)(d)/gi,ft=function(e){return String.fromCharCode(e+(e>25?39:97))};function yt(e){var t,r="";for(t=Math.abs(e);t>52;t=t/52|0)r=ft(t%52)+r;return(ft(t%52)+r).replace(mt,"$1-$2")}var gt=function(e,t){for(var r=t.length;r;)e=33*e^t.charCodeAt(--r);return e},vt=function(e){return gt(5381,e)};function xt(e){for(var t=0;t<e.length;t+=1){var r=e[t];if(ze(r)&&!Ge(r))return!1}return!0}var bt=vt("5.3.11"),wt=function(){function e(e,t,r){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===r||r.isStatic)&&xt(e),this.componentId=t,this.baseHash=gt(bt,t),this.baseStyle=r,ht.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,r){var n=this.componentId,a=[];if(this.baseStyle&&a.push(this.baseStyle.generateAndInjectStyles(e,t,r)),this.isStatic&&!r.hash)if(this.staticRulesId&&t.hasNameForId(n,this.staticRulesId))a.push(this.staticRulesId);else{var i=qt(this.rules,e,t,r).join(""),o=yt(gt(this.baseHash,i)>>>0);if(!t.hasNameForId(n,o)){var s=r(i,"."+o,void 0,n);t.insertRules(n,o,s)}a.push(o),this.staticRulesId=o}else{for(var l=this.rules.length,c=gt(this.baseHash,r.hash),d="",u=0;u<l;u++){var p=this.rules[u];if("string"==typeof p)d+=p;else if(p){var h=qt(p,e,t,r),m=Array.isArray(h)?h.join(""):h;c=gt(c,m+u),d+=m}}if(d){var f=yt(c>>>0);if(!t.hasNameForId(n,f)){var y=r(d,"."+f,void 0,n);t.insertRules(n,f,y)}a.push(f)}}return a.join(" ")},e}(),_t=/^\s*\/\/.*$/gm,Et=[":","[",".","#"];function Tt(e){var t,r,n,a,i=void 0===e?Fe:e,o=i.options,s=void 0===o?Fe:o,l=i.plugins,c=void 0===l?Ue:l,d=new Ie(s),u=[],p=function(e){function t(t){if(t)try{e(t+"}")}catch(e){}}return function(r,n,a,i,o,s,l,c,d,u){switch(r){case 1:if(0===d&&64===n.charCodeAt(0))return e(n+";"),"";break;case 2:if(0===c)return n+"/*|*/";break;case 3:switch(c){case 102:case 112:return e(a[0]+n),"";default:return n+(0===u?"/*|*/":"")}case-2:n.split("/*|*/}").forEach(t)}}}((function(e){u.push(e)})),h=function(e,n,i){return 0===n&&-1!==Et.indexOf(i[r.length])||i.match(a)?e:"."+t};function m(e,i,o,s){void 0===s&&(s="&");var l=e.replace(_t,""),c=i&&o?o+" "+i+" { "+l+" }":l;return t=s,r=i,n=new RegExp("\\"+r+"\\b","g"),a=new RegExp("(\\"+r+"\\b){2,}"),d(o||!i?"":i,c)}return d.use([].concat(c,[function(e,t,a){2===e&&a.length&&a[0].lastIndexOf(r)>0&&(a[0]=a[0].replace(n,h))},p,function(e){if(-2===e){var t=u;return u=[],t}}])),m.hash=c.length?c.reduce((function(e,t){return t.name||Qe(15),gt(e,t.name)}),5381).toString():"",m}var St=n.createContext(),jt=(St.Consumer,n.createContext()),Ct=(jt.Consumer,new ht),kt=Tt();function It(){return(0,n.useContext)(St)||Ct}function At(){return(0,n.useContext)(jt)||kt}function Nt(e){var t=(0,n.useState)(e.stylisPlugins),r=t[0],a=t[1],i=It(),o=(0,n.useMemo)((function(){var t=i;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t}),[e.disableCSSOMInjection,e.sheet,e.target]),s=(0,n.useMemo)((function(){return Tt({options:{prefix:!e.disableVendorPrefixes},plugins:r})}),[e.disableVendorPrefixes,r]);return(0,n.useEffect)((function(){ke()(r,e.stylisPlugins)||a(e.stylisPlugins)}),[e.stylisPlugins]),n.createElement(St.Provider,{value:o},n.createElement(jt.Provider,{value:s},e.children))}var Dt=function(){function e(e,t){var r=this;this.inject=function(e,t){void 0===t&&(t=kt);var n=r.name+t.hash;e.hasNameForId(r.id,n)||e.insertRules(r.id,n,t(r.rules,n,"@keyframes"))},this.toString=function(){return Qe(12,String(r.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=t}return e.prototype.getName=function(e){return void 0===e&&(e=kt),this.name+e.hash},e}(),Mt=/([A-Z])/,Rt=/([A-Z])/g,Pt=/^ms-/,Lt=function(e){return"-"+e.toLowerCase()};function $t(e){return Mt.test(e)?e.replace(Rt,Lt).replace(Pt,"-ms-"):e}var Ot=function(e){return null==e||!1===e||""===e};function qt(e,t,r,n){if(Array.isArray(e)){for(var a,i=[],o=0,s=e.length;o<s;o+=1)""!==(a=qt(e[o],t,r,n))&&(Array.isArray(a)?i.push.apply(i,a):i.push(a));return i}return Ot(e)?"":Ge(e)?"."+e.styledComponentId:ze(e)?"function"!=typeof(l=e)||l.prototype&&l.prototype.isReactComponent||!t?e:qt(e(t),t,r,n):e instanceof Dt?r?(e.inject(r,n),e.getName(n)):e:qe(e)?function e(t,r){var n,a,i=[];for(var o in t)t.hasOwnProperty(o)&&!Ot(t[o])&&(Array.isArray(t[o])&&t[o].isCss||ze(t[o])?i.push($t(o)+":",t[o],";"):qe(t[o])?i.push.apply(i,e(t[o],o)):i.push($t(o)+": "+(n=o,(null==(a=t[o])||"boolean"==typeof a||""===a?"":"number"!=typeof a||0===a||n in Ae||n.startsWith("--")?String(a).trim():a+"px")+";")));return r?[r+" {"].concat(i,["}"]):i}(e):e.toString();var l}var Ut=function(e){return Array.isArray(e)&&(e.isCss=!0),e};function Ft(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ze(e)||qe(e)?Ut(qt(Oe(Ue,[e].concat(r)))):0===r.length&&1===e.length&&"string"==typeof e[0]?e:Ut(qt(Oe(e,r)))}new Set;var zt=function(e,t,r){return void 0===r&&(r=Fe),e.theme!==r.theme&&e.theme||t||r.theme},Bt=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Gt=/(^-|-$)/g;function Wt(e){return e.replace(Bt,"-").replace(Gt,"")}var Ht=function(e){return yt(vt(e)>>>0)};function Vt(e){return"string"==typeof e&&!0}var Qt=function(e){return"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)},Yt=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e};function Kt(e,t,r){var n=e[r];Qt(t)&&Qt(n)?Xt(n,t):e[r]=t}function Xt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var a=0,i=r;a<i.length;a++){var o=i[a];if(Qt(o))for(var s in o)Yt(s)&&Kt(e,o[s],s)}return e}var Jt=n.createContext();Jt.Consumer;var Zt={};function er(e,t,r){var a=Ge(e),i=!Vt(e),o=t.attrs,s=void 0===o?Ue:o,l=t.componentId,c=void 0===l?function(e,t){var r="string"!=typeof e?"sc":Wt(e);Zt[r]=(Zt[r]||0)+1;var n=r+"-"+Ht("5.3.11"+r+Zt[r]);return t?t+"-"+n:n}(t.displayName,t.parentComponentId):l,d=t.displayName,u=void 0===d?function(e){return Vt(e)?"styled."+e:"Styled("+Be(e)+")"}(e):d,p=t.displayName&&t.componentId?Wt(t.displayName)+"-"+t.componentId:t.componentId||c,h=a&&e.attrs?Array.prototype.concat(e.attrs,s).filter(Boolean):s,m=t.shouldForwardProp;a&&e.shouldForwardProp&&(m=t.shouldForwardProp?function(r,n,a){return e.shouldForwardProp(r,n,a)&&t.shouldForwardProp(r,n,a)}:e.shouldForwardProp);var f,y=new wt(r,p,a?e.componentStyle:void 0),g=y.isStatic&&0===s.length,v=function(e,t){return function(e,t,r,a){var i=e.attrs,o=e.componentStyle,s=e.defaultProps,l=e.foldedComponentIds,c=e.shouldForwardProp,d=e.styledComponentId,u=e.target,p=function(e,t,r){void 0===e&&(e=Fe);var n=$e({},t,{theme:e}),a={};return r.forEach((function(e){var t,r,i,o=e;for(t in ze(o)&&(o=o(n)),o)n[t]=a[t]="className"===t?(r=a[t],i=o[t],r&&i?r+" "+i:r||i):o[t]})),[n,a]}(zt(t,(0,n.useContext)(Jt),s)||Fe,t,i),h=p[0],m=p[1],f=function(e,t,r){var n=It(),a=At();return t?e.generateAndInjectStyles(Fe,n,a):e.generateAndInjectStyles(r,n,a)}(o,a,h),y=r,g=m.$as||t.$as||m.as||t.as||u,v=Vt(g),x=m!==t?$e({},t,{},m):t,b={};for(var w in x)"$"!==w[0]&&"as"!==w&&("forwardedAs"===w?b.as=x[w]:(c?c(w,Me,g):!v||Me(w))&&(b[w]=x[w]));return t.style&&m.style!==t.style&&(b.style=$e({},t.style,{},m.style)),b.className=Array.prototype.concat(l,d,f!==d?f:null,t.className,m.className).filter(Boolean).join(" "),b.ref=y,(0,n.createElement)(g,b)}(f,e,t,g)};return v.displayName=u,(f=n.forwardRef(v)).attrs=h,f.componentStyle=y,f.displayName=u,f.shouldForwardProp=m,f.foldedComponentIds=a?Array.prototype.concat(e.foldedComponentIds,e.styledComponentId):Ue,f.styledComponentId=p,f.target=a?e.target:e,f.withComponent=function(e){var n=t.componentId,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(t,["componentId"]),i=n&&n+"-"+(Vt(e)?e:Wt(Be(e)));return er(e,$e({},a,{attrs:h,componentId:i}),r)},Object.defineProperty(f,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=a?Xt({},e.defaultProps,t):t}}),Object.defineProperty(f,"toString",{value:function(){return"."+f.styledComponentId}}),i&&Pe()(f,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),f}var tr=function(e){return function e(t,r,n){if(void 0===n&&(n=Fe),!(0,je.Hy)(r))return Qe(1,String(r));var a=function(){return t(r,n,Ft.apply(void 0,arguments))};return a.withConfig=function(a){return e(t,r,$e({},n,{},a))},a.attrs=function(a){return e(t,r,$e({},n,{attrs:Array.prototype.concat(n.attrs,a).filter(Boolean)}))},a}(er,e)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach((function(e){tr[e]=tr(e)}));!function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=xt(e),ht.registerId(this.componentId+1)}var t=e.prototype;t.createStyles=function(e,t,r,n){var a=n(qt(this.rules,t,r,n).join(""),""),i=this.componentId+e;r.insertRules(i,i,a)},t.removeStyles=function(e,t){t.clearRules(this.componentId+e)},t.renderStyles=function(e,t,r,n){e>2&&ht.registerId(this.componentId+e),this.removeStyles(e,r),this.createStyles(e,t,r,n)}}();function rr(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=Ft.apply(void 0,[e].concat(r)).join(""),i=Ht(a);return new Dt(i,a)}!function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString();if(!t)return"";var r=ot();return"<style "+[r&&'nonce="'+r+'"',We+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+t+"</style>"},this.getStyleTags=function(){return e.sealed?Qe(2):e._emitSheetCSS()},this.getStyleElement=function(){var t;if(e.sealed)return Qe(2);var r=((t={})[We]="",t["data-styled-version"]="5.3.11",t.dangerouslySetInnerHTML={__html:e.instance.toString()},t),a=ot();return a&&(r.nonce=a),[n.createElement("style",$e({},r,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new ht({isServer:!0}),this.sealed=!1}var t=e.prototype;t.collectStyles=function(e){return this.sealed?Qe(2):n.createElement(Nt,{sheet:this.instance},e)},t.interleaveWithNodeStream=function(e){return Qe(3)}}();const nr=tr;var ar=r(4953);!function(e){e.add1000Currency=function(){try{const o=e.__GAME_CONTEXT__,s=e.__GAME_STATE__,l=e.__GAME_DISPATCH__;if(o&&o.actions&&o.actions.updateCurrency){var t,r,n;null===(t=o.state)||void 0===t||null===(r=t.player)||void 0===r||null===(n=r.inventory)||void 0===n||n.currency;const e={copper:1e3,silver:1e3,gold:1e3,spiritStones:1e3};return o.actions.updateCurrency(e,!0),console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u043e 1000 \u0435\u0434\u0438\u043d\u0438\u0446 \u043a\u0430\u0436\u0434\u043e\u0439 \u0432\u0430\u043b\u044e\u0442\u044b!",e),!0}if(s&&l){var a,i;const e=(null===s||void 0===s||null===(a=s.player)||void 0===a||null===(i=a.inventory)||void 0===i?void 0:i.currency)||{},t={copper:(e.copper||0)+1e3,silver:(e.silver||0)+1e3,gold:(e.gold||0)+1e3,spiritStones:(e.spiritStones||0)+1e3};return l({type:"UPDATE_CURRENCY",payload:t}),console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u043e 1000 \u0435\u0434\u0438\u043d\u0438\u0446 \u043a\u0430\u0436\u0434\u043e\u0439 \u0432\u0430\u043b\u044e\u0442\u044b!",t),!0}{let e=null;const t=e=>{const t=Object.keys(e||{});for(let r=0;r<t.length;r++){const n=t[r];if(n.startsWith("__reactInternalInstance$")||n.startsWith("__reactContainer$"))return e[n]}return null},r=document.getElementById("root")||document.body.firstChild;if(r&&(e=t(r)),e){console.log("\u041d\u0430\u0439\u0434\u0435\u043d React-\u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442, \u043f\u044b\u0442\u0430\u0435\u043c\u0441\u044f \u043d\u0430\u0439\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0438\u0433\u0440\u044b..."),console.log("\u0412\u044b\u0437\u044b\u0432\u0430\u0435\u043c \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0447\u0435\u0440\u0435\u0437 \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430 \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0430\u043b\u044e\u0442\u044b...");const e=document.createElement("script");return e.textContent="\n            (function() {\n              try {\n                const dispatch = window.__GAME_DISPATCH__ || \n                                (window.__store__ && window.__store__.dispatch);\n                \n                if (dispatch) {\n                  dispatch({\n                    type: 'UPDATE_CURRENCY',\n                    payload: {\n                      copper: 1000,\n                      silver: 1000,\n                      gold: 1000,\n                      spiritStones: 1000\n                    }\n                  });\n                  console.log('\u0412\u0430\u043b\u044e\u0442\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430!');\n                  return true;\n                } else {\n                  console.error('\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0430\u0439\u0442\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044e dispatch');\n                  return false;\n                }\n              } catch (e) {\n                console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0432\u0430\u043b\u044e\u0442\u044b:', e);\n                return false;\n              }\n            })();\n          ",document.body.appendChild(e),document.body.removeChild(e),!0}return console.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0430\u0439\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0438\u0433\u0440\u044b"),!1}}catch(o){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0432\u0430\u043b\u044e\u0442\u044b:",o),!1}},e.showPlayerInfo=function(){try{var t;const r=e.__GAME_CONTEXT__,n=e.__GAME_STATE__;if(!r&&!n)return console.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0433\u0440\u044b"),!1;const a=(null===r||void 0===r?void 0:r.state)||n;if(!a||!a.player)return console.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0433\u0440\u043e\u043a\u0430"),!1;const i=function(){try{e.__GAME_CONTEXT__;const r=e.__GAME_STATE__;let n=null;try{const e=document.querySelector("[data-health]"),t=document.querySelector("[data-energy]");e&&t&&(n={health:parseFloat(e.getAttribute("data-health")),maxHealth:parseFloat(e.getAttribute("data-max-health")),energy:parseFloat(t.getAttribute("data-energy")),maxEnergy:parseFloat(t.getAttribute("data-max-energy"))},console.debug("\u041d\u0430\u0439\u0434\u0435\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435 \u0431\u043e\u044f \u0447\u0435\u0440\u0435\u0437 DOM:",n))}catch(t){console.debug("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0431\u043e\u044f \u0447\u0435\u0440\u0435\u0437 DOM:",t)}return n&&void 0!==n.health?n:r&&r.player?r.player.stats&&void 0!==r.player.stats.health&&void 0!==r.player.stats.maxHealth&&void 0!==r.player.stats.energy&&void 0!==r.player.stats.maxEnergy?{health:r.player.stats.health,maxHealth:r.player.stats.maxHealth,energy:r.player.stats.energy,maxEnergy:r.player.stats.maxEnergy}:{health:void 0!==r.player.health?r.player.health:100,maxHealth:void 0!==r.player.maxHealth?r.player.maxHealth:100,energy:void 0!==r.player.energy?r.player.energy:100,maxEnergy:void 0!==r.player.maxEnergy?r.player.maxEnergy:100}:{health:100,maxHealth:100,energy:100,maxEnergy:100}}catch(r){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u0430:",r),{health:100,maxHealth:100,energy:100,maxEnergy:100}}}();return console.log("\ud83e\uddd9 \u0418\u0433\u0440\u043e\u043a:"),console.log("\u0418\u043c\u044f:",a.player.name||"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),console.log("\u0423\u0440\u043e\u0432\u0435\u043d\u044c:",(null===(t=a.player.cultivation)||void 0===t?void 0:t.level)||"1"),console.log("\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435:",i.health+"/"+i.maxHealth),console.log("\u042d\u043d\u0435\u0440\u0433\u0438\u044f:",i.energy+"/"+i.maxEnergy),console.log("\u0421\u0442\u0430\u0442\u0443\u0441-\u044d\u0444\u0444\u0435\u043a\u0442\u044b:",Object.keys(a.player.statusEffects||{}).length?"\u0410\u043a\u0442\u0438\u0432\u043d\u044b":"\u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432"),!0}catch(r){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e\u0431 \u0438\u0433\u0440\u043e\u043a\u0435:",r),!1}},setTimeout((()=>{try{e.showPlayerInfo()}catch(Lg){console.debug("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0438\u0433\u0440\u043e\u043a\u0435:",Lg)}}),1e3),e.repairAllTechniques=function(){try{var t,r,n;const a=e.__GAME_CONTEXT__,i=e.__GAME_STATE__,o=e.__GAME_DISPATCH__;if(!a&&!i)return console.error("\u274c \u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0433\u0440\u044b"),!1;const s=(null===a||void 0===a||null===(t=a.state)||void 0===t||null===(r=t.player)||void 0===r?void 0:r.techniques)||(null===i||void 0===i||null===(n=i.player)||void 0===n?void 0:n.techniques);if(!Array.isArray(s)||0===s.length)return console.warn("\u26a0\ufe0f \u0422\u0435\u0445\u043d\u0438\u043a\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b \u0438\u043b\u0438 \u043c\u0430\u0441\u0441\u0438\u0432 \u043f\u0443\u0441\u0442"),!1;if(o)return o({type:"REPAIR_TECHNIQUES",payload:null}),console.log("\u2705 \u0422\u0435\u0445\u043d\u0438\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0447\u0435\u0440\u0435\u0437 REPAIR_TECHNIQUES action"),!0;if(a&&a.actions&&a.actions.repairTechniques)return a.actions.repairTechniques(),console.log("\u2705 \u0422\u0435\u0445\u043d\u0438\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0447\u0435\u0440\u0435\u0437 GameContext.actions.repairTechniques()"),!0;if(a&&a.actions){if("function"===typeof a.actions.repairTechniques)return a.actions.repairTechniques(),console.log("\u2705 \u0422\u0435\u0445\u043d\u0438\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0447\u0435\u0440\u0435\u0437 GameContext.actions.repairTechniques()"),!0;if(o)return o({type:"REPAIR_TECHNIQUES",payload:null}),console.log("\u2705 \u0422\u0435\u0445\u043d\u0438\u043a\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0447\u0435\u0440\u0435\u0437 REPAIR_TECHNIQUES action"),!0}return console.warn("\u26a0\ufe0f \u0422\u0435\u0445\u043d\u0438\u043a\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b, \u043d\u043e \u043d\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u044b \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438"),console.log("\u0414\u043b\u044f \u0440\u0443\u0447\u043d\u043e\u0433\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435:"),console.log('window.__GAME_DISPATCH__({ type: "REPAIR_TECHNIQUES", payload: null })'),!0}catch(a){return console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0442\u0435\u0445\u043d\u0438\u043a:",a),!1}},e.\u0434\u0430\u0442\u044c1000\u0420\u0435\u0441\u0443\u0440\u0441\u043e\u0432=e.add1000Currency,e.\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c\u0418\u0433\u0440\u043e\u043a\u0430=e.showPlayerInfo,e.\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c\u0422\u0435\u0445\u043d\u0438\u043a\u0438=e.repairAllTechniques,console.log("\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0434\u043b\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438:"),console.log("add1000Currency() - \u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043f\u043e 1000 \u0435\u0434\u0438\u043d\u0438\u0446 \u043c\u0435\u0434\u0438, \u0441\u0435\u0440\u0435\u0431\u0440\u0430, \u0437\u043e\u043b\u043e\u0442\u0430 \u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u043a\u0430\u043c\u043d\u0435\u0439"),console.log("\u0434\u0430\u0442\u044c1000\u0420\u0435\u0441\u0443\u0440\u0441\u043e\u0432() - \u0422\u043e \u0436\u0435 \u0441\u0430\u043c\u043e\u0435, \u043d\u043e \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c"),console.log("showPlayerInfo() - \u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0438\u0433\u0440\u043e\u043a\u0435"),console.log("\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c\u0418\u0433\u0440\u043e\u043a\u0430() - \u0422\u043e \u0436\u0435 \u0441\u0430\u043c\u043e\u0435, \u043d\u043e \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c"),console.log("repairAllTechniques() - \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442 \u0432\u0441\u0435 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u0438\u0437 \u0431\u0430\u0437\u043e\u0432\u044b\u0445 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0439"),console.log("\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c\u0422\u0435\u0445\u043d\u0438\u043a\u0438() - \u0422\u043e \u0436\u0435 \u0441\u0430\u043c\u043e\u0435, \u043d\u043e \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c")}("undefined"!==typeof window?window:{});let ir=null,or=null;function sr(e,t){if("undefined"!==typeof window&&e&&(e.context||e.state||t)){var r;e.state;const n=e.context||{},a=n.state||(null===(r=n.value)||void 0===r?void 0:r.state);a?ir=a:t&&(t.state||t.weather||t.world)&&(ir=t)}}var lr=r(8568);const cr="/api";const dr=class{static async registerUser(e,t,r){try{const n=await fetch(`${cr}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:r})});if(!n.ok){const e=await n.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438")}return await n.json()}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438:",n),n}}static async loginUser(e,t){try{const r=await fetch(`${cr}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({usernameOrEmail:e,password:t})});if(!r.ok){const e=await r.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438")}return await r.json()}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0445\u043e\u0434\u0430:",r),r}}static async updateUserProgress(e,t,r){try{const n=await fetch(`${cr}/users/${e}/progress`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({experience:t,cultivationLevel:r})});if(!n.ok){const e=await n.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430")}return await n.json()}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430:",n),n}}static async getUserProfile(e){try{const t="number"===typeof e||!isNaN(parseInt(e))?`${cr}/users/${e}`:`${cr}/users/by-username/${e}`,r=await fetch(t,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!r.ok){const e=await r.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f")}return await r.json()}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f:",t),t}}};var ur=r(2285);async function pr(){if(lr.isServerEnvironment&&"undefined"!==typeof ur&&ur.versions&&ur.versions.node)try{const e=await r.e(121).then(r.bind(r,8121));return e.default||e}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u043e\u0433\u043e AuthService:",e),console.warn("\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c API \u0432\u0435\u0440\u0441\u0438\u044e \u0438\u0437-\u0437\u0430 \u043e\u0448\u0438\u0431\u043a\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0430"),dr}return dr}const hr=new Proxy({},{get:function(e,t){return async function(){const e=await pr();if("function"===typeof e[t])return e[t](...arguments);throw new Error(`\u041c\u0435\u0442\u043e\u0434 ${t} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 AuthService`)}}}),mr="/api";const fr=class{static async getCultivationProgress(e){try{const t=await fetch(`${mr}/cultivation/${e}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!t.ok){const e=await t.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438")}return await t.json()}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438:",t),t}}static async updateCultivationProgress(e,t){try{const r=await fetch(`${mr}/cultivation/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify(t)});if(!r.ok){const e=await r.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438")}return await r.json()}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438:",r),r}}static async checkBreakthroughPossibility(e){try{const t=await fetch(`${mr}/cultivation/${e}/breakthrough-check`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!t.ok){const e=await t.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u043e\u0440\u044b\u0432\u0430")}return await t.json()}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u043e\u0440\u044b\u0432\u0430:",t),t}}static async completeTribulation(e,t){try{const r=await fetch(`${mr}/cultivation/${e}/complete-tribulation`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify(t)});if(!r.ok){const e=await r.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u0438")}return await r.json()}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u0438:",r),r}}static async increaseBottleneckProgress(e,t){try{const r=await fetch(`${mr}/cultivation/${e}/bottleneck-progress`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({amount:t})});if(!r.ok){const e=await r.json();throw new Error(e.error||'\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u0430"')}return await r.json()}catch(r){throw console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u0430":',r),r}}static async gainInsight(e){try{const t=await fetch(`${mr}/cultivation/${e}/gain-insight`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(!t.ok){const e=await t.json();throw new Error(e.error||"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043e\u0437\u0430\u0440\u0435\u043d\u0438\u044f")}return await t.json()}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043e\u0437\u0430\u0440\u0435\u043d\u0438\u044f:",t),t}}};var yr=r(2285);async function gr(){if(lr.isServerEnvironment&&"undefined"!==typeof yr&&yr.versions&&yr.versions.node)try{const e=await Promise.resolve().then(r.t.bind(r,1429,23));return e.default||e}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u043e\u0433\u043e CultivationService:",e),console.warn("\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c API \u0432\u0435\u0440\u0441\u0438\u044e \u0438\u0437-\u0437\u0430 \u043e\u0448\u0438\u0431\u043a\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0430"),fr}return fr}const vr=new Proxy({},{get:function(e,t){return async function(){const e=await gr();if("function"===typeof e[t])return e[t](...arguments);throw new Error(`\u041c\u0435\u0442\u043e\u0434 ${t} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 CultivationService`)}}});var xr=r(3249),br=r.n(xr),wr=r(8543),_r=r.n(wr),Er=r(2696),Tr=r.n(Er),Sr=r(6963),jr=r.n(Sr),Cr=r(5033),kr=r.n(Cr),Ir=r(3382),Ar=r(2342),Nr=r(8153),Dr=r.n(Nr);let Mr=null;class Rr extends Ar.Model{static associate(e){Rr.belongsTo(e.User,{foreignKey:"userId",as:"user"})}}Rr.init=async function(){const e=await async function(){if(!Mr){const e=await Nr.unifiedDatabase.getSequelizeInstance();Mr=e.db}return Mr}();return Ar.Model.init.call(this,{userId:{type:Ar.DataTypes.INTEGER,references:{model:"Users",key:"id"},onUpdate:"CASCADE",onDelete:"CASCADE",unique:!0},name:{type:Ar.DataTypes.STRING,allowNull:!1},gender:{type:Ar.DataTypes.ENUM("male","female"),defaultValue:"male"},region:{type:Ar.DataTypes.STRING,defaultValue:"central"},background:{type:Ar.DataTypes.STRING,defaultValue:"commoner"},description:{type:Ar.DataTypes.TEXT},avatar:{type:Ar.DataTypes.STRING},level:{type:Ar.DataTypes.INTEGER,defaultValue:1},experience:{type:Ar.DataTypes.INTEGER,defaultValue:0},gold:{type:Ar.DataTypes.INTEGER,defaultValue:0},silver:{type:Ar.DataTypes.INTEGER,defaultValue:0},copper:{type:Ar.DataTypes.INTEGER,defaultValue:0},spiritStones:{type:Ar.DataTypes.INTEGER,defaultValue:0},reputation:{type:Ar.DataTypes.JSON,defaultValue:{}},relationships:{type:Ar.DataTypes.JSON,defaultValue:{}}},{sequelize:e,modelName:"CharacterProfile",tableName:"CharacterProfiles"})},(async()=>{try{await Rr.init(),console.log("CharacterProfile \u043c\u043e\u0434\u0435\u043b\u044c \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 CharacterProfile:",e),console.error(e.stack)}})();const Pr=Rr,Lr="undefined"!==typeof window;let $r={};const Or=class{static async getCharacterProfile(e){try{if(Lr){const t=$r[e];return t?{name:t.name,gender:t.gender,region:t.region,background:t.background,description:t.description,avatar:t.avatar,level:t.level,experience:t.experience,currency:{gold:t.gold,silver:t.silver,copper:t.copper,spiritStones:t.spiritStones},reputation:t.reputation,relationships:t.relationships}:null}{let t=await Pr.findOne({where:{userId:e}});return t?{name:t.name,gender:t.gender,region:t.region,background:t.background,description:t.description,avatar:t.avatar,level:t.level,experience:t.experience,currency:{gold:t.gold,silver:t.silver,copper:t.copper,spiritStones:t.spiritStones},reputation:t.reputation,relationships:t.relationships}:null}}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430:",t),t}}static async updateCharacterProfile(e,t){try{if(Lr){if($r[e])void 0!==t.name&&($r[e].name=t.name),void 0!==t.gender&&($r[e].gender=t.gender),void 0!==t.region&&($r[e].region=t.region),void 0!==t.background&&($r[e].background=t.background),void 0!==t.description&&($r[e].description=t.description),void 0!==t.avatar&&($r[e].avatar=t.avatar),void 0!==t.level&&($r[e].level=t.level),void 0!==t.experience&&($r[e].experience=t.experience),t.currency&&(void 0!==t.currency.gold&&($r[e].gold=t.currency.gold),void 0!==t.currency.silver&&($r[e].silver=t.currency.silver),void 0!==t.currency.copper&&($r[e].copper=t.currency.copper),void 0!==t.currency.spiritStones&&($r[e].spiritStones=t.currency.spiritStones)),void 0!==t.reputation&&($r[e].reputation=t.reputation),void 0!==t.relationships&&($r[e].relationships=t.relationships);else{var r,n,a,i;if(!t.name)throw new Error("\u0418\u043c\u044f \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e");$r[e]={userId:e,name:t.name,gender:t.gender||"male",region:t.region||"central",background:t.background||"commoner",description:t.description||"",avatar:t.avatar||"",level:t.level||1,experience:t.experience||0,gold:(null===(r=t.currency)||void 0===r?void 0:r.gold)||0,silver:(null===(n=t.currency)||void 0===n?void 0:n.silver)||0,copper:(null===(a=t.currency)||void 0===a?void 0:a.copper)||0,spiritStones:(null===(i=t.currency)||void 0===i?void 0:i.spiritStones)||0,reputation:t.reputation||{},relationships:t.relationships||{}}}const o=$r[e];return{name:o.name,gender:o.gender,region:o.region,background:o.background,description:o.description,avatar:o.avatar,level:o.level,experience:o.experience,currency:{gold:o.gold,silver:o.silver,copper:o.copper,spiritStones:o.spiritStones},reputation:o.reputation,relationships:o.relationships}}{let r=await Pr.findOne({where:{userId:e}});if(r){const e={};void 0!==t.name&&(e.name=t.name),void 0!==t.gender&&(e.gender=t.gender),void 0!==t.region&&(e.region=t.region),void 0!==t.background&&(e.background=t.background),void 0!==t.description&&(e.description=t.description),void 0!==t.avatar&&(e.avatar=t.avatar),void 0!==t.level&&(e.level=t.level),void 0!==t.experience&&(e.experience=t.experience),t.currency&&(void 0!==t.currency.gold&&(e.gold=t.currency.gold),void 0!==t.currency.silver&&(e.silver=t.currency.silver),void 0!==t.currency.copper&&(e.copper=t.currency.copper),void 0!==t.currency.spiritStones&&(e.spiritStones=t.currency.spiritStones)),void 0!==t.reputation&&(e.reputation=t.reputation),void 0!==t.relationships&&(e.relationships=t.relationships),await r.update(e)}else{var o,s,l,c;if(!t.name)throw new Error("\u0418\u043c\u044f \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e");r=await Pr.create({userId:e,name:t.name,gender:t.gender||"male",region:t.region||"central",background:t.background||"commoner",description:t.description||"",avatar:t.avatar||"",level:t.level||1,experience:t.experience||0,gold:(null===(o=t.currency)||void 0===o?void 0:o.gold)||0,silver:(null===(s=t.currency)||void 0===s?void 0:s.silver)||0,copper:(null===(l=t.currency)||void 0===l?void 0:l.copper)||0,spiritStones:(null===(c=t.currency)||void 0===c?void 0:c.spiritStones)||0,reputation:t.reputation||{},relationships:t.relationships||{}})}return r=await Pr.findOne({where:{userId:e}}),{name:r.name,gender:r.gender,region:r.region,background:r.background,description:r.description,avatar:r.avatar,level:r.level,experience:r.experience,currency:{gold:r.gold,silver:r.silver,copper:r.copper,spiritStones:r.spiritStones},reputation:r.reputation,relationships:r.relationships}}}catch(d){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430:",d),d}}static async isCharacterCreated(e){try{if(Lr)return!!$r[e];return!!await Pr.findOne({where:{userId:e}})}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430:",t),t}}static async updateCurrency(e,t){try{if(Lr){const r=$r[e];if(!r)throw new Error("\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");return void 0!==t.gold&&(r.gold=t.gold),void 0!==t.silver&&(r.silver=t.silver),void 0!==t.copper&&(r.copper=t.copper),void 0!==t.spiritStones&&(r.spiritStones=t.spiritStones),{gold:r.gold,silver:r.silver,copper:r.copper,spiritStones:r.spiritStones}}{let r=await Pr.findOne({where:{userId:e}});if(!r)throw new Error("\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");const n={};return void 0!==t.gold&&(n.gold=t.gold),void 0!==t.silver&&(n.silver=t.silver),void 0!==t.copper&&(n.copper=t.copper),void 0!==t.spiritStones&&(n.spiritStones=t.spiritStones),await r.update(n),r=await Pr.findOne({where:{userId:e}}),{gold:r.gold,silver:r.silver,copper:r.copper,spiritStones:r.spiritStones}}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0432\u0430\u043b\u044e\u0442\u044b \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430:",r),r}}static async updateRelationships(e,t){try{if(Lr){const r=$r[e];if(!r)throw new Error("\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");return r.relationships=t,r.relationships}{let r=await Pr.findOne({where:{userId:e}});if(!r)throw new Error("\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");return await r.update({relationships:t}),r=await Pr.findOne({where:{userId:e}}),r.relationships}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430:",r),r}}},qr=[{id:1,name:"\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438",role:"\u041d\u0430\u0441\u0442\u0430\u0432\u043d\u0438\u043a",level:80,events:["\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0443\u0440\u043e\u043a \u043e\u0442 \u041c\u0430\u0441\u0442\u0435\u0440\u0430 \u041b\u0438","\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438 \u043f\u043e\u0445\u0432\u0430\u043b\u0438\u043b \u0432\u0430\u0448 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441"]},{id:2,name:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0427\u0436\u0430\u043d",role:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0441\u0435\u043a\u0442\u044b",level:60,events:["\u0412\u044b \u043f\u043e\u043c\u043e\u0433\u043b\u0438 \u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0435 \u0427\u0436\u0430\u043d\u0443 \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0442\u0440\u0430\u0432\u044b"]},{id:3,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0412\u0430\u043d",role:"\u0421\u043e\u0443\u0447\u0435\u043d\u0438\u043a",level:45,events:["\u0412\u044b \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u0412\u0430\u043d\u043e\u043c","\u0412\u044b \u043e\u0434\u043e\u043b\u0436\u0438\u043b\u0438 \u0412\u0430\u043d\u0443 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0430\u043c\u0435\u043d\u044c"]},{id:4,name:"\u0423\u0447\u0435\u043d\u0438\u0446\u0430 \u041c\u044d\u0439",role:"\u0421\u043e\u0443\u0447\u0435\u043d\u0438\u0446\u0430",level:40,events:["\u041c\u044d\u0439 \u043f\u043e\u0434\u0435\u043b\u0438\u043b\u0430\u0441\u044c \u0441 \u0432\u0430\u043c\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u043e\u0439 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"]},{id:5,name:"\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446 \u0427\u0435\u043d",role:"\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446",level:30,events:["\u0412\u044b \u043a\u0443\u043f\u0438\u043b\u0438 \u0442\u043e\u0432\u0430\u0440\u044b \u0443 \u0427\u0435\u043d\u0430","\u0427\u0435\u043d \u0434\u0430\u043b \u0432\u0430\u043c \u0441\u043a\u0438\u0434\u043a\u0443"]},{id:6,name:"\u0413\u043b\u0430\u0432\u0430 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439",role:"\u0413\u043b\u0430\u0432\u0430 \u0432\u0440\u0430\u0436\u0434\u0435\u0431\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u043d\u0430",level:10,events:["\u0413\u043b\u0430\u0432\u0430 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439 \u0443\u0433\u0440\u043e\u0436\u0430\u043b \u0432\u0430\u043c","\u0412\u044b \u0438\u0437\u0431\u0435\u0436\u0430\u043b\u0438 \u043b\u043e\u0432\u0443\u0448\u043a\u0438 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439"]}],Ur=()=>JSON.parse(JSON.stringify(qr));var Fr=r(480);const zr=e=>new Promise((t=>setTimeout(t,e))),Br={async login(e,t){await zr(1e3);try{const r=await hr.loginUser(e,t);console.log("\u0423\u0441\u043f\u0435\u0448\u043d\u0430\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f:",r.username);const n=Math.random().toString(36).substring(2);return localStorage.setItem("authToken",n),localStorage.setItem("currentUser",r.username),{user:{id:r.id,username:r.username,email:r.email,cultivationLevel:r.cultivationLevel,experience:r.experience},token:n}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0445\u043e\u0434\u0430:",r),r}},async register(e,t){await zr(1e3);try{const r=`${e}@example.com`,n=await hr.registerUser(e,r,t),a=Math.random().toString(36).substring(2);return localStorage.setItem("authToken",a),localStorage.setItem("currentUser",e),console.log("\u0423\u0441\u043f\u0435\u0448\u043d\u0430\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f:",e),await Or.updateCharacterProfile(n.id,{name:null,gender:null,region:null,background:null,description:null,social:{sect:null,reputation:{},friends:[],relationships:Ur()}}),{user:{id:n.id,username:n.username,email:n.email,cultivationLevel:n.cultivationLevel,experience:n.experience,social:{sect:null,reputation:{},friends:[],relationships:Ur()}},token:a}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438:",r),r}},async logout(){await zr(500),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),console.log("\u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b")},async checkAuth(){await zr(500);const e=localStorage.getItem("authToken"),t=localStorage.getItem("currentUser");if(!e||!t)return!1;try{return!!await hr.getUserProfile(t)}catch(r){return console.warn("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438:",r),localStorage.removeItem("authToken"),localStorage.removeItem("currentUser"),!1}},async getCurrentUser(){await zr(500);const e=localStorage.getItem("currentUser");if(!e)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d");try{const t=await hr.getUserProfile(e),r=await Or.getCharacterProfile(t.id);return{id:t.id,username:t.username,email:t.email,cultivationLevel:t.cultivationLevel,experience:t.experience,...r?{name:r.name,gender:r.gender,region:r.region,background:r.background,description:r.description,social:r.social||{sect:null,reputation:{},friends:[],relationships:Ur()}}:{}}}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",t),t}},async saveGameState(e){try{await zr(300);const r=localStorage.getItem("currentUser");if(!r)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d");const n=await hr.getUserProfile(r);if(!n)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445");if(e&&e.player){if(e.player.name&&await Or.updateCharacterProfile(n.id,{name:e.player.name,gender:e.player.gender,region:e.player.region,background:e.player.background,description:e.player.description,avatar:e.player.avatar,level:e.player.level,experience:e.player.experience,currency:e.player.inventory.currency,reputation:e.player.social.reputation,relationships:e.player.social.relationships}),e.player.cultivation&&await vr.updateCultivationProgress(n.id,e.player.cultivation),e.player.stats&&await Tr().updateCharacterStats(n.id,e.player.stats),e.player.inventory&&e.player.inventory.items)for(const t of e.player.inventory.items)await br().addInventoryItem(n.id,t);if(e.player.techniques)for(const r of e.player.techniques)try{const e=await _r().getLearnedTechniques(n.id);if(e.some((e=>e.id===r.id))){if(r.level>1)for(let t=1;t<r.level;t++)await _r().upgradeTechnique(n.id,r.id)}else await _r().learnTechnique(n.id,r.id)}catch(t){}if(e.player.progress&&e.player.progress.quests){for(const r of e.player.progress.quests.active)try{await jr().acceptQuest(n.id,r.id),await jr().updateQuestProgress(n.id,r.id,r.progress||{})}catch(t){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0433\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044f ${r.id}:`,t)}for(const r of e.player.progress.quests.completed)try{await jr().acceptQuest(n.id,r.id),await jr().completeQuest(n.id,r.id)}catch(t){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u043e\u0433\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044f ${r.id}:`,t)}}}return{success:!0}}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f:",t),t}},async loadGameState(){try{await zr(300);const e=localStorage.getItem("currentUser");if(!e)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d");const t=await hr.getUserProfile(e);if(!t)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445");const r={player:{id:t.id,stats:{},cultivation:{},inventory:{items:[],equipment:{},currency:{copper:0,silver:0,gold:0,spiritStones:0}},techniques:[],progress:{quests:{active:[],available:[],completed:[]},discoveries:{},achievements:{}},social:{sect:null,reputation:{},friends:[],relationships:Ur()}},world:{currentLocation:null,time:{day:1,hour:6,minute:0,season:"spring",year:1},weather:"clear",events:[]},ui:{currentScreen:"world",notifications:[],dialogs:[],settings:{soundVolume:.5,musicVolume:.5,graphicsQuality:"medium"}},achievements:{completed:[],points:0},combat:{inCombat:!1,enemy:null,log:[],turn:1}},n=await Or.getCharacterProfile(t.id);n&&(r.player.name=n.name,r.player.gender=n.gender,r.player.region=n.region,r.player.background=n.background,r.player.description=n.description,r.player.avatar=n.avatar,r.player.level=n.level,r.player.experience=n.experience,r.player.inventory.currency=n.currency,r.player.social.reputation=n.reputation,n.relationships?(Array.isArray(n.relationships)?r.player.social.relationships=n.relationships:(console.log("\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0435 relationships \u0438\u0437 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432"),r.player.social.relationships=Object.values(n.relationships)),Array.isArray(r.player.social.relationships)&&0===r.player.social.relationships.length&&(console.log("Relationships \u043f\u0443\u0441\u0442\u043e\u0439, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f"),r.player.social.relationships=Ur())):(console.log("Relationships \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f"),r.player.social.relationships=Ur()));const a=await vr.getCultivationProgress(t.id);r.player.cultivation=a;const i=await Tr().getCharacterStats(t.id);r.player.stats=i;const o=Tr().calculateSecondaryStats(i,a);r.player.secondaryStats=o;const s=await br().getInventoryItems(t.id);r.player.inventory.items=s;const l=await _r().getLearnedTechniques(t.id);r.player.techniques=l;const c=await jr().getQuests(t.id);return r.player.progress.quests=c,console.log("\u0418\u0433\u0440\u043e\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043e \u0438\u0437 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",e),r}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f:",e),e}},async migrateUsersToDatabase(){try{const n=JSON.parse(localStorage.getItem("users")||"{}"),a={success:!0,processed:0,migrated:0,skipped:0,errors:[]};for(const i in n){a.processed++;const o=n[i];try{let r=null;try{const e=await(0,Ir.getInitializedUserModel)();r=await e.findOne({where:{username:i}})}catch(e){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0438\u0441\u043a\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ${i}:`,e),a.errors.push({username:i,stage:"search",error:e.message})}if(r)console.log(`\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c ${i} \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0411\u0414`),a.skipped++;else{const e=o.email||`${i}@example.com`;try{const t=await(0,Fr.E)(o.password),r=await(0,Ir.getInitializedUserModel)();await r.create({username:i,email:e,passwordHash:t,cultivationLevel:1,experience:0,createdAt:new Date,updatedAt:new Date}),console.log(`\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c ${i} \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043c\u0438\u0433\u0440\u0438\u0440\u043e\u0432\u0430\u043d \u0432 \u0411\u0414`),a.migrated++}catch(t){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ${i} \u0432 \u0411\u0414:`,t),a.errors.push({username:i,stage:"create",error:t.message})}}}catch(r){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ${i}:`,r),a.errors.push({username:i,stage:"process",error:r.message})}}return a}catch(r){return console.error("\u041e\u0431\u0449\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439:",r),{success:!1,error:r.message}}}};var Gr=r(5105),Wr=r(1429),Hr=r.n(Wr),Vr=r(3603);const Qr={player:{id:null,name:"",avatar:"",gender:"",background:"",region:"",stats:{strength:10,intellect:10,agility:10,health:100,maxHealth:100,energy:100,maxEnergy:100,unassignedPoints:0},secondaryStats:{physicalDefense:0,spiritualDefense:0,attackSpeed:0,criticalChance:0,movementSpeed:0,luck:0},cultivation:{stage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",level:1,experience:0,experienceToNextLevel:100,energy:100,maxEnergy:100,techniques:[]},inventory:{items:[],equipment:{},currency:{copper:0,silver:0,gold:0,spiritStones:0}},social:{sect:null,reputationLegacy:{},friends:[],relationships:[]},progress:{quests:{active:[],available:[],completed:[]},discoveries:{},achievements:{}},techniques:[],activeTechniques:{},statusEffects:{},spiritPets:{pets:[],activePetId:null},combatHistory:[]},world:{currentLocation:null,time:{day:1,hour:6,minute:0,season:"spring",year:1},weather:"clear",events:[],generatedEnemies:{}},ui:{currentScreen:"world",notifications:[],dialogs:[],settings:{soundVolume:.5,musicVolume:.5,graphicsQuality:"medium"}},achievements:{completed:[],points:0},combat:{inCombat:!1,enemy:null,log:[],turn:1,playerCombatState:{stats:null,effects:[]},enemyCombatState:null,isPlayerTurn:!0,combatStats:{player:{damageDealt:0,techniquesUsed:0,criticalHits:0,dodges:0},enemy:{damageDealt:0,techniquesUsed:0,criticalHits:0,dodges:0}},startTime:null,lastCombatResult:null},sect:{sect:null,loading:!1,error:null,userRank:null,privileges:[],benefits:[],selectedMember:null},market:{playerItems:[],marketItems:[],merchantReputation:{},lastUpdated:null},reputation:{data:{cities:[],factions:[],global:null},features:[],notifications:[],loading:!1,changing:!1,error:null},isInitialized:!1},Yr={SET_GROUPS:"SET_GROUPS",SET_CURRENT_GROUP:"SET_CURRENT_GROUP",CREATE_GROUP:"CREATE_GROUP",UPDATE_GROUP:"UPDATE_GROUP",DELETE_GROUP:"DELETE_GROUP",JOIN_GROUP:"JOIN_GROUP",LEAVE_GROUP:"LEAVE_GROUP",SET_GROUP_ACTIVITIES:"SET_GROUP_ACTIVITIES",SET_CURRENT_ACTIVITY:"SET_CURRENT_ACTIVITY",FETCH_USER_INVITATIONS:"FETCH_USER_INVITATIONS",SET_USER_INVITATIONS:"SET_USER_INVITATIONS",RESPOND_TO_INVITATION:"RESPOND_TO_INVITATION",CREATE_ACTIVITY_INSTANCE:"CREATE_ACTIVITY_INSTANCE",FETCH_GROUP_ACTIVITY_INSTANCES:"FETCH_GROUP_ACTIVITY_INSTANCES",SET_GROUP_ACTIVITY_INSTANCES:"SET_GROUP_ACTIVITY_INSTANCES",UPDATE_ACTIVITY_INSTANCE:"UPDATE_ACTIVITY_INSTANCE",START_ACTIVITY:"START_ACTIVITY",UPDATE_ACTIVITY_PROGRESS:"UPDATE_ACTIVITY_PROGRESS",COMPLETE_ACTIVITY:"COMPLETE_ACTIVITY",FAIL_ACTIVITY:"FAIL_ACTIVITY",ABANDON_ACTIVITY:"ABANDON_ACTIVITY",ADD_ACTIVITY_PARTICIPANT:"ADD_ACTIVITY_PARTICIPANT",REMOVE_ACTIVITY_PARTICIPANT:"REMOVE_ACTIVITY_PARTICIPANT",UPDATE_ACTIVITY_REWARDS:"UPDATE_ACTIVITY_REWARDS",ADD_REWARDS:"ADD_REWARDS",INITIALIZE_WEATHER:"INITIALIZE_WEATHER",UPDATE_PLAYER:"UPDATE_PLAYER",UPDATE_PLAYER_STATS:"UPDATE_PLAYER_STATS",UPDATE_CULTIVATION:"UPDATE_CULTIVATION",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",EQUIP_ITEM:"EQUIP_ITEM",UNEQUIP_ITEM:"UNEQUIP_ITEM",UPDATE_CURRENCY:"UPDATE_CURRENCY",UPDATE_LOCATION:"UPDATE_LOCATION",UPDATE_TIME:"UPDATE_TIME",UPDATE_WEATHER:"UPDATE_WEATHER",ADD_EVENT:"ADD_EVENT",REMOVE_EVENT:"REMOVE_EVENT",CHANGE_SCREEN:"CHANGE_SCREEN",ADD_NOTIFICATION:"ADD_NOTIFICATION",REMOVE_NOTIFICATION:"REMOVE_NOTIFICATION",UPDATE_SETTINGS:"UPDATE_SETTINGS",SAVE_GAME:"SAVE_GAME",LOAD_GAME:"LOAD_GAME",ACCEPT_QUEST:"ACCEPT_QUEST",COMPLETE_QUEST:"COMPLETE_QUEST",UPDATE_QUEST_OBJECTIVE:"UPDATE_QUEST_OBJECTIVE",CHECK_ACHIEVEMENTS:"CHECK_ACHIEVEMENTS",COMPLETE_ACHIEVEMENT:"COMPLETE_ACHIEVEMENT",LEARN_TECHNIQUE:"LEARN_TECHNIQUE",UPGRADE_TECHNIQUE:"UPGRADE_TECHNIQUE",USE_TECHNIQUE:"USE_TECHNIQUE",START_COMBAT:"START_COMBAT",END_COMBAT:"END_COMBAT",UPDATE_COMBAT:"UPDATE_COMBAT",UPDATE_COMBAT_STATE:"UPDATE_COMBAT_STATE",ADD_COMBAT_LOG:"ADD_COMBAT_LOG",ADD_STATUS_EFFECT:"ADD_STATUS_EFFECT",UPDATE_STATUS_EFFECT:"UPDATE_STATUS_EFFECT",REMOVE_STATUS_EFFECT:"REMOVE_STATUS_EFFECT",SET_INITIALIZED:"SET_INITIALIZED",SET_ERROR:"SET_ERROR",SET_SECT:"SET_SECT",UPDATE_SECT:"UPDATE_SECT",JOIN_SECT:"JOIN_SECT",LEAVE_SECT:"LEAVE_SECT",CONTRIBUTE_TO_SECT:"CONTRIBUTE_TO_SECT",TRAIN_SECT_MEMBER:"TRAIN_SECT_MEMBER",UPDATE_SECT_MEMBER:"UPDATE_SECT_MEMBER",UPDATE_SECT_BENEFITS:"UPDATE_SECT_BENEFITS",UPDATE_SECT_RANK:"UPDATE_SECT_RANK",ADD_SPIRIT_PET:"ADD_SPIRIT_PET",REMOVE_SPIRIT_PET:"REMOVE_SPIRIT_PET",REMOVE_FLEEING_PET:"REMOVE_FLEEING_PET",UPDATE_SPIRIT_PET:"UPDATE_SPIRIT_PET",SET_ACTIVE_SPIRIT_PET:"SET_ACTIVE_SPIRIT_PET",FEED_SPIRIT_PET:"FEED_SPIRIT_PET",TRAIN_SPIRIT_PET:"TRAIN_SPIRIT_PET",USE_PET_ABILITY:"USE_PET_ABILITY",UPDATE_PETS_STATE:"UPDATE_PETS_STATE",ADD_MARKET_ITEM:"ADD_MARKET_ITEM",REMOVE_MARKET_ITEM:"REMOVE_MARKET_ITEM",UPDATE_MARKET_ITEM:"UPDATE_MARKET_ITEM",BUY_MARKET_ITEM:"BUY_MARKET_ITEM",SELL_MARKET_ITEM:"SELL_MARKET_ITEM",UPDATE_MERCHANT_REPUTATION:"UPDATE_MERCHANT_REPUTATION",UPDATE_MARKET_STATE:"UPDATE_MARKET_STATE",CACHE_GENERATED_ENEMY:"CACHE_GENERATED_ENEMY",APPLY_EQUIPMENT_BONUSES:"APPLY_EQUIPMENT_BONUSES",UPDATE_RELATIONSHIP:"UPDATE_RELATIONSHIP",REPAIR_TECHNIQUES:"REPAIR_TECHNIQUES",ADD_COMBAT_HISTORY:"ADD_COMBAT_HISTORY",NORMALIZE_SECT_DATA:"NORMALIZE_SECT_DATA",NORMALIZE_EFFECTS:"NORMALIZE_EFFECTS",SYNC_SECT_TO_SOCIAL:"SYNC_SECT_TO_SOCIAL",SYNC_SOCIAL_TO_SECT:"SYNC_SOCIAL_TO_SECT",UPDATE_SECT_LOYALTY:"UPDATE_SECT_LOYALTY",UPDATE_SOCIAL_RELATIONSHIPS:"UPDATE_SOCIAL_RELATIONSHIPS",UPDATE_SECT_DATA:"UPDATE_SECT_DATA",UPDATE_RELATIONSHIP_AND_LOYALTY:"UPDATE_RELATIONSHIP_AND_LOYALTY"};var Kr=r(8790),Xr=r.n(Kr),Jr=r(8317),Zr=r(6433),en=r(592);const tn=(e,t)=>{switch(t.type){case Yr.UPDATE_PLAYER:return{...e,player:{...e.player,...t.payload}};case Yr.UPDATE_PLAYER_STATS:return{...e,player:{...e.player,stats:{...e.player.stats,...t.payload},secondaryStats:Tr().calculateSecondaryStats({...e.player.stats,...t.payload},e.player.cultivation)}};case Yr.UPDATE_CULTIVATION:return{...e,player:{...e.player,cultivation:{...e.player.cultivation,...t.payload},secondaryStats:Tr().calculateSecondaryStats(e.player.stats,{...e.player.cultivation,...t.payload})}};case Yr.ADD_ITEM:const i=e.player.inventory.items.findIndex((e=>e.id===t.payload.id));if(-1!==i){const r=[...e.player.inventory.items];return r[i]={...r[i],quantity:r[i].quantity+(t.payload.quantity||1)},{...e,player:{...e.player,inventory:{...e.player.inventory,items:r}}}}return{...e,player:{...e.player,inventory:{...e.player.inventory,items:[...e.player.inventory.items,{...t.payload,quantity:t.payload.quantity||1}]}}};case Yr.REMOVE_ITEM:const o=e.player.inventory.items.findIndex((e=>e.id===t.payload.id));if(-1===o)return e;const s=e.player.inventory.items[o],l=t.payload.quantity||1;if(s.quantity<=l)return{...e,player:{...e.player,inventory:{...e.player.inventory,items:e.player.inventory.items.filter(((e,t)=>t!==o))}}};{const t=[...e.player.inventory.items];return t[o]={...s,quantity:s.quantity-l},{...e,player:{...e.player,inventory:{...e.player.inventory,items:t}}}}case Yr.UPDATE_CURRENCY:const c={...e.player.inventory.currency||{}};return"number"===typeof t.payload?c.gold=(c.gold||0)+t.payload:"object"===typeof t.payload&&Object.entries(t.payload).forEach((e=>{let[r,n]=e;"number"===typeof n&&(!0===t.isAdditive?c[r]=(c[r]||0)+n:c[r]=n)})),console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0430\u043b\u044e\u0442\u044b:",{"\u0431\u044b\u043b\u043e":e.player.inventory.currency,"\u043d\u043e\u0432\u043e\u0435":c,"\u0440\u0430\u0437\u043d\u0438\u0446\u0430":t.payload,"\u0440\u0435\u0436\u0438\u043c":!0===t.isAdditive?"\u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435":"\u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0430"}),console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0430\u043b\u044e\u0442\u044b:",c),{...e,player:{...e.player,inventory:{...e.player.inventory,currency:c}}};case Yr.UPDATE_LOCATION:const d=t.payload,u=[{id:1,name:"\u0414\u043e\u043b\u0438\u043d\u0430 \u041d\u0430\u0447\u0430\u043b\u0430",type:"forest",x:3,y:3,description:"\u041c\u0435\u0441\u0442\u043e, \u0433\u0434\u0435 \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442 \u0441\u0432\u043e\u0439 \u043f\u0443\u0442\u044c \u043c\u043e\u043b\u043e\u0434\u044b\u0435 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u044b.",resources:[{id:1,name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u0442\u0440\u0430\u0432\u044b",amount:"\u041c\u0430\u043b\u043e"}]},{id:2,name:"\u0413\u043e\u0440\u044b \u041e\u0431\u043b\u0430\u0447\u043d\u043e\u0433\u043e \u041f\u0438\u043a\u0430",type:"mountain",x:5,y:2,description:"\u0412\u044b\u0441\u043e\u043a\u0438\u0435 \u0433\u043e\u0440\u044b, \u043e\u043a\u0443\u0442\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u043b\u0430\u043a\u0430\u043c\u0438 \u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0435\u0439.",resources:[{id:2,name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043a\u0430\u043c\u043d\u0438",amount:"\u0421\u0440\u0435\u0434\u043d\u0435"}]},{id:3,name:"\u0413\u043e\u0440\u043e\u0434 \u0412\u043e\u0441\u0442\u043e\u0447\u043d\u043e\u0433\u043e \u0412\u0435\u0442\u0440\u0430",type:"city",x:7,y:5,description:"\u041a\u0440\u0443\u043f\u043d\u044b\u0439 \u0433\u043e\u0440\u043e\u0434, \u0446\u0435\u043d\u0442\u0440 \u0442\u043e\u0440\u0433\u043e\u0432\u043b\u0438 \u0438 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438.",resources:[{id:3,name:"\u0422\u043e\u0432\u0430\u0440\u044b",amount:"\u041c\u043d\u043e\u0433\u043e"}]},{id:4,name:"\u041e\u0437\u0435\u0440\u043e \u041e\u0442\u0440\u0430\u0436\u0435\u043d\u0438\u0439",type:"water",x:2,y:6,description:"\u041c\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043e\u0437\u0435\u0440\u043e, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043e\u0442\u0440\u0430\u0436\u0430\u044e\u0442\u0441\u044f \u0437\u0432\u0435\u0437\u0434\u044b \u0434\u0430\u0436\u0435 \u0434\u043d\u0435\u043c.",resources:[{id:4,name:"\u0412\u043e\u0434\u043d\u044b\u0435 \u044d\u0441\u0441\u0435\u043d\u0446\u0438\u0438",amount:"\u041c\u043d\u043e\u0433\u043e"}]},{id:5,name:"\u041f\u0435\u0449\u0435\u0440\u0430 \u0422\u044b\u0441\u044f\u0447\u0438 \u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0439",type:"dungeon",x:8,y:8,description:"\u0414\u0440\u0435\u0432\u043d\u0435\u0435 \u043c\u0435\u0441\u0442\u043e \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0439 \u0434\u043b\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432.",resources:[{id:5,name:"\u0421\u043e\u043a\u0440\u043e\u0432\u0438\u0449\u0430",amount:"\u0420\u0435\u0434\u043a\u043e"}]}];let p=d;if(d&&void 0!==d.x&&(!d.name||!d.type)){const e=u.find((e=>e.x===d.x&&e.y===d.y));e&&(p={...e,...d},console.log(`\ud83c\udf0d \u041d\u0430\u0439\u0434\u0435\u043d\u0430 \u043f\u043e\u043b\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043b\u043e\u043a\u0430\u0446\u0438\u0438: ${p.name}`))}return{...e,world:{...e.world,currentLocation:p},player:{...e.player,location:p}};case Yr.ADD_STATUS_EFFECT:console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u0430:",t.payload);const h=[...(0,Zr.normalizeStatusEffects)(e.player.statusEffects),(0,en.cleanEffects)([t.payload])[0]],m=((0,en.collectAllSectBenefits)(e.sect),{...e.player,statusEffects:h}),f=(0,Zr.normalizePlayerEffects)(m,e.sect);return{...e,player:f};case Yr.UPDATE_STATUS_EFFECT:console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u0430:",t.payload);const y=(0,Zr.normalizeStatusEffects)(e.player.statusEffects),g=t.payload.type;if(!g)return console.error("\u041e\u0448\u0438\u0431\u043a\u0430: \u0442\u0438\u043f \u044d\u0444\u0444\u0435\u043a\u0442\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d \u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438",t.payload),e;const v=(0,en.cleanEffects)([t.payload])[0],x=y.map((e=>e.type===g?{...e,...v}:e)),b={...e.player,statusEffects:x},w=(0,Zr.normalizePlayerEffects)(b,e.sect);return{...e,player:w};case Yr.REMOVE_STATUS_EFFECT:console.log("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u0430 \u0441 \u0442\u0438\u043f\u043e\u043c:",t.payload);const _=(0,Zr.normalizeStatusEffects)(e.player.statusEffects),E="string"===typeof t.payload?_.filter((e=>e.type!==t.payload)):_.filter((e=>e.id!==t.payload)),T={...e.player,statusEffects:E},S=(0,Zr.normalizePlayerEffects)(T,e.sect);return{...e,player:S};case Yr.NORMALIZE_EFFECTS:console.log("\ud83d\udcca \u041f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432");const j=(0,Zr.normalizePlayerEffects)(e.player,e.sect);return console.log("\u2705 \u042d\u0444\u0444\u0435\u043a\u0442\u044b \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u044b:",j.statusEffects),{...e,player:j};case Yr.EQUIP_ITEM:if(console.log("\u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430:",t.payload),!t.payload||!t.payload.id)return console.error("\u041e\u0448\u0438\u0431\u043a\u0430: \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430",t.payload),e;const C=(0,Jr.ensureItemHasCalculatedBonuses)(t.payload);console.log("\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u0441 \u0431\u043e\u043d\u0443\u0441\u0430\u043c\u0438 \u0434\u043b\u044f \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:",C);const k=e.player.inventory.items.map((e=>{if(e.id===C.id)return{...e,equipped:!0};if("armor"===e.type&&"armor"===C.type&&e.id!==C.id&&e.equipped){var t,r;const n=(null===(t=e.properties)||void 0===t?void 0:t.armorType)||e.armorType,a=(null===(r=C.properties)||void 0===r?void 0:r.armorType)||C.armorType,i=e=>e?(e=e.toLowerCase()).includes("\u0448\u043b\u0435\u043c")||e.includes("\u0448\u0430\u043f\u043a\u0430")||e.includes("\u043a\u0430\u043f\u044e\u0448\u043e\u043d")?"head":e.includes("\u0441\u0430\u043f\u043e\u0433")||e.includes("\u0431\u043e\u0442\u0438\u043d")||e.includes("\u043e\u0431\u0443\u0432\u044c")?"legs":e.includes("\u043f\u0435\u0440\u0447\u0430\u0442")||e.includes("\u0440\u0443\u043a\u0430\u0432")?"hands":"body":"body",o=n||i(e.name),s=a||i(C.name);return console.log(`\u0421\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0435 \u0442\u0438\u043f\u043e\u0432 \u0431\u0440\u043e\u043d\u0438: ${e.name} (${o}) \u0438 ${C.name} (${s})`),o===s?(console.log(`\u0421\u043d\u0438\u043c\u0430\u0435\u043c \u043f\u0440\u0435\u0434\u043c\u0435\u0442 ${e.name}, \u0442.\u043a. \u044d\u043a\u0438\u043f\u0438\u0440\u0443\u0435\u043c \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u0442\u043e\u0433\u043e \u0436\u0435 \u0442\u0438\u043f\u0430 (${s})`),{...e,equipped:!1}):e}return"weapon"===e.type&&"weapon"===C.type&&e.id!==C.id&&e.equipped?{...e,equipped:!1}:("accessory"===e.type&&"accessory"===C.type||"artifact"===e.type&&C.type,e)})),I={...e.player,inventory:{...e.player.inventory,items:k}},A={};k.filter((e=>e.equipped)).forEach((e=>{var t;let r=null;switch(e.type){case"weapon":r="weapon";break;case"armor":const n=(null===(t=e.properties)||void 0===t?void 0:t.armorType)||e.armorType;if("head"===n)r="headArmor";else if("body"===n)r="bodyArmor";else if("legs"===n)r="legArmor";else if("hands"===n)r="handArmor";else{const t=e.name.toLowerCase();r=t.includes("\u0448\u043b\u0435\u043c")||t.includes("\u0448\u0430\u043f\u043a\u0430")?"headArmor":t.includes("\u0441\u0430\u043f\u043e\u0433")||t.includes("\u0431\u043e\u0442\u0438\u043d")?"legArmor":t.includes("\u043f\u0435\u0440\u0447\u0430\u0442")||t.includes("\u0440\u0443\u043a\u0430\u0432")?"handArmor":"bodyArmor"}break;case"accessory":r=A.accessory1?"accessory2":"accessory1";break;case"artifact":r=A.artifact1?"artifact2":"artifact1"}r&&(A[r]=(0,Jr.ensureItemHasCalculatedBonuses)(e))})),console.log("\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u043f\u043e\u0441\u043b\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:",A);const N={...e,player:I};return tn(N,{type:Yr.APPLY_EQUIPMENT_BONUSES,payload:A});case Yr.UNEQUIP_ITEM:if(console.log("\u0421\u043d\u044f\u0442\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:",t.payload),!t.payload)return console.error("\u041e\u0448\u0438\u0431\u043a\u0430: \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d \u0441\u043b\u043e\u0442 \u0434\u043b\u044f \u0441\u043d\u044f\u0442\u0438\u044f \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430"),e;const D=t.payload,M=e.player.inventory.items.map((e=>{var t;let r=null;if(e.equipped){switch(e.type){case"weapon":r="weapon";break;case"armor":const n=(null===(t=e.properties)||void 0===t?void 0:t.armorType)||e.armorType;if("head"===n)r="headArmor";else if("body"===n)r="bodyArmor";else if("legs"===n)r="legArmor";else if("hands"===n)r="handArmor";else{const t=e.name.toLowerCase();r=t.includes("\u0448\u043b\u0435\u043c")||t.includes("\u0448\u0430\u043f\u043a\u0430")?"headArmor":t.includes("\u0441\u0430\u043f\u043e\u0433")||t.includes("\u0431\u043e\u0442\u0438\u043d")?"legArmor":t.includes("\u043f\u0435\u0440\u0447\u0430\u0442")||t.includes("\u0440\u0443\u043a\u0430\u0432")?"handArmor":"bodyArmor"}}if(r===D)return{...e,equipped:!1}}return e})),R={...e.player,inventory:{...e.player.inventory,items:M}},P={};M.filter((e=>e.equipped)).forEach((e=>{var t;let r=null;switch(e.type){case"weapon":r="weapon";break;case"armor":const n=(null===(t=e.properties)||void 0===t?void 0:t.armorType)||e.armorType;if("head"===n)r="headArmor";else if("body"===n)r="bodyArmor";else if("legs"===n)r="legArmor";else if("hands"===n)r="handArmor";else{const t=e.name.toLowerCase();r=t.includes("\u0448\u043b\u0435\u043c")||t.includes("\u0448\u0430\u043f\u043a\u0430")?"headArmor":t.includes("\u0441\u0430\u043f\u043e\u0433")||t.includes("\u0431\u043e\u0442\u0438\u043d")?"legArmor":t.includes("\u043f\u0435\u0440\u0447\u0430\u0442")||t.includes("\u0440\u0443\u043a\u0430\u0432")?"handArmor":"bodyArmor"}break;case"accessory":r=P.accessory1?"accessory2":"accessory1";break;case"artifact":r=P.artifact1?"artifact2":"artifact1"}r&&(P[r]=(0,Jr.ensureItemHasCalculatedBonuses)(e))})),console.log("\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u043f\u043e\u0441\u043b\u0435 \u0441\u043d\u044f\u0442\u0438\u044f \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430:",P);const L={...e,player:R};return tn(L,{type:Yr.APPLY_EQUIPMENT_BONUSES,payload:P});case Yr.APPLY_EQUIPMENT_BONUSES:if(console.log("\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u043e\u0442 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:",t.payload),!t.payload||!Object.keys(t.payload).length)return console.log("\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0435 \u0434\u043b\u044f \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0431\u043e\u043d\u0443\u0441\u043e\u0432"),{...e,player:{...e.player,equipmentBonuses:{stats:{},combat:{},cultivation:{},elemental:{},special:[]}}};const $=(0,Jr.ensureEquipmentHasCalculatedBonuses)(t.payload);let O;console.log("\u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0430 \u0441 \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438 \u0431\u043e\u043d\u0443\u0441\u0430\u043c\u0438:",$);Object.values($).some((e=>e&&e.calculatedBonuses))?(console.log("\u2705 \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043f\u0440\u0435\u0434\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b \u0438\u0437 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432"),O={stats:{strength:0,dexterity:0,vitality:0,intelligence:0,perception:0,luck:0},combat:{physicalDamage:0,magicDamage:0,physicalDefense:0,magicDefense:0,critChance:0,critDamage:0,dodgeChance:0},cultivation:{energyMax:0,energyRegen:0,comprehensionRate:0,breakthroughChance:0},elemental:{fire:0,water:0,earth:0,air:0,light:0,dark:0},special:[]},Object.values(t.payload).forEach((e=>{if(!e||!e.calculatedBonuses)return;const t=e.calculatedBonuses;t.stats&&Object.entries(t.stats).forEach((e=>{let[t,r]=e;void 0!==O.stats[t]&&(O.stats[t]+=r)})),t.combat&&Object.entries(t.combat).forEach((e=>{let[t,r]=e;void 0!==O.combat[t]&&(O.combat[t]+=r)})),t.cultivation&&Object.entries(t.cultivation).forEach((e=>{let[t,r]=e;void 0!==O.cultivation[t]&&(O.cultivation[t]+=r)})),t.elemental&&Object.entries(t.elemental).forEach((e=>{let[t,r]=e;void 0!==O.elemental[t]&&(O.elemental[t]+=r)})),t.special&&Array.isArray(t.special)&&(O.special=[...O.special,...t.special])}))):(console.log("\u26a0\ufe0f \u041f\u0440\u0435\u0434\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c BonusService"),O=Xr().getEquipmentTotalBonuses(t.payload)),console.log("\u0418\u0442\u043e\u0433\u043e\u0432\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b \u043e\u0442 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:",O);const q=Tr().calculateSecondaryStats(e.player.stats,e.player.cultivation),U={...q,physicalAttack:(q.physicalAttack||0)+(O.combat.physicalDamage||0),magicalAttack:(q.magicalAttack||0)+(O.combat.magicDamage||0),physicalDefense:(q.physicalDefense||0)+(O.combat.physicalDefense||0),magicDefense:(q.magicDefense||0)+(O.combat.magicDefense||0),critChance:(q.critChance||0)+(O.combat.critChance||0),critDamage:(q.critDamage||0)+(O.combat.critDamage||0),evasion:(q.evasion||0)+(O.combat.dodgeChance||0)};return console.log("\u0412\u0442\u043e\u0440\u0438\u0447\u043d\u044b\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u043f\u043e\u0441\u043b\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0431\u043e\u043d\u0443\u0441\u043e\u0432:",U),{...e,player:{...e.player,secondaryStats:U,equipmentBonuses:O}};case Yr.LEARN_TECHNIQUE:const F=t.payload;if(e.player.techniques.find((e=>e.id===F.id)))return e;const z=F.upgradeCost?F.upgradeCost(1):{experience:50,currency:20},B=e.player.cultivation.experience||0,G=Math.max(0,B-z.experience);let W={...e.player.inventory.currency||{}};return"object"===typeof z.currency?Object.entries(z.currency).forEach((e=>{let[t,r]=e;W[t]=(W[t]||0)-r})):W.gold=(W.gold||0)-z.currency,console.log("\u0418\u0437\u0443\u0447\u0435\u043d\u0430 \u043d\u043e\u0432\u0430\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0430:",F),{...e,player:{...e.player,techniques:[...e.player.techniques,{id:F.id,name:F.name,description:F.description,type:F.type,icon:F.icon,damage:F.damage,damageType:F.damageType,energyCost:F.energyCost,cooldown:F.cooldown,effects:F.effects,level:1,experience:0,maxLevel:F.maxLevel,requiredLevel:F.requiredLevel,learnedAt:(new Date).toISOString()}],cultivation:{...e.player.cultivation,experience:G},inventory:{...e.player.inventory,currency:W}}};case Yr.UPGRADE_TECHNIQUE:const{techniqueId:H,cost:V}=t.payload;if(!e.player.techniques.find((e=>e.id===H)))return console.error(`\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0441 ID ${H} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0430`),e;const Q=e.player.cultivation.experience||0,Y=Math.max(0,Q-V.experience);let K={...e.player.inventory.currency||{}};"object"===typeof V.currency?Object.entries(V.currency).forEach((e=>{let[t,r]=e;K[t]=(K[t]||0)-r})):K.gold=(K.gold||0)-V.currency;const{getTechniqueById:X}=r(280),J=X(H);console.log("\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0430 \u0434\u043b\u044f \u0430\u043f\u0433\u0440\u0435\u0439\u0434\u0430:",J);const Z=e.player.techniques.map((e=>{if(e.id===H){const t=e.level+1,r=1+.2*(t-1),n={...e,level:t,damage:e.damage?Math.floor(e.damage*r):e.damage,healing:e.healing?Math.floor(e.healing*r):e.healing,energyCost:e.energyCost?Math.floor(e.energyCost*(1+.1*(t-1))):e.energyCost};return e.effects&&Array.isArray(e.effects)&&(n.effects=e.effects.map((e=>{const t={...e};return t.damage&&(t.damage=Math.floor(t.damage*r)),t.healing&&(t.healing=Math.floor(t.healing*r)),t}))),console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u0442\u0435\u0445\u043d\u0438\u043a\u0430:",n),n}return e}));return{...e,player:{...e.player,techniques:Z,cultivation:{...e.player.cultivation,experience:Y},inventory:{...e.player.inventory,currency:K}}};case Yr.UPDATE_RELATIONSHIP:const ee=t.payload,te=[{id:1,name:"\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438",role:"\u041d\u0430\u0441\u0442\u0430\u0432\u043d\u0438\u043a",level:80,events:["\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0443\u0440\u043e\u043a \u043e\u0442 \u041c\u0430\u0441\u0442\u0435\u0440\u0430 \u041b\u0438","\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438 \u043f\u043e\u0445\u0432\u0430\u043b\u0438\u043b \u0432\u0430\u0448 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441"]},{id:2,name:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0427\u0436\u0430\u043d",role:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0441\u0435\u043a\u0442\u044b",level:60,events:["\u0412\u044b \u043f\u043e\u043c\u043e\u0433\u043b\u0438 \u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0435 \u0427\u0436\u0430\u043d\u0443 \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0442\u0440\u0430\u0432\u044b"]},{id:3,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0412\u0430\u043d",role:"\u0421\u043e\u0443\u0447\u0435\u043d\u0438\u043a",level:45,events:["\u0412\u044b \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u0412\u0430\u043d\u043e\u043c","\u0412\u044b \u043e\u0434\u043e\u043b\u0436\u0438\u043b\u0438 \u0412\u0430\u043d\u0443 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0430\u043c\u0435\u043d\u044c"]},{id:4,name:"\u0423\u0447\u0435\u043d\u0438\u0446\u0430 \u041c\u044d\u0439",role:"\u0421\u043e\u0443\u0447\u0435\u043d\u0438\u0446\u0430",level:40,events:["\u041c\u044d\u0439 \u043f\u043e\u0434\u0435\u043b\u0438\u043b\u0430\u0441\u044c \u0441 \u0432\u0430\u043c\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u043e\u0439 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"]},{id:5,name:"\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446 \u0427\u0435\u043d",role:"\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446",level:30,events:["\u0412\u044b \u043a\u0443\u043f\u0438\u043b\u0438 \u0442\u043e\u0432\u0430\u0440\u044b \u0443 \u0427\u0435\u043d\u0430","\u0427\u0435\u043d \u0434\u0430\u043b \u0432\u0430\u043c \u0441\u043a\u0438\u0434\u043a\u0443"]},{id:6,name:"\u0413\u043b\u0430\u0432\u0430 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439",role:"\u0413\u043b\u0430\u0432\u0430 \u0432\u0440\u0430\u0436\u0434\u0435\u0431\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u043d\u0430",level:10,events:["\u0413\u043b\u0430\u0432\u0430 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439 \u0443\u0433\u0440\u043e\u0436\u0430\u043b \u0432\u0430\u043c","\u0412\u044b \u0438\u0437\u0431\u0435\u0436\u0430\u043b\u0438 \u043b\u043e\u0432\u0443\u0448\u043a\u0438 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439"]}];let re=e.player.relationships||[...te];Array.isArray(re)||(re=Object.values(re));const ne=re.findIndex((e=>e.id===ee.id));let ae;-1!==ne?(ae=[...re],ae[ne]=ee):ae=[...re,ee],console.log(`\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441 ${ee.name} \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f ${ee.level}`);const ie=e.player.social||{};return{...e,player:{...e.player,relationships:ae,social:{...ie,relationships:ae}}};case"UPDATE_SOCIAL_FRIENDS":if(console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0434\u0440\u0443\u0437\u0435\u0439:",t.payload),!Array.isArray(t.payload))return console.error("\u041e\u0448\u0438\u0431\u043a\u0430: payload \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c:",t.payload),e;const oe=e.player.social||{};return{...e,player:{...e.player,social:{...oe,friends:t.payload}}};case Yr.REPAIR_TECHNIQUES:if(console.log("\ud83d\udd27 \u0417\u0430\u043f\u0443\u0449\u0435\u043d \u043f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u0445\u043d\u0438\u043a"),!Array.isArray(e.player.techniques)||0===e.player.techniques.length)return console.log("\ud83d\udd27 \u041d\u0435\u0442 \u0442\u0435\u0445\u043d\u0438\u043a \u0434\u043b\u044f \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f"),e;try{const{techniques:t}=r(280),a=e.player.techniques.map((e=>{const r=e.level||1,n=e.experience||0,a=e.masteryLevel||0,i=e.lastUsed||null,o=e.id,s=t.find((e=>e.id===o));if(!s)return console.warn(`\u26a0\ufe0f \u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u0431\u0430\u0437\u043e\u0432\u043e\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u0441 ID: ${o}`),e;const l=1+.2*(r-1),c={...s,id:o,level:r,experience:n,masteryLevel:a,lastUsed:i,damage:Math.floor((s.damage||0)*l),healing:Math.floor((s.healing||0)*l),energyCost:Math.floor((s.energyCost||10)*(1+.1*(r-1)))};return console.log(`\u2705 \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u0442\u0435\u0445\u043d\u0438\u043a\u0430 ${c.name} (ID: ${o}, \u0423\u0440\u043e\u043d: ${c.damage})`),c}));console.log(`\ud83d\udd27 \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e ${a.length} \u0442\u0435\u0445\u043d\u0438\u043a`);try{const t={...e,player:{...e.player,techniques:a}};"undefined"!==typeof localStorage&&(localStorage.setItem("gameState",JSON.stringify(t)),console.log("\ud83d\udcbe \u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0441 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u043c\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u0430\u043c\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043e \u0432 localStorage"))}catch(n){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f:",n)}return{...e,player:{...e.player,techniques:a}}}catch(a){return console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0442\u0435\u0445\u043d\u0438\u043a:",a),e}case Yr.UPDATE_COMBAT_STATE:return{...e,combat:{...e.combat,...t.payload}};case Yr.USE_TECHNIQUE:{const{techniqueId:r}=t.payload;console.log(`\ud83d\udd04 \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u0441 ID: ${r}`);const n=e.player.techniques.findIndex((e=>e.id===r));if(-1===n)return console.error(`\u274c \u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0441 ID ${r} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430`),e;const i=[...e.player.techniques],o=i[n];i[n]={...o,lastUsed:(new Date).toISOString(),experience:(o.experience||0)+1};const s=100*((o.masteryLevel||0)+1);(i[n].experience||0)>=s&&(i[n].masteryLevel=(i[n].masteryLevel||0)+1,i[n].experience-=s,console.log(`\ud83c\udf1f \u041f\u043e\u0432\u044b\u0448\u0435\u043d \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043c\u0430\u0441\u0442\u0435\u0440\u0441\u0442\u0432\u0430 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 ${o.name} \u0434\u043e ${i[n].masteryLevel}`));const l={...e,player:{...e.player,techniques:i}};try{localStorage.setItem("gameState",JSON.stringify(l)),console.log("\ud83d\udcbe \u0410\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u0441\u043b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e")}catch(a){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043f\u043e\u0441\u043b\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0438:",a)}return l}case Yr.ADD_COMBAT_HISTORY:{if(console.log("\ud83d\udcdd \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u0438 \u0432 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0431\u043e\u0435\u0432:",t.payload),!t.payload||"object"!==typeof t.payload)return console.error("\u274c \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0431\u043e\u0435\u0432:",t.payload),e;const r=Array.isArray(e.player.combatHistory)?e.player.combatHistory:[],n=[{...t.payload,timestamp:t.payload.timestamp||Date.now()},...r].slice(0,50);console.log(`\ud83d\udcca \u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0431\u043e\u0435\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430: ${n.length} \u0437\u0430\u043f\u0438\u0441\u0435\u0439`);try{const t={...e,player:{...e.player,combatHistory:n}};return localStorage.setItem("gameState",JSON.stringify(t)),console.log("\ud83d\udcbe \u0410\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0431\u043e\u0435\u0432 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e"),t}catch(a){return console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0431\u043e\u0435\u0432:",a),{...e,player:{...e.player,combatHistory:n}}}}case Yr.SYNC_SECT_TO_SOCIAL:{if(console.log("\ud83d\udd04 \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0441\u0435\u043a\u0442\u044b \u0441 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f\u043c\u0438"),!e.sect||!e.sect.sect||void 0===e.sect.sect.loyalty)return console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c: \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0441\u0435\u043a\u0442\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0438\u043b\u0438 \u043d\u0435\u043f\u043e\u043b\u043d\u044b\u0435"),e;const t=e.sect.sect.loyalty,r=(0,Vr.syncSectRelationshipToSocial)(e.player.relationships||[],e.sect.sect,t);console.log(`\u2705 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0441\u0435\u043a\u0442\u044b (${t})`);const n=e.player.social||{};return{...e,player:{...e.player,relationships:r,social:{...n,relationships:r}}}}case Yr.SYNC_SOCIAL_TO_SECT:{if(console.log("\ud83d\udd04 \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c\u044e \u0441\u0435\u043a\u0442\u044b"),!e.player.relationships&&(!e.player.social||!e.player.social.relationships))return console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c: \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f\u0445 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442"),e;const t=e.player.relationships||e.player.social&&e.player.social.relationships||[],r=(0,Vr.syncSocialToSectRelationship)(t,e.sect&&e.sect.sect);return null===r||void 0===r?(console.warn("\u26a0\ufe0f \u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0441\u0435\u043a\u0442\u044b"),e):(console.log(`\u2705 \u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u0430 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0435\u043a\u0442\u044b (${r}) \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439`),{...e,calculatedSectLoyalty:r})}case Yr.UPDATE_SOCIAL_RELATIONSHIPS:return console.log("\ud83d\udd04 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439"),t.payload&&Array.isArray(t.payload)?(console.log(`\u2705 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f (${t.payload.length} \u0437\u0430\u043f\u0438\u0441\u0435\u0439)`),{...e,player:{...e.player,relationships:t.payload,social:{...e.player.social||{},relationships:t.payload}}}):(console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c: \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f\u0445"),e);case Yr.UPDATE_RELATIONSHIP_AND_LOYALTY:{if(console.log("\ud83d\udd04 \u041e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0438 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438"),!t.payload||!t.payload.name||void 0===t.payload.value)return console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c: \u043d\u0435\u043f\u043e\u043b\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435",t.payload),e;const{name:r,value:n}=t.payload;console.log(`\ud83d\udcca \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 "${r}" \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f ${n}`);return(0,Vr.updateRelationshipAndLoyalty)(e,r,n)}default:return e}},rn="UPDATE_WEATHER",nn="SET_TIME_OF_DAY",an="WEATHER_SPECIAL_EVENT",on="UPDATE_GAME_TIME",sn="FORCE_WEATHER_CHANGE",ln=Yr.INITIALIZE_WEATHER,cn=e=>(console.log("\ud83c\udf26\ufe0f \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u044d\u043a\u0448\u0435\u043d\u0430 updateWeather \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438:",e),{type:rn,payload:e}),dn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r="number"===typeof e?e:1;return console.log(`\ud83d\udd52 \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u044d\u043a\u0448\u0435\u043d\u0430 updateGameTime \u0441 ${r} \u043c\u0438\u043d\u0443\u0442\u0430\u043c\u0438 (\u0440\u0443\u0447\u043d\u043e\u0435: ${t?"\u0434\u0430":"\u043d\u0435\u0442"})`),{type:on,payload:{minutesToAdd:r,isManual:t,timestamp:Date.now()}}},un=30,pn=["spring","summer","autumn","winter"],hn=e=>(e-1)%un+1,mn=e=>{const t=Math.floor((e-1)/un)%pn.length;return pn[t]},fn={currentTime:720,timeOfDay:"\u0434\u0435\u043d\u044c",formattedTime:"12:00",weatherType:"\u044f\u0441\u043d\u043e",weatherIntensity:5,weatherEffects:{combat:{damageModifiers:{},hitChanceModifier:1,dodgeChanceModifier:1,critChanceModifier:1,enemySpawnRateModifier:1},cultivation:{elementModifiers:{},meditationEfficiencyModifier:1,breakthroughChanceModifier:1,bottleneckProgressModifier:3},exploration:{movementEnergyCostModifier:1,resourceFindRateModifier:1,resourceQualityModifier:1,hiddenLocationChanceModifier:1,visibilityModifier:1},crafting:{alchemySuccessRateModifier:1,alchemyQualityModifier:1,spiritEnergyConsumptionModifier:1},system:{specialEncounterChance:0,uniqueResourceSpawnChance:0}},activeSpecialEvent:null};r(5513);const yn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Yr.ADD_MARKET_ITEM:return{...e,marketItems:[...e.marketItems,t.payload]};case Yr.REMOVE_MARKET_ITEM:return{...e,marketItems:e.marketItems.filter((e=>e.id!==t.payload.id))};case Yr.UPDATE_MARKET_ITEM:return{...e,marketItems:e.marketItems.map((e=>e.id===t.payload.id?{...e,...t.payload}:e))};case Yr.BUY_MARKET_ITEM:return{...e,marketItems:e.marketItems.filter((e=>e.id!==t.payload.id)),lastUpdated:(new Date).toISOString()};case Yr.SELL_MARKET_ITEM:return{...e,playerItems:[...e.playerItems,t.payload],lastUpdated:(new Date).toISOString()};case Yr.UPDATE_MERCHANT_REPUTATION:return{...e,merchantReputation:{...e.merchantReputation,[t.payload.merchantId]:t.payload.reputation}};case Yr.UPDATE_MARKET_STATE:return t.payload.marketItems?{...e,...t.payload,marketItems:(t.payload.marketItems||[]).map((t=>{if(t.originalPrice&&void 0!==t.discount)return t;const r=e.marketItems?e.marketItems.find((e=>e.itemId===t.itemId&&e.itemType===t.itemType)):null;return r&&r.originalPrice&&void 0!==r.discount?{...t,originalPrice:r.originalPrice,discount:r.discount}:t})),lastUpdated:(new Date).toISOString()}:{...e,...t.payload,lastUpdated:(new Date).toISOString()};default:return e}},gn={sect:null,loading:!1,error:null,userRank:null,privileges:[],benefits:[{type:"cultivation_speed",modifier:0},{type:"resource_gathering",modifier:0},{type:"energy_regen",modifier:0},{type:"technique_discount",modifier:0},{type:"max_energy",modifier:0}],selectedMember:null},vn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gn,t=arguments.length>1?arguments[1]:void 0,r=(0,en.normalizeSectData)(e);switch(t.type){case Yr.NORMALIZE_SECT_DATA:return console.log("\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b"),(0,en.normalizeSectData)(r);case Yr.SET_SECT:if(!t.payload)return e;const n={...t.payload,benefits:(0,en.normalizeSectBenefits)(t.payload.benefits)},a={...e,sect:n,benefits:n.benefits||e.benefits,loading:!1,error:null};return(0,en.normalizeSectData)(a);case Yr.UPDATE_SECT:return{...e,sect:{...e.sect,...t.payload},loading:!1,error:null};case Yr.JOIN_SECT:return{...e,sect:t.payload,loading:!1,error:null};case Yr.LEAVE_SECT:return{...gn};case Yr.CONTRIBUTE_TO_SECT:return{...e,loading:!0,error:null};case`${Yr.CONTRIBUTE_TO_SECT}_SUCCESS`:return{...e,sect:{...e.sect,level:t.payload.newLevel,rank:t.payload.sectRank,experience:t.payload.sectExperience,requiredExperience:t.payload.sectRequiredExperience,influence:t.payload.sectInfluence},loading:!1,error:null};case`${Yr.CONTRIBUTE_TO_SECT}_ERROR`:return{...e,loading:!1,error:t.payload};case Yr.TRAIN_SECT_MEMBER:return{...e,loading:!0,error:null};case`${Yr.TRAIN_SECT_MEMBER}_SUCCESS`:const i=e.sect.members.map((e=>e.id===t.payload.memberId?{...e,level:t.payload.memberLevel,experience:t.payload.memberExperience,requiredExperience:t.payload.memberRequiredExperience,role:t.payload.memberRole,loyalty:t.payload.memberLoyalty}:e));return{...e,sect:{...e.sect,members:i},loading:!1,error:null};case`${Yr.TRAIN_SECT_MEMBER}_ERROR`:return{...e,loading:!1,error:t.payload};case Yr.UPDATE_SECT_MEMBER:const o=e.sect.members.map((e=>e.id===t.payload.id?{...e,...t.payload}:e));return{...e,sect:{...e.sect,members:o},loading:!1,error:null};case Yr.UPDATE_SECT_BENEFITS:const s=(0,en.normalizeSectBenefits)(t.payload);console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u0441\u0435\u043a\u0442\u044b. \u041d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b:",s);const l=e.sect?{...e.sect,benefits:s}:null,c={...e,benefits:s,sect:l,effectsArray:(0,en.normalizeSectBenefits)(s)},d=(0,en.normalizeSectData)(c);return console.log("\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b:",d),d;case Yr.UPDATE_SECT_RANK:return{...e,userRank:t.payload.role,privileges:t.payload.privileges};case"SELECT_SECT_MEMBER":return{...e,selectedMember:t.payload};case Yr.SYNC_SECT_TO_SOCIAL:case Yr.SYNC_SOCIAL_TO_SECT:return e;case Yr.UPDATE_SECT_LOYALTY:return e.sect?(console.log(`\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0441\u0435\u043a\u0442\u044b \u0441 ${e.sect.loyalty} \u043d\u0430 ${t.payload.loyalty}`),{...e,sect:{...e.sect,loyalty:t.payload.loyalty}}):(console.warn("\u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0435\u043a\u0442\u044b, \u043d\u043e \u0441\u0435\u043a\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"),e);case Yr.UPDATE_SECT_DATA:if(!e.sect||!t.payload)return console.warn("\u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0441\u0435\u043a\u0442\u044b, \u043d\u043e \u0441\u0435\u043a\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u0438\u043b\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b"),e;console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b:",t.payload);const u=t.payload.benefits?{...t.payload,benefits:(0,en.normalizeSectBenefits)(t.payload.benefits)}:t.payload,p={...e,sect:{...e.sect,...u}};return(0,en.normalizeSectData)(p);case Yr.UPDATE_RELATIONSHIP_AND_LOYALTY:return t.payload&&t.payload.name&&void 0!==t.payload.value?(console.log(`\ud83d\udd04 \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0435 \u043e\u0431 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 "${t.payload.name}" \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f ${t.payload.value}`),e):(console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0438 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c: \u043d\u0435\u043f\u043e\u043b\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435",t.payload),e);default:return e}},xn={data:{cities:[],factions:[],global:null},features:[],notifications:[],loading:!1,changing:!1,error:null},bn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_REPUTATION_REQUEST":case"CHECK_REPUTATION_FEATURES_REQUEST":return{...e,loading:!0,error:null};case"LOAD_REPUTATION_SUCCESS":return{...e,data:t.payload.reputationData,features:t.payload.availableFeatures,loading:!1,error:null};case"LOAD_REPUTATION_FAILURE":case"CHECK_REPUTATION_FEATURES_FAILURE":return{...e,loading:!1,error:t.payload.error};case"CHANGE_REPUTATION_REQUEST":return{...e,changing:!0,error:null};case"CHANGE_REPUTATION_SUCCESS":{const{userId:r,entityType:n,entityId:a,sphere:i,reputation:o,relatedChanges:s}=t.payload;let l={...e.data};if("city"===n?l.cities=e.data.cities.map((e=>e.id===a?{...e,spheres:e.spheres.map((e=>e.name===i?{...e,value:o.value,level:o.level,title:o.title}:e))}:e)):"faction"===n?l.factions=e.data.factions.map((e=>e.id===a?{...e,spheres:e.spheres.map((e=>e.name===i?{...e,value:o.value,level:o.level,title:o.title}:e))}:e)):"global"===n&&l.global&&(l.global={...l.global,spheres:l.global.spheres.map((e=>e.name===i?{...e,value:o.value,level:o.level,title:o.title}:e))}),s&&s.length>0)for(const e of s)"city"===e.entityType?l.cities=l.cities.map((t=>t.id===e.entityId?{...t,spheres:t.spheres.map((t=>t.name===e.sphere?{...t,value:t.value+e.amount}:t))}:t)):"faction"===e.entityType?l.factions=l.factions.map((t=>t.id===e.entityId?{...t,spheres:t.spheres.map((t=>t.name===e.sphere?{...t,value:t.value+e.amount}:t))}:t)):"global"===e.entityType&&l.global&&(l.global={...l.global,spheres:l.global.spheres.map((t=>t.name===e.sphere?{...t,value:t.value+e.amount}:t))});return{...e,data:l,changing:!1,error:null}}case"CHANGE_REPUTATION_FAILURE":return{...e,changing:!1,error:t.payload.error};case"CHECK_REPUTATION_FEATURES_SUCCESS":return{...e,features:t.payload.availableFeatures,loading:!1,error:null};case"ADD_REPUTATION_NOTIFICATION":return{...e,notifications:[...e.notifications,t.payload.notification]};case"REMOVE_REPUTATION_NOTIFICATION":return{...e,notifications:e.notifications.filter((e=>e.id!==t.payload.id))};case"CLEAR_REPUTATION_NOTIFICATIONS":return{...e,notifications:[]};default:return e}},wn={list:[],currentGroup:null,activities:[],currentActivity:null,activityInstances:[],invitations:[],rewards:[],loading:!1,error:null},_n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Yr.SET_GROUPS:return{...e,list:t.payload};case Yr.SET_CURRENT_GROUP:return{...e,currentGroup:t.payload};case Yr.CREATE_GROUP:return{...e,list:[...e.list,t.payload],currentGroup:t.payload};case Yr.UPDATE_GROUP:return{...e,list:e.list.map((e=>e.id===t.payload.id?t.payload:e)),currentGroup:e.currentGroup&&e.currentGroup.id===t.payload.id?t.payload:e.currentGroup};case Yr.DELETE_GROUP:return{...e,list:e.list.filter((e=>e.id!==t.payload)),currentGroup:e.currentGroup&&e.currentGroup.id===t.payload?null:e.currentGroup};case Yr.JOIN_GROUP:{const{groupId:r,member:n}=t.payload;return{...e,list:e.list.map((e=>e.id===r?{...e,members:[...e.members,n]}:e))}}case Yr.LEAVE_GROUP:{const{groupId:r,userId:n}=t.payload;return{...e,list:e.list.map((e=>e.id===r?{...e,members:e.members.filter((e=>e.userId!==n))}:e))}}case Yr.SET_GROUP_ACTIVITIES:return{...e,activities:t.payload};case Yr.SET_CURRENT_ACTIVITY:return{...e,currentActivity:t.payload};case Yr.CREATE_ACTIVITY_INSTANCE:return{...e,activityInstances:[...e.activityInstances,t.payload],currentActivity:t.payload};case Yr.FETCH_GROUP_ACTIVITY_INSTANCES:return{...e,loading:!0,error:null};case Yr.SET_GROUP_ACTIVITY_INSTANCES:return{...e,activityInstances:t.payload,loading:!1};case Yr.UPDATE_ACTIVITY_INSTANCE:return{...e,activityInstances:e.activityInstances.map((e=>e.id===t.payload.id?t.payload:e)),currentActivity:e.currentActivity&&e.currentActivity.id===t.payload.id?t.payload:e.currentActivity};case Yr.START_ACTIVITY:case Yr.UPDATE_ACTIVITY_PROGRESS:case Yr.COMPLETE_ACTIVITY:case Yr.FAIL_ACTIVITY:case Yr.ABANDON_ACTIVITY:return{...e,activityInstances:e.activityInstances.map((e=>e.id===t.payload.id?t.payload:e))};case Yr.ADD_ACTIVITY_PARTICIPANT:{const{instanceId:r,participant:n}=t.payload;return{...e,activityInstances:e.activityInstances.map((e=>e.id===r?{...e,participants:[...e.participants,n]}:e))}}case Yr.REMOVE_ACTIVITY_PARTICIPANT:{const{instanceId:r,userId:n}=t.payload;return{...e,activityInstances:e.activityInstances.map((e=>e.id===r?{...e,participants:e.participants.filter((e=>e.userId!==n))}:e))}}case Yr.UPDATE_ACTIVITY_REWARDS:{const{instanceId:r,rewards:n}=t.payload;return{...e,activityInstances:e.activityInstances.map((e=>e.id===r?{...e,rewards:n}:e))}}case Yr.ADD_REWARDS:return{...e,rewards:[...e.rewards,...t.payload.filter((e=>!e.isClaimed))]};case Yr.SET_USER_INVITATIONS:return{...e,invitations:t.payload,loading:!1};case Yr.FETCH_USER_INVITATIONS:return{...e,loading:!0};case Yr.RESPOND_TO_INVITATION:return{...e,invitations:e.invitations.filter((e=>e.id!==t.payload.invitationId))};case Yr.SET_ERROR:return{...e,loading:!1,error:t.payload};default:return e}},En=(e,t)=>{let n=e;return n=((e,t)=>{switch(t.type){case Yr.SAVE_GAME:try{const r=JSON.parse(JSON.stringify(e));r.player&&Array.isArray(r.player.techniques)&&(r.player.techniques=r.player.techniques.map((e=>({id:e.id,name:e.name||"",description:e.description||"",type:e.type||"attack",element:e.element||"fire",icon:e.icon||"",level:e.level||1,experience:e.experience||0,masteryLevel:e.masteryLevel||0,energyCost:e.energyCost||10,damage:e.damage||0,damageType:e.damageType||"physical",healing:e.healing||0,cooldown:e.cooldown||0,maxLevel:e.maxLevel||10,lastUsed:e.lastUsed||null,effects:Array.isArray(e.effects)?e.effects:[],requiredLevel:e.requiredLevel||1}))),console.log(`\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043b\u0435\u043d\u043e ${r.player.techniques.length} \u0442\u0435\u0445\u043d\u0438\u043a \u0434\u043b\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f`)),localStorage.setItem("gameState",JSON.stringify(r)),console.log("\u0418\u0433\u0440\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0430 \u0432 localStorage"),t.payload&&"function"===typeof t.payload.onSuccess&&t.payload.onSuccess()}catch(L){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0438\u0433\u0440\u044b:",L),t.payload&&"function"===typeof t.payload.onError&&t.payload.onError(L)}return e;case Yr.LOAD_GAME:{var r,n,a,i,o,s,l,c,d,u,p,h,m,f,y,g,v,x,b,w,_,E,T,S,j,C,k,I,A,N,D,M,R,P;const e=t.payload;console.log("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f:",e),Array.isArray(null===e||void 0===e||null===(r=e.player)||void 0===r?void 0:r.techniques)&&e.player.techniques.length>0&&console.log("\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c\u044b\u0435 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u0434\u043e \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438:",e.player.techniques);const L={...Qr,...e,player:{...Qr.player,...(null===e||void 0===e?void 0:e.player)||{},social:{...Qr.player.social,...(null===e||void 0===e||null===(n=e.player)||void 0===n?void 0:n.social)||{},relationships:(null===e||void 0===e||null===(a=e.player)||void 0===a||null===(i=a.social)||void 0===i?void 0:i.relationships)||{}},progress:{...Qr.player.progress,...(null===e||void 0===e||null===(o=e.player)||void 0===o?void 0:o.progress)||{},discoveries:(null===e||void 0===e||null===(s=e.player)||void 0===s||null===(l=s.progress)||void 0===l?void 0:l.discoveries)||{},quests:{...Qr.player.progress.quests,...(null===e||void 0===e||null===(c=e.player)||void 0===c||null===(d=c.progress)||void 0===d?void 0:d.quests)||{},active:Array.isArray(null===e||void 0===e||null===(u=e.player)||void 0===u||null===(p=u.progress)||void 0===p||null===(h=p.quests)||void 0===h?void 0:h.active)?e.player.progress.quests.active:[],available:Array.isArray(null===e||void 0===e||null===(m=e.player)||void 0===m||null===(f=m.progress)||void 0===f||null===(y=f.quests)||void 0===y?void 0:y.available)?e.player.progress.quests.available:[],completed:Array.isArray(null===e||void 0===e||null===(g=e.player)||void 0===g||null===(v=g.progress)||void 0===v||null===(x=v.quests)||void 0===x?void 0:x.completed)?e.player.progress.quests.completed:[]}},inventory:{...Qr.player.inventory,...(null===e||void 0===e||null===(b=e.player)||void 0===b?void 0:b.inventory)||{},items:Array.isArray(null===e||void 0===e||null===(w=e.player)||void 0===w||null===(_=w.inventory)||void 0===_?void 0:_.items)?e.player.inventory.items:[],equipment:(null===e||void 0===e||null===(E=e.player)||void 0===E||null===(T=E.inventory)||void 0===T?void 0:T.equipment)||{},currency:(null===e||void 0===e||null===(S=e.player)||void 0===S||null===(j=S.inventory)||void 0===j?void 0:j.currency)||0},cultivation:{...Qr.player.cultivation,...(null===e||void 0===e||null===(C=e.player)||void 0===C?void 0:C.cultivation)||{}},techniques:Array.isArray(null===e||void 0===e||null===(k=e.player)||void 0===k?void 0:k.techniques)?e.player.techniques:[],spiritPets:{...Qr.player.spiritPets,...(null===e||void 0===e||null===(I=e.player)||void 0===I?void 0:I.spiritPets)||{},pets:Array.isArray(null===e||void 0===e||null===(A=e.player)||void 0===A||null===(N=A.spiritPets)||void 0===N?void 0:N.pets)?e.player.spiritPets.pets:[],activePetId:(null===e||void 0===e||null===(D=e.player)||void 0===D||null===(M=D.spiritPets)||void 0===M?void 0:M.activePetId)||null}},achievements:{...Qr.achievements,...(null===e||void 0===e?void 0:e.achievements)||{},completed:Array.isArray(null===e||void 0===e||null===(R=e.achievements)||void 0===R?void 0:R.completed)?e.achievements.completed:[]},isLoading:void 0!==(null===e||void 0===e?void 0:e.isLoading)&&e.isLoading,error:(null===e||void 0===e?void 0:e.error)||null,isInitialized:void 0!==(null===e||void 0===e?void 0:e.isInitialized)&&e.isInitialized};return console.log("\u0412\u0430\u043b\u0438\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435:",L),Array.isArray(null===L||void 0===L||null===(P=L.player)||void 0===P?void 0:P.techniques)&&L.player.techniques.length>0&&console.log("\u0422\u0435\u0445\u043d\u0438\u043a\u0438 \u043f\u043e\u0441\u043b\u0435 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438:",L.player.techniques),L}case Yr.SET_INITIALIZED:return{...e,isInitialized:t.payload};case Yr.SET_ERROR:return{...e,error:t.payload};default:return e}})(n,t),"INITIALIZE_WEATHER_STATE"===t.type&&t.payload&&(console.log("\ud83d\udd04 rootReducer: \u041f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c INITIALIZE_WEATHER_STATE"),n=t.payload),n=tn(n,t),n=((e,t)=>{var n,a,i,o,s,l,c,d,u,p,h,m,f,y,g,v,x,b,w,_,E,T,S,j,C,k,I,A,N;switch(t.type){case ln:return console.log("\ud83d\udd0d\ud83d\udd0d worldReducer: \u041f\u043e\u043b\u0443\u0447\u0435\u043d INITIALIZE_WEATHER"),e;case Yr.UPDATE_TIME:console.log("\ud83d\udd0e\ud83d\udd0e\ud83d\udd0e \u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u041e\u0422\u041b\u0410\u0414\u041a\u0410 - \u041f\u041e\u041b\u0423\u0427\u0415\u041d UPDATE_TIME:",{raw_payload:t.payload,raw_day_value:t.payload.day,raw_day_type:typeof t.payload.day,raw_state_day:null===(n=e.world)||void 0===n||null===(a=n.time)||void 0===a?void 0:a.day,raw_state_day_type:typeof(null===(i=e.world)||void 0===i||null===(o=i.time)||void 0===o?void 0:o.day)});const O=void 0!==t.payload.day?Number(t.payload.day):(null===(s=e.world)||void 0===s||null===(l=s.time)||void 0===l?void 0:l.day)||1,q=void 0!==t.payload.hour?Number(t.payload.hour):(null===(c=e.world)||void 0===c||null===(d=c.time)||void 0===d?void 0:d.hour)||0,U=void 0!==t.payload.minute?Number(t.payload.minute):(null===(u=e.world)||void 0===u||null===(p=u.time)||void 0===p?void 0:p.minute)||0;let F=t.payload.season||(null===(h=e.world)||void 0===h||null===(m=h.time)||void 0===m?void 0:m.season)||"spring";const z=void 0!==(null===(f=e.world)||void 0===f||null===(y=f.time)||void 0===y?void 0:y.day)?Number(e.world.time.day):1;console.log("\ud83d\udd52 UPDATE_TIME \u0432 \u0440\u0435\u0434\u044c\u044e\u0441\u0435\u0440\u0435 - \u041f\u041e\u0421\u041b\u0415 \u041f\u0420\u0415\u041e\u0411\u0420\u0410\u0417\u041e\u0412\u0410\u041d\u0418\u042f:",{currentDay:z,newDay:O,parsedNewDay:Number(t.payload.day),newHour:q,newMinute:U,newSeason:F,diff:O-z,actionPayload:t.payload,currentValues:(null===(g=e.world)||void 0===g?void 0:g.time)||"time \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442",conversion_details:{raw:t.payload.day,after_number:Number(t.payload.day),after_parse_int:parseInt(t.payload.day),after_force_num_check:parseFloat(String(t.payload.day).replace(/[^0-9.-]+/g,""))}});let B=!1;O>z?(console.log("\ud83d\udcc5\ud83d\udcc5\ud83d\udcc5 \u0414\u0415\u041d\u042c \u0418\u0417\u041c\u0415\u041d\u0418\u041b\u0421\u042f: "+z+" -> "+O),B=!0):void 0!==t.payload.day&&Number(t.payload.day)<=z&&console.log("\u26a0\ufe0f \u0412\u041d\u0418\u041c\u0410\u041d\u0418\u0415: \u0434\u0435\u043d\u044c \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u0441\u044f \u0438\u043b\u0438 \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u043b\u0441\u044f:",{currentDay:z,newDay:Number(t.payload.day)});const G=60*q+U,W=`${String(q).padStart(2,"0")}:${String(U).padStart(2,"0")}`,H=q>=5&&q<7?"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":q>=7&&q<11?"\u0443\u0442\u0440\u043e":q>=11&&q<14?"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":q>=14&&q<17?"\u0434\u0435\u043d\u044c":q>=17&&q<20?"\u0432\u0435\u0447\u0435\u0440":q>=20&&q<23?"\u043d\u043e\u0447\u044c":"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c";let V,Q;console.log("\ud83d\udd52 \u0416\u0415\u0421\u0422\u041a\u0410\u042f \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u0418\u0417\u0410\u0426\u0418\u042f \u0412 UPDATE_TIME: world.time \u2192 weather",{hour:q,minute:U,day:O,season:F}),O>un?(V=hn(O),Q=mn(O),console.log("\ud83c\udf08 \u0420\u0410\u0421\u0427\u0415\u0422 \u0421\u0415\u0417\u041e\u041d\u0410 \u041f\u0420\u0418 \u041f\u0415\u0420\u0415\u0425\u041e\u0414\u0415 \u0427\u0415\u0420\u0415\u0417 \u041c\u0410\u041a\u0421\u0418\u041c\u0410\u041b\u042c\u041d\u0423\u042e \u0414\u041b\u0418\u041d\u0423:",{"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":O,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":V,"\u0442\u0435\u043a\u0443\u0449\u0438\u0439_\u0441\u0435\u0437\u043e\u043d":F,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":Q,"\u0434\u043b\u0438\u043d\u0430_\u0441\u0435\u0437\u043e\u043d\u0430":un}),V?Q!==F&&(console.log(`\ud83c\udf08\ud83c\udf08 \u0421\u041c\u0415\u041d\u0410 \u0421\u0415\u0417\u041e\u041d\u0410: ${F} -> ${Q} (\u0434\u0435\u043d\u044c \u0441\u0435\u0437\u043e\u043d\u0430: ${V})`),F=Q):(V=1,console.warn("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u044c \u0434\u0435\u043d\u044c \u0441\u0435\u0437\u043e\u043d\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e = 1"))):V=O,console.log("\ud83d\udcc5 \u0418\u0422\u041e\u0413\u041e\u0412\u042b\u0415 \u0417\u041d\u0410\u0427\u0415\u041d\u0418\u042f \u041f\u041e\u0421\u041b\u0415 \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u0418\u0417\u0410\u0426\u0418\u0418 \u0421\u0415\u0417\u041e\u041d\u0410:",{"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":O,"\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":V,"\u0441\u0435\u0437\u043e\u043d":F});let Y=null===(v=e.weather)||void 0===v?void 0:v.nextWeatherChange;const K=null===(x=e.weather)||void 0===x?void 0:x.weatherChangeAt;if(void 0!==K){const e=60*q+U,t=K-e;Y=Math.max(0,t),console.log("\u23f1\ufe0f UPDATE_TIME: \u041f\u0435\u0440\u0435\u0441\u0447\u0435\u0442 nextWeatherChange:",{weatherChangeAt:K,currentAbsoluteMinutes:e,"\u0440\u0430\u0437\u043d\u0438\u0446\u0430":t,"\u043d\u043e\u0432\u043e\u0435_\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435":Y}),0===Y&&console.log("\u26a0\ufe0f UPDATE_TIME: \u0412\u0440\u0435\u043c\u044f \u0434\u043e \u0441\u043c\u0435\u043d\u044b \u043f\u043e\u0433\u043e\u0434\u044b \u0440\u0430\u0432\u043d\u043e 0, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0433\u043e\u0434\u0443")}else console.log("\u26a0\ufe0f UPDATE_TIME: weatherChangeAt \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442, nextWeatherChange \u043d\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d");const X={...e.weather,currentTime:G,formattedTime:W,hour:q,minute:U,dayCount:O,seasonDay:V,currentSeason:F,timeOfDay:H,isDayTime:q>=6&&q<20,nextWeatherChange:Y};return{...e,world:{...e.world,time:{...e.world.time,...t.payload,hour:q,minute:U,day:O,season:F}},weather:X};case Yr.UPDATE_WEATHER:return{...e,world:{...e.world,weather:t.payload}};case rn:console.log("\ud83c\udf24\ufe0f UPDATE_WEATHER \u0432 \u0440\u0435\u0434\u044c\u044e\u0441\u0435\u0440\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b:",{"\u0442\u0435\u043a\u0443\u0449\u0430\u044f_\u043f\u043e\u0433\u043e\u0434\u0430":t.payload.currentWeather,"\u0438\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c":t.payload.weatherIntensity,"\u0432\u0440\u0435\u043c\u044f_\u0434\u043e_\u0441\u043c\u0435\u043d\u044b":t.payload.nextWeatherChange,"\u0435\u0441\u0442\u044c_\u043f\u0440\u043e\u0433\u043d\u043e\u0437":Boolean(t.payload.forecast)});let J=t.payload.nextWeatherChange;void 0===t.payload.nextWeatherChange||"number"===typeof t.payload.nextWeatherChange&&!isNaN(t.payload.nextWeatherChange)||(console.warn("\u26a0\ufe0f nextWeatherChange \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0447\u0438\u0441\u043b\u043e\u043c:",t.payload.nextWeatherChange),J=parseInt(t.payload.nextWeatherChange,10),isNaN(J)&&(J=60));let Z=(null===(b=e.weather)||void 0===b?void 0:b.seasonDay)||1;const ee=null===(w=e.world)||void 0===w||null===(_=w.time)||void 0===_?void 0:_.day;return void 0!==ee&&(ee>un?(Z=(ee-1)%un+1,console.log("\ud83c\udf08 UPDATE_WEATHER: \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u043d\u044f \u0441\u0435\u0437\u043e\u043d\u0430 \u043f\u0440\u0438 \u0434\u043b\u0438\u043d\u0435 > SEASON_LENGTH:",{worldDay:ee,correctSeasonDay:Z,"\u0444\u043e\u0440\u043c\u0443\u043b\u0430":`((${ee} - 1) % 30) + 1`})):(Z=ee,console.log("\ud83c\udf08 UPDATE_WEATHER: \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u043d\u044f \u0441\u0435\u0437\u043e\u043d\u0430 \u0432 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445 \u0441\u0435\u0437\u043e\u043d\u0430:",{worldDay:ee,correctSeasonDay:Z}))),Z<=0&&(console.log("\u26a0\ufe0f UPDATE_WEATHER: \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d \u043d\u0443\u043b\u0435\u0432\u043e\u0439 \u0438\u043b\u0438 \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0434\u0435\u043d\u044c \u0441\u0435\u0437\u043e\u043d\u0430, \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u0430 1"),Z=1),{...e,weather:{...e.weather,...t.payload,nextWeatherChange:J,seasonDay:Z}};case nn:return{...e,weather:{...e.weather,timeOfDay:t.payload.timeOfDay}};case an:return{...e,weather:{...e.weather,activeSpecialEvent:{type:t.payload.eventType,data:t.payload.eventData}}};case on:return e;case"DIRECT_UPDATE_WEATHER_TIME":console.log("\u26a1 \u0420\u0435\u0434\u044c\u044e\u0441\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 DIRECT_UPDATE_WEATHER_TIME:",{...t.payload,dayCountType:typeof t.payload.dayCount,currentDayType:typeof(null===(E=e.weather)||void 0===E?void 0:E.dayCount)});const te=void 0!==t.payload.dayCount?Number(t.payload.dayCount):(null===(T=e.weather)||void 0===T?void 0:T.dayCount)||1,re=t.payload.currentSeason||(null===(S=e.weather)||void 0===S?void 0:S.currentSeason)||"spring";let ne,ae=re;return te>un?(ne=hn(te),ae=mn(te),console.log("\ud83c\udf08 DIRECT_UPDATE_WEATHER_TIME: \u0420\u0410\u0421\u0427\u0415\u0422 \u0421\u0415\u0417\u041e\u041d\u0410:",{"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":te,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":ne,"\u0442\u0435\u043a\u0443\u0449\u0438\u0439_\u0441\u0435\u0437\u043e\u043d":re,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":ae}),ae!==re&&console.log(`\ud83c\udf08\ud83c\udf08 DIRECT_UPDATE_WEATHER_TIME: \u041a\u041e\u0420\u0420\u0415\u041a\u0426\u0418\u042f \u0421\u0415\u0417\u041e\u041d\u0410: ${re} -> ${ae}`)):ne=te,console.log("\ud83d\udd04 DIRECT_UPDATE_WEATHER_TIME - \u041f\u043e\u043b\u043d\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f weather \u0441 worldTime:",{hour:t.payload.hour,minute:t.payload.minute,dayCount:te,seasonDay:ne,season:ae}),ae!==re&&null!==(j=e.world)&&void 0!==j&&j.time?(console.log(`\ud83c\udf08 DIRECT_UPDATE_WEATHER_TIME: \u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u0441\u0435\u0437\u043e\u043d \u0432 world.time: ${re} -> ${ae}`),{...e,world:{...e.world,time:{...e.world.time,season:ae}},weather:{...e.weather,currentTime:t.payload.currentTime,formattedTime:t.payload.formattedTime,hour:t.payload.hour,minute:t.payload.minute,dayCount:te,seasonDay:ne,currentSeason:ae,timeOfDay:t.payload.hour>=5&&t.payload.hour<7?"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":t.payload.hour>=7&&t.payload.hour<11?"\u0443\u0442\u0440\u043e":t.payload.hour>=11&&t.payload.hour<14?"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":t.payload.hour>=14&&t.payload.hour<17?"\u0434\u0435\u043d\u044c":t.payload.hour>=17&&t.payload.hour<20?"\u0432\u0435\u0447\u0435\u0440":t.payload.hour>=20&&t.payload.hour<23?"\u043d\u043e\u0447\u044c":"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c",isDayTime:t.payload.hour>=6&&t.payload.hour<20}}):{...e,weather:{...e.weather,currentTime:t.payload.currentTime,formattedTime:t.payload.formattedTime,hour:t.payload.hour,minute:t.payload.minute,dayCount:te,seasonDay:ne,currentSeason:ae,timeOfDay:t.payload.hour>=5&&t.payload.hour<7?"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":t.payload.hour>=7&&t.payload.hour<11?"\u0443\u0442\u0440\u043e":t.payload.hour>=11&&t.payload.hour<14?"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":t.payload.hour>=14&&t.payload.hour<17?"\u0434\u0435\u043d\u044c":t.payload.hour>=17&&t.payload.hour<20?"\u0432\u0435\u0447\u0435\u0440":t.payload.hour>=20&&t.payload.hour<23?"\u043d\u043e\u0447\u044c":"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c",isDayTime:t.payload.hour>=6&&t.payload.hour<20}};case"DIRECT_FORCE_SYNC_WEATHER_TIME":if(null===(C=e.world)||void 0===C||!C.time||!e.weather)return console.log("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c DIRECT_FORCE_SYNC_WEATHER_TIME: \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 world.time \u0438\u043b\u0438 weather"),e;console.log("\ud83d\udd04\ud83d\udd04 \u041f\u0420\u0418\u041d\u0423\u0414\u0418\u0422\u0415\u041b\u042c\u041d\u0410\u042f \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u0418\u0417\u0410\u0426\u0418\u042f weather \u27f8 world.time");const ie=Number(e.world.time.hour),oe=Number(e.world.time.minute),se=Number(e.world.time.day),le=e.world.time.season,ce=60*ie+oe,de=`${String(ie).padStart(2,"0")}:${String(oe).padStart(2,"0")}`,ue=ie>=5&&ie<7?"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":ie>=7&&ie<11?"\u0443\u0442\u0440\u043e":ie>=11&&ie<14?"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":ie>=14&&ie<17?"\u0434\u0435\u043d\u044c":ie>=17&&ie<20?"\u0432\u0435\u0447\u0435\u0440":ie>=20&&ie<23?"\u043d\u043e\u0447\u044c":"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c";let pe,he=le;return se>un?(pe=hn(se),he=mn(se),console.log("\ud83c\udf08 FORCE_SYNC: \u0420\u0410\u0421\u0427\u0415\u0422 \u0421\u0415\u0417\u041e\u041d\u0410 \u041f\u0420\u0418 \u041f\u0415\u0420\u0415\u0425\u041e\u0414\u0415 \u0427\u0415\u0420\u0415\u0417 \u041c\u0410\u041a\u0421\u0418\u041c\u0410\u041b\u042c\u041d\u0423\u042e \u0414\u041b\u0418\u041d\u0423:",{"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":se,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":pe,"\u0442\u0435\u043a\u0443\u0449\u0438\u0439_\u0441\u0435\u0437\u043e\u043d":le,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":he,"\u0434\u043b\u0438\u043d\u0430_\u0441\u0435\u0437\u043e\u043d\u0430":un}),he&&he!==le&&console.log(`\ud83c\udf08\ud83c\udf08 FORCE_SYNC: \u041e\u0411\u041d\u0410\u0420\u0423\u0416\u0415\u041d\u041e \u041d\u0415\u0421\u041e\u041e\u0422\u0412\u0415\u0422\u0421\u0422\u0412\u0418\u0415 \u0421\u0415\u0417\u041e\u041d\u0410: ${le} -> ${he}`)):pe=se,console.log("\ud83d\udd04 FORCE_SYNC: \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445:",{from:{hour:ie,minute:oe,day:se,season:le},to:{currentTime:ce,formattedTime:de,hour:ie,minute:oe,dayCount:se,seasonDay:pe,timeOfDay:ue,isDayTime:ie>=6&&ie<20,currentSeason:he}}),{...e,world:{...e.world,time:{...e.world.time,season:he}},weather:{...e.weather,currentTime:ce,formattedTime:de,hour:ie,minute:oe,dayCount:se,seasonDay:pe,timeOfDay:ue,isDayTime:ie>=6&&ie<20,currentSeason:he}};case"SYNC_SEASON_DAY":if(null===(k=e.world)||void 0===k||!k.time||!e.weather)return console.log("\u26a0\ufe0f \u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c SYNC_SEASON_DAY: \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 world.time \u0438\u043b\u0438 weather"),e;const me=Number(e.world.time.day),fe=e.weather.seasonDay||1;let ye;return me>un?(ye=(me-1)%un+1,console.log("\ud83d\udd04 SYNC_SEASON_DAY: \u041a\u043e\u0440\u0440\u0435\u043a\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u0434\u043d\u044f \u0441\u0435\u0437\u043e\u043d\u0430 \u0434\u043b\u044f \u0434\u043d\u044f > SEASON_LENGTH:",{worldDay:me,currentSeasonDay:fe,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439\u0414\u0435\u043d\u044c\u0421\u0435\u0437\u043e\u043d\u0430":ye,"\u0444\u043e\u0440\u043c\u0443\u043b\u0430":`((${me} - 1) % 30) + 1 = ${ye}`})):(ye=me,console.log("\ud83d\udd04 SYNC_SEASON_DAY: \u0414\u0435\u043d\u044c \u0432 \u043f\u0440\u0435\u0434\u0435\u043b\u0430\u0445 \u0441\u0435\u0437\u043e\u043d\u0430:",{worldDay:me,currentSeasonDay:fe})),{...e,weather:{...e.weather,seasonDay:ye}};case"FORCE_WEATHER_CHANGE":if(console.log("\ud83c\udf24\ufe0f Reducer: \u043f\u043e\u043b\u0443\u0447\u0435\u043d FORCE_WEATHER_CHANGE"),!e.weather)return console.error("\u274c FORCE_WEATHER_CHANGE: state.weather \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442"),e;try{var D,M,R,P,L;const t=new(r(4953).default),n=60*((null===(D=e.world)||void 0===D||null===(M=D.time)||void 0===M?void 0:M.hour)||e.weather.hour||0)+((null===(R=e.world)||void 0===R||null===(P=R.time)||void 0===P?void 0:P.minute)||e.weather.minute||0),a=t.forceWeatherChange(e.weather,null===(L=e.world)||void 0===L?void 0:L.currentLocation);void 0===a.weatherChangeAt&&void 0!==a.nextWeatherChange?(a.weatherChangeAt=n+a.nextWeatherChange,console.log("\u26a0\ufe0f FORCE_WEATHER_CHANGE: weatherChangeAt \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442, \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c:",{currentAbsoluteMinutes:n,nextWeatherChange:a.nextWeatherChange,weatherChangeAt:a.weatherChangeAt})):void 0!==a.weatherChangeAt&&void 0===a.nextWeatherChange&&(a.nextWeatherChange=Math.max(0,a.weatherChangeAt-n),console.log("\u26a0\ufe0f FORCE_WEATHER_CHANGE: nextWeatherChange \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442, \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c:",{currentAbsoluteMinutes:n,weatherChangeAt:a.weatherChangeAt,nextWeatherChange:a.nextWeatherChange}));const i="number"===typeof a.nextWeatherChange&&!isNaN(a.nextWeatherChange),o="number"===typeof a.weatherChangeAt&&!isNaN(a.weatherChangeAt);return i&&o||(console.error("\u26a0\ufe0f FORCE_WEATHER_CHANGE: \u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0441\u0447\u0435\u0442\u0447\u0438\u043a\u043e\u0432 \u043f\u043e\u0433\u043e\u0434\u044b:",{nextWeatherChange:a.nextWeatherChange,weatherChangeAt:a.weatherChangeAt}),i||(a.nextWeatherChange=60),o||(a.weatherChangeAt=n+60)),console.log("\u2705 FORCE_WEATHER_CHANGE: \u043f\u043e\u0433\u043e\u0434\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430",{"\u043d\u043e\u0432\u0430\u044f_\u043f\u043e\u0433\u043e\u0434\u0430":a.currentWeather,"\u0438\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c":a.weatherIntensity,"\u0432\u0440\u0435\u043c\u044f_\u0434\u043e_\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439_\u0441\u043c\u0435\u043d\u044b":a.nextWeatherChange,"\u0430\u0431\u0441\u043e\u043b\u044e\u0442\u043d\u043e\u0435_\u0432\u0440\u0435\u043c\u044f_\u0441\u043c\u0435\u043d\u044b":a.weatherChangeAt}),{...e,weather:a}}catch($){return console.error("\u274c FORCE_WEATHER_CHANGE: \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u043e\u0433\u043e\u0434\u044b",$),e}case"UPDATE_TIME_MULTIPLIER":return console.log("\u23f1\ufe0f Reducer: \u043f\u043e\u043b\u0443\u0447\u0435\u043d UPDATE_TIME_MULTIPLIER \u0441 multiplier =",null===(I=t.payload)||void 0===I?void 0:I.multiplier),e;case"FIX_WEATHER_MINUTES":if(!e.weather||void 0===(null===(A=t.payload)||void 0===A?void 0:A.minute))return console.log("\u26a0\ufe0f FIX_WEATHER_MINUTES: \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043c\u0438\u043d\u0443\u0442\u044b, \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0434\u0430\u043d\u043d\u044b\u0435"),e;console.log("\ud83d\udd27 \u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f FIX_WEATHER_MINUTES: \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043c\u0438\u043d\u0443\u0442",{currentMinute:e.weather.minute,newMinute:t.payload.minute,minuteType:typeof t.payload.minute});const ge=parseInt(t.payload.minute,10);if(isNaN(ge))return console.error("\u26a0\ufe0f FIX_WEATHER_MINUTES: \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u044c minute \u0432 \u0447\u0438\u0441\u043b\u043e",t.payload.minute),e;const ve=void 0!==e.weather.hour?parseInt(e.weather.hour,10):0,xe=60*ve+ge,be=`${String(ve).padStart(2,"0")}:${String(ge).padStart(2,"0")}`;return console.log("\u2705 FIX_WEATHER_MINUTES: \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u043c\u0438\u043d\u0443\u0442\u044b",{hour:ve,newMinute:ge,newTotalMinutes:xe,newFormattedTime:be}),{...e,weather:{...e.weather,minute:ge,currentTime:xe,formattedTime:be}};case"DIRECT_ADD_GAME_HOURS":if(null===(N=e.world)||void 0===N||!N.time)return console.error("\u274c DIRECT_ADD_GAME_HOURS: state.world.time \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442"),e;console.log(`\ud83d\udd52 DIRECT_ADD_GAME_HOURS: \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 ${t.payload.hours} \u0438\u0433\u0440\u043e\u0432\u044b\u0445 \u0447\u0430\u0441\u043e\u0432`);const we=Number(e.world.time.hour),_e=Number(e.world.time.minute),Ee=Number(e.world.time.day),Te=e.world.time.season;let Se=we+t.payload.hours,je=_e,Ce=Ee;for(;Se>=24;)Se-=24,Ce+=1;const ke=60*Se+je,Ie=`${String(Se).padStart(2,"0")}:${String(je).padStart(2,"0")}`,Ae=Se>=5&&Se<7?"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":Se>=7&&Se<11?"\u0443\u0442\u0440\u043e":Se>=11&&Se<14?"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":Se>=14&&Se<17?"\u0434\u0435\u043d\u044c":Se>=17&&Se<20?"\u0432\u0435\u0447\u0435\u0440":Se>=20&&Se<23?"\u043d\u043e\u0447\u044c":"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c";Ce>Ee&&console.log(`\ud83d\udcc5\ud83d\udcc5\ud83d\udcc5 \u0414\u0415\u041d\u042c \u0418\u0417\u041c\u0415\u041d\u0418\u041b\u0421\u042f \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0447\u0430\u0441\u043e\u0432: ${Ee} -> ${Ce}`);let Ne,De=Te;Ce>un?(Ne=hn(Ce),De=mn(Ce),console.log("\ud83c\udf08 DIRECT_ADD_GAME_HOURS: \u0420\u0410\u0421\u0427\u0415\u0422 \u0421\u0415\u0417\u041e\u041d\u0410 \u041f\u0420\u0418 \u041f\u0415\u0420\u0415\u0425\u041e\u0414\u0415 \u0427\u0415\u0420\u0415\u0417 \u041c\u0410\u041a\u0421\u0418\u041c\u0410\u041b\u042c\u041d\u0423\u042e \u0414\u041b\u0418\u041d\u0423:",{"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":Ce,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":Ne,"\u0442\u0435\u043a\u0443\u0449\u0438\u0439_\u0441\u0435\u0437\u043e\u043d":Te,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":De,"\u0434\u043b\u0438\u043d\u0430_\u0441\u0435\u0437\u043e\u043d\u0430":un}),De!==Te&&console.log(`\ud83c\udf08\ud83c\udf08 DIRECT_ADD_GAME_HOURS: \u0421\u041c\u0415\u041d\u0410 \u0421\u0415\u0417\u041e\u041d\u0410: ${Te} -> ${De}`)):Ne=Ce;const Me={...e.weather,currentTime:ke,formattedTime:Ie,hour:Se,minute:je,dayCount:Ce,seasonDay:Ne,currentSeason:De,timeOfDay:Ae,isDayTime:Se>=6&&Se<20};return console.log("\u2705 DIRECT_ADD_GAME_HOURS: \u041d\u043e\u0432\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u0438:",{"\u0447\u0430\u0441":Se,"\u043c\u0438\u043d\u0443\u0442\u0430":je,"\u0434\u0435\u043d\u044c":Ce,"\u0441\u0435\u0437\u043e\u043d":De,"\u043f\u0435\u0440\u0438\u043e\u0434_\u0441\u0443\u0442\u043e\u043a":Ae}),{...e,world:{...e.world,time:{...e.world.time,hour:Se,minute:je,day:Ce,season:De}},weather:Me};case Yr.ADD_EVENT:return{...e,world:{...e.world,events:[...e.world.events,t.payload]}};case Yr.REMOVE_EVENT:return{...e,world:{...e.world,events:e.world.events.filter((e=>e.id!==t.payload))}};case Yr.CACHE_GENERATED_ENEMY:const{areaId:Re,enemyId:Pe,enemy:Le}=t.payload,$e=`${Re}_${Pe}`;return console.log(`\ud83c\udfae \u041a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430: ${$e}`,{"\u0443\u0440\u043e\u0432\u0435\u043d\u044c":Le.level,requiredLevel:Le.requiredLevel}),{...e,world:{...e.world,generatedEnemies:{...e.world.generatedEnemies||{},[$e]:Le}}};default:return e}})(n,t),n=((e,t)=>{switch(t.type){case Yr.CHANGE_SCREEN:return{...e,ui:{...e.ui,currentScreen:t.payload}};case Yr.ADD_NOTIFICATION:const r=Date.now(),n={...t.payload,id:t.payload.id||`notification_${r}_${Math.random().toString(36).substr(2,9)}`,timestamp:r};if(e.ui.notifications.some((e=>e.message===n.message&&e.timestamp&&r-e.timestamp<3e3)))return e;const a=[...e.ui.notifications,n].slice(-10);return{...e,ui:{...e.ui,notifications:a}};case Yr.REMOVE_NOTIFICATION:return{...e,ui:{...e.ui,notifications:e.ui.notifications.filter((e=>e.id!==t.payload))}};case Yr.UPDATE_SETTINGS:return{...e,ui:{...e.ui,settings:{...e.ui.settings,...t.payload}}};default:return e}})(n,t),n=((e,t)=>{switch(t.type){case Yr.START_COMBAT:return{...e,combat:{inCombat:!0,enemy:t.payload,log:[],turn:1}};case Yr.END_COMBAT:return{...e,combat:{...e.combat,inCombat:!1,enemy:null}};case Yr.UPDATE_COMBAT:return{...e,combat:{...e.combat,...t.payload}};case Yr.ADD_COMBAT_LOG:return{...e,combat:{...e.combat,log:[...e.combat.log,t.payload]}};case Yr.USE_TECHNIQUE:return{...e,combat:{...e.combat,log:[...e.combat.log,{message:`\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0430 \u0442\u0435\u0445\u043d\u0438\u043a\u0430: ${t.payload.name}`,timestamp:(new Date).toISOString()}]}};default:return e}})(n,t),n=((e,t)=>{switch(t.type){case Yr.ACCEPT_QUEST:{const r=e.player.progress.quests.available.find((e=>e.id===t.payload));return r?{...e,player:{...e.player,progress:{...e.player.progress,quests:{...e.player.progress.quests,available:e.player.progress.quests.available.filter((e=>e.id!==t.payload)),active:[...e.player.progress.quests.active,{...r,status:"active",startedAt:(new Date).toISOString()}]}}}}:e}case Yr.COMPLETE_QUEST:{const n=e.player.progress.quests.active.find((e=>e.id===t.payload));if(!n)return e;if(!n.objectives.every((e=>e.completed)))return e;const a=n.rewards.reduce((async(e,t)=>{const n=await e;switch(t.type){case"experience":return{...n,player:{...n.player,cultivation:{...n.player.cultivation,experience:n.player.cultivation.experience+t.amount}}};case"currency":let e={...n.player.inventory.currency||{}};return console.log("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u043d\u0430\u0433\u0440\u0430\u0434\u044b \u0432\u0430\u043b\u044e\u0442\u043e\u0439:",t.amount),"number"===typeof t.amount?e.gold=(e.gold||0)+t.amount:"object"===typeof t.amount&&Object.entries(t.amount).forEach((t=>{let[r,n]=t;"number"===typeof n&&(e[r]=(e[r]||0)+n)})),{...n,player:{...n.player,inventory:{...n.player.inventory,currency:e}}};case"item":return{...n,player:{...n.player,inventory:{...n.player.inventory,items:[...n.player.inventory.items,t]}}};case"technique":try{const e=r(8543),a=await e.getTechniqueByName(t.name);return n.player.techniques.some((e=>e.id===a.techniqueId))?n:{...n,player:{...n.player,techniques:[...n.player.techniques,{id:a.techniqueId,level:1,experience:0}]},ui:{...n.ui,notifications:[...n.ui.notifications,{id:Date.now()+Math.random(),message:`\u0412\u044b \u0438\u0437\u0443\u0447\u0438\u043b\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u0443 "${a.name}"!`,type:"success"}]}}}catch(a){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 "${t.name}":`,a),n}default:return n}}),Promise.resolve(e));return{...(async()=>await a)(),player:{...e.player,progress:{...e.player.progress,quests:{...e.player.progress.quests,active:e.player.progress.quests.active.filter((e=>e.id!==t.payload)),completed:[...e.player.progress.quests.completed,{...n,status:"completed",completedAt:(new Date).toISOString()}]}},ui:{...e.ui,notifications:[...e.ui.notifications,{id:Date.now(),message:`\u0417\u0430\u0434\u0430\u043d\u0438\u0435 "${n.title}" \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e!`,type:"success"}]}}}}case Yr.UPDATE_QUEST_OBJECTIVE:{const{questId:r,objectiveId:n}=t.payload;return{...e,player:{...e.player,progress:{...e.player.progress,quests:{...e.player.progress.quests,active:e.player.progress.quests.active.map((e=>e.id===r?{...e,objectives:e.objectives.map((e=>e.id===n?{...e,completed:!0}:e))}:e))}}}}}default:return e}})(n,t),n=((e,t)=>{switch(t.type){case Yr.CHECK_ACHIEVEMENTS:{const r=navigator.userAgent,d=r.match(/chrome|chromium|crios/i)&&!r.match(/opr\//i)&&!r.match(/edg/i);console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0439 \u0432 \u0440\u0435\u0434\u044c\u044e\u0441\u0435\u0440\u0435, \u0431\u0440\u0430\u0443\u0437\u0435\u0440 Chrome:",d);const{achievements:u}=t.payload;if(console.log("\u041d\u0430\u0447\u0430\u043b\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0439 \u0432 \u0440\u0435\u0434\u044c\u044e\u0441\u0435\u0440\u0435:",{achievements:u}),!Array.isArray(u))return console.error("\u0414\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f \u043d\u0435 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c:",u),e;try{if(null===e||void 0===e||!e.player)return console.error("\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 player \u0432 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438"),e;let t;var n,a,i,o,s,l;t=d?{...e,player:{...e.player,social:{...e.player.social||{},relationships:null!==(n=e.player.social)&&void 0!==n&&n.relationships?{...e.player.social.relationships}:{}},progress:{...e.player.progress||{},discoveries:null!==(a=e.player.progress)&&void 0!==a&&a.discoveries?{...e.player.progress.discoveries}:{}},inventory:{...e.player.inventory||{},currency:(null===(i=e.player.inventory)||void 0===i?void 0:i.currency)||{copper:0,silver:0,gold:0,spiritStones:0}}}}:{...e,player:{...e.player,social:{...e.player.social||{},relationships:(null===(o=e.player.social)||void 0===o?void 0:o.relationships)||{}},progress:{...e.player.progress||{},discoveries:(null===(s=e.player.progress)||void 0===s?void 0:s.discoveries)||{}},inventory:{...e.player.inventory||{},currency:(null===(l=e.player.inventory)||void 0===l?void 0:l.currency)||{copper:0,silver:0,gold:0,spiritStones:0}}}},console.log("\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0434\u043b\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0432 \u0440\u0435\u0434\u044c\u044e\u0441\u0435\u0440\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043e");const r=[];for(let n=0;n<u.length;n++){const a=u[n];console.log(`\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f #${n}:`,{id:null===a||void 0===a?void 0:a.id,title:null===a||void 0===a?void 0:a.title});try{if(!a||"object"!==typeof a){console.warn("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0435:",a);continue}const n="function"===typeof a.condition;if(!n){console.warn("\u0423 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u0443\u043d\u043a\u0446\u0438\u044f condition:",a);continue}console.log(`\u0412\u044b\u0437\u043e\u0432 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 condition \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f ${a.id}`);const i=a.condition(t);console.log(`\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f ${a.id}:`,i);const o=!e.achievements.completed.find((e=>e.id===a.id));console.log("\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438:",{id:null===a||void 0===a?void 0:a.id,hasCondition:n,conditionResult:i,isNotCompleted:o}),n&&i&&o&&r.push(a)}catch(c){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f ${null===a||void 0===a?void 0:a.id}:`,c)}}return console.log("\u041d\u043e\u0432\u044b\u0435 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f:",r),0===r.length?(console.log("\u041d\u0435\u0442 \u043d\u043e\u0432\u044b\u0445 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0439"),e):r.reduce(((e,t)=>null!==t&&void 0!==t&&t.rewards&&Array.isArray(t.rewards)?(e.ui.notifications.push({id:Date.now()+Math.random(),message:`\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0435: ${t.title||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e\u0435 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0435"}!`,type:"achievement"}),t.rewards.forEach((t=>{if(null!==t&&void 0!==t&&t.type)try{switch(t.type){case"experience":e.player.cultivation.experience+=t.amount||0;break;case"currency":if("number"===typeof e.player.inventory.currency)e.player.inventory.currency+=t.amount||0;else if("object"===typeof e.player.inventory.currency&&null!==e.player.inventory.currency){const r=t.amount||0;t.currencyType?e.player.inventory.currency[t.currencyType]=(e.player.inventory.currency[t.currencyType]||0)+r:r>=1e3?e.player.inventory.currency.gold=(e.player.inventory.currency.gold||0)+r:r>=10?e.player.inventory.currency.silver=(e.player.inventory.currency.silver||0)+r:e.player.inventory.currency.copper=(e.player.inventory.currency.copper||0)+r,console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0432\u0430\u043b\u044e\u0442\u0430 \u0437\u0430 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0435:",{"\u0442\u0438\u043f":t.currencyType||(r>=1e3?"gold":r>=10?"silver":"copper"),"\u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e":r,"\u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0435\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435":e.player.inventory.currency})}break;case"item":t.name&&e.player.inventory.items.push(t);break;case"reputation":e.player.reputation=(e.player.reputation||0)+(t.amount||0);break;case"technique":t.name&&e.player.techniques.push(t)}}catch(c){console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u043d\u0430\u0433\u0440\u0430\u0434\u044b ${t.type}:`,c)}else console.warn("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0430\u044f \u043d\u0430\u0433\u0440\u0430\u0434\u0430:",t)})),e):(console.warn("\u0423 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u043d\u0430\u0433\u0440\u0430\u0434\u044b:",t),e)),{...e,achievements:{...e.achievements,completed:[...e.achievements.completed,...r],points:e.achievements.points+r.reduce(((e,t)=>e+(t.rewards||[]).reduce(((e,t)=>e+((null===t||void 0===t?void 0:t.amount)||0)),0)),0)},ui:{...e.ui,notifications:[...e.ui.notifications]}})}catch(c){return console.error("\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0439:",c),e}}case Yr.COMPLETE_ACHIEVEMENT:{const n=t.payload;if(e.achievements.completed.find((e=>e.id===n.id)))return e;const a=n.rewards.reduce((async(e,t)=>{const n=await e;switch(t.type){case"experience":return{...n,player:{...n.player,cultivation:{...n.player.cultivation,experience:n.player.cultivation.experience+t.amount}}};case"currency":return{...n,player:{...n.player,inventory:{...n.player.inventory,currency:"number"===typeof n.player.inventory.currency?n.player.inventory.currency+t.amount:{...n.player.inventory.currency,...t.currencyType?{[t.currencyType]:(n.player.inventory.currency[t.currencyType]||0)+(t.amount||0)}:t.amount>=1e3?{gold:(n.player.inventory.currency.gold||0)+(t.amount||0)}:t.amount>=10?{silver:(n.player.inventory.currency.silver||0)+(t.amount||0)}:{copper:(n.player.inventory.currency.copper||0)+(t.amount||0)}}}}};case"item":return{...n,player:{...n.player,inventory:{...n.player.inventory,items:[...n.player.inventory.items,t]}}};case"technique":try{const e=r(8543),a=await e.getTechniqueByName(t.name);return n.player.techniques.some((e=>e.id===a.techniqueId))?n:{...n,player:{...n.player,techniques:[...n.player.techniques,{id:a.techniqueId,level:1,experience:0}]},ui:{...n.ui,notifications:[...n.ui.notifications,{id:Date.now()+Math.random(),message:`\u0412\u044b \u0438\u0437\u0443\u0447\u0438\u043b\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u0443 "${a.name}"!`,type:"success"}]}}}catch(c){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u0438 "${t.name}":`,c),n}default:return n}}),Promise.resolve({...e,achievements:{...e.achievements,completed:[...e.achievements.completed,n],points:e.achievements.points+n.rewards.reduce(((e,t)=>e+(t.amount||0)),0)},ui:{...e.ui,notifications:[...e.ui.notifications,{id:Date.now()+Math.random(),message:`\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0435: ${n.title}!`,type:"achievement"}]}}));return(async()=>await a)()}default:return e}})(n,t),n=((e,t)=>{var r,n,a,i,o,s,l,c,d,u,p,h;switch(t.type){case Yr.ADD_SPIRIT_PET:const k=(null===(r=e.player)||void 0===r||null===(n=r.spiritPets)||void 0===n?void 0:n.pets)||[];return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:[...k,t.payload]}}};case Yr.REMOVE_SPIRIT_PET:return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:((null===(a=e.player)||void 0===a||null===(i=a.spiritPets)||void 0===i?void 0:i.pets)||[]).filter((e=>e.id!==t.payload)),activePetId:(null===(o=e.player)||void 0===o||null===(s=o.spiritPets)||void 0===s?void 0:s.activePetId)===t.payload?null:null===(l=e.player)||void 0===l||null===(c=l.spiritPets)||void 0===c?void 0:c.activePetId}}};case Yr.UPDATE_SPIRIT_PET:return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:((null===(d=e.player)||void 0===d||null===(u=d.spiritPets)||void 0===u?void 0:u.pets)||[]).map((e=>e.id===t.payload.id?{...e,...t.payload.updates}:e))}}};case Yr.SET_ACTIVE_SPIRIT_PET:const I=((null===(p=e.player)||void 0===p||null===(h=p.spiritPets)||void 0===h?void 0:h.pets)||[]).map((e=>({...e,isActive:e.id===t.payload})));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:I,activePetId:t.payload}}};case Yr.FEED_SPIRIT_PET:{var m,f;const r=t.payload.petId||t.payload.id,n=t.payload.foodItemId,a=t.payload.foodItem;if(!r)return e;const i=(null===(m=e.player)||void 0===m||null===(f=m.spiritPets)||void 0===f?void 0:f.pets)||[],o=i.find((e=>e.id===r));if(!o)return e;if(n){var y,g;const t=(null===(y=e.player)||void 0===y||null===(g=y.inventory)||void 0===g?void 0:g.items)||[],a=t.find((e=>e.id===n&&"pet_food"===e.type&&e.quantity>0));if(!a)return console.log(`\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u043f\u0438\u0442\u0430\u043d\u0438\u044f \u0441 ID ${n} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u0435`),e;const s={...o,hunger:Math.min(o.hunger+(void 0!==a.nutritionValue?a.nutritionValue:25),100),loyalty:Math.min(o.loyalty+(void 0!==a.loyaltyBonus?a.loyaltyBonus:5),100),lastFed:new Date},l=i.map((e=>e.id===r?s:e)),c=t.map((e=>e.id===n?{...e,quantity:e.quantity-1}:e)).filter((e=>e.quantity>0));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:l},inventory:{...e.player.inventory,items:c}}}}if(a){const t={...o,hunger:Math.min(o.hunger+(void 0!==a.nutritionValue?a.nutritionValue:25),100),loyalty:Math.min(o.loyalty+(void 0!==a.loyaltyBonus?a.loyaltyBonus:5),100),lastFed:new Date},n=i.map((e=>e.id===r?t:e));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:n}}}}{console.log("\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0435\u0444\u043e\u043b\u0442\u043d\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u043a\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044f \u043f\u0438\u0442\u043e\u043c\u0446\u0430 (\u043e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u044c)");const t={...o,hunger:Math.min(o.hunger+20,100),loyalty:Math.min(o.loyalty+5,100),lastFed:new Date},n=i.map((e=>e.id===r?t:e));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:n}}}}}case Yr.TRAIN_SPIRIT_PET:{var v,x,b,w;const r=t.payload.petId||t.payload.id,n=t.payload.trainingType||t.payload.statToTrain;if(!r||!n)return e;const a=(null===(v=e.player)||void 0===v||null===(x=v.spiritPets)||void 0===x?void 0:x.pets)||[],i=a.find((e=>e.id===r));if(!i)return e;if(i.hunger<30)return e;let o={...i};o.hunger=Math.max(i.hunger-15,0),o.lastTrained=new Date,o.experience=(i.experience||0)+10;const s=(null===(b=e.player)||void 0===b||null===(w=b.spiritPets)||void 0===w?void 0:w.expForNextLevel)||100;switch(o.experience>=s&&(o.level=(i.level||1)+1,o.experience=o.experience-s),n){case"strength":o.strength=Math.min((i.strength||1)+1,100);break;case"intelligence":o.intelligence=Math.min((i.intelligence||1)+1,100);break;case"agility":o.agility=Math.min((i.agility||1)+1,100);break;case"vitality":o.vitality=Math.min((i.vitality||1)+1,100);break;case"spirit":o.spirit=Math.min((i.spirit||1)+1,100)}const l=a.map((e=>e.id===r?o:e));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:l}}}}case Yr.USE_PET_ABILITY:{var _,E;const{petId:r,abilityId:n}=t.payload,a=(null===(_=e.player)||void 0===_||null===(E=_.spiritPets)||void 0===E?void 0:E.pets)||[],i=a.find((e=>e.id===r));if(!i)return e;if(!i.abilities.find((e=>e.id===n)))return e;const o=20;if(i.hunger<o)return console.log(`\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0441\u044b\u0442\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438: ${i.hunger}% < ${o}%`),e;console.log(`\u041f\u0438\u0442\u043e\u043c\u0435\u0446 ${i.name} (ID: ${i.id}) \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c ${n}:`),console.log(`- \u0414\u043e: \u0441\u044b\u0442\u043e\u0441\u0442\u044c ${i.hunger}%, \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c ${i.loyalty}%`);const s=Math.round(100/Math.max(i.hunger,1)*5);if(console.log(`\u041f\u0438\u0442\u043e\u043c\u0435\u0446 ${i.name} \u0442\u0435\u0440\u044f\u0435\u0442 ${s}% \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 (\u0441\u044b\u0442\u043e\u0441\u0442\u044c: ${i.hunger}%, \u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044c: 5)`),console.log(`\u0424\u041e\u0420\u041c\u0423\u041b\u0410: 5 * (100 / ${i.hunger}) = ${s}`),i.loyalty<=25){console.log(`\u041f\u0438\u0442\u043e\u043c\u0435\u0446 ${i.name} \u043e\u0442\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u043c\u043e\u0433\u0430\u0442\u044c \u0438 \u0443\u0431\u0435\u0433\u0430\u0435\u0442 (\u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u043d\u0438\u0437\u043a\u0430\u044f: ${i.loyalty}%)!`);const t=a.filter((e=>e.id!==r));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:t,activePetId:i.id===e.player.spiritPets.activePetId?null:e.player.spiritPets.activePetId}}}}const l={...i,hunger:Math.max(0,i.hunger-o),loyalty:Math.max(0,i.loyalty-s),lastUsedAbility:new Date};console.log(`- \u041f\u043e\u0441\u043b\u0435: \u0441\u044b\u0442\u043e\u0441\u0442\u044c ${l.hunger}%, \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c ${l.loyalty}%`),console.log(`- \u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f: \u0441\u044b\u0442\u043e\u0441\u0442\u044c -${o}%, \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c -${s}%`);const c=a.map((e=>e.id===r?l:e));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:c}}}}case Yr.REMOVE_FLEEING_PET:{var T,S;const r=t.payload,n=((null===(T=e.player)||void 0===T||null===(S=T.spiritPets)||void 0===S?void 0:S.pets)||[]).filter((e=>e.id!==r));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:n,activePetId:r===e.player.spiritPets.activePetId?null:e.player.spiritPets.activePetId}}}}case Yr.UPDATE_PETS_STATE:{var j,C;const t=((null===(j=e.player)||void 0===j||null===(C=j.spiritPets)||void 0===C?void 0:C.pets)||[]).map((e=>({...e,hunger:Math.max((e.hunger||100)-1,0),energy:Math.min((e.energy||0)+2,100),loyalty:(e.hunger||100)<20?Math.max((e.loyalty||100)-1,0):e.loyalty||100})));return{...e,player:{...e.player,spiritPets:{...e.player.spiritPets||{},pets:t}}}}default:return e}})(n,t),n={...n,market:yn(n.market,t)},n={...n,sect:vn(n.sect,t)},n={...n,reputation:bn(n.reputation,t)},n={...n,groups:_n(n.groups,t)},n};let Tn=!1,Sn=null,jn=0;var Cn=r(579);const kn=(0,n.createContext)(),In=()=>(0,n.useContext)(kn),An=new class{constructor(e){this.models=e,this.cultivationService=new(Hr())(e),this.resourceService=new(kr())(e)}async getSectById(e){try{let r;try{r=await this.models.Sect.findByPk(e,{include:[{model:this.models.SectMember,as:"members"}]})}catch(t){console.warn("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0441\u0435\u043a\u0442\u044b \u0432 \u0411\u0414, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043c\u043e\u043a-\u0434\u0430\u043d\u043d\u044b\u0435:",t)}if(!r&&"undefined"!==typeof window){const t=localStorage.getItem(`sect_${e}`);let n=1,a=0,i="\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f",o=100;if(t)try{const e=JSON.parse(t);n=e.level||1,a=e.experience||0,i=e.rank||"\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f",o=e.requiredExperience||100}catch(Lg){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0447\u0442\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b \u0438\u0437 localStorage:",Lg)}return r={id:e,name:"\u0421\u0435\u043a\u0442\u0430 \u0412\u043e\u0441\u0445\u043e\u0434\u044f\u0449\u0435\u0433\u043e \u041e\u0431\u043b\u0430\u043a\u0430",rank:i,level:n,experience:a,requiredExperience:o,influence:100,resources:50,territories:1,benefits:[{type:"cultivation_speed",modifier:5},{type:"resource_gathering",modifier:3},{type:"energy_regen",modifier:1},{type:"technique_discount",modifier:2},{type:"max_energy",modifier:10}],members:[{id:1,name:"\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438",role:"\u0413\u043b\u0430\u0432\u0430 \u0441\u0435\u043a\u0442\u044b",cultivationLevel:30,level:8,experience:200,requiredExperience:300,loyalty:100},{id:2,name:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0427\u0436\u0430\u043d",role:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430",cultivationLevel:25,level:6,experience:150,requiredExperience:250,loyalty:95},{id:3,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0412\u0430\u043d",role:"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:15,level:4,experience:80,requiredExperience:150,loyalty:70},{id:4,name:"\u0423\u0447\u0435\u043d\u0438\u0446\u0430 \u041c\u044d\u0439",role:"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:12,level:3,experience:50,requiredExperience:120,loyalty:65},{id:5,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0427\u0435\u043d",role:"\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:8,level:2,experience:30,requiredExperience:100,loyalty:40}],calculateRequiredExperience:function(){return this.requiredExperience=Math.floor(100*Math.pow(1.2,this.level-1)),this.requiredExperience},updateRank:function(){return this.level>=10?this.rank="\u0412\u044b\u0441\u0448\u0430\u044f":this.level>=5?this.rank="\u0421\u0440\u0435\u0434\u043d\u044f\u044f":this.rank="\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f",this.rank},updateBenefits:function(){return this.benefits=[{type:"cultivation_speed",modifier:Math.round(100*(.05+.01*this.level))},{type:"resource_gathering",modifier:Math.round(100*(.03+.01*this.level))},{type:"energy_regen",modifier:1+Math.floor(this.level/2)},{type:"technique_discount",modifier:Math.round(100*(.02+.005*this.level))},{type:"max_energy",modifier:10+5*this.level}],this.benefits},save:async function(){return this}},r}if(!r)throw new Error("\u0421\u0435\u043a\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");return r}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0441\u0435\u043a\u0442\u044b:",t),t}}async getUserSect(e){try{let r;try{r=await this.models.SectMember.findOne({where:{userId:e},include:[{model:this.models.Sect,as:"sect",include:[{model:this.models.SectMember,as:"members"}]}]})}catch(t){console.warn("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0432 \u0411\u0414, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043c\u043e\u043a-\u0434\u0430\u043d\u043d\u044b\u0435:",t)}if(!r||!r.sect){if("undefined"!==typeof window){const e=localStorage.getItem("sect_1");let t=1,r=0,n="\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f",a=100;if(e)try{const i=JSON.parse(e);t=i.level||1,r=i.experience||0,n=i.rank||"\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f",a=i.requiredExperience||100}catch(Lg){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0447\u0442\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b \u0438\u0437 localStorage:",Lg)}const i={id:1,name:"\u0421\u0435\u043a\u0442\u0430 \u0412\u043e\u0441\u0445\u043e\u0434\u044f\u0449\u0435\u0433\u043e \u041e\u0431\u043b\u0430\u043a\u0430",rank:n,level:t,experience:r,requiredExperience:a,influence:100,resources:50,territories:1,benefits:[{type:"cultivation_speed",modifier:5},{type:"resource_gathering",modifier:3},{type:"energy_regen",modifier:1},{type:"technique_discount",modifier:2},{type:"max_energy",modifier:10}],members:[{id:1,name:"\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438",role:"\u0413\u043b\u0430\u0432\u0430 \u0441\u0435\u043a\u0442\u044b",cultivationLevel:30,level:8,experience:200,requiredExperience:300,loyalty:100},{id:2,name:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0427\u0436\u0430\u043d",role:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430",cultivationLevel:25,level:6,experience:150,requiredExperience:250,loyalty:95},{id:3,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0412\u0430\u043d",role:"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:15,level:4,experience:80,requiredExperience:150,loyalty:70},{id:4,name:"\u0423\u0447\u0435\u043d\u0438\u0446\u0430 \u041c\u044d\u0439",role:"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:12,level:3,experience:50,requiredExperience:120,loyalty:65},{id:5,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0427\u0435\u043d",role:"\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:8,level:2,experience:30,requiredExperience:100,loyalty:40}],calculateRequiredExperience:function(){return this.requiredExperience=Math.floor(100*Math.pow(1.2,this.level-1)),this.requiredExperience},updateRank:function(){return this.level>=10?this.rank="\u0412\u044b\u0441\u0448\u0430\u044f":this.level>=5?this.rank="\u0421\u0440\u0435\u0434\u043d\u044f\u044f":this.rank="\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f",this.rank},updateBenefits:function(){return this.benefits=[{type:"cultivation_speed",modifier:Math.round(100*(.05+.01*this.level))},{type:"resource_gathering",modifier:Math.round(100*(.03+.01*this.level))},{type:"energy_regen",modifier:1+Math.floor(this.level/2)},{type:"technique_discount",modifier:Math.round(100*(.02+.005*this.level))},{type:"max_energy",modifier:10+5*this.level}],this.benefits},save:async function(){return this}};return i}return null}return r.sect}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0441\u0435\u043a\u0442\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",t),t}}async createSect(e,t){try{var r;if(await this.getUserSect(e))throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0432 \u0441\u0435\u043a\u0442\u0435");const n=await this.models.User.findByPk(e);if(!n)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");const a=await this.models.Sect.create({name:t,leaderId:e});return await this.models.SectMember.create({name:n.name||"\u041b\u0438\u0434\u0435\u0440 \u0441\u0435\u043a\u0442\u044b",role:"\u0413\u043b\u0430\u0432\u0430 \u0441\u0435\u043a\u0442\u044b",userId:e,sectId:a.id,cultivationLevel:(null===(r=n.cultivation)||void 0===r?void 0:r.level)||1}),await this.getSectById(a.id)}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0441\u0435\u043a\u0442\u044b:",n),n}}async joinSect(e,t){try{var r;if(await this.getUserSect(e))throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0432 \u0441\u0435\u043a\u0442\u0435");const n=await this.models.User.findByPk(e);if(!n)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");if(!await this.getSectById(t))throw new Error("\u0421\u0435\u043a\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");return await this.models.SectMember.create({name:n.name||"\u041d\u043e\u0432\u044b\u0439 \u0447\u043b\u0435\u043d \u0441\u0435\u043a\u0442\u044b",role:"\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",userId:e,sectId:t,cultivationLevel:(null===(r=n.cultivation)||void 0===r?void 0:r.level)||1})}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u043a\u0442\u0435:",n),n}}async contributeToSect(e,t,r){try{const a=await this.getSectById(t);if(!a)throw new Error("\u0421\u0435\u043a\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");let i;try{i=await this.models.SectMember.findOne({where:{userId:e,sectId:t}})}catch(n){console.warn("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0432 \u0411\u0414 \u043f\u0440\u0438 \u0432\u043d\u0435\u0441\u0435\u043d\u0438\u0438 \u0432\u043a\u043b\u0430\u0434\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043c\u043e\u043a-\u0434\u0430\u043d\u043d\u044b\u0435:",n)}if(i||"undefined"===typeof window||(i={userId:e,sectId:t}),!i)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0447\u043b\u0435\u043d\u043e\u043c \u044d\u0442\u043e\u0439 \u0441\u0435\u043a\u0442\u044b");const o=await Hr().getCultivationProgress(e);if(o.energy<r)throw new Error("\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u044d\u043d\u0435\u0440\u0433\u0438\u0438");o.energy-=r,await Hr().updateCultivationProgress(e,{energy:o.energy});const s=5*r,l=Math.floor(r/2);a.experience+=s,a.influence+=l;const c=a.level;if(a.level<=2)a.level+=1,a.experience=0,a.calculateRequiredExperience(),a.updateRank(),a.updateBenefits();else for(;a.experience>=a.requiredExperience;)a.level+=1,a.experience-=a.requiredExperience,a.calculateRequiredExperience(),a.updateRank(),a.updateBenefits();if(await a.save(),"undefined"!==typeof window)try{localStorage.setItem(`sect_${t}`,JSON.stringify({level:a.level,experience:a.experience,rank:a.rank,requiredExperience:a.requiredExperience}))}catch(Lg){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b \u0432 localStorage:",Lg)}return{leveledUp:a.level>c,oldLevel:c,newLevel:a.level,sectRank:a.rank,sectExperience:a.experience,sectRequiredExperience:a.requiredExperience,sectInfluence:a.influence,influenceGain:l,message:`\u0412\u043a\u043b\u0430\u0434 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0432\u043d\u0435\u0441\u0435\u043d! \u0421\u0435\u043a\u0442\u0430 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0430 ${s} \u043e\u043f\u044b\u0442\u0430 \u0438 ${l} \u0432\u043b\u0438\u044f\u043d\u0438\u044f.`}}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u043d\u0435\u0441\u0435\u043d\u0438\u0438 \u0432\u043a\u043b\u0430\u0434\u0430 \u0432 \u0441\u0435\u043a\u0442\u0443:",n),n}}async trainWithMember(e,t,r){try{let a;try{a=await this.models.SectMember.findByPk(t)}catch(n){console.warn("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0432 \u0411\u0414, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043c\u043e\u043a-\u0434\u0430\u043d\u043d\u044b\u0435:",n)}if(!a){let r=null;if("undefined"!==typeof window)try{const e=localStorage.getItem(`sect_member_${t}`);e&&(r=JSON.parse(e),console.log("\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0438\u0437 localStorage:",r))}catch(Lg){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0438\u0437 localStorage:",Lg)}const n=await this.getUserSect(e);n&&n.members&&(a=n.members.find((e=>e.id===t)),r&&a&&(a={...a,level:r.level||a.level||1,experience:r.experience||a.experience||0,requiredExperience:r.requiredExperience||a.requiredExperience||100,loyalty:r.loyalty||a.loyalty||50}),a&&(a.canTrainToday=()=>!0,a.addExperience=e=>{console.log(`[DEBUG] \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u043f\u044b\u0442\u0430 \u0447\u043b\u0435\u043d\u0443 ${a.name}. \u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u043e\u043f\u044b\u0442:`,a.experience,"\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c:",e),"number"!==typeof a.experience&&(console.log("[DEBUG] \u041e\u043f\u044b\u0442 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0447\u0438\u0441\u043b\u043e\u043c, \u0441\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u043c \u0432 0"),a.experience=0),a.experience=(a.experience||0)+e;const t=a.level||1,r=a.requiredExperience||100;let n=!1;return console.log(`[DEBUG] \u041f\u043e\u0441\u043b\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f: \u041e\u043f\u044b\u0442=${a.experience}, \u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f=${r}`),a.experience>=r&&(a.level=(a.level||1)+1,a.experience-=r,a.requiredExperience=Math.floor(1.2*r),n=!0,console.log(`[DEBUG] \u041f\u043e\u0432\u044b\u0448\u0435\u043d\u0438\u0435 \u0443\u0440\u043e\u0432\u043d\u044f! \u041d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c=${a.level}, \u041e\u0441\u0442\u0430\u0442\u043e\u043a \u043e\u043f\u044b\u0442\u0430=${a.experience}`)),{leveledUp:n,oldLevel:t,newLevel:a.level}},a.updateRole=()=>a.role,a.save=async()=>{if("undefined"!==typeof window)try{const e={id:a.id,level:a.level,experience:a.experience,requiredExperience:a.requiredExperience,loyalty:a.loyalty,role:a.role};console.log("[DEBUG] \u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0432 localStorage:",JSON.stringify(e)),localStorage.setItem(`sect_member_${t}`,JSON.stringify(e))}catch(Lg){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0432 localStorage:",Lg)}return a}))}if(!a)throw new Error("\u0427\u043b\u0435\u043d \u0441\u0435\u043a\u0442\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");if(!a.canTrainToday())throw new Error("\u0421 \u044d\u0442\u0438\u043c \u0447\u043b\u0435\u043d\u043e\u043c \u0441\u0435\u043a\u0442\u044b \u0443\u0436\u0435 \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u043b\u0430\u0441\u044c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f");const i=await Hr().getCultivationProgress(e);let o;try{o=await this.models.SectMember.findOne({where:{userId:e,sectId:a.sectId}})}catch(n){console.warn("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0411\u0414, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043c\u043e\u043a-\u0434\u0430\u043d\u043d\u044b\u0435:",n)}if(!o){const t=await this.getUserSect(e);t&&t.members&&(o=t.members.find((t=>t.userId===e))),o||"undefined"===typeof window||(o={userId:e,sectId:a.sectId})}if(!o)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0447\u043b\u0435\u043d\u043e\u043c \u044d\u0442\u043e\u0439 \u0441\u0435\u043a\u0442\u044b");const s=5*r;if(i.energy<s)throw new Error("\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438");i.energy-=s,await Hr().updateCultivationProgress(e,{energy:i.energy});const l=Math.floor(10*r*(1+i.level/10));a.lastTrainingDate=new Date,console.log(`[DEBUG] \u041d\u0430\u0447\u0438\u043d\u0430\u0435\u043c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0443 \u0441 \u0447\u043b\u0435\u043d\u043e\u043c \u0441\u0435\u043a\u0442\u044b ${a.name}. \u0422\u0435\u043a\u0443\u0449\u0435\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435:`,{"\u0443\u0440\u043e\u0432\u0435\u043d\u044c":a.level,"\u043e\u043f\u044b\u0442":a.experience,"\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f":a.requiredExperience,"\u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c":a.loyalty});const c=a.addExperience(l),d=Math.min(10,Math.floor(r)),u=Math.min(100,a.loyalty+d);if(a.loyalty=u,console.log("[DEBUG] \u041f\u043e\u0441\u043b\u0435 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438:",{"\u0443\u0440\u043e\u0432\u0435\u043d\u044c":a.level,"\u043e\u043f\u044b\u0442":a.experience,"\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f":a.requiredExperience,"\u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c":a.loyalty}),"undefined"!==typeof window&&window.__gameContext)try{window.__gameContext.getState();window.__gameContext.dispatch({type:"UPDATE_RELATIONSHIP_AND_LOYALTY",payload:{name:a.name,value:u}}),console.log(`\u2705 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0438 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f "${a.name}" \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f ${u}`)}catch(n){console.warn("\u26a0\ufe0f \u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f:",n)}a.updateRole(),await a.save();const p=Math.floor(5*r*(1+a.level/20)),h=i.level;i.experience+=p;let m=!1;return i.experience>=i.requiredExperience&&(m=!0),await Hr().updateCultivationProgress(e,{experience:i.experience}),{memberName:a.name,memberLevel:a.level,memberExperience:a.experience,memberRequiredExperience:a.requiredExperience,memberLeveledUp:c.leveledUp,memberOldLevel:c.oldLevel,memberNewLevel:c.newLevel,memberRole:a.role,memberLoyalty:a.loyalty,userGainedXP:p,userLevelUp:m,userLevel:i.level,userLevelBefore:h,energySpent:s,message:c.leveledUp?`\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u0430! ${a.name} \u043f\u043e\u043b\u0443\u0447\u0438\u043b ${l} \u043e\u043f\u044b\u0442\u0430 \u0438 \u043f\u043e\u0432\u044b\u0441\u0438\u043b \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0434\u043e ${a.level}!`:`\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u0430! ${a.name} \u043f\u043e\u043b\u0443\u0447\u0438\u043b ${l} \u043e\u043f\u044b\u0442\u0430 \u0438 \u0442\u0435\u043f\u0435\u0440\u044c \u0438\u043c\u0435\u0435\u0442 ${a.experience}/${a.requiredExperience} \u043e\u043f\u044b\u0442\u0430.`}}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0435 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b:",n),n}}async getSectBenefits(e){try{const t=await this.getUserSect(e);return t?Array.isArray(t.benefits)?t.benefits:(console.warn("\u0411\u043e\u043d\u0443\u0441\u044b \u0441\u0435\u043a\u0442\u044b \u043d\u0435 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c, \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u0432 \u043c\u0430\u0441\u0441\u0438\u0432"),[{type:"cultivation_speed",modifier:Math.round(100*(t.benefits.cultivationSpeedBonus||0))},{type:"resource_gathering",modifier:Math.round(100*(t.benefits.resourceGatheringBonus||0))},{type:"energy_regen",modifier:t.benefits.energyRegenBonus||0},{type:"technique_discount",modifier:Math.round(100*(t.benefits.techniqueDiscountPercent||0))},{type:"max_energy",modifier:t.benefits.maxEnergyBonus||0}]):[{type:"cultivation_speed",modifier:0},{type:"resource_gathering",modifier:0},{type:"energy_regen",modifier:0},{type:"technique_discount",modifier:0},{type:"max_energy",modifier:0}]}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u0441\u0435\u043a\u0442\u044b:",t),t}}async getUserSectRank(e){try{let r;try{r=await this.models.SectMember.findOne({where:{userId:e},include:[{model:this.models.Sect,as:"sect"}]})}catch(t){console.warn("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0432 \u0411\u0414 \u0434\u043b\u044f \u0440\u0430\u043d\u0433\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043c\u043e\u043a-\u0434\u0430\u043d\u043d\u044b\u0435:",t)}if(r&&r.sect||"undefined"===typeof window){if(!r||!r.sect)return{inSect:!1,rank:null,privileges:[]}}else{const t=await this.getUserSect(e);if(!t||!t.members)return{inSect:!1,rank:null,privileges:[]};r={role:"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",level:5,loyalty:75,sect:t}}let n=[];switch(r.role){case"\u0413\u043b\u0430\u0432\u0430 \u0441\u0435\u043a\u0442\u044b":n=["\u041f\u043e\u043b\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0441\u0435\u043a\u0442\u043e\u0439","\u0414\u043e\u0441\u0442\u0443\u043f \u043a\u043e \u0432\u0441\u0435\u043c \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c \u0441\u0435\u043a\u0442\u044b","\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0447\u043b\u0435\u043d\u0430\u043c\u0438 \u0441\u0435\u043a\u0442\u044b","\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0441\u0431\u043e\u0440\u0430 \u043d\u0430\u043b\u043e\u0433\u043e\u0432 (20%)","\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u043e\u0441\u043e\u0431\u044b\u043c \u0442\u0435\u0445\u043d\u0438\u043a\u0430\u043c \u0441\u0435\u043a\u0442\u044b"];break;case"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430":n=["\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u043f\u0440\u043e\u0434\u0432\u0438\u043d\u0443\u0442\u044b\u043c \u0442\u0435\u0445\u043d\u0438\u043a\u0430\u043c","\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0432\u044b\u0441\u043e\u043a\u043e\u0433\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430","\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0441\u0431\u043e\u0440\u0430 \u043d\u0430\u043b\u043e\u0433\u043e\u0432 (10%)","\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u044f\u043c \u0441\u0435\u043a\u0442\u044b"];break;case"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a":n=["\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u0440\u0435\u0434\u043d\u0438\u043c \u0442\u0435\u0445\u043d\u0438\u043a\u0430\u043c","\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b \u0441\u0440\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430","\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u043c \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0430\u043c \u0441\u0435\u043a\u0442\u044b"];break;case"\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a":n=["\u0414\u043e\u0441\u0442\u0443\u043f \u043a \u0431\u0430\u0437\u043e\u0432\u044b\u043c \u0442\u0435\u0445\u043d\u0438\u043a\u0430\u043c","\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0437\u0430\u0449\u0438\u0442\u0430 \u0441\u0435\u043a\u0442\u044b"]}return{inSect:!0,sectName:r.sect.name,sectRank:r.sect.rank,memberName:r.name,role:r.role,level:r.level,loyalty:r.loyalty,privileges:n}}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0440\u0430\u043d\u0433\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0432 \u0441\u0435\u043a\u0442\u0435:",t),t}}}({Sect:Gr.Sect,SectMember:Gr.SectMember}),Nn=In,Dn=nr.div`
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: rgba(0, 0, 0, 0.8);
  border: 1px solid #444;
  border-radius: 5px;
  padding: 15px;
  color: #fff;
  font-family: monospace;
  min-width: 300px;
  z-index: 9999;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
`,Mn=nr.h3`
  margin: 0 0 15px 0;
  color: #ffd700;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,Rn=nr.button`
  background: none;
  border: none;
  color: #aaa;
  cursor: pointer;
  font-size: 16px;
  padding: 0;
  &:hover {
    color: #fff;
  }
`,Pn=nr.div`
  margin-bottom: 10px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 5px;
`,Ln=nr.span`
  color: #aaa;
`,$n=nr.span`
  color: #fff;
  font-weight: bold;
`,On=nr.div`
  display: flex;
  gap: 10px;
  margin-top: 15px;
  flex-wrap: wrap;
`,qn=nr.div`
  margin-top: 15px;
`,Un=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 5px;
`,Fn=nr.input`
  width: 100%;
  -webkit-appearance: none;
  height: 8px;
  border-radius: 4px;
  background: #333;
  outline: none;
  
  &::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: #ffd700;
    cursor: pointer;
  }
  
  &::-moz-range-thumb {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: #ffd700;
    cursor: pointer;
  }
`,zn=nr.button`
  background-color: #333;
  border: 1px solid #555;
  border-radius: 3px;
  color: #fff;
  padding: 5px 10px;
  cursor: pointer;
  transition: background-color 0.2s;
  
  &:hover {
    background-color: #444;
  }
  
  &:active {
    background-color: #555;
  }
`;const Bn=function(e){var t,r;let{onClose:a}=e;const{state:i,actions:o}=Nn(),[s,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0),[u,p]=(0,n.useState)(ar.default.TIME_MULTIPLIER),[h,m]=(0,n.useState)(null),f=(0,n.useRef)(null),y=(0,n.useCallback)((()=>{var e,t,r,n,a,s;console.log("\ud83d\udcca TimeDebugPanel - fetchTimeInfo, \u043f\u043e\u043b\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435:",{world_time:null===(e=i.world)||void 0===e?void 0:e.time,weather:i.weather}),null!==(t=i.world)&&void 0!==t&&t.time&&console.log("\u2b50\u2b50 \u0415\u0414\u0418\u041d\u0421\u0422\u0412\u0415\u041d\u041d\u042b\u0419 \u0418\u0421\u0422\u041e\u0427\u041d\u0418\u041a \u041f\u0420\u0410\u0412\u0414\u042b: state.world.time =",i.world.time);const c=(null===(r=i.world)||void 0===r?void 0:r.time)||{},d=void 0!==c.hour?Number(c.hour):12,u=void 0!==c.minute?Number(c.minute):0,p=void 0!==c.day?Number(c.day):1,h=c.season||"spring";console.log("\ud83d\udd0d \u0418\u0417\u0412\u041b\u0415\u0427\u0415\u041d\u041d\u042b\u0415 \u0414\u0410\u041d\u041d\u042b\u0415 \u0418\u0417 state.world.time:",{hour:d,minute:u,day:p,season:h});const m=d>=6&&d<20,f=`${String(d).padStart(2,"0")}:${String(u).padStart(2,"0")}`,y=60*d+u,g=d>=5&&d<7?"dawn":d>=7&&d<11?"morning":d>=11&&d<14?"noon":d>=14&&d<17?"afternoon":d>=17&&d<20?"evening":d>=20&&d<23?"night":"deepNight",v={dawn:"\u0420\u0430\u0441\u0441\u0432\u0435\u0442",morning:"\u0423\u0442\u0440\u043e",noon:"\u041f\u043e\u043b\u0434\u0435\u043d\u044c",afternoon:"\u0414\u0435\u043d\u044c",evening:"\u0412\u0435\u0447\u0435\u0440",night:"\u041d\u043e\u0447\u044c",deepNight:"\u0413\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c"}[g]||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e",x=p;var b;(null===(n=i.weather)||void 0===n?void 0:n.seasonDay)!==p&&(console.log("\ud83d\udd04 TimeDebugPanel: \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u0435\u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u044f \u0434\u043d\u044f \u0441\u0435\u0437\u043e\u043d\u0430",{"\u0442\u0435\u043a\u0443\u0449\u0438\u0439_\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":null===(b=i.weather)||void 0===b?void 0:b.seasonDay,"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":p,"\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435":"\u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f"}),void 0!==p&&o&&o.dispatch&&setTimeout((()=>{o.dispatch({type:"SYNC_SEASON_DAY"})}),100));const w={hour:d,minute:u,dayCount:p,formattedTime:f,isDayTime:m,daytimePeriod:g,daytimeName:v,currentTime:y,currentSeason:h,seasonDay:x,currentWeather:(null===(a=i.weather)||void 0===a?void 0:a.currentWeather)||"clear",nextWeatherChange:(null===(s=i.weather)||void 0===s?void 0:s.nextWeatherChange)||60};console.log("\u23f0\u23f0 TimeDebugPanel - \u0418\u0422\u041e\u0413\u041e\u0412\u0410\u042f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438:",w),l(w)}),[i]),g=(0,n.useRef)(null);(0,n.useEffect)((()=>(sr({context:{state:i}}),y(),f.current=setInterval(y,3e3),()=>{f.current&&clearInterval(f.current)})),[i,y]),(0,n.useEffect)((()=>{var e,t;const r=null===(e=i.world)||void 0===e||null===(t=e.time)||void 0===t?void 0:t.day;var n;null!==g.current?r!==g.current&&(console.log("\ud83c\udfaf\ud83c\udfaf\ud83c\udfaf \u0414\u0415\u041d\u042c \u0418\u0417\u041c\u0415\u041d\u0418\u041b\u0421\u042f \u0412 UI \u041a\u041e\u041c\u041f\u041e\u041d\u0415\u041d\u0422\u0415:",{prevDay:g.current,newDay:r,worldTimeObject:{...null===(n=i.world)||void 0===n?void 0:n.time},timeInfo:s,detectedChange:!0}),g.current=r):g.current=r}),[null===(t=i.world)||void 0===t||null===(r=t.time)||void 0===r?void 0:r.day,s]),(0,n.useCallback)((e=>{try{var t,r,n,a;if(console.log("\ud83d\udd0d advanceTime \u0432\u044b\u0437\u0432\u0430\u043d \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c:",e),!o)return void console.error("\ud83d\udeab actions \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442");if(!o.dispatch)return void console.error("\ud83d\udeab actions.dispatch \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442. actions:",o);console.log("\u2705 actions \u0438 dispatch \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0442 \u0438 \u0433\u043e\u0442\u043e\u0432\u044b \u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044e"),console.log("\ud83d\udd2c DIAG: \u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u0434 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435\u043c:",{worldTime:null===(t=i.world)||void 0===t?void 0:t.time,weather:{hour:null===(r=i.weather)||void 0===r?void 0:r.hour,minute:null===(n=i.weather)||void 0===n?void 0:n.minute,dayCount:null===(a=i.weather)||void 0===a?void 0:a.dayCount}}),console.log("\u26a1\u26a1 \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c updateGameTime \u0434\u043b\u044f \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u041d\u041e\u0413\u041e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u0438");const s=dn(e,!0);console.log("\ud83d\udccc \u041e\u0422\u041f\u0420\u0410\u0412\u041b\u042f\u0415\u041c updateGameTime:",{minutes:e,isManual:!0,action:s}),o.dispatch(s),window.dispatchEvent(new CustomEvent("manual_time_update",{detail:{type:"manual_time_update",minutes:e,timestamp:Date.now()}})),window.__forceSyncWeatherTime=!0;const l=[100,500,1500];(()=>{l.forEach(((e,t)=>{setTimeout((()=>{console.log(`\ud83d\udd04 \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 #${t+1} (${e} \u043c\u0441)...`),y(),t===l.length-1&&(console.log("\ud83d\udd04 \u041f\u0420\u0418\u041d\u0423\u0414\u0418\u0422\u0415\u041b\u042c\u041d\u0410\u042f \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u0418\u0417\u0410\u0426\u0418\u042f"),o&&o.dispatch&&(console.log("\ud83d\udd04 \u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c DIRECT_FORCE_SYNC_WEATHER_TIME"),o.dispatch({type:"DIRECT_FORCE_SYNC_WEATHER_TIME",payload:{}}))),setTimeout((()=>{var e;if(y(),null!==(e=i.world)&&void 0!==e&&e.time&&i.weather){console.log("\ud83d\udd0d \u0410\u041d\u0410\u041b\u0418\u0417 \u0422\u0418\u041f\u041e\u0412 \u0414\u0410\u041d\u041d\u042b\u0425 \u0414\u041b\u042f \u0421\u0420\u0410\u0412\u041d\u0415\u041d\u0418\u042f:",{worldHour:{value:i.world.time.hour,type:typeof i.world.time.hour,isNumber:!isNaN(Number(i.world.time.hour))},worldMinute:{value:i.world.time.minute,type:typeof i.world.time.minute,isNumber:!isNaN(Number(i.world.time.minute))},weatherHour:{value:i.weather.hour,type:typeof i.weather.hour,isNumber:!isNaN(Number(i.weather.hour))},weatherMinute:{value:i.weather.minute,type:typeof i.weather.minute,isNumber:!isNaN(Number(i.weather.minute))}});const e=parseInt(i.world.time.hour,10),t=parseInt(i.world.time.minute,10),r=parseInt(i.weather.hour,10),n=parseInt(i.weather.minute,10),a=!isNaN(e)&&!isNaN(t)&&!isNaN(r)&&!isNaN(n),s=String(i.world.time.minute)===String(i.weather.minute),l=e===r,c=t===n||s,d=parseInt(i.world.time.day,10)===parseInt(i.weather.dayCount,10),u=i.world.time.season===i.weather.currentSeason;l&&c&&d&&u&&a?console.log("\u2705 \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u0430!"):(console.error("\u26a0\ufe0f \u041e\u0428\u0418\u0411\u041a\u0410 \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u0418\u0417\u0410\u0426\u0418\u0418 \u043c\u0435\u0436\u0434\u0443 world.time \u0438 weather:",{hourSynced:l,minuteSynced:c,minuteStringsEqual:s,daySynced:d,seasonSynced:u,valuesAreValid:a,worldTime:{hour:e,minute:t,hourRaw:i.world.time.hour,minuteRaw:i.world.time.minute,day:i.world.time.day,season:i.world.time.season},weather:{hour:r,minute:n,hourRaw:i.weather.hour,minuteRaw:i.weather.minute,dayCount:i.weather.dayCount,currentSeason:i.weather.currentSeason}}),!c&&o&&o.dispatch&&(console.log("\ud83d\udd27 \u0420\u0423\u0427\u041d\u041e\u0415 \u0418\u0421\u041f\u0420\u0410\u0412\u041b\u0415\u041d\u0418\u0415 \u043c\u0438\u043d\u0443\u0442 \u0432 weather: \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c minute = "+i.world.time.minute),o.dispatch({type:"FIX_WEATHER_MINUTES",payload:{minute:i.world.time.minute}})))}}),200)}),e)}))})()}catch(s){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u0432 advanceTime:",s),s&&s.toString().includes("TypeError")&&console.error("\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430:",s)}}),[o,y]);const v=(0,n.useCallback)((e=>{try{var t;if(console.log(`\ud83d\udd52 \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 ${e} \u0438\u0433\u0440\u043e\u0432\u044b\u0445 \u0447\u0430\u0441\u043e\u0432 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e`),!o)return void console.error("\ud83d\udeab actions \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442");if(!o.dispatch)return void console.error("\ud83d\udeab actions.dispatch \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442. actions:",o);console.log("\u2705 actions \u0438 dispatch \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0442 \u0438 \u0433\u043e\u0442\u043e\u0432\u044b \u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044e"),console.log("\ud83d\udd2c DIAG: \u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u0435\u0440\u0435\u0434 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435\u043c \u0447\u0430\u0441\u043e\u0432:",{worldTime:null===(t=i.world)||void 0===t?void 0:t.time,hours:e}),o.dispatch({type:"DIRECT_ADD_GAME_HOURS",payload:{hours:e,timestamp:Date.now()}}),window.dispatchEvent(new CustomEvent("manual_time_update",{detail:{type:"manual_game_hours_update",hours:e,timestamp:Date.now()}}));const r=[100,500];r.forEach(((e,t)=>{setTimeout((()=>{y(),t===r.length-1&&(console.log("\ud83d\udd04 \u041f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e\u0441\u043b\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0447\u0430\u0441\u043e\u0432"),o&&o.dispatch&&(o.dispatch({type:"DIRECT_FORCE_SYNC_WEATHER_TIME",payload:{}}),setTimeout(y,200)))}),e)}))}catch(r){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u0432 advanceGameHours:",r)}}),[o,y]),x=(0,n.useCallback)((()=>{"undefined"!==typeof window&&window.getGameTime?window.getGameTime({state:i}):console.info("\u0424\u0443\u043d\u043a\u0446\u0438\u044f getGameTime() \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430. \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u043d\u0443\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443.")}),[i]),b=(0,n.useCallback)((e=>{console.log("\ud83d\udd27 updateTimeMultiplier \u0432\u044b\u0437\u0432\u0430\u043d \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c:",e);const t=parseInt(e,10);if(!isNaN(t)&&t>0){const e=ar.default.TIME_MULTIPLIER;ar.default.TIME_MULTIPLIER=t,p(t),console.log(`\u2705 TIME_MULTIPLIER \u0438\u0437\u043c\u0435\u043d\u0435\u043d: ${e} \u2192 ${t}`),window.dispatchEvent(new CustomEvent("time_multiplier_changed",{detail:{timeMultiplier:t}}));try{o&&o.dispatch&&o.dispatch({type:"UPDATE_TIME_MULTIPLIER",payload:{multiplier:t}})}catch(r){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 UPDATE_TIME_MULTIPLIER:",r)}}else console.warn("\u26a0\ufe0f \u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044f:",e)}),[o]);return c&&s?(0,Cn.jsxs)(Dn,{children:[(0,Cn.jsxs)(Mn,{children:["\u041e\u0442\u043b\u0430\u0434\u043a\u0430 \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438",(0,Cn.jsx)(Rn,{onClick:()=>{d(!1),a&&a()},children:"\xd7"})]}),(0,Cn.jsxs)(Pn,{children:[(0,Cn.jsx)(Ln,{children:"\u0412\u0440\u0435\u043c\u044f:"}),(0,Cn.jsx)($n,{children:s.formattedTime}),(0,Cn.jsx)(Ln,{children:"\u041f\u0435\u0440\u0438\u043e\u0434 \u0441\u0443\u0442\u043e\u043a:"}),(0,Cn.jsx)($n,{children:s.daytimeName}),(0,Cn.jsx)(Ln,{children:"\u0414\u0435\u043d\u044c:"}),(0,Cn.jsx)($n,{children:s.dayCount}),(0,Cn.jsx)(Ln,{children:"\u0421\u0435\u0437\u043e\u043d:"}),(0,Cn.jsxs)($n,{children:[s.currentSeason," (\u0434\u0435\u043d\u044c ",s.seasonDay,")",s.dayCount!==s.seasonDay&&(0,Cn.jsx)("span",{style:{color:"#ff6666",marginLeft:"5px"},children:"\u26a0\ufe0f \u041d\u0435\u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435!"})]}),(0,Cn.jsx)(Ln,{children:"\u041f\u043e\u0433\u043e\u0434\u0430:"}),(0,Cn.jsx)($n,{children:s.currentWeather}),(0,Cn.jsx)(Ln,{children:"\u0414\u043e \u0441\u043c\u0435\u043d\u044b \u043f\u043e\u0433\u043e\u0434\u044b:"}),(0,Cn.jsx)($n,{children:s.nextWeatherChange?`${s.nextWeatherChange} \u043c\u0438\u043d. \u0438\u0433\u0440. / ${Math.ceil(s.nextWeatherChange/ar.default.TIME_MULTIPLIER)} \u043c\u0438\u043d. \u0440\u0435\u0430\u043b.`:"\u041d/\u0414"}),(0,Cn.jsx)(Ln,{children:"\u041c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u0438:"}),(0,Cn.jsxs)($n,{children:["1:",u]})]}),(0,Cn.jsxs)(qn,{children:[(0,Cn.jsx)(Ln,{children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u0438:"}),(0,Cn.jsxs)(Un,{children:[(0,Cn.jsx)("span",{children:"1"}),(0,Cn.jsx)(Fn,{type:"range",min:"1",max:"240",value:u,onChange:e=>{console.log("\ud83d\udd27 \u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u0437\u0443\u043d\u043a\u0430 \u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u0438:",e.target.value),b(e.target.value)},style:{background:`linear-gradient(to right, #ffd700 0%, #ffd700 ${u/240*100}%, #333 ${u/240*100}%, #333 100%)`}}),(0,Cn.jsx)("span",{children:"240"})]}),(0,Cn.jsxs)($n,{style:{textAlign:"center",color:"#ffd700"},children:["1 \u043c\u0438\u043d. \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 = ",u," \u043c\u0438\u043d. \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438"]})]}),(0,Cn.jsxs)(On,{children:[(0,Cn.jsx)(zn,{onClick:()=>{m("sync_day");try{o&&o.dispatch&&(console.log("\ud83d\udd04 \u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044e \u0434\u043d\u044f \u0441\u0435\u0437\u043e\u043d\u0430 \u0441 \u043c\u0438\u0440\u043e\u0432\u044b\u043c \u0434\u043d\u0435\u043c"),o.dispatch({type:"SYNC_SEASON_DAY"}),setTimeout((()=>{y(),console.log("\u2705 \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0434\u043d\u044f \u0441\u0435\u0437\u043e\u043d\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430")}),300))}catch(e){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u043d\u044f \u0441\u0435\u0437\u043e\u043d\u0430:",e)}setTimeout((()=>m(null)),1e3)},style:{backgroundColor:"sync_day"===h?"#00663d":"#006633",transform:"sync_day"===h?"scale(0.95)":void 0,boxShadow:"sync_day"===h?"0 0 10px #00cc66":void 0,borderColor:"sync_day"===h?"#00cc66":void 0},children:"\u0421\u0438\u043d\u0445\u0440. \u0434\u0435\u043d\u044c \u0441\u0435\u0437\u043e\u043d\u0430"}),(0,Cn.jsx)(zn,{onClick:()=>{m("change_weather");try{o&&o.dispatch&&(console.log("\ud83c\udf24\ufe0f \u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0441\u043c\u0435\u043d\u0443 \u043f\u043e\u0433\u043e\u0434\u044b"),o.dispatch({type:"FORCE_WEATHER_CHANGE"}),setTimeout((()=>{y(),console.log("\u2705 \u041f\u043e\u0433\u043e\u0434\u0430 \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0430")}),300))}catch(e){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043c\u0435\u043d\u0435 \u043f\u043e\u0433\u043e\u0434\u044b:",e)}setTimeout((()=>m(null)),1e3)},style:{backgroundColor:"change_weather"===h?"#1a538c":"#0066cc",transform:"change_weather"===h?"scale(0.95)":void 0,boxShadow:"change_weather"===h?"0 0 10px #66aaff":void 0,borderColor:"change_weather"===h?"#66aaff":void 0},children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0433\u043e\u0434\u0443"}),(0,Cn.jsx)(zn,{onClick:()=>{m("1hour"),v(1),setTimeout((()=>m(null)),1e3)},style:{backgroundColor:"1hour"===h?"#7a5c00":void 0,transform:"1hour"===h?"scale(0.95)":void 0,boxShadow:"1hour"===h?"0 0 10px #ffd700":void 0,borderColor:"1hour"===h?"#ffd700":void 0},children:"+1 \u0447\u0430\u0441 \u0438\u0433\u0440."}),(0,Cn.jsx)(zn,{onClick:()=>{m("3hours"),v(3),setTimeout((()=>m(null)),1e3)},style:{backgroundColor:"3hours"===h?"#7a5c00":void 0,transform:"3hours"===h?"scale(0.95)":void 0,boxShadow:"3hours"===h?"0 0 10px #ffd700":void 0,borderColor:"3hours"===h?"#ffd700":void 0},children:"+3 \u0447\u0430\u0441\u0430 \u0438\u0433\u0440."}),(0,Cn.jsx)(zn,{onClick:()=>{m("6hours"),v(6),setTimeout((()=>m(null)),1e3)},style:{backgroundColor:"6hours"===h?"#7a5c00":void 0,transform:"6hours"===h?"scale(0.95)":void 0,boxShadow:"6hours"===h?"0 0 10px #ffd700":void 0,borderColor:"6hours"===h?"#ffd700":void 0},children:"+6 \u0447\u0430\u0441\u043e\u0432 \u0438\u0433\u0440."}),(0,Cn.jsx)(zn,{onClick:()=>{m("12hours"),v(12),setTimeout((()=>m(null)),1e3)},style:{backgroundColor:"12hours"===h?"#7a5c00":void 0,transform:"12hours"===h?"scale(0.95)":void 0,boxShadow:"12hours"===h?"0 0 10px #ffd700":void 0,borderColor:"12hours"===h?"#ffd700":void 0},children:"+12 \u0447\u0430\u0441\u043e\u0432 \u0438\u0433\u0440."}),(0,Cn.jsx)(zn,{onClick:()=>{m("console"),x(),setTimeout((()=>m(null)),500)},style:{backgroundColor:"console"===h?"#666":void 0,transform:"console"===h?"scale(0.95)":void 0},children:"\u041a\u043e\u043d\u0441\u043e\u043b\u044c"})]})]}):null},Gn=nr.div`
  position: fixed;
  bottom: 10px;
  right: 10px;
  z-index: 9999;
`,Wn=nr.button`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: #333;
  color: #ddd;
  border: 1px solid #555;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  cursor: pointer;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
  transition: all 0.2s;
  opacity: 0.7;
  
  &:hover {
    opacity: 1;
    transform: scale(1.05);
  }
`;const Hn=function(e){let{enabled:t=!1}=e;const[r,a]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1),s=(0,n.useContext)(kn),l=()=>{a((e=>!e)),r||(console.info("\ud83d\udee0\ufe0f \u041e\u0442\u043b\u0430\u0434\u043e\u0447\u043d\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u044b:"),console.info("\u2022 getGameTime() - \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0438\u0433\u0440\u043e\u0432\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438"),console.info("\u2022 showTimeHelp() - \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0438 \u043f\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044e \u043e\u0442\u043b\u0430\u0434\u043a\u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0438"),console.info("\u2022 add1000Currency() - \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c 1000 \u0435\u0434\u0438\u043d\u0438\u0446 \u043a\u0430\u0436\u0434\u043e\u0439 \u0432\u0430\u043b\u044e\u0442\u044b"),console.info("\u2022 \u0434\u0430\u0442\u044c1000\u0420\u0435\u0441\u0443\u0440\u0441\u043e\u0432() - \u0442\u043e \u0436\u0435 \u0441\u0430\u043c\u043e\u0435 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c")),"undefined"!==typeof window&&s&&(window.__GAME_CONTEXT__=s,window.__GAME_STATE__=s.state,window.__GAME_DISPATCH__=s.actions.dispatch)};return(0,n.useEffect)((()=>{if(!t)return;const e=e=>{e.ctrlKey&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),o(!0),l())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[t,l]),t||i?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(Gn,{children:(0,Cn.jsx)(Wn,{onClick:l,title:"\u041e\u0442\u043b\u0430\u0434\u043e\u0447\u043d\u044b\u0435 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b (Ctrl+Shift+D)",children:"\ud83d\udee0\ufe0f"})}),r&&(0,Cn.jsxs)("div",{style:{position:"fixed",top:"10px",right:"10px",zIndex:9998,maxWidth:"350px"},children:[(0,Cn.jsx)(Bn,{onClose:()=>a(!1)}),(0,Cn.jsxs)("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#333",borderRadius:"5px",boxShadow:"0 2px 5px rgba(0,0,0,0.3)",color:"#fff"},children:[(0,Cn.jsx)("h3",{style:{margin:"0 0 8px 0",fontSize:"14px"},children:"\u0412\u0430\u043b\u044e\u0442\u0430"}),(0,Cn.jsx)("button",{onClick:()=>{if(s&&s.actions)try{const e=s.state.player.inventory.currency||{},t={copper:(e.copper||0)+1e3,silver:(e.silver||0)+1e3,gold:(e.gold||0)+1e3,spiritStones:(e.spiritStones||0)+1e3};s.actions.updateCurrency(t),console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u043e 1000 \u0435\u0434\u0438\u043d\u0438\u0446 \u043a\u0430\u0436\u0434\u043e\u0439 \u0432\u0430\u043b\u044e\u0442\u044b!",t)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0432\u0430\u043b\u044e\u0442\u044b:",e)}else console.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0443 \u0438\u0433\u0440\u044b")},style:{padding:"5px 10px",backgroundColor:"#d4af37",color:"#000",border:"none",borderRadius:"3px",cursor:"pointer",fontWeight:"bold",fontSize:"12px"},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c 1000 \u0432\u0441\u0435\u0445 \u0432\u0430\u043b\u044e\u0442"})]})]})]}):null},Vn=nr.div`
  width: 100%;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
`,Qn=nr.div`
  width: 400px;
  background: rgba(30, 30, 30, 0.9);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 30px;
  box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
  color: #f0f0f0;
`,Yn=nr.h1`
  font-family: 'Ma Shan Zheng', cursive;
  text-align: center;
  color: #d4af37;
  margin-bottom: 30px;
  font-size: 2.5rem;
  text-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
`,Kn=nr.form`
  display: flex;
  flex-direction: column;
`,Xn=nr.div`
  margin-bottom: 20px;
`,Jn=nr.label`
  display: block;
  margin-bottom: 5px;
  color: #d4af37;
`,Zn=nr.input`
  width: 100%;
  padding: 10px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #f0f0f0;
  font-size: 1rem;
  
  &:focus {
    outline: none;
    box-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
  }
`,ea=nr.button`
  padding: 12px;
  background: #d4af37;
  color: #000;
  border: none;
  border-radius: 4px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  font-weight: bold;
  margin-top: 10px;
  
  &:hover {
    background: #f4cf47;
    box-shadow: 0 0 10px rgba(212, 175, 55, 0.7);
  }
  
  &:disabled {
    background: #666;
    cursor: not-allowed;
  }
`,ta=nr.p`
  text-align: center;
  margin-top: 20px;
  color: #aaa;
  
  span {
    color: #d4af37;
    cursor: pointer;
    
    &:hover {
      text-decoration: underline;
    }
  }
`,ra=nr.div`
  color: #ff6b6b;
  margin-top: 15px;
  text-align: center;
`,na=nr.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: 20px;
`,aa=nr.p`
  color: #d4af37;
  font-size: 1.2rem;
  margin-top: 10px;
`;const ia=function(){const[e,t]=(0,n.useState)(!0),[r,a]=(0,n.useState)(""),[i,o]=(0,n.useState)(""),[s,l]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,p]=(0,n.useState)(!1),[h,m]=(0,n.useState)(!0),f=re(),{state:y,actions:g}=Nn();return(0,n.useEffect)((()=>{(async()=>{try{if(await Br.checkAuth()){const e=await Br.loadGameState();e?(g.loadGame(e),e.player&&e.player.name?(console.log("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u043d\u0430\u0439\u0434\u0435\u043d, \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u0432 \u0438\u0433\u0440\u0443:",e.player.name),f("/game")):(console.log("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430"),f("/character-creation"))):(console.log("\u041d\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f, \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430"),f("/character-creation"))}}catch(c){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438:",c)}finally{m(!1)}})()}),[f,g]),h?(0,Cn.jsx)(Vn,{children:(0,Cn.jsxs)(Qn,{children:[(0,Cn.jsx)(Yn,{children:"\u041f\u0443\u0442\u044c \u043a \u0411\u0435\u0441\u0441\u043c\u0435\u0440\u0442\u0438\u044e"}),(0,Cn.jsx)(na,{children:(0,Cn.jsx)(aa,{children:"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438..."})})]})}):(0,Cn.jsx)(Vn,{children:(0,Cn.jsxs)(Qn,{children:[(0,Cn.jsx)(Yn,{children:"\u041f\u0443\u0442\u044c \u043a \u0411\u0435\u0441\u0441\u043c\u0435\u0440\u0442\u0438\u044e"}),(0,Cn.jsxs)(Kn,{onSubmit:async t=>{if(t.preventDefault(),d(""),r&&i)if(e||i===s){p(!0);try{if(e){console.log("\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u0432\u0445\u043e\u0434 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443:",r),await Br.login(r,i),console.log("\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0438\u0433\u0440\u043e\u0432\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435");const e=await Br.loadGameState();e?(console.log("\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442"),g.loadGame(e),e.player&&e.player.name?(console.log("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u043d\u0430\u0439\u0434\u0435\u043d, \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u0432 \u0438\u0433\u0440\u0443:",e.player.name),f("/game")):(console.log("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430"),f("/character-creation"))):(console.log("\u041d\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f, \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430"),f("/character-creation"))}else console.log("\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e:",r),await Br.register(r,i),console.log("\u041f\u0435\u0440\u0435\u0445\u043e\u0434 \u043a \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044e \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u043f\u043e\u0441\u043b\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"),f("/character-creation")}catch(c){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438:",c),d(c.message)}finally{p(!1)}}else d("\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442");else d("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f")},children:[(0,Cn.jsxs)(Xn,{children:[(0,Cn.jsx)(Jn,{children:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),(0,Cn.jsx)(Zn,{type:"text",value:r,onChange:e=>a(e.target.value),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",disabled:u})]}),(0,Cn.jsxs)(Xn,{children:[(0,Cn.jsx)(Jn,{children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),(0,Cn.jsx)(Zn,{type:"password",value:i,onChange:e=>o(e.target.value),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",disabled:u})]}),!e&&(0,Cn.jsxs)(Xn,{children:[(0,Cn.jsx)(Jn,{children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"}),(0,Cn.jsx)(Zn,{type:"password",value:s,onChange:e=>l(e.target.value),placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",disabled:u})]}),c&&(0,Cn.jsx)(ra,{children:c}),(0,Cn.jsx)(ea,{type:"submit",disabled:u,children:u?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":e?"\u0412\u043e\u0439\u0442\u0438":"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),(0,Cn.jsxs)(ta,{children:[e?"\u041d\u0435\u0442 \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430? ":"\u0423\u0436\u0435 \u0435\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442? ",(0,Cn.jsx)("span",{onClick:()=>!u&&t(!e),children:e?"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f":"\u0412\u043e\u0439\u0442\u0438"})]})]})})},oa=nr.div`
  width: 100%;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)),
              url('/assets/images/character-creation-bg.jpg');
  background-size: cover;
  background-position: center;
`,sa=nr.div`
  width: 800px;
  min-height: 600px;
  background: rgba(30, 30, 30, 0.95);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 30px;
  box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
  color: #f0f0f0;
  display: flex;
  flex-direction: column;
`,la=nr.h1`
  font-family: 'Ma Shan Zheng', cursive;
  text-align: center;
  color: #d4af37;
  margin-bottom: 30px;
  font-size: 2rem;
  text-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
`,ca=nr.form`
  display: flex;
  flex-direction: column;
  gap: 20px;
`,da=nr.div`
  display: flex;
  gap: 20px;
  justify-content: space-between;
`,ua=nr.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 10px;
`,pa=nr.label`
  color: #d4af37;
  font-size: 1rem;
`,ha=nr.input`
  width: 100%;
  padding: 10px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #f0f0f0;
  font-size: 1rem;
  
  &:focus {
    outline: none;
    box-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
  }
`,ma=nr.select`
  width: 100%;
  padding: 10px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #f0f0f0;
  font-size: 1rem;
  
  &:focus {
    outline: none;
    box-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
  }
  
  option {
    background: #1a1a1a;
  }
`,fa=nr.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 20px;
`,ya=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
`,ga=nr.span`
  width: 120px;
  color: #d4af37;
`,va=nr.span`
  width: 40px;
  text-align: center;
`,xa=nr.button`
  width: 30px;
  height: 30px;
  background: #d4af37;
  border: none;
  border-radius: 4px;
  color: #000;
  font-weight: bold;
  cursor: pointer;
  
  &:disabled {
    background: #666;
    cursor: not-allowed;
  }
  
  &:hover:not(:disabled) {
    background: #f4cf47;
  }
`,ba=nr.textarea`
  width: 100%;
  height: 100px;
  padding: 10px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #f0f0f0;
  font-size: 1rem;
  resize: none;
  
  &:focus {
    outline: none;
    box-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
  }
`,wa=nr.button`
  padding: 12px;
  background: #d4af37;
  color: #000;
  border: none;
  border-radius: 4px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  font-weight: bold;
  margin-top: 20px;
  
  &:hover {
    background: #f4cf47;
    box-shadow: 0 0 10px rgba(212, 175, 55, 0.7);
  }
  
  &:disabled {
    background: #666;
    cursor: not-allowed;
  }
`,_a=nr.div`
  color: #ff6b6b;
  text-align: center;
  margin-top: 10px;
`,Ea=nr.div`
  text-align: center;
  margin-top: 10px;
  color: #d4af37;
  font-size: 1.1rem;
`;const Ta=function(){const e=re(),{actions:t}=Nn(),[r,a]=(0,n.useState)({name:"",gender:"male",region:"central",background:"commoner",description:""}),[i,o]=(0,n.useState)({strength:10,intellect:10,spirit:10,agility:10,health:10}),[s,l]=(0,n.useState)(""),[c,d]=(0,n.useState)(10),u=e=>{const{name:t,value:r}=e.target;a((e=>({...e,[t]:r})))},p=(e,t)=>{const r=i[e]+t;t>0&&c<=0||r<10||r>20||(o((t=>({...t,[e]:r}))),d((e=>e-t)))},h=e=>{const t=[{id:"basic_cultivation_manual",name:"\u0411\u0430\u0437\u043e\u0432\u043e\u0435 \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u043f\u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438",type:"book",quality:"common",description:"\u041f\u0440\u043e\u0441\u0442\u043e\u0435 \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0441\u0442\u0432\u043e \u0434\u043b\u044f \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0445 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432."},{id:"qi_gathering_pill",name:"\u041f\u0438\u043b\u044e\u043b\u044f \u0441\u0431\u043e\u0440\u0430 \u0446\u0438",type:"consumable",quality:"common",quantity:3,description:"\u041f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0432 \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e\u0439 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438."}];switch(e){case"noble":t.push({id:"jade_pendant",name:"\u041d\u0435\u0444\u0440\u0438\u0442\u043e\u0432\u044b\u0439 \u043a\u0443\u043b\u043e\u043d",type:"accessory",quality:"uncommon",description:"\u0424\u0430\u043c\u0438\u043b\u044c\u043d\u0430\u044f \u0440\u0435\u043b\u0438\u043a\u0432\u0438\u044f, \u0443\u0441\u0438\u043b\u0438\u0432\u0430\u044e\u0449\u0430\u044f \u0434\u0443\u0445\u043e\u0432\u043d\u0443\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u044e."});break;case"warrior":t.push({id:"training_sword",name:"\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0439 \u043c\u0435\u0447",type:"weapon",quality:"common",description:"\u041f\u0440\u043e\u0441\u0442\u043e\u0439, \u043d\u043e \u043d\u0430\u0434\u0451\u0436\u043d\u044b\u0439 \u043c\u0435\u0447 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u043a."});break;case"scholar":t.push({id:"ancient_scroll",name:"\u0414\u0440\u0435\u0432\u043d\u0438\u0439 \u0441\u0432\u0438\u0442\u043e\u043a",type:"book",quality:"uncommon",description:"\u0421\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0437\u0430\u0431\u044b\u0442\u044b\u0435 \u0437\u043d\u0430\u043d\u0438\u044f \u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438."});break;case"merchant":t.push({id:"spirit_stones",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043a\u0430\u043c\u043d\u0438",type:"currency",quality:"common",quantity:10,description:"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u0432\u0430\u043b\u044e\u0442\u0430 \u043c\u0438\u0440\u0430 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438."})}return t};return(0,Cn.jsx)(oa,{children:(0,Cn.jsxs)(sa,{children:[(0,Cn.jsx)(la,{children:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430"}),(0,Cn.jsxs)(ca,{onSubmit:n=>{if(n.preventDefault(),l(""),!r.name.trim())return void l("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430");if(c>0)return void l("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u0435 \u0432\u0441\u0435 \u043e\u0447\u043a\u0438 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a");t.updatePlayer({name:r.name,gender:r.gender,region:r.region,background:r.background,description:r.description}),t.updatePlayerStats(i);h(r.background).forEach((e=>t.addItem(e))),e("/game")},children:[(0,Cn.jsxs)(da,{children:[(0,Cn.jsxs)(ua,{children:[(0,Cn.jsx)(pa,{children:"\u0418\u043c\u044f \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430"}),(0,Cn.jsx)(ha,{type:"text",name:"name",value:r.name,onChange:u,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f"}),(0,Cn.jsx)(pa,{children:"\u041f\u043e\u043b"}),(0,Cn.jsxs)(ma,{name:"gender",value:r.gender,onChange:u,children:[(0,Cn.jsx)("option",{value:"male",children:"\u041c\u0443\u0436\u0441\u043a\u043e\u0439"}),(0,Cn.jsx)("option",{value:"female",children:"\u0416\u0435\u043d\u0441\u043a\u0438\u0439"})]})]}),(0,Cn.jsxs)(ua,{children:[(0,Cn.jsx)(pa,{children:"\u0420\u0435\u0433\u0438\u043e\u043d \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f"}),(0,Cn.jsx)(ma,{name:"region",value:r.region,onChange:u,children:Object.entries({central:"\u0426\u0435\u043d\u0442\u0440\u0430\u043b\u044c\u043d\u044b\u0435 \u0440\u0430\u0432\u043d\u0438\u043d\u044b",mountain:"\u0413\u043e\u0440\u043d\u044b\u0435 \u0445\u0440\u0435\u0431\u0442\u044b",coastal:"\u041f\u0440\u0438\u0431\u0440\u0435\u0436\u043d\u044b\u0435 \u0437\u0435\u043c\u043b\u0438",desert:"\u0417\u0430\u043f\u0430\u0434\u043d\u0430\u044f \u043f\u0443\u0441\u0442\u044b\u043d\u044f",forest:"\u0414\u0440\u0435\u0432\u043d\u0438\u0435 \u043b\u0435\u0441\u0430"}).map((e=>{let[t,r]=e;return(0,Cn.jsx)("option",{value:t,children:r},t)}))}),(0,Cn.jsx)(pa,{children:"\u041f\u0440\u043e\u0438\u0441\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435"}),(0,Cn.jsx)(ma,{name:"background",value:r.background,onChange:u,children:Object.entries({commoner:"\u041f\u0440\u043e\u0441\u0442\u043e\u043b\u044e\u0434\u0438\u043d",noble:"\u0410\u0440\u0438\u0441\u0442\u043e\u043a\u0440\u0430\u0442",merchant:"\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446",warrior:"\u0412\u043e\u0438\u043d",scholar:"\u0423\u0447\u0451\u043d\u044b\u0439"}).map((e=>{let[t,r]=e;return(0,Cn.jsx)("option",{value:t,children:r},t)}))})]})]}),(0,Cn.jsx)(pa,{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430"}),(0,Cn.jsx)(ba,{name:"description",value:r.description,onChange:u,placeholder:"\u0420\u0430\u0441\u0441\u043a\u0430\u0436\u0438\u0442\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0432\u0430\u0448\u0435\u0433\u043e \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430..."}),(0,Cn.jsxs)(fa,{children:[(0,Cn.jsxs)(Ea,{children:["\u041e\u0447\u043a\u043e\u0432 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c: ",c]}),Object.entries(i).map((e=>{let[t,r]=e;return(0,Cn.jsxs)(ya,{children:[(0,Cn.jsxs)(ga,{children:["strength"===t&&"\u0421\u0438\u043b\u0430","intellect"===t&&"\u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442","spirit"===t&&"\u0414\u0443\u0445","agility"===t&&"\u041b\u043e\u0432\u043a\u043e\u0441\u0442\u044c","health"===t&&"\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435"]}),(0,Cn.jsx)(xa,{type:"button",onClick:()=>p(t,-1),disabled:r<=10,children:"-"}),(0,Cn.jsx)(va,{children:r}),(0,Cn.jsx)(xa,{type:"button",onClick:()=>p(t,1),disabled:r>=20||c<=0,children:"+"})]},t)}))]}),s&&(0,Cn.jsx)(_a,{children:s}),(0,Cn.jsx)(wa,{type:"submit",children:"\u041d\u0430\u0447\u0430\u0442\u044c \u043f\u0443\u0442\u044c \u043a \u0431\u0435\u0441\u0441\u043c\u0435\u0440\u0442\u0438\u044e"})]})]})})};const Sa=function(){var e;const{state:t}=Nn(),[r,a]=(0,n.useState)(!1),[i,o]=(0,n.useState)(null),[s,l]=(0,n.useState)(null),c=t.weather||{},d=(null===(e=t.world)||void 0===e?void 0:e.time)||{},u=void 0!==d.hour?d.hour:12,p=void 0!==d.minute?d.minute:0,h=`${String(u).padStart(2,"0")}:${String(p).padStart(2,"0")}`,m=u>=6&&u<20,f=u>=5&&u<7?"dawn":u>=7&&u<11?"morning":u>=11&&u<14?"noon":u>=14&&u<17?"afternoon":u>=17&&u<20?"evening":u>=20&&u<23?"night":"deepNight",y=c.currentWeather||c.weatherType||"clear",g=c.weatherIntensity||1,v=c.weatherEffects||null,x=c.nextWeatherChange||60,b=c.seasonDay||d.seasonDay||1,w=c.seasonLength||d.seasonLength||30,_=c.activeEvent||null,E=c.eventRemainingTime||0,T=void 0!==d.day?d.day:1,S=d.season||"spring",j=(0,n.useRef)({hour:u,minute:p,worldTime:d}),[C,k]=(0,n.useState)(0);return(0,n.useEffect)((()=>{const e=()=>{k((e=>e+1)),console.log("\ud83d\udd04 useTimeWeather: \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u0435 manual_time_update, \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b")};return window.addEventListener("manual_time_update",e),()=>{window.removeEventListener("manual_time_update",e)}}),[]),(0,n.useEffect)((()=>{var e;const t=j.current,r=t.hour!==u||t.minute!==p,n=void 0!==(null===(e=t.worldTime)||void 0===e?void 0:e.day)?Number(t.worldTime.day):1,m=void 0!==d.day?Number(d.day):1,f=m!==n;f&&console.log("\ud83d\udcc5\ud83d\udcc5 useTimeWeather: \u041e\u0411\u041d\u0410\u0420\u0423\u0416\u0415\u041d\u041e \u0418\u0417\u041c\u0415\u041d\u0415\u041d\u0418\u0415 \u0414\u041d\u042f:",{prevDay:n,currentDay:m,diff:m-n,worldTime:d,prevWorldTime:t.worldTime});const y=c.currentWeather||c.weatherType||"clear";var g;(r||f)&&(k((e=>e+1)),console.log("\u23f0 useTimeWeather: \u0418\u0417\u041c\u0415\u041d\u0415\u041d\u0418\u0415 \u0412\u0420\u0415\u041c\u0415\u041d\u0418 \u0438\u043b\u0438 \u0414\u041d\u042f!",{oldHour:t.hour,newHour:u,oldMinute:t.minute,newMinute:p,oldDay:null===(g=t.worldTime)||void 0===g?void 0:g.day,newDay:d.day,forceUpdateCounter:C+1}));null===i||i===h&&s===y||(a(!0),setTimeout((()=>a(!1)),500),console.log("\ud83d\udd04 useTimeWeather \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u0442\u0441\u044f:",{oldTime:i,newTime:h,oldWeather:s,newWeather:y,day:T,worldTime:d,forceUpdateCounter:C})),j.current={hour:u,minute:p,worldTime:d},o(h),l(y)}),[u,p,h,c,d,T,i,s,C]),{hour:u,minute:p,formattedTime:h,isDayTime:m,daytimePeriod:f,currentWeather:y,weatherIntensity:g,weatherEffects:v,dayCount:T,season:S,seasonDay:b,seasonLength:w,activeEvent:_,eventRemainingTime:E,nextWeatherChange:x,updating:r,worldTime:d,weather:c,forceUpdateCounter:C}},ja=nr.div`
  background-color: rgba(20, 20, 20, 0.8);
  border: 1px solid #444;
  border-radius: 6px;
  padding: 10px 15px;
  color: #fff;
  font-family: 'Arial', sans-serif;
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 10px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
`,Ca=nr.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,ka=nr.div`
  font-size: 1.2rem;
  color: ${e=>e.isDayTime?"#FFD700":"#8A97CD"};
`,Ia=nr.div`
  font-size: 1.1rem;
  font-weight: bold;
  color: #eee;
`,Aa=nr.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,Na=nr.div`
  font-size: 1.2rem;
  color: ${e=>{switch(e.type){case"clear":default:return"#FFD700";case"cloudy":return"#B0C4DE";case"rain":return"#4682B4";case"thunderstorm":return"#483D8B";case"fog":return"#D3D3D3";case"snow":return"#F0F8FF"}}};
`,Da=nr.div`
  font-size: 1rem;
`,Ma=nr.div`
  height: 8px;
  width: 100%;
  background: ${e=>{switch(e.season){case"spring":default:return"linear-gradient(to right, #C5E8B7, #ABE098, #83D475)";case"summer":return"linear-gradient(to right, #FFD700, #FFA500, #FF8C00)";case"autumn":return"linear-gradient(to right, #D2691E, #CD853F, #B8860B)";case"winter":return"linear-gradient(to right, #B0E0E6, #87CEEB, #1E90FF)"}}};
  border-radius: 4px;
  margin-top: 8px;
`,Ra={clear:"\u042f\u0441\u043d\u043e",cloudy:"\u041e\u0431\u043b\u0430\u0447\u043d\u043e",rain:"\u0414\u043e\u0436\u0434\u044c",thunderstorm:"\u0413\u0440\u043e\u0437\u0430",fog:"\u0422\u0443\u043c\u0430\u043d",snow:"\u0421\u043d\u0435\u0433"},Pa={dawn:"\u0420\u0430\u0441\u0441\u0432\u0435\u0442",morning:"\u0423\u0442\u0440\u043e",noon:"\u041f\u043e\u043b\u0434\u0435\u043d\u044c",afternoon:"\u0414\u0435\u043d\u044c",evening:"\u0412\u0435\u0447\u0435\u0440",night:"\u041d\u043e\u0447\u044c",deepNight:"\u0413\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c"},La={dawn:"\ud83c\udf05",morning:"\ud83c\udf04",noon:"\u2600\ufe0f",afternoon:"\ud83c\udf1e",evening:"\ud83c\udf07",night:"\ud83c\udf19",deepNight:"\ud83c\udf1a"},$a={clear:"\u2600\ufe0f",cloudy:"\u2601\ufe0f",rain:"\ud83c\udf27\ufe0f",thunderstorm:"\u26c8\ufe0f",fog:"\ud83c\udf2b\ufe0f",snow:"\u2744\ufe0f"},Oa={spring:"\u0412\u0435\u0441\u043d\u0430",summer:"\u041b\u0435\u0442\u043e",autumn:"\u041e\u0441\u0435\u043d\u044c",winter:"\u0417\u0438\u043c\u0430"};const qa=function(){const e=Sa(),[t,r]=(0,n.useReducer)((e=>e+1),0),{hour:a,minute:i,formattedTime:o,isDayTime:s,daytimePeriod:l,currentWeather:c,dayCount:d,season:u,forceUpdateCounter:p}=e;return void 0===a&&void 0===i?null:((0,n.useEffect)((()=>{r(),console.log("\ud83d\udd04 WorldTimeWidget: \u041f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435",{forceUpdateCounter:p,time:o,day:d})}),[p,o,d]),(0,Cn.jsxs)(ja,{children:[(0,Cn.jsxs)(Ca,{children:[(0,Cn.jsx)(ka,{isDayTime:s,children:La[l]}),(0,Cn.jsxs)(Ia,{children:[o," (",Pa[l],")"]})]}),(0,Cn.jsxs)(Aa,{children:[(0,Cn.jsx)(Na,{type:c,children:$a[c]}),(0,Cn.jsx)(Da,{children:Ra[c]})]}),(0,Cn.jsxs)("div",{children:[(0,Cn.jsxs)("div",{children:[Oa[u]," (\u0434\u0435\u043d\u044c ",d,")"]}),(0,Cn.jsx)(Ma,{season:u})]})]}))};nr.div`
  background-color: rgba(20, 20, 20, 0.8);
  border: 1px solid #555;
  border-radius: 8px;
  padding: 10px 15px;
  margin-bottom: 15px;
  color: #fff;
`,nr.h3`
  font-size: 1.1rem;
  color: #ffd700;
  margin: 0 0 15px 0;
  display: flex;
  align-items: center;
  padding-bottom: 8px;
  border-bottom: 1px solid rgba(255, 215, 0, 0.3);
  
  span {
    margin-right: 8px;
  }
`,nr.div`
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding-bottom: 5px;
  
  /*   */
  &::-webkit-scrollbar {
    height: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: rgba(30, 30, 30, 0.6);
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: rgba(150, 150, 150, 0.6);
    border-radius: 3px;
  }
`,nr.div`
  flex: 0 0 auto;
  min-width: 180px;
  background-color: rgba(50, 50, 50, 0.6);
  border-radius: 6px;
  padding: 12px;
  position: relative;
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: ${e=>{switch(e.weatherType){case"clear":default:return"linear-gradient(to right, #FFD700, #FFA500)";case"cloudy":return"linear-gradient(to right, #B0C4DE, #778899)";case"rain":return"linear-gradient(to right, #4682B4, #1E90FF)";case"thunderstorm":return"linear-gradient(to right, #483D8B, #6A5ACD)";case"fog":return"linear-gradient(to right, #D3D3D3, #A9A9A9)";case"snow":return"linear-gradient(to right, #F0F8FF, #B0E2FF)"}}};
    border-radius: 6px 6px 0 0;
  }
`,nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
`,nr.div`
  font-weight: bold;
  display: flex;
  align-items: center;
  gap: 6px;
`,nr.span`
  font-size: 1.3rem;
`,nr.div`
  font-size: 0.85rem;
  color: ${e=>e.value>100?"#FF7F7F":"#7FFF7F"};
`,nr.div`
  font-size: 0.85rem;
  color: #ccc;
  margin-top: 5px;
`,nr.div`
  position: absolute;
  top: -8px;
  right: -8px;
  background-color: rgba(255, 215, 0, 0.8);
  color: #000;
  font-size: 0.7rem;
  font-weight: bold;
  padding: 2px 6px;
  border-radius: 4px;
  transform: rotate(5deg);
`;var Ua=r(685);const Fa=nr.div`
  background-color: rgba(20, 20, 20, 0.8);
  border: 1px solid #444;
  border-radius: 6px;
  padding: 15px;
  color: #fff;
  font-family: 'Arial', sans-serif;
  margin-bottom: 10px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
`,za=nr.div`
  font-size: 1.1rem;
  font-weight: bold;
  color: #ffd700;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
`,Ba=nr.div`
  display: flex;
  flex-direction: column;
  gap: 8px;
`,Ga=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 5px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  
  &:last-child {
    border-bottom: none;
  }
`,Wa=nr.div`
  font-size: 1.2rem;
  color: ${e=>{switch(e.type){case"positive":return"#7FFF7F";case"negative":return"#FF7F7F";case"neutral":return"#FFFF7F";default:return"#FFFFFF"}}};
`,Ha=nr.div`
  flex: 1;
`,Va=nr.div`
  font-weight: bold;
  color: ${e=>{const t=parseFloat(e.value);return isNaN(t)?"#FFFFFF":t>0?"#7FFF7F":t<0?"#FF7F7F":"#FFFFFF"}};
`;const Qa=function(){var e,t;const{state:r}=Nn(),a=(null===(e=r.world)||void 0===e||e.weather,null===(t=r.world)||void 0===t||t.currentLocation,(0,n.useMemo)((()=>(0,Ua.IC)(r).sort(((e,t)=>{if(e.displayType!==t.displayType){if("positive"===e.displayType)return-1;if("negative"===e.displayType)return 1;if("neutral"===e.displayType&&"positive"===t.displayType)return 1;if("neutral"===e.displayType&&"negative"===t.displayType)return-1}return e.name.localeCompare(t.name)})).map((e=>({name:e.name,value:e.displayValue,icon:e.icon||"\u2728",type:e.displayType,source:e.source})))),[r]));return 0===a.length?null:(0,Cn.jsxs)(Fa,{children:[(0,Cn.jsxs)(za,{children:["\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b (",a.length,")"]}),(0,Cn.jsx)(Ba,{children:a.map(((e,t)=>(0,Cn.jsxs)(Ga,{children:[(0,Cn.jsx)(Wa,{type:e.type,children:e.icon}),(0,Cn.jsx)(Ha,{children:e.name}),(0,Cn.jsx)(Va,{value:e.value,children:e.value})]},t)))})]})},Ya=rr`
  0% {
    background-position: 0% 0%;
  }
  100% {
    background-position: 20% 100%;
  }
`,Ka=rr`
  0% {
    background-position: 0px 0px;
  }
  100% {
    background-position: 500px 1000px, 400px 400px;
  }
`,Xa=rr`
  0% {
    opacity: 0.5;
    transform: translateX(-5%) translateY(0);
  }
  50% {
    opacity: 0.55;
    transform: translateX(0) translateY(0);
  }
  100% {
    opacity: 0.5;
    transform: translateX(5%) translateY(0);
  }
`,Ja=rr`
  0% {
    opacity: 0;
  }
  10% {
    opacity: 0.8;
  }
  20% {
    opacity: 0;
  }
  30% {
    opacity: 0;
  }
  40% {
    opacity: 0.4;
  }
  50% {
    opacity: 0;
  }
  100% {
    opacity: 0;
  }
`,Za=nr.div`
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 100;
  transition: all 1s ease-in-out;
  
  /*       */
  ${e=>{let t="";switch(e.daytimePeriod){case"dawn":t+="brightness(0.9) sepia(0.2)";break;case"morning":t+="brightness(1.1) contrast(1.05)";break;case"noon":t+="brightness(1.2) contrast(1.1)";break;case"afternoon":t+="brightness(1.15) contrast(1.05)";break;case"evening":t+="brightness(0.9) sepia(0.15)";break;case"night":t+="brightness(0.7) contrast(1.2) saturate(0.8)";break;case"deepNight":t+="brightness(0.6) contrast(1.3) saturate(0.7)";break;default:t+="brightness(1) contrast(1)"}return`filter: ${t};`}}
`,ei=nr.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  
  ${e=>{switch(e.weatherType){case"rain":return Ft`
          background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><line x1="20" y1="0" x2="10" y2="30" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="30" y1="10" x2="20" y2="40" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="40" y1="0" x2="30" y2="30" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="50" y1="5" x2="40" y2="35" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="60" y1="0" x2="50" y2="30" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="70" y1="10" x2="60" y2="40" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="80" y1="0" x2="70" y2="30" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="90" y1="5" x2="80" y2="35" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/></svg>');
          background-repeat: repeat;
          opacity: ${.7*e.intensity};
          animation: ${Ya} 0.5s linear infinite;
        `;case"snow":return Ft`
          background-image: 
            radial-gradient(circle at 50% 50%, white 0.5px, transparent 1px),
            radial-gradient(circle at 70% 30%, white 0.5px, transparent 1px);
          background-size: 100px 100px, 150px 150px;
          opacity: ${.5*e.intensity};
          animation: ${Ka} 20s linear infinite;
        `;case"fog":return Ft`
          background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), rgba(200, 200, 200, 0.2));
          opacity: ${.5*e.intensity};
          animation: ${Xa} 20s ease-in-out infinite;
        `;case"thunderstorm":return Ft`
          background-color: rgba(255, 255, 255, 0);
          box-shadow: inset 0 0 100vw 0 rgba(255, 255, 255, 0);
          animation: ${Ja} ${10+20*Math.random()}s ease-out infinite;
          opacity: ${.2*e.intensity};
        `;case"cloudy":return Ft`
          background-image: 
            radial-gradient(circle at 30% 40%, rgba(220, 220, 220, 0.3) 20px, transparent 30px),
            radial-gradient(circle at 70% 50%, rgba(220, 220, 220, 0.3) 30px, transparent 40px);
          background-size: 200px 200px;
          opacity: ${.3*e.intensity};
        `;default:return""}}}
`,ti=nr.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 101;
  
  ${e=>{if(e.specialEvent)switch(e.specialEvent){case"bloom":return Ft`
            box-shadow: inset 0 0 100px rgba(255, 230, 230, 0.3);
            background: 
              radial-gradient(circle at 30% 40%, rgba(255, 200, 200, 0.1) 0px, transparent 100px),
              radial-gradient(circle at 70% 60%, rgba(255, 200, 200, 0.1) 0px, transparent 100px);
          `;case"spirit_tide":return Ft`
            background: linear-gradient(to bottom, 
              rgba(100, 150, 255, 0.05) 0%, 
              rgba(100, 200, 255, 0.1) 50%, 
              rgba(100, 150, 255, 0.05) 100%);
          `;case"solstice":return Ft`
            box-shadow: inset 0 0 150px rgba(255, 200, 100, 0.3);
          `;case"meteor_shower":return Ft`
            background-image: linear-gradient(to bottom right, rgba(255, 255, 255, 0) 80%, rgba(255, 255, 255, 0.2) 80.5%, rgba(255, 255, 255, 0) 81%);
            background-size: 200px 200px;
            animation: ${Ya} 1s linear infinite;
          `;case"ice_tribulation":return Ft`
            background: radial-gradient(circle at center, rgba(200, 230, 255, 0.1) 0%, transparent 100%);
            box-shadow: inset 0 0 100px rgba(200, 230, 255, 0.2);
          `;case"blizzard":return Ft`
            background-image: 
              radial-gradient(circle at 50% 50%, white 1px, transparent 2px),
              radial-gradient(circle at 70% 30%, white 1px, transparent 2px);
            background-size: 50px 50px, 70px 70px;
            opacity: 0.7;
            animation: ${Ka} 5s linear infinite;
          `;default:return""}return""}}
`,ri=nr.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  opacity: 0.2;
  
  ${e=>{switch(e.season){case"spring":return Ft`
          box-shadow: inset 0 0 200px rgba(150, 255, 150, 0.1);
        `;case"summer":return Ft`
          box-shadow: inset 0 0 200px rgba(255, 200, 100, 0.1);
        `;case"autumn":return Ft`
          box-shadow: inset 0 0 200px rgba(255, 150, 50, 0.1);
        `;case"winter":return Ft`
          box-shadow: inset 0 0 200px rgba(200, 230, 255, 0.1);
        `;default:return""}}}
`,ni=nr.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  
  ${e=>{if(e.location){return{lake_of_reflections:Ft`
          background: linear-gradient(to bottom, rgba(100, 200, 255, 0.03) 0%, rgba(100, 150, 255, 0.05) 100%);
        `,fire_mountain:Ft`
          box-shadow: inset 0 0 200px rgba(255, 100, 50, 0.1);
        `,wind_plains:Ft`
          opacity: 0.1;
          background-image: linear-gradient(to right, transparent 90%, rgba(200, 200, 255, 0.2) 100%);
          background-size: 100px 100%;
          animation: ${Xa} 30s linear infinite;
        `,spirit_forest:Ft`
          background-image: 
            radial-gradient(circle at 30% 40%, rgba(150, 255, 150, 0.1) 0px, transparent 50px),
            radial-gradient(circle at 70% 60%, rgba(150, 255, 150, 0.1) 0px, transparent 50px);
        `,frozen_peaks:Ft`
          box-shadow: inset 0 0 150px rgba(200, 230, 255, 0.1);
        `,desert_of_trials:Ft`
          background: linear-gradient(to bottom, rgba(255, 200, 100, 0.05) 0%, rgba(255, 150, 50, 0.03) 100%);
        `}[e.location.id||"unknown"]||""}return""}}
`;const ai=function(){const{state:e}=Nn(),t=e.weather||{},r=e.world||{},a=r.currentLocation||{},i=(0,n.useMemo)((()=>{var e;const n=void 0!==t.hour?t.hour:(null===(e=r.time)||void 0===e?void 0:e.hour)||12;return t.daytimePeriod?t.daytimePeriod:n>=5&&n<7?"dawn":n>=7&&n<11?"morning":n>=11&&n<14?"noon":n>=14&&n<17?"afternoon":n>=17&&n<20?"evening":n>=20&&n<23?"night":"deepNight"}),[t,r.time]),o=t.currentWeather||"clear",s=t.weatherIntensity||1,l=t.activeEvent||null,c=t.currentSeason||"spring";return(0,Cn.jsxs)(Za,{daytimePeriod:i,children:[(0,Cn.jsx)(ei,{weatherType:o,intensity:s}),(0,Cn.jsx)(ri,{season:c}),l&&(0,Cn.jsx)(ti,{specialEvent:l}),(0,Cn.jsx)(ni,{location:a})]})},ii=nr.div`
  background-color: rgba(20, 20, 20, 0.9);
  border: 1px solid #555;
  border-radius: 8px;
  padding: 20px;
  color: #fff;
  font-family: 'Arial', sans-serif;
  max-width: 800px;
  margin: 0 auto;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6);
`,oi=nr.h2`
  font-size: 1.4rem;
  color: #ffd700;
  margin: 0 0 20px 0;
  text-align: center;
  border-bottom: 1px solid rgba(255, 215, 0, 0.3);
  padding-bottom: 10px;
`,si=nr.div`
  margin-bottom: 20px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,li=nr.h3`
  font-size: 1.2rem;
  color: #ddd;
  margin: 0 0 10px 0;
  display: flex;
  align-items: center;
  gap: 8px;
`,ci=nr.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 15px;
`,di=nr.div`
  display: flex;
  flex-direction: row;
  overflow-x: auto;
  gap: 15px;
  padding-bottom: 10px;
  
  /*   */
  &::-webkit-scrollbar {
    height: 6px;
  }
  
  &::-webkit-scrollbar-track {
    background: rgba(30, 30, 30, 0.6);
    border-radius: 3px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: rgba(150, 150, 150, 0.6);
    border-radius: 3px;
  }
`,ui=nr.div`
  background-color: rgba(50, 50, 50, 0.6);
  border-radius: 6px;
  padding: 15px;
  display: flex;
  flex-direction: column;
  gap: 5px;
`,pi=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding: 5px 0;
  
  &:last-child {
    border-bottom: none;
  }
`,hi=nr.span`
  color: #aaa;
`,mi=nr.span`
  color: #fff;
  font-weight: bold;
  
  ${e=>e.highlight&&"\n    color: #ffd700;\n  "}
  
  ${e=>"positive"===e.type&&"\n    color: #7FFF7F;\n  "}
  
  ${e=>"negative"===e.type&&"\n    color: #FF7F7F;\n  "}
`,fi=nr.div`
  background-color: rgba(50, 50, 50, 0.6);
  border-radius: 6px;
  padding: 15px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  position: relative;
  min-width: 250px;
  max-width: 300px;
  flex: 1;
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: ${e=>{switch(e.weatherType){case"clear":default:return"linear-gradient(to right, #FFD700, #FFA500)";case"cloudy":return"linear-gradient(to right, #B0C4DE, #778899)";case"rain":return"linear-gradient(to right, #4682B4, #1E90FF)";case"thunderstorm":return"linear-gradient(to right, #483D8B, #6A5ACD)";case"fog":return"linear-gradient(to right, #D3D3D3, #A9A9A9)";case"snow":return"linear-gradient(to right, #F0F8FF, #B0E2FF)"}}};
    border-radius: 6px 6px 0 0;
  }
`,yi=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: bold;
`,gi=nr.span`
  font-size: 1.4rem;
  margin-right: 5px;
`,vi=nr.div`
  font-size: 0.9rem;
  color: #aaa;
`,xi=nr.div`
  background-color: rgba(30, 30, 30, 0.6);
  height: 8px;
  border-radius: 4px;
  position: relative;
  overflow: hidden;
  
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: ${e=>e.progress||0}%;
    background: ${e=>{switch(e.type){case"time":default:return"linear-gradient(to right, #4682B4, #87CEEB)";case"day":return"linear-gradient(to right, #FFD700, #FFA500)";case"season":return"linear-gradient(to right, #9370DB, #8A2BE2)"}}};
    border-radius: 4px;
  }
`,bi=nr.button`
  position: absolute;
  top: 15px;
  right: 15px;
  background: none;
  border: none;
  color: #aaa;
  font-size: 1.2rem;
  cursor: pointer;
  
  &:hover {
    color: #fff;
  }
`,wi={clear:"\u2600\ufe0f",cloudy:"\u2601\ufe0f",rain:"\ud83c\udf27\ufe0f",thunderstorm:"\u26c8\ufe0f",fog:"\ud83c\udf2b\ufe0f",snow:"\u2744\ufe0f"},_i={clear:"\u042f\u0441\u043d\u043e",cloudy:"\u041e\u0431\u043b\u0430\u0447\u043d\u043e",rain:"\u0414\u043e\u0436\u0434\u044c",thunderstorm:"\u0413\u0440\u043e\u0437\u0430",fog:"\u0422\u0443\u043c\u0430\u043d",snow:"\u0421\u043d\u0435\u0433"},Ei={spring:"\u0412\u0435\u0441\u043d\u0430",summer:"\u041b\u0435\u0442\u043e",autumn:"\u041e\u0441\u0435\u043d\u044c",winter:"\u0417\u0438\u043c\u0430"},Ti={spring:"\ud83c\udf31",summer:"\u2600\ufe0f",autumn:"\ud83c\udf42",winter:"\u2744\ufe0f"},Si={bloom:"\u0426\u0432\u0435\u0442\u0435\u043d\u0438\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u0442\u0440\u0430\u0432",spirit_tide:"\u041f\u0440\u0438\u043b\u0438\u0432 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",solstice:"\u0421\u043e\u043b\u043d\u0446\u0435\u0441\u0442\u043e\u044f\u043d\u0438\u0435",meteor_shower:"\u041c\u0435\u0442\u0435\u043e\u0440\u0438\u0442\u043d\u044b\u0439 \u0434\u043e\u0436\u0434\u044c",harvest:"\u0421\u0431\u043e\u0440 \u0443\u0440\u043e\u0436\u0430\u044f",spirit_wind:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u0432\u0435\u0442\u0435\u0440",ice_tribulation:"\u041b\u0435\u0434\u044f\u043d\u0430\u044f \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f",blizzard:"\u041c\u0435\u0442\u0435\u043b\u044c"},ji={bloom:"\ud83c\udf38",spirit_tide:"\ud83c\udf0a",solstice:"\u2600\ufe0f",meteor_shower:"\u2604\ufe0f",harvest:"\ud83c\udf3e",spirit_wind:"\ud83c\udf2c\ufe0f",ice_tribulation:"\u2744\ufe0f",blizzard:"\ud83c\udf28\ufe0f"},Ci={dawn:"\u0420\u0430\u0441\u0441\u0432\u0435\u0442",morning:"\u0423\u0442\u0440\u043e",noon:"\u041f\u043e\u043b\u0434\u0435\u043d\u044c",afternoon:"\u0414\u0435\u043d\u044c",evening:"\u0412\u0435\u0447\u0435\u0440",night:"\u041d\u043e\u0447\u044c",deepNight:"\u0413\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c"},ki={dawn:"\ud83c\udf05",morning:"\ud83c\udf04",noon:"\u2600\ufe0f",afternoon:"\ud83c\udf1e",evening:"\ud83c\udf07",night:"\ud83c\udf19",deepNight:"\ud83c\udf1a"};const Ii=function(e){var t,r;let{onClose:a}=e;const{state:i}=Nn(),o=Sa();if(!o)return null;const s=i.weather||{},l=(i.world||{}).currentLocation||{},c=o.hour,d=o.minute,u=o.daytimePeriod,p=o.formattedTime,h=o.currentWeather,m=o.weatherIntensity,f=s.nextWeatherChange||0,y=Math.max(0,Math.min(100,100-f/120*100)),{actions:g}=Nn();n.useEffect((()=>{s.currentWeather&&s.currentWeather!==h&&console.warn("\u26a0\ufe0f \u041d\u0435\u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435 \u043f\u043e\u0433\u043e\u0434\u044b:",{hookWeather:h,stateWeather:s.currentWeather})}),[h,s.currentWeather]),n.useEffect((()=>{if(0===f&&h){console.log("\u26a0\ufe0f WeatherDetailScreen: \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d \u043d\u0443\u043b\u0435\u0432\u043e\u0439 nextWeatherChange, \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u043c \u0441\u043c\u0435\u043d\u0443 \u043f\u043e\u0433\u043e\u0434\u044b");const e=setTimeout((()=>{g.dispatch({type:"FORCE_WEATHER_CHANGE"}),console.log("\ud83c\udf26\ufe0f WeatherDetailScreen: \u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430 \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0441\u043c\u0435\u043d\u0430 \u043f\u043e\u0433\u043e\u0434\u044b \u0438\u0437-\u0437\u0430 \u043d\u0443\u043b\u0435\u0432\u043e\u0433\u043e \u0442\u0430\u0439\u043c\u0435\u0440\u0430")}),500);return()=>clearTimeout(e)}}),[f,h,g]);const v=o.season,x=s.seasonDay||1,b=s.seasonLength||30,w=x/b*100,_=s.activeEvent||null,E=s.eventRemainingTime||0,T=s.forecast||[],S=(60*c+d)/1440*100;return(0,Cn.jsxs)(ii,{children:[(0,Cn.jsx)(bi,{onClick:a,children:"\xd7"}),(0,Cn.jsx)(oi,{children:"\u0414\u0435\u0442\u0430\u043b\u044c\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u0433\u043e\u0434\u0435 \u0438 \u0432\u0440\u0435\u043c\u0435\u043d\u0438"}),(0,Cn.jsxs)(si,{children:[(0,Cn.jsx)(li,{children:(0,Cn.jsx)("span",{children:"\ud83d\udd52 \u0422\u0435\u043a\u0443\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0438 \u043f\u043e\u0433\u043e\u0434\u0430"})}),(0,Cn.jsxs)(ci,{children:[(0,Cn.jsxs)(ui,{children:[(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0412\u0440\u0435\u043c\u044f:"}),(0,Cn.jsx)(mi,{highlight:!0,children:p})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u041f\u0435\u0440\u0438\u043e\u0434 \u0441\u0443\u0442\u043e\u043a:"}),(0,Cn.jsxs)(mi,{children:[ki[u]," ",Ci[u]]})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0421\u0443\u0442\u043e\u0447\u043d\u044b\u0439 \u0446\u0438\u043a\u043b:"}),(0,Cn.jsx)(mi,{children:(0,Cn.jsx)(xi,{progress:S,type:"day"})})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0414\u0435\u043d\u044c:"}),(0,Cn.jsx)(mi,{children:o.dayCount})]})]}),(0,Cn.jsxs)(ui,{children:[(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u043f\u043e\u0433\u043e\u0434\u0430:"}),(0,Cn.jsxs)(mi,{children:[wi[h]," ",_i[h]]})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0418\u043d\u0442\u0435\u043d\u0441\u0438\u0432\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsxs)(mi,{children:[Math.min(100,Math.round(100*m)),"%"]})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0414\u043e \u0441\u043c\u0435\u043d\u044b \u043f\u043e\u0433\u043e\u0434\u044b:"}),(0,Cn.jsxs)(mi,{children:[f," \u043c\u0438\u043d. \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438"]})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441:"}),(0,Cn.jsx)(mi,{children:(0,Cn.jsx)(xi,{progress:y,type:"time"})})]})]})]})]}),(0,Cn.jsxs)(si,{children:[(0,Cn.jsx)(li,{children:(0,Cn.jsx)("span",{children:"\ud83c\udf21\ufe0f \u0421\u0435\u0437\u043e\u043d \u0438 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"})}),(0,Cn.jsxs)(ci,{children:[(0,Cn.jsxs)(ui,{children:[(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u0441\u0435\u0437\u043e\u043d:"}),(0,Cn.jsxs)(mi,{children:[Ti[v]," ",Ei[v]]})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0414\u0435\u043d\u044c \u0441\u0435\u0437\u043e\u043d\u0430:"}),(0,Cn.jsxs)(mi,{children:[x," \u0438\u0437 ",b]})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0441\u0435\u0437\u043e\u043d\u0430:"}),(0,Cn.jsx)(mi,{children:(0,Cn.jsx)(xi,{progress:w,type:"season"})})]})]}),(0,Cn.jsxs)(ui,{children:[(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435:"}),(0,Cn.jsx)(mi,{highlight:null!==_,children:_?`${ji[_]} ${Si[_]}`:"\u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u043e\u0431\u044b\u0442\u0438\u0439"})]}),_&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u041e\u0441\u0442\u0430\u0432\u0448\u0435\u0435\u0441\u044f \u0432\u0440\u0435\u043c\u044f:"}),(0,Cn.jsxs)(mi,{children:[E," \u043c\u0438\u043d. \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438"]})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0441\u043e\u0431\u044b\u0442\u0438\u044f:"}),(0,Cn.jsx)(mi,{children:(0,Cn.jsx)(xi,{progress:100-E/((null===(t=s.specialEvents)||void 0===t||null===(r=t[_])||void 0===r?void 0:r.duration)||120)*100,type:"time"})})]})]})]})]})]}),T.length>0&&(0,Cn.jsxs)(si,{children:[(0,Cn.jsx)(li,{children:(0,Cn.jsx)("span",{children:"\ud83d\udd2e \u041f\u0440\u043e\u0433\u043d\u043e\u0437 \u043f\u043e\u0433\u043e\u0434\u044b"})}),(0,Cn.jsxs)(di,{children:[(0,Cn.jsxs)(fi,{weatherType:h,children:[(0,Cn.jsxs)(yi,{children:[(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)(gi,{children:wi[h]}),_i[h]]}),(0,Cn.jsxs)(mi,{type:m>1?"negative":"positive",children:[Math.round(100*m),"%"]})]}),(0,Cn.jsx)(vi,{children:(0,Cn.jsx)("strong",{children:"\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u043f\u043e\u0433\u043e\u0434\u0430"})}),(0,Cn.jsxs)(vi,{children:["\u0414\u043e \u0441\u043c\u0435\u043d\u044b: ",f," \u043c\u0438\u043d. \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438"]})]}),T.map(((e,t)=>(0,Cn.jsxs)(fi,{weatherType:e.type,children:[(0,Cn.jsxs)(yi,{children:[(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)(gi,{children:wi[e.type]}),_i[e.type]]}),(0,Cn.jsxs)(mi,{type:e.intensity>1?"negative":"positive",children:[Math.round(100*e.intensity),"%"]})]}),(0,Cn.jsxs)(vi,{children:["\u0427\u0435\u0440\u0435\u0437 ",e.timeToOccur," \u043c\u0438\u043d. \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438"]}),(0,Cn.jsxs)(vi,{children:["\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c: ",e.duration," \u043c\u0438\u043d. \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438"]})]},t)))]})]}),(0,Cn.jsxs)(si,{children:[(0,Cn.jsx)(li,{children:(0,Cn.jsx)("span",{children:"\ud83c\udfde\ufe0f \u0412\u043b\u0438\u044f\u043d\u0438\u0435 \u043b\u043e\u043a\u0430\u0446\u0438\u0438"})}),(0,Cn.jsxs)(ui,{children:[(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u0422\u0435\u043a\u0443\u0449\u0430\u044f \u043b\u043e\u043a\u0430\u0446\u0438\u044f:"}),(0,Cn.jsx)(mi,{highlight:!0,children:l&&l.name?l.name:"\u0414\u043e\u043b\u0438\u043d\u0430 \u041d\u0430\u0447\u0430\u043b\u0430"})]}),(()=>{const e={},t=l&&l.type?l.type:"forest";switch(t){case"forest":e.baseEnergy={value:"+5%",positive:!0},e.basePerception={value:"+10%",positive:!0},"spring"===v&&(e.resourceBonus={value:"+20% \u043a \u0441\u0431\u043e\u0440\u0443 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432",positive:!0}),"rain"===h&&(e.energyRecovery={value:"+10% \u043a \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u0438",positive:!0});break;case"mountain":e.baseStrength={value:"+5%",positive:!0},e.baseStamina={value:"+15%",positive:!0},"winter"===v&&(e.cultivationSpeed={value:"+15% \u043a \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438",positive:!0}),"thunderstorm"===h&&(e.insightChance={value:"+20% \u043a \u0448\u0430\u043d\u0441\u0443 \u043e\u0437\u0430\u0440\u0435\u043d\u0438\u044f",positive:!0});break;case"water":e.baseWisdom={value:"+10%",positive:!0},e.baseHealing={value:"+15%",positive:!0},"summer"===v&&(e.cooldown={value:"-20% \u043a \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0430\u0432\u044b\u043a\u043e\u0432",positive:!0}),"clear"===h&&(e.spiritualEnergy={value:"+20% \u043a \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044e \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",positive:!0});break;case"city":e.baseSocial={value:"+20%",positive:!0},e.baseLuck={value:"+5%",positive:!0},"autumn"===v&&(e.tradeBonus={value:"+15% \u043a \u0432\u044b\u0433\u043e\u0434\u0435 \u043f\u0440\u0438 \u0442\u043e\u0440\u0433\u043e\u0432\u043b\u0435",positive:!0}),"fog"===h&&(e.stealthBonus={value:"+30% \u043a \u0441\u043a\u0440\u044b\u0442\u043d\u043e\u0441\u0442\u0438",positive:!0});break;case"dungeon":e.baseAttack={value:"+10%",positive:!0},e.baseDefense={value:"+5%",positive:!0},"winter"===v&&(e.defenseBonus={value:"+10% \u043a \u0437\u0430\u0449\u0438\u0442\u0435",positive:!0}),"thunderstorm"===h&&(e.attackBonus={value:"+20% \u043a \u0430\u0442\u0430\u043a\u0435",positive:!0})}switch(u){case"dawn":"forest"===t&&(e.dawnPerception={value:"+15% \u043a \u0432\u043e\u0441\u043f\u0440\u0438\u044f\u0442\u0438\u044e",positive:!0}),"water"===t&&(e.dawnMeditation={value:"+25% \u043a \u044d\u0444\u0444\u0435\u043a\u0442\u0443 \u043c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u0438",positive:!0});break;case"afternoon":"mountain"===t&&(e.dayStamina={value:"+10% \u043a \u0432\u044b\u043d\u043e\u0441\u043b\u0438\u0432\u043e\u0441\u0442\u0438",positive:!0});break;case"night":case"deepNight":"water"===t&&(e.nightEnergy={value:"+20% \u043a \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",positive:!0}),"dungeon"===t&&(e.nightMonsterStrength={value:"+15% \u043a \u0441\u0438\u043b\u0435 \u043c\u043e\u043d\u0441\u0442\u0440\u043e\u0432",positive:!1})}if(_)switch(_){case"bloom":"forest"===t&&(e.bloomHerbQuality={value:"+50% \u043a \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0443 \u0442\u0440\u0430\u0432",positive:!0});break;case"spirit_tide":"water"===t&&(e.tideSpiritualPower={value:"+40% \u043a \u0441\u0438\u043b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u0442\u0435\u0445\u043d\u0438\u043a",positive:!0});break;case"solstice":"mountain"===t&&(e.solsticeCultivation={value:"+30% \u043a \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438",positive:!0});break;case"meteor_shower":e.meteorRareMaterials={value:"\u0428\u0430\u043d\u0441 \u043d\u0430\u0439\u0442\u0438 \u0440\u0435\u0434\u043a\u0438\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b",positive:!0}}return(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u043b\u043e\u043a\u0430\u0446\u0438\u0438:"}),(0,Cn.jsx)(mi,{children:Object.entries(e).filter((e=>{let[t]=e;return t.startsWith("base")})).length>0?Object.entries(e).filter((e=>{let[t]=e;return t.startsWith("base")})).map((e=>{let[t,r]=e;return t.replace("base","")+": "+r.value})).join(", "):"\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442"})]}),(0,Cn.jsxs)(pi,{children:[(0,Cn.jsx)(hi,{children:"\u041f\u043e\u0433\u043e\u0434\u043d\u044b\u0435 \u043c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b:"}),(0,Cn.jsx)(mi,{children:Object.entries(e).filter((e=>{let[t]=e;return!t.startsWith("base")})).length>0?Object.entries(e).filter((e=>{let[t]=e;return!t.startsWith("base")})).map((e=>{let[t,r]=e;return r.value})).join(", "):"\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442"})]})]})})()]})]})]})},Ai=rr`
  0% {
    box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.7);
  }
  70% {
    box-shadow: 0 0 0 10px rgba(212, 175, 55, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(212, 175, 55, 0);
  }
`,Ni=rr`
  0% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
`,Di=rr`
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
`,Mi=nr.div`
  display: flex;
  flex-direction: column;
  gap: 20px;
  animation: ${Di} 0.5s ease-in-out;
`,Ri=nr.div`
  display: flex;
  gap: 5px;
  margin-bottom: 10px;
`,Pi=nr.div`
  padding: 10px 20px;
  background: ${e=>e.active?"rgba(212, 175, 55, 0.2)":"rgba(0, 0, 0, 0.3)"};
  color: ${e=>e.active?"#d4af37":"#aaa"};
  border: 1px solid ${e=>e.active?"#d4af37":"transparent"};
  border-radius: 4px 4px 0 0;
  cursor: pointer;
  transition: all 0.3s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.1);
    color: #d4af37;
  }
  
  ${e=>e.active&&Ft`
    position: relative;
    
    &::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 2px;
      background: #d4af37;
    }
  `}
`,Li=nr.div`
  display: grid;
  grid-template-columns: 1fr 300px;
  gap: 20px;
  animation: ${Di} 0.5s ease-in-out;
`,$i=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
  animation: ${Di} 0.5s ease-in-out;
  transition: all 0.3s ease;
  
  &:hover {
    box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
  }
`,Oi=nr($i)`
  display: flex;
  flex-direction: column;
  gap: 15px;
`,qi=nr.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
`,Ui=nr.div`
  width: 100%;
  height: 20px;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 10px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 0 5px rgba(212, 175, 55, 0.3);
  
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: ${e=>e.progress}%;
    background: linear-gradient(90deg, #d4af37, #ffdf00, #d4af37);
    background-size: 200% 200%;
    animation: ${Ni} 3s ease infinite;
    transition: width 0.3s ease;
  }
`,Fi=nr.div`
  text-align: center;
  font-size: 0.9rem;
  color: #aaa;
`,zi=nr.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
`,Bi=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 0;
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
`,Gi=nr.span`
  color: #aaa;
`,Wi=nr.span`
  color: #d4af37;
`,Hi=nr.button`
  padding: 12px;
  background: ${e=>e.active?"#d4af37":"rgba(0, 0, 0, 0.2)"};
  color: ${e=>e.active?"#000":"#d4af37"};
  border: none;
  border-radius: 4px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  
  &:hover:not(:disabled) {
    box-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
    transform: translateY(-2px);
  }
  
  &:active:not(:disabled) {
    transform: translateY(1px);
  }
  
  &:disabled {
    background: #333;
    color: #666;
    cursor: not-allowed;
  }
  
  ${e=>e.active&&Ft`
    animation: ${Ai} 2s infinite;
  `}
`,Vi=nr.ul`
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 10px;
  animation: ${Di} 0.5s ease-in-out;
`,Qi=nr.li`
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.3s ease;
  
  &::before {
    content: '';
    color: ${e=>e.met?"#4caf50":"#f44336"};
    transition: color 0.3s ease;
  }
  
  color: ${e=>e.met?"#4caf50":"#f44336"};
  
  ${e=>e.met&&Ft`
    text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
  `}
`,Yi=nr.div`
  margin-top: 15px;
  padding: 10px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  animation: ${Di} 0.5s ease-in-out;
  box-shadow: 0 0 5px rgba(212, 175, 55, 0.2);
`,Ki=nr.div`
  display: flex;
  justify-content: space-between;
  padding: 5px 0;
  border-bottom: 1px solid rgba(212, 175, 55, 0.1);
  transition: all 0.3s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.05);
  }
  
  &:last-child {
    border-bottom: none;
  }
`,Xi=nr(Ui)`
  box-shadow: 0 0 10px #d4af37;
  animation: ${Ai} 2s infinite;
`,Ji=e=>{let{active:t,children:r}=e;return t?(0,Cn.jsx)("div",{children:r}):null};const Zi=function(){const{state:e,actions:t}=Nn(),[r,a]=(0,n.useState)(!1),[i,o]=(0,n.useState)(0),[s,l]=(0,n.useState)("meditation"),[c,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(0),[h,m]=(0,n.useState)(null),[f,y]=(0,n.useState)(0),g=(0,n.useCallback)((()=>{const r=e.player.cultivation.cultivationEfficiency||1,n=Math.floor((10*Math.random()+10)*r),a=Math.floor((5*Math.random()+5)*r),i=void 0!==e.player.cultivation.bottleneckProgress?e.player.cultivation.bottleneckProgress:0;let o=i;if(Math.random()<.3){const e=Math.floor(3*Math.random())+1;o=i+e,t.addNotification({message:`\u0412\u044b \u043f\u0440\u043e\u0434\u0432\u0438\u043d\u0443\u043b\u0438\u0441\u044c \u0432 \u043f\u0440\u0435\u043e\u0434\u043e\u043b\u0435\u043d\u0438\u0438 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u0430" (+${e})`,type:"info"}),console.log(`\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 \u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u0430: ${i} -> ${o}`)}const s=e.player.cultivation.experienceToNextLevel||100,l=e.player.cultivation.experience||0,c=Math.min(l+n,s);c>=s&&t.addNotification({message:"\u0412\u044b \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u043f\u044b\u0442\u0430 \u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043e\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0440\u044b\u0432!",type:"success"}),t.updateCultivation({experience:c,energy:Math.min(e.player.cultivation.energy+a,e.player.cultivation.maxEnergy),bottleneckProgress:o})}),[t,e.player.cultivation]);(0,n.useEffect)((()=>{let e;return r&&(e=setInterval((()=>{o((e=>{const t=e+1;return t>=100?(setTimeout((()=>{g()}),0),0):t}))}),100)),()=>clearInterval(e)}),[r,g]);const v=e.player.cultivation.experienceToNextLevel||100,x=e.player.cultivation.experience>=v,b=e.player.cultivation.energy>=.8*e.player.cultivation.maxEnergy,w=e.player.cultivation.level%3===0,_=!w||e.player.cultivation.tribulationCompleted,E=e.player.cultivation.bottleneckProgress||0,T=e.player.cultivation.requiredBottleneckProgress||100,S=E>=T,[j,C]=(0,n.useState)({}),[k,I]=(0,n.useState)(!1);(0,n.useEffect)((()=>{let t=!0;const r=setTimeout((async()=>{try{const n=e.player.cultivation.requiredResources||{},a=Object.keys(n),i=e.player.cultivation.stage,o=e.player.cultivation.level,s=e.player.inventory.items,l={},c={"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430":{low_grade_herb:5*o,basic_pill:2*o},"\u041e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0426\u0438":{medium_grade_herb:4*o,qi_pill:3*o,spirit_stone:3*o},"\u0417\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e":{rare_herb:3*o,high_quality_pill:2*o,spirit_mineral:4*o,spirit_stone:10*o},"\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438":{exotic_herb:2*o,spirit_essence:3*o,beast_soul:1*o,spirit_mineral:8*o,spirit_stone:20*o}};if(a.length>0)for(const e of a)try{const r=await kr().getResourceById(e);r&&t&&(l[e]={name:r.name,amount:n[e],available:s.filter((t=>t.id===e)).length})}catch(r){console.error(`Error fetching resource ${e}:`,r)}else{const e=c[i]||c["\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430"];for(const n of Object.keys(e))try{const r=await kr().getResourceById(n);r&&t&&(l[n]={name:r.name,amount:e[n],available:s.filter((e=>e.id===n)).length})}catch(r){console.error(`Error fetching resource ${n}:`,r)}}if(t){C(l);const e=Object.values(l).every((e=>e.available>=e.amount));I(e)}}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0442\u0440\u0435\u0431\u0443\u0435\u043c\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432:",n),t&&I(!1)}}),0);return()=>{t=!1,clearTimeout(r)}}),[e.player.cultivation.stage,e.player.cultivation.level,e.player.cultivation.requiredResources,e.player.inventory.items]);const A=x&&b&&_&&S&&k,N=(0,n.useCallback)((()=>{A&&setTimeout((()=>{const r=e.player.stats.spirit||0,n=e.player.stats.intellect||0,a=e.player.cultivation.level||1,i=e.player.cultivation.stage||"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",o=e.player.cultivation.experienceToNextLevel||100,s=e.player.cultivation.maxEnergy||100,l=e.player.stats.unassignedPoints||0,c=e.player.cultivation.experience||0,d=e.player.cultivation.energy||0,u=.5+r/100+n/200;if(Math.random()<u){const e=a+1;if(e>9){const e=["\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430","\u041e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0426\u0438","\u0417\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e","\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438"],r=e.indexOf(i);if(r<e.length-1){const n=e[r+1],a=1.5*s;t.updateCultivation({stage:n,level:1,experience:0,experienceToNextLevel:2*o,maxEnergy:a,energy:a,tribulationCompleted:!1,bottleneckProgress:0,requiredBottleneckProgress:100}),t.addNotification({message:`\u041f\u043e\u0437\u0434\u0440\u0430\u0432\u043b\u044f\u0435\u043c! \u0412\u044b \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0438 \u0441\u0442\u0443\u043f\u0435\u043d\u0438 ${n}!`,type:"success"})}}else{const r=Math.floor(1.1*s);t.updateCultivation({level:e,experience:0,experienceToNextLevel:Math.floor(1.2*o),maxEnergy:r,energy:r,tribulationCompleted:!1,bottleneckProgress:0,requiredBottleneckProgress:10*e}),t.updatePlayerStats({unassignedPoints:l+5}),t.addNotification({message:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0432\u044b\u0441\u0438\u043b\u0438 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438! \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e 5 \u043e\u0447\u043a\u043e\u0432 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a.",type:"success"})}}else t.updateCultivation({energy:Math.floor(.5*d),experience:Math.floor(.8*c)}),t.addNotification({message:"\u041f\u0440\u043e\u0440\u044b\u0432 \u043d\u0435 \u0443\u0434\u0430\u043b\u0441\u044f. \u0412\u044b \u043f\u043e\u0442\u0435\u0440\u044f\u043b\u0438 \u0447\u0430\u0441\u0442\u044c \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0438 \u043e\u043f\u044b\u0442\u0430.",type:"error"})}),0)}),[t,A,e.player.cultivation,e.player.stats]);(0,n.useEffect)((()=>{let e;return c&&u<100&&!h&&(e=setInterval((()=>{if(Math.random()<.1){const e=Math.floor(3*Math.random()),r=[{message:"\u0412\u044b \u0447\u0443\u0432\u0441\u0442\u0432\u0443\u0435\u0442\u0435, \u043a\u0430\u043a \u044d\u043d\u0435\u0440\u0433\u0438\u044f \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u0438 \u0443\u0441\u0438\u043b\u0438\u0432\u0430\u0435\u0442\u0441\u044f!",type:"warning"},{message:"\u0412\u0430\u0448\u0435 \u0442\u0435\u043b\u043e \u0438\u0441\u043f\u044b\u0442\u044b\u0432\u0430\u0435\u0442 \u0441\u0438\u043b\u044c\u043d\u0443\u044e \u0431\u043e\u043b\u044c, \u043d\u043e \u0432\u044b \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u0435\u0442\u0435 \u0441\u043e\u043f\u0440\u043e\u0442\u0438\u0432\u043b\u044f\u0442\u044c\u0441\u044f!",type:"warning"},{message:"\u0412\u044b \u043e\u0449\u0443\u0449\u0430\u0435\u0442\u0435, \u043a\u0430\u043a \u0432\u0430\u0448\u0430 \u0434\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u0441\u0438\u043b\u0430 \u0440\u0430\u0441\u0442\u0435\u0442 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u044f!",type:"info"}];t.addNotification(r[e])}p((e=>{const t=e+(2*Math.random()+.5);return t>=100?(setTimeout((()=>{D()}),0),100):t}))}),500)),()=>clearInterval(e)}),[c,h]);const D=(0,n.useCallback)((()=>{setTimeout((()=>{const r=e.player.stats.spirit||0,n=e.player.stats.intellect||0,a=e.player.cultivation.experienceToNextLevel||100,i=e.player.cultivation.experience||0,o=e.player.cultivation.maxEnergy||100,s=e.player.cultivation.energy||0,l=e.player.health||100,c=.6+r/150+n/250;if(Math.random()<c){const e=Math.floor(.2*a),r=Math.floor(.2*o),n=Math.min(i+e,a);m({success:!0,message:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0440\u043e\u0448\u043b\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e!",rewards:{experience:e,energy:r}}),n>=a&&t.addNotification({message:"\u0412\u044b \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u043f\u044b\u0442\u0430 \u0434\u043b\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043e\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0440\u044b\u0432!",type:"success"}),t.updateCultivation({tribulationCompleted:!0,experience:n,energy:Math.min(s+r,o)}),t.addNotification({message:"\u041f\u043e\u0437\u0434\u0440\u0430\u0432\u043b\u044f\u0435\u043c! \u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0440\u043e\u0448\u043b\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e \u0438 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043d\u0430\u0433\u0440\u0430\u0434\u0443!",type:"success"})}else{const e=Math.floor(.3*s),r=Math.floor(.2*l);m({success:!1,message:"\u0412\u044b \u043d\u0435 \u0441\u043c\u043e\u0433\u043b\u0438 \u043f\u0440\u043e\u0439\u0442\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e.",penalties:{energy:e,health:r}}),t.updateCultivation({energy:Math.floor(.7*s)}),t.addNotification({message:"\u0412\u044b \u043d\u0435 \u0441\u043c\u043e\u0433\u043b\u0438 \u043f\u0440\u043e\u0439\u0442\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e \u0438 \u043f\u043e\u0442\u0435\u0440\u044f\u043b\u0438 \u0447\u0430\u0441\u0442\u044c \u044d\u043d\u0435\u0440\u0433\u0438\u0438.",type:"error"})}d(!1)}),0)}),[t,e.player.cultivation,e.player.stats,e.player.health]),M=(0,n.useCallback)((()=>{if(c)return;const r=e.player.cultivation.maxEnergy||100,n=e.player.cultivation.energy||0;n<.5*r?t.addNotification({message:"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u0438. \u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043c\u0438\u043d\u0438\u043c\u0443\u043c 50% \u043e\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c\u0430.",type:"error"}):setTimeout((()=>{const e=Math.floor(.8*n);d(!0),p(0),m(null),t.updateCultivation({energy:e}),t.addNotification({message:"\u0412\u044b \u043d\u0430\u0447\u0430\u043b\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e. \u0421\u043e\u0441\u0440\u0435\u0434\u043e\u0442\u043e\u0447\u044c\u0442\u0435\u0441\u044c \u0438 \u043f\u0440\u0435\u043e\u0434\u043e\u043b\u0435\u0439\u0442\u0435 \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435!",type:"info"})}),0)}),[t,e.player.cultivation,c]),R=(0,n.useCallback)((()=>{f>0||setTimeout((()=>{try{const r=e.player.cultivation.cultivationEfficiency||1,n=Math.min(r+.1,2),a=e.player.cultivation.insightPoints||0,i={success:!0,message:"\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435! \u042d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0430 \u043d\u0430 10%.",effect:{cultivationEfficiency:n}};i.success?(t.updateCultivation({cultivationEfficiency:n,insightPoints:a+1}),y(86400),t.addNotification({message:i.message,type:"success"})):t.addNotification({message:i.message||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435.",type:"error"})}catch(r){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u044f:",r),t.addNotification({message:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u044f.",type:"error"})}}),0)}),[t,f,e.player.cultivation]);return(0,Cn.jsxs)(Mi,{children:[(0,Cn.jsxs)(Ri,{children:[(0,Cn.jsx)(Pi,{active:"meditation"===s,onClick:()=>l("meditation"),children:"\u041c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u044f"}),(0,Cn.jsx)(Pi,{active:"breakthrough"===s,onClick:()=>l("breakthrough"),children:"\u041f\u0440\u043e\u0440\u044b\u0432"}),(0,Cn.jsx)(Pi,{active:"tribulation"===s,onClick:()=>l("tribulation"),children:"\u0422\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f"}),(0,Cn.jsx)(Pi,{active:"insight"===s,onClick:()=>l("insight"),children:"\u041f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435"})]}),(0,Cn.jsxs)(Ji,{active:"meditation"===s,children:[(0,Cn.jsxs)(Li,{children:[(0,Cn.jsxs)(Oi,{children:[(0,Cn.jsx)("h3",{children:"\u041c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u044f"}),(0,Cn.jsxs)(qi,{children:[(0,Cn.jsx)(Ui,{progress:i}),(0,Cn.jsx)(Fi,{children:r?"\u041c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u044f...":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 \u0434\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u043c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u0438"})]}),(0,Cn.jsx)(Hi,{active:r,onClick:()=>a(!r),children:r?"\u041f\u0440\u0435\u0440\u0432\u0430\u0442\u044c \u043c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u044e":"\u041d\u0430\u0447\u0430\u0442\u044c \u043c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u044e"})]}),(0,Cn.jsxs)($i,{children:[(0,Cn.jsx)("h3",{children:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"}),(0,Cn.jsxs)(zi,{children:[(0,Cn.jsxs)(Bi,{children:[(0,Cn.jsx)(Gi,{children:"\u0421\u0442\u0443\u043f\u0435\u043d\u044c"}),(0,Cn.jsx)(Wi,{children:e.player.cultivation.stage})]}),(0,Cn.jsxs)(Bi,{children:[(0,Cn.jsx)(Gi,{children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c"}),(0,Cn.jsx)(Wi,{children:e.player.cultivation.level})]}),(0,Cn.jsxs)(Bi,{children:[(0,Cn.jsx)(Gi,{children:"\u041e\u043f\u044b\u0442"}),(0,Cn.jsxs)(Wi,{children:[e.player.cultivation.experience||0,"/",v||100]})]}),(0,Cn.jsxs)(Bi,{children:[(0,Cn.jsx)(Gi,{children:"\u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f"}),(0,Cn.jsxs)(Wi,{children:[e.player.cultivation.energy,"/",e.player.cultivation.maxEnergy]})]}),(0,Cn.jsxs)(Bi,{children:[(0,Cn.jsx)(Gi,{children:"\u042d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),(0,Cn.jsxs)(Wi,{children:[Math.floor(100*(e.player.cultivation.cultivationEfficiency||1)),"%"]})]})]})]})]}),(0,Cn.jsxs)($i,{children:[(0,Cn.jsx)("h3",{children:'\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 "\u0431\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u0430"'}),(0,Cn.jsxs)(qi,{children:[(0,Cn.jsx)(Ui,{progress:E/T*100}),(0,Cn.jsxs)(Fi,{children:[E,"/",T]})]})]})]}),(0,Cn.jsx)(Ji,{active:"breakthrough"===s,children:(0,Cn.jsxs)($i,{children:[(0,Cn.jsx)("h3",{children:"\u041f\u0440\u043e\u0440\u044b\u0432"}),(0,Cn.jsxs)(Vi,{children:[(0,Cn.jsxs)(Qi,{met:x,children:["\u041e\u043f\u044b\u0442: ",e.player.cultivation.experience,"/",v||100]}),(0,Cn.jsxs)(Qi,{met:b,children:["\u042d\u043d\u0435\u0440\u0433\u0438\u044f: ",e.player.cultivation.energy," (\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f ",Math.floor(.8*e.player.cultivation.maxEnergy),")"]}),(0,Cn.jsxs)(Qi,{met:S,children:["\u0411\u0443\u0442\u044b\u043b\u043e\u0447\u043d\u043e\u0435 \u0433\u043e\u0440\u043b\u044b\u0448\u043a\u043e: ",E,"/",T]}),w&&(0,Cn.jsxs)(Qi,{met:_,children:["\u0422\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f: ",_?"\u041f\u0440\u043e\u0439\u0434\u0435\u043d\u0430":"\u041d\u0435 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u0430"]}),(0,Cn.jsxs)(Qi,{met:k,children:["\u0420\u0435\u0441\u0443\u0440\u0441\u044b: ",k?"\u0414\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e":(0,Cn.jsxs)("span",{children:["\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e: ",Object.values(j).filter((e=>e.available<e.amount)).map((e=>`${e.name} (${e.available}/${e.amount})`)).join(", ")]})]})]}),Object.keys(j).length>0&&(0,Cn.jsxs)(Yi,{children:[(0,Cn.jsx)("h4",{children:"\u0422\u0440\u0435\u0431\u0443\u0435\u043c\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b:"}),Object.values(j).map(((e,t)=>(0,Cn.jsxs)(Ki,{children:[(0,Cn.jsx)("span",{children:e.name}),(0,Cn.jsxs)("span",{style:{color:e.available>=e.amount?"#4caf50":"#f44336"},children:[e.available,"/",e.amount]})]},t)))]}),(0,Cn.jsx)(Hi,{onClick:N,disabled:!A,style:{marginTop:"15px",width:"100%"},children:"\u041f\u043e\u043f\u044b\u0442\u0430\u0442\u044c\u0441\u044f \u0441\u043e\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043f\u0440\u043e\u0440\u044b\u0432"})]})}),(0,Cn.jsx)(Ji,{active:"tribulation"===s,children:(0,Cn.jsxs)($i,{children:[(0,Cn.jsx)("h3",{children:"\u0422\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f"}),w&&!_&&(0,Cn.jsxs)(Cn.Fragment,{children:[!c&&!h&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("p",{children:"\u0414\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u043d\u0430 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0432\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u043e\u0439\u0442\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e. \u042d\u0442\u043e \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442 \u0432\u0430\u0448\u0443 \u0441\u0438\u043b\u0443 \u0434\u0443\u0445\u0430 \u0438 \u0442\u0435\u043b\u0430."}),(0,Cn.jsx)(Hi,{onClick:M,disabled:e.player.cultivation.energy<.5*e.player.cultivation.maxEnergy,style:{marginTop:"15px",width:"100%"},children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e (\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f 50% \u044d\u043d\u0435\u0440\u0433\u0438\u0438)"})]}),c&&!h&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("p",{children:"\u0412\u044b \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442\u0435 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e. \u0421\u043e\u0441\u0440\u0435\u0434\u043e\u0442\u043e\u0447\u044c\u0442\u0435\u0441\u044c \u0438 \u043f\u0440\u0435\u043e\u0434\u043e\u043b\u0435\u0439\u0442\u0435 \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435!"}),(0,Cn.jsxs)(qi,{children:[(0,Cn.jsx)(Xi,{progress:u}),(0,Cn.jsxs)(Fi,{children:["\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441: ",Math.floor(u),"%"]})]})]}),h&&(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("h4",{style:{color:h.success?"#4caf50":"#f44336"},children:h.message}),h.success&&h.rewards&&(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("p",{children:"\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043d\u0430\u0433\u0440\u0430\u0434\u0443:"}),(0,Cn.jsxs)("ul",{children:[h.rewards.experience&&(0,Cn.jsxs)("li",{children:["\u041e\u043f\u044b\u0442 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438: +",h.rewards.experience]}),h.rewards.energy&&(0,Cn.jsxs)("li",{children:["\u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f: +",h.rewards.energy]})]})]}),!h.success&&h.penalties&&(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("p",{children:"\u0412\u044b \u043f\u043e\u043d\u0435\u0441\u043b\u0438 \u043f\u043e\u0442\u0435\u0440\u0438:"}),(0,Cn.jsxs)("ul",{children:[h.penalties.energy&&(0,Cn.jsxs)("li",{children:["\u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f: -",h.penalties.energy]}),h.penalties.health&&(0,Cn.jsxs)("li",{children:["\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435: -",h.penalties.health]})]})]}),(0,Cn.jsx)(Hi,{onClick:()=>m(null),style:{marginTop:"15px",width:"100%"},children:h.success?"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044e":"\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0441\u043d\u043e\u0432\u0430 \u043f\u043e\u0437\u0436\u0435"})]})]}),(!w||_)&&(0,Cn.jsxs)("p",{children:["\u0412\u0430\u043c \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442\u044c \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e \u043d\u0430 \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u0443\u0440\u043e\u0432\u043d\u0435 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438.",_&&w&&" \u0412\u044b \u0443\u0436\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0440\u043e\u0448\u043b\u0438 \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044e."]})]})}),(0,Cn.jsx)(Ji,{active:"insight"===s,children:(0,Cn.jsxs)($i,{children:[(0,Cn.jsx)("h3",{children:"\u041f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435"}),(0,Cn.jsx)(Hi,{onClick:R,disabled:f>0,style:{marginTop:"15px",width:"100%"},children:f>0?`\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u0447\u0435\u0440\u0435\u0437: ${Math.floor(f/3600)}:${Math.floor(f%3600/60)}:${f%60}`:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0437\u0440\u0435\u043d\u0438\u0435"})]})})]})},eo=nr.div`
  display: grid;
  grid-template-columns: 1fr 300px;
  gap: 20px;
`,to=nr.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 10px;
  padding: 20px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
`,ro=nr.div`
  width: 100%;
  aspect-ratio: 1;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid ${e=>"common"===e.quality?"#666":"uncommon"===e.quality?"#2196f3":"rare"===e.quality?"#9c27b0":"epic"===e.quality?"#ff9800":"#d4af37"};
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    transform: scale(1.05);
    box-shadow: 0 0 10px ${e=>"common"===e.quality?"#666":"uncommon"===e.quality?"#2196f3":"rare"===e.quality?"#9c27b0":"epic"===e.quality?"#ff9800":"#d4af37"};
  }
`,no=nr.div`
  width: 60%;
  height: 60%;
  background: ${e=>"weapon"===e.type?"#f44336":"armor"===e.type?"#2196f3":"accessory"===e.type?"#9c27b0":"consumable"===e.type?"#4caf50":"material"===e.type?"#ff9800":"book"===e.type?"#795548":"#666"};
  border-radius: 4px;
`,ao=nr.div`
  position: absolute;
  bottom: 2px;
  right: 2px;
  background: rgba(0, 0, 0, 0.8);
  padding: 2px 4px;
  border-radius: 2px;
  font-size: 0.8rem;
  color: #fff;
`,io=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
`,oo=nr.h3`
  color: ${e=>"common"===e.quality?"#fff":"uncommon"===e.quality?"#2196f3":"rare"===e.quality?"#9c27b0":"epic"===e.quality?"#ff9800":"#d4af37"};
  margin: 0 0 10px 0;
`,so=nr.div`
  color: #aaa;
  font-size: 0.9rem;
  margin-bottom: 15px;
`,lo=nr.p`
  color: #f0f0f0;
  font-size: 0.9rem;
  line-height: 1.4;
  margin-bottom: 20px;
`,co=nr.button`
  width: 100%;
  padding: 10px;
  background: rgba(212, 175, 55, 0.2);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #d4af37;
  font-size: 0.9rem;
  cursor: pointer;
  margin-bottom: 10px;
  transition: all 0.2s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.3);
  }
  
  &:disabled {
    background: #333;
    border-color: #666;
    color: #666;
    cursor: not-allowed;
  }
`,uo=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(212, 175, 55, 0.2);
`,po=nr.div`
  display: flex;
  align-items: center;
  gap: 5px;
  color: #aaa;
  
  span {
    color: #d4af37;
  }
`;const ho=function(){const{state:e,actions:t}=Nn(),[a,i]=(0,n.useState)(null),o=a&&("consumable"===a.type||"book"===a.type||"weapon"===a.type||"armor"===a.type||"accessory"===a.type);return(0,Cn.jsxs)(eo,{children:[(0,Cn.jsx)(to,{children:e.player.inventory.items.map(((e,t)=>(0,Cn.jsxs)(ro,{quality:e.quality,onClick:()=>(e=>{i(e)})(e),children:[(0,Cn.jsx)(no,{type:e.type}),e.quantity>1&&(0,Cn.jsx)(ao,{children:e.quantity})]},`${e.id}_${t}`)))}),(0,Cn.jsxs)(io,{children:[a?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(oo,{quality:a.quality,children:a.name}),(0,Cn.jsxs)(so,{children:["weapon"===a.type&&"\u041e\u0440\u0443\u0436\u0438\u0435","armor"===a.type&&"\u0411\u0440\u043e\u043d\u044f","accessory"===a.type&&"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440","consumable"===a.type&&"\u0420\u0430\u0441\u0445\u043e\u0434\u0443\u0435\u043c\u044b\u0439 \u043f\u0440\u0435\u0434\u043c\u0435\u0442","material"===a.type&&"\u041c\u0430\u0442\u0435\u0440\u0438\u0430\u043b","book"===a.type&&"\u041a\u043d\u0438\u0433\u0430"]}),(0,Cn.jsx)(lo,{children:a.description}),(0,Cn.jsx)(co,{onClick:()=>{if(a)switch(console.log("\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430:",a),a.type){case"weapon":case"armor":case"accessory":console.log(`\u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 ${a.name} (ID: ${a.id}, \u0442\u0438\u043f: ${a.type})`);const{ensureItemHasCalculatedBonuses:n}=r(8317),o=n(a);t.equipItem(o),t.addNotification({message:`\u0412\u044b \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043b\u0438 ${a.name}`,type:"success"}),i({...a,equipped:!0});break;case"consumable":"qi_gathering_pill"===a.id&&(t.updateCultivation({energy:Math.min(e.player.cultivation.energy+50,e.player.cultivation.maxEnergy)}),t.addNotification({message:"\u0412\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 \u043f\u0438\u043b\u044e\u043b\u044e \u0441\u0431\u043e\u0440\u0430 \u0446\u0438. \u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430.",type:"success"}));const s=e.player.inventory.items.map((e=>e.id===a.id?{...e,quantity:e.quantity-1}:e)).filter((e=>e.quantity>0));t.updatePlayer({inventory:{...e.player.inventory,items:s}}),a.quantity<=1?i(null):i({...a,quantity:a.quantity-1});break;case"book":t.addNotification({message:"\u0412\u044b \u0438\u0437\u0443\u0447\u0438\u043b\u0438 \u043d\u043e\u0432\u0443\u044e \u0442\u0435\u0445\u043d\u0438\u043a\u0443 \u0438\u0437 \u043a\u043d\u0438\u0433\u0438.",type:"success"});break;default:console.log(`\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0442\u0438\u043f \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430: ${a.type}`)}},disabled:!o,children:"consumable"===a.type?"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c":"book"===a.type?"\u0418\u0437\u0443\u0447\u0438\u0442\u044c":"material"===a.type?"\u041d\u0435\u043b\u044c\u0437\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c":"\u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,Cn.jsx)(co,{onClick:()=>{t.removeItem(a.id),i(null)},children:"\u0412\u044b\u0431\u0440\u043e\u0441\u0438\u0442\u044c"})]}):(0,Cn.jsx)("div",{style:{textAlign:"center",color:"#aaa"},children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0434\u0435\u0442\u0430\u043b\u0435\u0439"}),(0,Cn.jsxs)(uo,{children:[(0,Cn.jsxs)(po,{children:["\u041c\u0435\u0434\u044c: ",(0,Cn.jsx)("span",{children:e.player.inventory.currency.copper})]}),(0,Cn.jsxs)(po,{children:["\u0421\u0435\u0440\u0435\u0431\u0440\u043e: ",(0,Cn.jsx)("span",{children:e.player.inventory.currency.silver})]}),(0,Cn.jsxs)(po,{children:["\u0417\u043e\u043b\u043e\u0442\u043e: ",(0,Cn.jsx)("span",{children:e.player.inventory.currency.gold})]}),(0,Cn.jsxs)(po,{children:["\u0414\u0443\u0445. \u043a\u0430\u043c\u043d\u0438: ",(0,Cn.jsx)("span",{children:e.player.inventory.currency.spiritStones})]})]})]})]})},mo=e=>{e?(console.group("%c\ud83d\udcca \u0411\u043e\u043d\u0443\u0441\u044b \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:","font-weight: bold; color: gold;"),e.stats&&(console.group("%c \u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438:","color: aqua;"),Object.entries(e.stats).forEach((e=>{let[t,r]=e;const n=r>0?"color: green; font-weight: bold;":r<0?"color: red;":"color: gray;",a={strength:"\u0421\u0438\u043b\u0430",dexterity:"\u041b\u043e\u0432\u043a\u043e\u0441\u0442\u044c",vitality:"\u0412\u044b\u043d\u043e\u0441\u043b\u0438\u0432\u043e\u0441\u0442\u044c",intelligence:"\u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442",perception:"\u0412\u043e\u0441\u043f\u0440\u0438\u044f\u0442\u0438\u0435",luck:"\u0423\u0434\u0430\u0447\u0430"}[t]||t;console.log(`  ${a}: %c${r>0?"+":""}${r}`,n)})),console.groupEnd()),e.combat&&(console.group("%c \u0411\u043e\u0435\u0432\u044b\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438:","color: red;"),Object.entries(e.combat).forEach((e=>{let[t,r]=e;const n=r>0?"color: green; font-weight: bold;":r<0?"color: red;":"color: gray;",a={physicalDamage:"\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0440\u043e\u043d",magicDamage:"\u041c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0440\u043e\u043d",physicalDefense:"\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0437\u0430\u0449\u0438\u0442\u0430",magicDefense:"\u041c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0437\u0430\u0449\u0438\u0442\u0430",critChance:"\u0428\u0430\u043d\u0441 \u043a\u0440\u0438\u0442. \u0443\u0434\u0430\u0440\u0430",critDamage:"\u0423\u0440\u043e\u043d \u043e\u0442 \u043a\u0440\u0438\u0442. \u0443\u0434\u0430\u0440\u0430",dodgeChance:"\u0428\u0430\u043d\u0441 \u0443\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f"}[t]||t,i=["critChance","critDamage","dodgeChance"].includes(t)?"%":"";console.log(`  ${a}: %c${r>0?"+":""}${r}${i}`,n)})),console.groupEnd()),e.cultivation&&(console.group("%c \u041a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f:","color: cyan;"),Object.entries(e.cultivation).forEach((e=>{let[t,r]=e;const n=r>0?"color: green; font-weight: bold;":r<0?"color: red;":"color: gray;",a={energyMax:"\u041c\u0430\u043a\u0441. \u044d\u043d\u0435\u0440\u0433\u0438\u044f",energyRegen:"\u0412\u043e\u0441\u0441\u0442. \u044d\u043d\u0435\u0440\u0433\u0438\u0438",comprehensionRate:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u044f",breakthroughChance:"\u0428\u0430\u043d\u0441 \u043f\u0440\u043e\u0440\u044b\u0432\u0430"}[t]||t,i="energyRegen"===t?"/\u0447\u0430\u0441":["comprehensionRate","breakthroughChance"].includes(t)?"%":"";console.log(`  ${a}: %c${r>0?"+":""}${r}${i}`,n)})),console.groupEnd()),e.elemental&&(console.group("%c \u0421\u0442\u0438\u0445\u0438\u0439\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b:","color: orange;"),Object.entries(e.elemental).forEach((e=>{let[t,r]=e;const n=r>0?"color: green; font-weight: bold;":r<0?"color: red;":"color: gray;",a={fire:"\u041e\u0433\u043e\u043d\u044c",water:"\u0412\u043e\u0434\u0430",earth:"\u0417\u0435\u043c\u043b\u044f",air:"\u0412\u043e\u0437\u0434\u0443\u0445",light:"\u0421\u0432\u0435\u0442",dark:"\u0422\u044c\u043c\u0430"}[t]||t;console.log(`  ${a}: %c${r>0?"+":""}${r}`,n)})),console.groupEnd()),e.special&&e.special.length>0&&(console.group("%c \u041e\u0441\u043e\u0431\u044b\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b:","color: magenta;"),e.special.forEach((e=>{console.log(`  %c${e.name}:%c ${e.description}`,"color: yellow; font-weight: bold;","color: white;")})),console.groupEnd()),console.groupEnd()):console.log("%c\ud83d\udeab \u0411\u043e\u043d\u0443\u0441\u044b \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442!","font-weight: bold; color: red;")},fo=e=>{e&&0!==Object.keys(e).length?(console.group("%c\u2694\ufe0f \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u044b:","font-weight: bold; color: gold;"),Object.entries(e).forEach((e=>{let[t,r]=e;if(!r)return;const n={weapon:"\u041e\u0440\u0443\u0436\u0438\u0435",headArmor:"\u0413\u043e\u043b\u043e\u0432\u0430",bodyArmor:"\u0422\u0435\u043b\u043e",handArmor:"\u0420\u0443\u043a\u0438",legArmor:"\u041d\u043e\u0433\u0438",accessory1:"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440 1",accessory2:"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440 2",artifact1:"\u0410\u0440\u0442\u0435\u0444\u0430\u043a\u0442 1",artifact2:"\u0410\u0440\u0442\u0435\u0444\u0430\u043a\u0442 2"}[t]||t,a={common:"white",uncommon:"#1eff00",rare:"#0070dd",epic:"#a335ee",legendary:"#ff8000"}[r.rarity]||"white";console.group(`%c${n}: %c${r.name}`,"color: gray;",`color: ${a}; font-weight: bold;`),console.log(`  ID: ${r.id||r.itemId}`),console.log(`  \u0422\u0438\u043f: ${r.type}`),console.log(`  \u0420\u0435\u0434\u043a\u043e\u0441\u0442\u044c: %c${r.rarity}`,`color: ${a};`),r.calculatedBonuses?console.log("  %c\u2705 \u0418\u043c\u0435\u0435\u0442 \u043f\u0440\u0435\u0434\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b","color: green; font-weight: bold;"):console.log("  %c\u274c \u041d\u0435 \u0438\u043c\u0435\u0435\u0442 \u043f\u0440\u0435\u0434\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0445 \u0431\u043e\u043d\u0443\u0441\u043e\u0432","color: red;"),console.groupEnd()})),console.groupEnd()):console.log("%c\ud83d\udeab \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u044b \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442!","font-weight: bold; color: red;")},yo=e=>{if(console.group("%c\ud83d\udee1\ufe0f \u041e\u0422\u041b\u0410\u0414\u041a\u0410 \u042d\u041a\u0418\u041f\u0418\u0420\u041e\u0412\u041a\u0418","font-size: 16px; font-weight: bold; color: gold;"),e&&e.player){mo(e.player.equipmentBonuses);const t={};e.player.inventory&&e.player.inventory.items?(e.player.inventory.items.forEach((e=>{var r;if(e.equipped)switch(e.type){case"weapon":t.weapon=e;break;case"armor":const n=(null===(r=e.properties)||void 0===r?void 0:r.armorType)||e.armorType,a=e.name.toLowerCase();"head"===n||!n&&(a.includes("\u0448\u043b\u0435\u043c")||a.includes("\u0448\u0430\u043f\u043a\u0430"))?t.headArmor=e:"legs"===n||!n&&(a.includes("\u0441\u0430\u043f\u043e\u0433")||a.includes("\u0431\u043e\u0442\u0438\u043d"))?t.legArmor=e:"hands"===n||!n&&(a.includes("\u043f\u0435\u0440\u0447\u0430\u0442")||a.includes("\u0440\u0443\u043a\u0430\u0432"))?t.handArmor=e:t.bodyArmor=e;break;case"accessory":t.accessory1?t.accessory2||(t.accessory2=e):t.accessory1=e;break;case"artifact":t.artifact1?t.artifact2||(t.artifact2=e):t.artifact1=e}})),fo(t)):console.log("%c\u274c \u041d\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e\u0431 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u0435!","color: red; font-weight: bold;")}else console.log("%c\u274c \u041d\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438 \u0438\u0433\u0440\u043e\u043a\u0430!","color: red; font-weight: bold;");console.groupEnd()},go=nr.div`
  display: grid;
  grid-template-columns: 400px 1fr;
  gap: 20px;
`,vo=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  grid-auto-rows: minmax(100px, auto);
  grid-gap: 20px;
  max-width: 100%;
`,xo=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #666;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  padding: 10px;
  cursor: pointer;
  height: 100px;
  
  &.head {
    grid-column: 1 / span 3;
    height: 80px;
  }
  
  &.body {
    grid-column: 2;
    grid-row: 2;
  }
  
  &.left {
    grid-column: 1;
    grid-row: 2;
  }
  
  &.right {
    grid-column: 3;
    grid-row: 2;
  }
  
  &.hands {
    grid-column: 1 / span 3;
    grid-row: 3;
    height: 80px;
  }
  
  &.legs {
    grid-column: 1 / span 3;
    grid-row: 4;
    height: 80px;
  }
  
  &.acc1 {
    grid-column: 1;
    grid-row: 5;
  }
  
  &.acc2 {
    grid-column: 3;
    grid-row: 5;
  }
  
  &.art1 {
    grid-column: 1;
    grid-row: 6;
  }
  
  &.art2 {
    grid-column: 3;
    grid-row: 6;
  }
  
  &.equipped {
    border-color: ${e=>"common"===e.rarity?"#666":"uncommon"===e.rarity?"#2196f3":"rare"===e.rarity?"#9c27b0":"epic"===e.rarity?"#ff9800":"#d4af37"};
    box-shadow: 0 0 5px ${e=>"common"===e.rarity?"#666":"uncommon"===e.rarity?"#2196f3":"rare"===e.rarity?"#9c27b0":"epic"===e.rarity?"#ff9800":"#d4af37"};
  }
`,bo=nr.div`
  color: #aaa;
  font-size: 0.8rem;
  margin-bottom: 5px;
`,wo=nr.div`
  width: 40px;
  height: 40px;
  background: ${e=>"weapon"===e.type?"#f44336":"armor"===e.type?"#2196f3":"accessory"===e.type?"#9c27b0":"artifact"===e.type?"#ff9800":"material"===e.type?"#4caf50":"book"===e.type?"#795548":"#666"};
  border-radius: 4px;
`,_o=nr.div`
  color: ${e=>"common"===e.rarity?"#fff":"uncommon"===e.rarity?"#2196f3":"rare"===e.rarity?"#9c27b0":"epic"===e.rarity?"#ff9800":"#d4af37"};
  font-size: 0.9rem;
  margin-top: 5px;
  text-align: center;
`,Eo=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 15px;
`,To=nr.button`
  padding: 10px 15px;
  background: rgba(180, 30, 30, 0.3);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
  transition: all 0.2s ease;
  
  &:hover:not(:disabled) {
    background: rgba(180, 30, 30, 0.5);
  }
  
  &:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }
`,So=nr.button`
  padding: 10px 15px;
  background: rgba(180, 30, 30, 0.3);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
  width: 100%;
  transition: all 0.2s ease;
  
  &:hover:not(:disabled) {
    background: rgba(180, 30, 30, 0.5);
  }
  
  &:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }
`,jo=nr.h3`
  color: #d4af37;
  font-size: 1.2rem;
  margin-bottom: 10px;
  border-bottom: 1px solid rgba(212, 175, 55, 0.3);
  padding-bottom: 5px;
`,Co=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
`,ko=nr.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  
  span:first-child {
    color: #aaa;
  }
  
  span:last-child {
    color: ${e=>e.value>0?"#4caf50":e.value<0?"#f44336":"#aaa"};
  }
`,Io=nr.div`
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
`,Ao=nr.button`
  padding: 8px 15px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #666;
  border-radius: 4px;
  color: #aaa;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background: rgba(0, 0, 0, 0.5);
  }
  
  &.active {
    background: rgba(212, 175, 55, 0.2);
    border-color: #d4af37;
    color: #d4af37;
  }
`,No=nr.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 10px;
  padding: 15px;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #666;
  border-radius: 8px;
`,Do=nr.div`
  width: 100%;
  aspect-ratio: 1;
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid ${e=>"common"===e.rarity?"#666":"uncommon"===e.rarity?"#2196f3":"rare"===e.rarity?"#9c27b0":"epic"===e.rarity?"#ff9800":"#d4af37"};
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  position: relative;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    transform: scale(1.05);
    box-shadow: 0 0 10px ${e=>"common"===e.rarity?"#666":"uncommon"===e.rarity?"#2196f3":"rare"===e.rarity?"#9c27b0":"epic"===e.rarity?"#ff9800":"#d4af37"};
  }
  
  &.equipped {
    border-width: 2px;
    box-shadow: 0 0 5px ${e=>"common"===e.rarity?"#666":"uncommon"===e.rarity?"#2196f3":"rare"===e.rarity?"#9c27b0":"epic"===e.rarity?"#ff9800":"#d4af37"};
  }
`;const Mo=function(){const{state:e,actions:t}=Nn(),[r,a]=(0,n.useState)({weapon:null,headArmor:null,bodyArmor:null,legArmor:null,handArmor:null,accessory1:null,accessory2:null,artifact1:null,artifact2:null}),[i,o]=(0,n.useState)("all"),[s,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[u,p]=(0,n.useState)(null),h=n.useRef(!1);(0,n.useEffect)((()=>{if(h.current)return;console.log("\u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438"),h.current=!0;const r=m();console.log("\u042f\u0432\u043d\u043e\u0435 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u043f\u0440\u0438 \u043f\u0435\u0440\u0432\u043e\u043c \u043c\u043e\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438"),t.applyEquipmentBonuses(r),setTimeout((()=>{yo(e)}),500)}),[]),(0,n.useEffect)((()=>{h.current&&m()}),[e.player.inventory.items]);const m=()=>{const r={},n=e.player.inventory.items.filter((e=>e.equipped));return console.log("==== \u041e\u0411\u041d\u041e\u0412\u041b\u0415\u041d\u0418\u0415 \u042d\u041a\u0418\u041f\u0418\u0420\u041e\u0412\u0410\u041d\u041d\u042b\u0425 \u041f\u0420\u0415\u0414\u041c\u0415\u0422\u041e\u0412 ===="),console.log(`\u041d\u0430\u0439\u0434\u0435\u043d\u043e ${n.length} \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432`),e.player.inventory.items.forEach((e=>{var t;if(e.equipped){let n=(0,Jr.ensureItemHasCalculatedBonuses)(e);switch(n.calculatedBonuses&&console.log(`\u2705 \u041f\u0440\u0435\u0434\u043c\u0435\u0442 ${e.name} \u0438\u043c\u0435\u0435\u0442 \u043f\u0440\u0435\u0434\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b`),e.type){case"weapon":r.weapon=n,console.log(`\u2694\ufe0f \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u043e\u0440\u0443\u0436\u0438\u0435: ${n.name}`);break;case"armor":const a=(null===(t=e.properties)||void 0===t?void 0:t.armorType)||e.armorType,i=e.name.toLowerCase();"head"===a||!a&&(i.includes("\u0448\u043b\u0435\u043c")||i.includes("\u0448\u0430\u043f\u043a\u0430")||i.includes("\u043a\u0430\u043f\u044e\u0448\u043e\u043d"))?(r.headArmor=n,console.log(`\ud83e\udde2 \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0431\u0440\u043e\u043d\u044f \u0434\u043b\u044f \u0433\u043e\u043b\u043e\u0432\u044b: ${n.name}`)):"legs"===a||!a&&(i.includes("\u0441\u0430\u043f\u043e\u0433")||i.includes("\u0431\u043e\u0442\u0438\u043d")||i.includes("\u043e\u0431\u0443\u0432\u044c"))?(r.legArmor=n,console.log(`\ud83d\udc62 \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0431\u0440\u043e\u043d\u044f \u0434\u043b\u044f \u043d\u043e\u0433: ${n.name}`)):"hands"===a||!a&&(i.includes("\u043f\u0435\u0440\u0447\u0430\u0442")||i.includes("\u0440\u0443\u043a\u0430\u0432"))?(r.handArmor=n,console.log(`\ud83e\udde4 \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0431\u0440\u043e\u043d\u044f \u0434\u043b\u044f \u0440\u0443\u043a: ${n.name}`)):(r.bodyArmor=n,console.log(`\ud83e\udd4b \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0431\u0440\u043e\u043d\u044f \u0434\u043b\u044f \u0442\u0435\u043b\u0430: ${n.name}`));break;case"accessory":r.accessory1?r.accessory2||(r.accessory2=n,console.log(`\ud83d\udcff \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d \u0430\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440 2: ${n.name}`)):(r.accessory1=n,console.log(`\ud83d\udc8d \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d \u0430\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440 1: ${n.name}`));break;case"artifact":r.artifact1?r.artifact2||(r.artifact2=n,console.log(`\ud83e\uddff \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442 2: ${n.name}`)):(r.artifact1=n,console.log(`\ud83d\udd2e \u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442 1: ${n.name}`))}}})),a(r),console.log("\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u043f\u043e\u0441\u043b\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432"),t.applyEquipmentBonuses(r),r},f=e=>{l(e);const t=r[e];switch(d(t),e){case"weapon":o("weapon");break;case"headArmor":case"bodyArmor":case"legArmor":case"handArmor":o("armor");break;case"accessory1":case"accessory2":o("accessory");break;case"artifact1":case"artifact2":o("artifact");break;default:o("all")}},y=()=>{if(u){if(console.log(`\u0412\u044b\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 ${u.name}`),u.equipped)for(const[n,a]of Object.entries(r))if(a&&a.id===u.id){console.log(`\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0441\u043d\u0438\u043c\u0430\u0435\u043c \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0443 ${u.name} \u0438\u0437 \u0441\u043b\u043e\u0442\u0430 ${n}`),t.unequipItem(n);break}const e=u.id||u.itemId;t.removeItem({id:e}),setTimeout((()=>{m(),p(null)}),100)}};return(0,Cn.jsxs)(go,{children:[(0,Cn.jsxs)("div",{children:[(0,Cn.jsxs)(vo,{children:[(0,Cn.jsxs)(xo,{className:"head",onClick:()=>f("headArmor"),rarity:r.headArmor?r.headArmor.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u0413\u043e\u043b\u043e\u0432\u0430"}),r.headArmor?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"armor"}),(0,Cn.jsx)(_o,{rarity:r.headArmor.rarity,children:r.headArmor.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"left",onClick:()=>f("weapon"),rarity:r.weapon?r.weapon.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u041e\u0440\u0443\u0436\u0438\u0435"}),r.weapon?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"weapon"}),(0,Cn.jsx)(_o,{rarity:r.weapon.rarity,children:r.weapon.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"body",onClick:()=>f("bodyArmor"),rarity:r.bodyArmor?r.bodyArmor.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u0422\u0435\u043b\u043e"}),r.bodyArmor?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"armor"}),(0,Cn.jsx)(_o,{rarity:r.bodyArmor.rarity,children:r.bodyArmor.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"right",onClick:()=>f("shield"),rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u0429\u0438\u0442"}),(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"hands",onClick:()=>f("handArmor"),rarity:r.handArmor?r.handArmor.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u0420\u0443\u043a\u0438"}),r.handArmor?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"armor"}),(0,Cn.jsx)(_o,{rarity:r.handArmor.rarity,children:r.handArmor.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"legs",onClick:()=>f("legArmor"),rarity:r.legArmor?r.legArmor.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u041d\u043e\u0433\u0438"}),r.legArmor?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"armor"}),(0,Cn.jsx)(_o,{rarity:r.legArmor.rarity,children:r.legArmor.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"acc1",onClick:()=>f("accessory1"),rarity:r.accessory1?r.accessory1.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440 1"}),r.accessory1?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"accessory"}),(0,Cn.jsx)(_o,{rarity:r.accessory1.rarity,children:r.accessory1.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"acc2",onClick:()=>f("accessory2"),rarity:r.accessory2?r.accessory2.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440 2"}),r.accessory2?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"accessory"}),(0,Cn.jsx)(_o,{rarity:r.accessory2.rarity,children:r.accessory2.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"art1",onClick:()=>f("artifact1"),rarity:r.artifact1?r.artifact1.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u0410\u0440\u0442\u0435\u0444\u0430\u043a\u0442 1"}),r.artifact1?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"artifact"}),(0,Cn.jsx)(_o,{rarity:r.artifact1.rarity,children:r.artifact1.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]}),(0,Cn.jsxs)(xo,{className:"art2",onClick:()=>f("artifact2"),rarity:r.artifact2?r.artifact2.rarity:"common",children:[(0,Cn.jsx)(bo,{children:"\u0410\u0440\u0442\u0435\u0444\u0430\u043a\u0442 2"}),r.artifact2?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(wo,{type:"artifact"}),(0,Cn.jsx)(_o,{rarity:r.artifact2.rarity,children:r.artifact2.name})]}):(0,Cn.jsx)("span",{children:"\u041d\u0435 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e"})]})]}),(0,Cn.jsxs)("div",{style:{marginTop:"20px"},children:[(0,Cn.jsx)(jo,{children:"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044c"}),(0,Cn.jsxs)(Io,{children:[(0,Cn.jsx)(Ao,{className:"all"===i?"active":"",onClick:()=>o("all"),children:"\u0412\u0441\u0435"}),(0,Cn.jsx)(Ao,{className:"weapon"===i?"active":"",onClick:()=>o("weapon"),children:"\u041e\u0440\u0443\u0436\u0438\u0435"}),(0,Cn.jsx)(Ao,{className:"armor"===i?"active":"",onClick:()=>o("armor"),children:"\u0411\u0440\u043e\u043d\u044f"}),(0,Cn.jsx)(Ao,{className:"accessory"===i?"active":"",onClick:()=>o("accessory"),children:"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b"}),(0,Cn.jsx)(Ao,{className:"artifact"===i?"active":"",onClick:()=>o("artifact"),children:"\u0410\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u044b"})]}),(0,Cn.jsx)(No,{children:e.player.inventory.items.filter((e=>"all"===i||e.type===i)).map(((e,r)=>(0,Cn.jsxs)(Do,{rarity:e.rarity||"common",className:e.equipped?"equipped":"",onClick:()=>(e=>{p(e),s&&(e=(0,Jr.ensureItemHasCalculatedBonuses)(e),console.log(`\u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 ${e.name} \u0432 \u0441\u043b\u043e\u0442 ${s}`),t.equipItem(e),m())})(e),children:[(0,Cn.jsx)(wo,{type:e.type||"material"}),(0,Cn.jsx)(_o,{rarity:e.rarity||"common",children:e.name})]},`${e.id}-${r}`)))})]})]}),(0,Cn.jsxs)(Eo,{children:[(0,Cn.jsx)(jo,{children:"\u0411\u043e\u043d\u0443\u0441\u044b \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438"}),c&&(0,Cn.jsxs)("div",{children:[(0,Cn.jsxs)("h4",{children:["\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u0435\u0434\u043c\u0435\u0442: ",c.name]}),(0,Cn.jsx)(To,{onClick:()=>{c&&s&&(console.log(`\u0421\u043d\u044f\u0442\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 ${c.name} \u0438\u0437 \u0441\u043b\u043e\u0442\u0430 ${s}`),t.unequipItem(s),m(),d(null))},children:"\u0421\u043d\u044f\u0442\u044c \u043f\u0440\u0435\u0434\u043c\u0435\u0442"}),(0,Cn.jsx)("div",{style:{marginTop:"10px"},children:(0,Cn.jsx)(So,{onClick:y,children:"\u0412\u044b\u0431\u0440\u043e\u0441\u0438\u0442\u044c"})})]}),u&&!u.equipped&&(0,Cn.jsxs)("div",{children:[(0,Cn.jsxs)("h4",{children:["\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u0435\u0434\u043c\u0435\u0442: ",u.name]}),(0,Cn.jsx)("div",{style:{marginTop:"10px"},children:(0,Cn.jsx)(So,{onClick:y,children:"\u0412\u044b\u0431\u0440\u043e\u0441\u0438\u0442\u044c"})})]}),e.player.equipmentBonuses&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("h4",{children:"\u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438"}),(0,Cn.jsx)(Co,{children:Object.entries(e.player.equipmentBonuses.stats||{}).map((e=>{let[t,r]=e;return(0,Cn.jsxs)(ko,{value:r,children:[(0,Cn.jsx)("span",{children:"strength"===t?"\u0421\u0438\u043b\u0430":"dexterity"===t?"\u041b\u043e\u0432\u043a\u043e\u0441\u0442\u044c":"vitality"===t?"\u0412\u044b\u043d\u043e\u0441\u043b\u0438\u0432\u043e\u0441\u0442\u044c":"intelligence"===t?"\u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442":"perception"===t?"\u0412\u043e\u0441\u043f\u0440\u0438\u044f\u0442\u0438\u0435":"luck"===t?"\u0423\u0434\u0430\u0447\u0430":t}),(0,Cn.jsxs)("span",{children:[r>0?"+":"",r]})]},t)}))})]}),(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("h4",{children:"\u0411\u043e\u0435\u0432\u044b\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438"}),(0,Cn.jsx)(Co,{children:Object.entries(e.player.equipmentBonuses.combat||{}).map((e=>{let[t,r]=e;return(0,Cn.jsxs)(ko,{value:r,children:[(0,Cn.jsx)("span",{children:"physicalDamage"===t?"\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0440\u043e\u043d":"magicDamage"===t?"\u041c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0440\u043e\u043d":"physicalDefense"===t?"\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0437\u0430\u0449\u0438\u0442\u0430":"magicDefense"===t?"\u041c\u0430\u0433\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0437\u0430\u0449\u0438\u0442\u0430":"critChance"===t?"\u0428\u0430\u043d\u0441 \u043a\u0440\u0438\u0442. \u0443\u0434\u0430\u0440\u0430":"critDamage"===t?"\u0423\u0440\u043e\u043d \u043e\u0442 \u043a\u0440\u0438\u0442. \u0443\u0434\u0430\u0440\u0430":"dodgeChance"===t?"\u0428\u0430\u043d\u0441 \u0443\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f":t}),(0,Cn.jsxs)("span",{children:[r>0?"+":"",r,["critChance","critDamage","dodgeChance"].includes(t)?"%":""]})]},t)}))})]})]})]})]})},Ro=nr.div`
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 20px;
`,Po=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
`,Lo=nr.div`
  width: 200px;
  height: 200px;
  margin: 0 auto 20px;
  background: #2c2c2c;
  border: 2px solid #d4af37;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 3rem;
  color: #d4af37;
`,$o=nr.div`
  text-align: center;
  margin-bottom: 20px;
`,Oo=nr.h2`
  color: #d4af37;
  margin: 0 0 5px;
`,qo=nr.div`
  color: #aaa;
  font-size: 0.9rem;
  margin-bottom: 10px;
`,Uo=nr.div`
  color: #f0f0f0;
  font-size: 1.1rem;
  margin-bottom: 20px;
`,Fo=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
`,zo=nr.div`
  margin-bottom: 20px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,Bo=nr.h3`
  color: #d4af37;
  margin: 0 0 10px;
  font-size: 1.1rem;
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
  padding-bottom: 5px;
`,Go=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
`,Wo=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 10px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
`,Ho=nr.div`
  display: flex;
  align-items: center;
  gap: 8px;
`,Vo=nr.button`
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(212, 175, 55, 0.2);
  color: #d4af37;
  border: 1px solid #d4af37;
  border-radius: 4px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover:not(:disabled) {
    background: rgba(212, 175, 55, 0.4);
  }
  
  &:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }
`,Qo=nr.div`
  margin-top: 10px;
  padding: 10px;
  background: rgba(212, 175, 55, 0.1);
  border-radius: 4px;
  text-align: center;
  color: #d4af37;
  font-weight: bold;
`,Yo=nr.span`
  color: #aaa;
`,Ko=nr.span`
  color: #f0f0f0;
`,Xo=nr.div`
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(212, 175, 55, 0.2);
`,Jo=nr.h3`
  color: #d4af37;
  margin: 0 0 10px;
  font-size: 1.1rem;
`,Zo=nr.p`
  color: #f0f0f0;
  font-size: 0.9rem;
  line-height: 1.4;
  margin: 0;
`;const es=function(){var e,t,r,n,a,i,o,s,l,c,d,u,p,h,m,f,y,g,v,x,b,w;const{state:_,actions:E}=Nn(),T=(null===_||void 0===_?void 0:_.player)||{},S=(null===T||void 0===T?void 0:T.cultivation)||{},j=(null===T||void 0===T?void 0:T.stats)||{},C=(null===T||void 0===T?void 0:T.secondaryStats)||{},k=j.unassignedPoints||0,I=e=>(e=e||0)>=1e3?`${(e/1e3).toFixed(1)}k`:e.toString(),A=e=>{if(k<=0)return;const t={...j,[e]:(j[e]||0)+1,unassignedPoints:k-1};E.updatePlayerStats(t)};return console.log("DEBUG - CharacterTab - \u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0433\u0440\u043e\u043a\u0430:",_.player),console.log("DEBUG - CharacterTab - \u0411\u043e\u043d\u0443\u0441\u044b \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:",T.equipmentBonuses),console.log("DEBUG - CharacterTab - \u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438:",j),console.log("DEBUG - CharacterTab - \u0412\u0442\u043e\u0440\u0438\u0447\u043d\u044b\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438:",C),(0,Cn.jsxs)(Ro,{children:[(0,Cn.jsxs)(Po,{children:[(0,Cn.jsx)(Lo,{children:(T.name||"?")[0].toUpperCase()}),(0,Cn.jsxs)($o,{children:[(0,Cn.jsx)(Oo,{children:T.name||"\u0411\u0435\u0437\u044b\u043c\u044f\u043d\u043d\u044b\u0439"}),(0,Cn.jsx)(qo,{children:T.title||"\u0411\u0435\u0437 \u0442\u0438\u0442\u0443\u043b\u0430"}),(0,Cn.jsxs)(Uo,{children:[(N=S.level,(N=N||0)<10?"\u0423\u0447\u0435\u043d\u0438\u043a":N<20?"\u041f\u0440\u0430\u043a\u0442\u0438\u043a":N<30?"\u0410\u0434\u0435\u043f\u0442":N<40?"\u041c\u0430\u0441\u0442\u0435\u0440":N<50?"\u0413\u0440\u0430\u043d\u0434\u043c\u0430\u0441\u0442\u0435\u0440":"\u0411\u0435\u0441\u0441\u043c\u0435\u0440\u0442\u043d\u044b\u0439")," (",S.level||0," \u0443\u0440\u043e\u0432\u0435\u043d\u044c)"]})]}),(0,Cn.jsxs)(Xo,{children:[(0,Cn.jsx)(Jo,{children:"\u041f\u0440\u0435\u0434\u044b\u0441\u0442\u043e\u0440\u0438\u044f"}),(0,Cn.jsx)(Zo,{children:T.background||"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u044d\u0442\u043e\u0433\u043e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u0430 \u043f\u043e\u043a\u0430 \u043d\u0435 \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u0430..."})]})]}),(0,Cn.jsxs)(Fo,{children:[(0,Cn.jsxs)(zo,{children:[(0,Cn.jsx)(Bo,{children:"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438"}),k>0&&(0,Cn.jsxs)(Qo,{children:["\u041d\u0435\u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0435 \u043e\u0447\u043a\u0438: ",k]}),(0,Cn.jsxs)(Go,{children:[(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0421\u0438\u043b\u0430"}),(0,Cn.jsxs)(Ho,{children:[(0,Cn.jsxs)(Ko,{children:[I(j.strength),(null===(e=T.equipmentBonuses)||void 0===e||null===(t=e.stats)||void 0===t?void 0:t.strength)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.stats.strength]})]}),k>0&&(0,Cn.jsx)(Vo,{onClick:()=>A("strength"),children:"+"})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u041b\u043e\u0432\u043a\u043e\u0441\u0442\u044c"}),(0,Cn.jsxs)(Ho,{children:[(0,Cn.jsxs)(Ko,{children:[I(j.agility),(null===(r=T.equipmentBonuses)||void 0===r||null===(n=r.stats)||void 0===n?void 0:n.dexterity)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.stats.dexterity]})]}),k>0&&(0,Cn.jsx)(Vo,{onClick:()=>A("agility"),children:"+"})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435"}),(0,Cn.jsxs)(Ho,{children:[(0,Cn.jsxs)(Ko,{children:[I(j.health),(null===(a=T.equipmentBonuses)||void 0===a||null===(i=a.stats)||void 0===i?void 0:i.vitality)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.stats.vitality]})]}),k>0&&(0,Cn.jsx)(Vo,{onClick:()=>A("health"),children:"+"})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442"}),(0,Cn.jsxs)(Ho,{children:[(0,Cn.jsxs)(Ko,{children:[I(j.intellect),(null===(o=T.equipmentBonuses)||void 0===o||null===(s=o.stats)||void 0===s?void 0:s.intelligence)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.stats.intelligence]})]}),k>0&&(0,Cn.jsx)(Vo,{onClick:()=>A("intellect"),children:"+"})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0414\u0443\u0445"}),(0,Cn.jsxs)(Ho,{children:[(0,Cn.jsxs)(Ko,{children:[I(j.spirit),(null===(l=T.equipmentBonuses)||void 0===l||null===(c=l.stats)||void 0===c?void 0:c.perception)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.stats.perception]})]}),k>0&&(0,Cn.jsx)(Vo,{onClick:()=>A("spirit"),children:"+"})]})]}),(null===(d=T.equipmentBonuses)||void 0===d||null===(u=d.stats)||void 0===u?void 0:u.luck)>0&&(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0423\u0434\u0430\u0447\u0430"}),(0,Cn.jsx)(Ho,{children:(0,Cn.jsxs)(Ko,{children:[0,(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.stats.luck]})]})})]})]})]}),(0,Cn.jsxs)(zo,{children:[(0,Cn.jsx)(Bo,{children:"\u0411\u043e\u0435\u0432\u044b\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438"}),(0,Cn.jsxs)(Go,{children:[(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0424\u0438\u0437. \u0430\u0442\u0430\u043a\u0430"}),(0,Cn.jsxs)(Ko,{children:[I(j.strength),(null===(p=T.equipmentBonuses)||void 0===p||null===(h=p.combat)||void 0===h?void 0:h.physicalDamage)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.combat.physicalDamage]})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u041c\u0430\u0433. \u0430\u0442\u0430\u043a\u0430"}),(0,Cn.jsxs)(Ko,{children:[I(C.magicalAttack),(null===(m=T.equipmentBonuses)||void 0===m||null===(f=m.combat)||void 0===f?void 0:f.magicDamage)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.combat.magicDamage]})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0424\u0438\u0437. \u0437\u0430\u0449\u0438\u0442\u0430"}),(0,Cn.jsxs)(Ko,{children:[I(C.physicalDefense),(null===(y=T.equipmentBonuses)||void 0===y||null===(g=y.combat)||void 0===g?void 0:g.physicalDefense)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.combat.physicalDefense]})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u041c\u0430\u0433. \u0437\u0430\u0449\u0438\u0442\u0430"}),(0,Cn.jsxs)(Ko,{children:[I(C.magicalDefense),(null===(v=T.equipmentBonuses)||void 0===v||null===(x=v.combat)||void 0===x?void 0:x.magicDefense)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.combat.magicDefense]})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0423\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u0435"}),(0,Cn.jsxs)(Ko,{children:[I(C.evasion),(null===(b=T.equipmentBonuses)||void 0===b||null===(w=b.combat)||void 0===w?void 0:w.dodgeChance)>0&&(0,Cn.jsxs)("span",{style:{color:"#4caf50",marginLeft:"5px"},children:["+",T.equipmentBonuses.combat.dodgeChance,"%"]})]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c"}),(0,Cn.jsx)(Ko,{children:I(C.accuracy)})]})]})]}),(0,Cn.jsxs)(zo,{children:[(0,Cn.jsx)(Bo,{children:"\u041a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f"}),(0,Cn.jsxs)(Go,{children:[(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f"}),(0,Cn.jsxs)(Ko,{children:[S.energy||0,"/",S.maxEnergy||100]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u041e\u043f\u044b\u0442"}),(0,Cn.jsxs)(Ko,{children:[S.experience||0,"/",S.experienceRequired||100]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u041f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u0414\u0430\u043e"}),(0,Cn.jsxs)(Ko,{children:[S.daoUnderstanding||0,"%"]})]}),(0,Cn.jsxs)(Wo,{children:[(0,Cn.jsx)(Yo,{children:"\u041f\u0440\u043e\u0440\u044b\u0432\u044b"}),(0,Cn.jsx)(Ko,{children:S.breakthroughs||0})]})]})]})]})]});var N},ts=nr.div`
  width: 100%;
  margin-bottom: 5px;
`,rs=nr.div`
  width: 100%;
  height: 22px;
  background: rgba(0, 0, 0, 0.4);
  border-radius: 11px;
  overflow: hidden;
  position: relative;
  box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5), 0 1px 2px rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(0, 0, 0, 0.6);
`,ns=nr.div`
  height: 100%;
  width: ${e=>e.value/e.maxValue*100}%;
  background: ${e=>{const t=e.value/e.maxValue*100;switch(e.type){case"health":return t<=20?"linear-gradient(to right, #8B0000, #d32f2f)":t<=50?"linear-gradient(to right, #e65100, #fb8c00)":"linear-gradient(to right, #2e7d32, #4caf50)";case"energy":return"linear-gradient(to right, #1565C0, #42a5f5)";case"hunger":return t<=30?"linear-gradient(to right, #8B0000, #d32f2f)":t<=60?"linear-gradient(to right, #e65100, #fb8c00)":"linear-gradient(to right, #2e7d32, #4caf50)";case"loyalty":return t<=25?"linear-gradient(to right, #8B0000, #d32f2f)":t<=50?"linear-gradient(to right, #e65100, #fb8c00)":"linear-gradient(to right, #4A148C, #9c27b0)";default:return"linear-gradient(to right, #424242, #757575)"}}};
  transition: width 0.3s ease-out;
  position: relative;
  
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.25) 0%,
      rgba(255, 255, 255, 0.05) 100%
    );
  }
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    right: 0;
    width: 7px;
    background: rgba(255, 255, 255, 0.15);
    filter: blur(3px);
  }
`,as=nr.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #fff;
  font-size: 0.85rem;
  font-weight: bold;
  text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
  white-space: nowrap;
  letter-spacing: 0.5px;
  z-index: 1;
`,is=nr.div`
  color: #e0e0e0;
  font-size: 0.85rem;
  margin-bottom: 5px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.7);
`,os=nr.span`
  margin-right: 5px;
  filter: drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.5));
`;const ss=function(e){let{type:t="health",value:r,maxValue:n=100,label:a,showValues:i=!0,showPercentage:o=!1,className:s,...l}=e;const c=n||100,d=isNaN(r)?0:Math.max(0,r||0),u=Math.round(d/c*100);return(0,Cn.jsxs)(ts,{className:s,children:[(0,Cn.jsxs)(is,{children:[(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)(os,{children:{health:"\u2764\ufe0f",energy:"\u26a1",hunger:"\ud83c\udf56",loyalty:"\ud83d\udc3e"}[t]}),a]}),i&&(0,Cn.jsxs)("div",{children:[d,"/",c,o&&` (${u}%)`]})]}),(0,Cn.jsxs)(rs,{...l,children:[" ",(0,Cn.jsx)(ns,{type:t,value:d,maxValue:c}),(0,Cn.jsx)(as,{children:i?`${d}/${c}`:`${u}%`})]})]})},ls=nr.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
  max-width: 300px;
`,cs=nr.div`
  position: relative;
  width: 100%;
  padding-bottom: 100%;
  background: ${e=>e.isEnemy?"radial-gradient(circle, rgba(50, 23, 23, 0.7) 0%, rgba(68, 20, 20, 0.8) 100%)":"radial-gradient(circle, rgba(23, 34, 50, 0.7) 0%, rgba(20, 40, 68, 0.8) 100%)"};
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
  border: 1px solid ${e=>e.isEnemy?"rgba(220, 20, 60, 0.4)":"rgba(100, 149, 237, 0.4)"};
  transition: all 0.3s ease;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 20px rgba(0, 0, 0, 0.4);
  }
`,ds=nr.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 5rem;
  text-shadow: 0 0 15px ${e=>e.isEnemy?"rgba(255, 100, 100, 0.7)":"rgba(100, 200, 255, 0.7)"};
  
  ${e=>e.isEnemy&&"\n    transform: scaleX(-1);\n  "}
  
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: ${e=>e.isEnemy?"radial-gradient(circle at 30% 30%, rgba(255, 100, 100, 0.2) 0%, transparent 60%)":"radial-gradient(circle at 30% 30%, rgba(100, 200, 255, 0.2) 0%, transparent 60%)"};
    pointer-events: none;
  }
`,us=nr.div`
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.6) 80%, transparent 100%);
  padding: 15px 10px 10px;
  text-align: center;
`,ps=nr.div`
  color: ${e=>e.isEnemy?"#ff9e9e":"#9ecaff"};
  font-size: 1.2rem;
  margin-bottom: 5px;
  font-weight: bold;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
  letter-spacing: 0.5px;
`,hs=nr.div`
  color: #e0e0e0;
  font-size: 0.9rem;
  font-weight: 300;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
`,ms=nr.div`
  display: flex;
  flex-direction: column;
  gap: 8px;
`,fs=nr(ss)`
  height: 15px;
`;const ys=function(e){let{name:t,level:r,icon:n,health:a,maxHealth:i,energy:o,maxEnergy:s,hunger:l,loyalty:c,isPet:d=!1,isEnemy:u=!1}=e;return(0,Cn.jsxs)(ls,{children:[(0,Cn.jsxs)(cs,{isEnemy:u,children:[(0,Cn.jsx)(ds,{isEnemy:u,children:n}),(0,Cn.jsxs)(us,{children:[(0,Cn.jsx)(ps,{isEnemy:u,children:t}),(0,Cn.jsxs)(hs,{children:["\u0423\u0440\u043e\u0432\u0435\u043d\u044c ",r]})]})]}),(0,Cn.jsxs)(ms,{children:[(0,Cn.jsx)(fs,{type:"health",value:a,maxValue:i,label:"\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435","data-health":a,"data-max-health":i}),s>0&&(0,Cn.jsx)(fs,{type:"energy",value:o,maxValue:s,label:"\u042d\u043d\u0435\u0440\u0433\u0438\u044f","data-energy":o,"data-max-energy":s}),d&&void 0!==l&&(0,Cn.jsx)(fs,{type:"hunger",value:l,maxValue:100,label:"\u0421\u044b\u0442\u043e\u0441\u0442\u044c","data-hunger":l}),d&&void 0!==c&&(0,Cn.jsx)(fs,{type:"loyalty",value:c,maxValue:100,label:"\u041b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c","data-loyalty":c})]})]})},gs=nr.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
  gap: 15px;
  padding: 5px;
`,vs=nr.button`
  position: relative;
  background: ${e=>e.disabled?"linear-gradient(to bottom, rgba(40, 40, 40, 0.95), rgba(30, 30, 30, 0.95))":"linear-gradient(to bottom, rgba(53, 46, 21, 0.95), rgba(43, 36, 11, 0.95))"};
  border: 1px solid ${e=>e.disabled?"rgba(102, 102, 102, 0.5)":"rgba(212, 175, 55, 0.7)"};
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3), inset 0 1px 3px rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  padding: 15px 12px;
  color: ${e=>e.disabled?"#777":"#ffd700"};
  cursor: ${e=>e.disabled?"not-allowed":"pointer"};
  transition: all 0.3s cubic-bezier(.25,.8,.25,1);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  opacity: ${e=>e.disabled?.8:1};
  font-weight: ${e=>e.disabled?"normal":"bold"};
  text-shadow: ${e=>e.disabled?"none":"0 1px 2px rgba(0, 0, 0, 0.5)"};
  
  &:hover:not(:disabled) {
    background: linear-gradient(to bottom, rgba(73, 66, 41, 0.95), rgba(63, 56, 31, 0.95));
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), inset 0 1px 3px rgba(255, 255, 255, 0.2);
    color: #fff07c;
    border-color: rgba(255, 215, 0, 0.8);
  }
  
  &:active:not(:disabled) {
    transform: translateY(1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), inset 0 1px 3px rgba(255, 255, 255, 0.1);
    background: linear-gradient(to bottom, rgba(43, 36, 11, 0.95), rgba(53, 46, 21, 0.95));
  }
  
  &:disabled {
    cursor: not-allowed;
  }
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 50%;
    background: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.1) 0%,
      transparent 100%
    );
    border-radius: 9px 9px 0 0;
  }
`,xs=nr.div`
  font-size: 2rem;
  filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.5));
  margin-bottom: 5px;
`,bs=nr.div`
  font-size: 1rem;
  text-align: center;
  margin-bottom: 2px;
  letter-spacing: 0.5px;
`,ws=nr.div`
  font-size: 0.9rem;
  color: ${e=>e.disabled?"#777":"#72bbff"};
  font-weight: normal;
  display: flex;
  align-items: center;
  gap: 3px;
`,_s=nr.div`
  font-size: 0.9rem;
  color: ${e=>e.disabled?"#777":"#ff7f7f"};
  font-weight: normal;
  display: flex;
  align-items: center;
  gap: 3px;
`,Es=nr.div`
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.9);
  border: 1px solid #d4af37;
  border-radius: 4px;
  padding: 8px;
  width: max-content;
  max-width: 200px;
  margin-bottom: 8px;
  z-index: 100;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s ease;
  
  ${vs}:hover & {
    opacity: 1;
  }
  
  &::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border-width: 5px;
    border-style: solid;
    border-color: #d4af37 transparent transparent transparent;
  }
`,Ts=nr.div`
  color: #d4af37;
  font-weight: bold;
  margin-bottom: 4px;
`,Ss=nr.div`
  color: #aaa;
  font-size: 0.9rem;
  line-height: 1.4;
`,js=nr.div`
  margin-top: 4px;
  font-size: 0.8rem;
  
  div {
    display: flex;
    justify-content: space-between;
    color: ${e=>"positive"===e.type?"#4caf50":"#f44336"};
  }
`,Cs={attack:"\u2694\ufe0f",defend:"\ud83d\udee1\ufe0f",heal:"\ud83d\udc9a",flee:"\ud83c\udfc3"};const ks=function(e){let{actions:t=[],onActionSelect:r,disabled:n=!1,currentEnergy:a=0}=e;const i=e=>n?"\u0421\u0435\u0439\u0447\u0430\u0441 \u043d\u0435 \u0432\u0430\u0448 \u0445\u043e\u0434":e.energyCost>a?`\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u044d\u043d\u0435\u0440\u0433\u0438\u0438 (\u043d\u0443\u0436\u043d\u043e ${e.energyCost})`:e.cooldown>0?`\u041f\u0435\u0440\u0435\u0437\u0430\u0440\u044f\u0434\u043a\u0430 (${e.cooldown} \u0445\u043e\u0434\u043e\u0432)`:e.disabled&&"petAbility"===e.type?"\u041f\u0438\u0442\u043e\u043c\u0446\u0443 \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u0441\u044b\u0442\u043e\u0441\u0442\u0438 (\u043d\u0443\u0436\u043d\u043e \u043c\u0438\u043d\u0438\u043c\u0443\u043c 20%)":e.disabled?"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e":"";return(0,Cn.jsx)(gs,{children:t.map(((e,t)=>{var o;const s=(e=>!n&&!(e.energyCost>a)&&!(e.cooldown>0)&&!e.disabled)(e);return(0,Cn.jsxs)(vs,{onClick:()=>s&&r(e),disabled:!s,children:[(0,Cn.jsx)(xs,{children:e.icon||Cs[e.type]||"\u2753"}),(0,Cn.jsx)(bs,{children:e.name}),e.energyCost>0&&(0,Cn.jsxs)(ws,{disabled:!s,children:["\u26a1 ",e.energyCost]}),e.cooldown>0&&(0,Cn.jsxs)(_s,{disabled:!s,children:["\ud83d\udd52 ",e.cooldown]}),(0,Cn.jsxs)(Es,{children:[(0,Cn.jsx)(Ts,{children:e.name}),(0,Cn.jsx)(Ss,{children:e.description}),!s&&(0,Cn.jsx)(Ss,{style:{color:"#ff6b6b",marginTop:"5px",fontWeight:"bold"},children:i(e)}),(e.calculatedDamage||e.damage)&&(0,Cn.jsx)(js,{type:"negative",children:(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("span",{children:"\u0423\u0440\u043e\u043d:"}),(0,Cn.jsx)("span",{children:e.calculatedDamage||e.damage})]})}),e.healing&&(0,Cn.jsx)(js,{type:"positive",children:(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("span",{children:"\u041b\u0435\u0447\u0435\u043d\u0438\u0435:"}),(0,Cn.jsx)("span",{children:e.healing})]})}),"petAbility"===e.type&&(0,Cn.jsx)(Ss,{style:{color:"#f39c12",marginTop:"5px",fontSize:"0.8rem"},children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u0443\u043c\u0435\u043d\u044c\u0448\u0430\u0435\u0442 \u0441\u044b\u0442\u043e\u0441\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u043d\u0430 20% \u0438 \u0441\u043d\u0438\u0436\u0430\u0435\u0442 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c"}),null===(o=e.effects)||void 0===o?void 0:o.map(((e,t)=>(0,Cn.jsx)(Ss,{children:e.description},t)))]})]},`${e.name}-${t}`)}))})},Is=nr.div`
  display: flex;
  flex-direction: column;
  gap: 6px;
`,As=nr.div`
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  
  &:last-child {
    border-bottom: none;
  }
`,Ns=nr.div`
  font-size: 1rem;
  color: ${e=>{switch(e.type){case"buff":return"#7FFF7F";case"debuff":return"#FF7F7F";default:return"#FFFF7F"}}};
`,Ds=nr.div`
  flex: 1;
  font-size: 0.9rem;
`,Ms=nr.div`
  font-size: 0.8rem;
  color: rgba(255, 255, 255, 0.7);
`;const Rs=function(e){let{effects:t=[]}=e;return t&&0!==t.length?(0,Cn.jsx)(Is,{children:t.map(((e,t)=>(0,Cn.jsxs)(As,{children:[(0,Cn.jsx)(Ns,{type:e.type||"neutral",children:e.icon||("buff"===e.type?"\u2728":"debuff"===e.type?"\u26a0\ufe0f":"\u2022")}),(0,Cn.jsx)(Ds,{children:e.name}),e.duration&&(0,Cn.jsxs)(Ms,{children:[e.duration," \u0445\u043e\u0434\u043e\u0432"]})]},t)))}):(0,Cn.jsx)("div",{style:{color:"#aaa",fontSize:"0.9rem"},children:"\u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432"})},Ps=nr.div`
  background: rgba(10, 12, 16, 0.7);
  border-radius: 10px;
  padding: 15px;
  height: 200px;
  overflow-y: auto;
  box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.1);
  font-family: 'Arial', sans-serif;
  
  &::-webkit-scrollbar {
    width: 8px;
  }
  
  &::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 4px;
  }
  
  &::-webkit-scrollbar-thumb {
    background: linear-gradient(to bottom, rgba(212, 175, 55, 0.7), rgba(192, 155, 35, 0.7));
    border-radius: 4px;
    border: 1px solid rgba(0, 0, 0, 0.2);
  }
  
  &::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(to bottom, rgba(232, 195, 75, 0.8), rgba(212, 175, 55, 0.8));
  }
`,Ls=nr.div`
  position: relative;
  color: ${e=>{switch(e.type){case"damage":return"#ff7f7f";case"heal":return"#7fff7f";case"buff":return"#7fbfff";case"debuff":return"#ffbf7f";case"critical":return"#ff7fbf";case"dodge":return"#bf7fff";case"system":return"#ffd700";default:return"#e0e0e0"}}};
  padding: 6px 10px;
  margin-bottom: 4px;
  font-size: 0.95rem;
  line-height: 1.5;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.7);
  border-left: 3px solid ${e=>{switch(e.type){case"damage":return"rgba(255, 87, 34, 0.7)";case"heal":return"rgba(76, 175, 80, 0.7)";case"buff":return"rgba(33, 150, 243, 0.7)";case"debuff":return"rgba(255, 152, 0, 0.7)";case"critical":return"rgba(233, 30, 99, 0.7)";case"dodge":return"rgba(156, 39, 176, 0.7)";case"system":return"rgba(212, 175, 55, 0.7)";default:return"rgba(158, 158, 158, 0.7)"}}};
  border-radius: 4px;
  background: ${e=>{switch(e.type){case"damage":return"rgba(244, 67, 54, 0.1)";case"heal":return"rgba(76, 175, 80, 0.1)";case"buff":return"rgba(33, 150, 243, 0.1)";case"debuff":return"rgba(255, 152, 0, 0.1)";case"critical":return"rgba(233, 30, 99, 0.1)";case"dodge":return"rgba(156, 39, 176, 0.1)";case"system":return"rgba(212, 175, 55, 0.1)";default:return"rgba(0, 0, 0, 0.15)"}}};
  
  &:hover {
    background: ${e=>{switch(e.type){case"damage":return"rgba(244, 67, 54, 0.2)";case"heal":return"rgba(76, 175, 80, 0.2)";case"buff":return"rgba(33, 150, 243, 0.2)";case"debuff":return"rgba(255, 152, 0, 0.2)";case"critical":return"rgba(233, 30, 99, 0.2)";case"dodge":return"rgba(156, 39, 176, 0.2)";case"system":return"rgba(212, 175, 55, 0.2)";default:return"rgba(66, 66, 66, 0.2)"}}};
    transform: translateX(2px);
    transition: all 0.3s ease;
  }
`,$s=nr.span`
  color: rgba(255, 255, 255, 0.5);
  font-size: 0.8rem;
  margin-right: 8px;
  font-family: 'Courier New', monospace;
  font-weight: bold;
`;const Os=function(e){let{entries:t=[]}=e;const r=(0,n.useRef)(null);(0,n.useEffect)((()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)}),[t]);const a=e=>{const t=new Date(e);return`${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`};return(0,Cn.jsx)(Ps,{ref:r,children:t.map(((e,t)=>(0,Cn.jsxs)(Ls,{type:e.type,children:[(0,Cn.jsx)($s,{children:a(e.timestamp)}),e.message]},`${e.timestamp}-${t}`)))})};console.log("CombatInterface \u0438\u043c\u043f\u043e\u0440\u0442\u044b:",{Portrait:typeof ys,ActionBar:typeof ks,StatusEffects:typeof Rs,CombatLog:typeof Os});const qs=nr.div`
  display: flex;
  flex-direction: column;
  gap: 20px;
  padding: 20px;
  height: 100%;
  background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%);
  box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.5);
  border-radius: 8px;
  font-family: 'Arial', sans-serif;
`,Us=nr.div`
  display: flex;
  justify-content: space-between;
  gap: 40px;
  margin-bottom: 20px;
  position: relative;
`,Fs=nr.div`
  display: flex;
  flex-direction: column;
  gap: 15px;
  width: 300px;
  position: relative;
  z-index: 1;
  
  &.player {
    box-shadow: 0 0 15px rgba(100, 149, 237, 0.3);
  }
  
  &.enemy {
    box-shadow: 0 0 15px rgba(220, 20, 60, 0.3);
  }
`,zs=nr.div`
  background: rgba(13, 17, 23, 0.7);
  border-radius: 8px;
  padding: 15px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(5px);
`,Bs=nr.div`
  color: #e0e0e0;
  font-size: 0.9rem;
  margin-bottom: 10px;
  font-weight: bold;
  letter-spacing: 0.5px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: 5px;
`,Gs=nr.div`
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 20px;
  position: relative;
  
  &::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(
      to right,
      transparent 0%,
      rgba(218, 165, 32, 0.5) 50%,
      transparent 100%
    );
    z-index: 0;
  }
`,Ws=nr.div`
  color: #ffd700;
  font-size: 1.3rem;
  text-align: center;
  padding: 15px;
  background: rgba(0, 0, 0, 0.7);
  border-radius: 10px;
  min-width: 220px;
  box-shadow: 0 0 20px rgba(218, 165, 32, 0.4);
  border: 1px solid rgba(218, 165, 32, 0.3);
  font-weight: bold;
  text-shadow: 0 0 5px rgba(218, 165, 32, 0.5);
  letter-spacing: 1px;
  position: relative;
  z-index: 1;
  transition: all 0.3s ease;
  animation: pulse 2s infinite;
  
  @keyframes pulse {
    0% { box-shadow: 0 0 20px rgba(218, 165, 32, 0.4); }
    50% { box-shadow: 0 0 30px rgba(218, 165, 32, 0.6); }
    100% { box-shadow: 0 0 20px rgba(218, 165, 32, 0.4); }
  }
`,Hs=nr.div`
  display: flex;
  flex-direction: column;
  gap: 20px;
  margin-top: 10px;
  background: rgba(0, 0, 0, 0.3);
  padding: 15px;
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, 0.1);
`,Vs=nr.div`
  flex: 1;
  min-height: 180px;
  max-height: 200px;
  overflow-y: auto;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 8px;
  padding: 10px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.2) rgba(0, 0, 0, 0.2);
  
  &::-webkit-scrollbar {
    width: 8px;
  }
  
  &::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
  }
  
  &::-webkit-scrollbar-thumb {
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
  }
`;const Qs=function(e){let{player:t,enemy:r,playerActions:a,onActionSelect:i,isPlayerTurn:o,disabled:s,combatLog:l=[]}=e;const{state:c}=(0,n.useContext)(kn);return(0,Cn.jsxs)(qs,{children:[(0,Cn.jsxs)(Us,{children:[(0,Cn.jsxs)(Fs,{className:"player",children:[(0,Cn.jsx)(ys,{name:t.name,level:t.level,icon:t.icon||"\ud83d\udc64",health:t.stats.health,maxHealth:t.stats.maxHealth,energy:t.stats.energy,maxEnergy:t.stats.maxEnergy}),(0,Cn.jsxs)(zs,{children:[(0,Cn.jsx)(Bs,{children:"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b"}),(0,Cn.jsx)(Rs,{effects:t.effects})]})]}),(0,Cn.jsx)(Gs,{children:(0,Cn.jsx)(Ws,{children:o?"\u0412\u0430\u0448 \u0445\u043e\u0434":"\u0425\u043e\u0434 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430"})}),(0,Cn.jsxs)(Fs,{className:"enemy",children:[(0,Cn.jsx)(ys,{name:r.name,level:r.level,icon:r.icon,health:r.stats.health,maxHealth:r.stats.maxHealth,energy:r.stats.energy,maxEnergy:r.stats.maxEnergy,isEnemy:!0}),(0,Cn.jsxs)(zs,{children:[(0,Cn.jsx)(Bs,{children:"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b"}),(0,Cn.jsx)(Rs,{effects:r.effects})]})]})]}),(0,Cn.jsx)(Hs,{children:(0,Cn.jsx)(ks,{actions:a,onActionSelect:i,disabled:s||!o,currentEnergy:t.stats.energy})}),(0,Cn.jsx)(Vs,{children:(0,Cn.jsx)(Os,{entries:l})})]})},Ys=nr.div`
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
`,Ks=nr.div`
  background: rgba(30, 30, 30, 0.95);
  border-radius: 8px;
  padding: 30px;
  width: 90%;
  max-width: 500px;
  text-align: center;
`,Xs=nr.h2`
  color: ${e=>e.victory?"#4caf50":"#f44336"};
  margin: 0 0 20px 0;
  font-size: 2rem;
`,Js=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-bottom: 30px;
`,Zs=nr.div`
  background: rgba(0, 0, 0, 0.2);
  padding: 15px;
  border-radius: 8px;
`,el=nr.h3`
  color: #d4af37;
  margin: 0 0 10px 0;
  font-size: 1.1rem;
`,tl=nr.div`
  display: flex;
  flex-direction: column;
  gap: 8px;
`,rl=nr.div`
  color: #aaa;
  display: flex;
  justify-content: space-between;
  align-items: center;
  
  span:last-child {
    color: ${e=>e.positive?"#4caf50":e.negative?"#f44336":"#d4af37"};
  }
`,nl=nr.div`
  background: rgba(0, 0, 0, 0.2);
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 30px;
`,al=nr.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 15px;
  margin-top: 15px;
`,il=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  color: #aaa;
  
  span:first-child {
    font-size: 1.5rem;
  }
  
  span:last-child {
    color: #d4af37;
  }
`,ol=nr.button`
  background: #d4af37;
  color: #000;
  border: none;
  padding: 12px 30px;
  border-radius: 4px;
  font-size: 1.1rem;
  cursor: pointer;
  transition: all 0.3s ease;
  
  &:hover {
    background: #e5c158;
    transform: translateY(-2px);
  }
`;const sl=function(e){let{results:t,onClose:r}=e;const{state:n}=Nn(),{victory:a,playerStats:i,enemyStats:o,rewards:s,duration:l}=t;return(0,Cn.jsx)(Ys,{children:(0,Cn.jsxs)(Ks,{children:[(0,Cn.jsx)(Xs,{victory:a,children:a?"\u041f\u043e\u0431\u0435\u0434\u0430!":"\u041f\u043e\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}),(0,Cn.jsxs)(Js,{children:[(0,Cn.jsxs)(Zs,{children:[(0,Cn.jsx)(el,{children:"\u0412\u0430\u0448\u0438 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0438"}),(0,Cn.jsxs)(tl,{children:[(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u041d\u0430\u043d\u0435\u0441\u0435\u043d\u043e \u0443\u0440\u043e\u043d\u0430:"}),(0,Cn.jsx)("span",{children:i.damageDealt})]}),(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043e \u0442\u0435\u0445\u043d\u0438\u043a:"}),(0,Cn.jsx)("span",{children:i.techniquesUsed})]}),(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0434\u0430\u0440\u044b:"}),(0,Cn.jsx)("span",{children:i.criticalHits})]}),(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u0423\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f:"}),(0,Cn.jsx)("span",{children:i.dodges})]})]})]}),(0,Cn.jsxs)(Zs,{children:[(0,Cn.jsx)(el,{children:"\u041f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a"}),(0,Cn.jsxs)(tl,{children:[(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u041d\u0430\u043d\u0435\u0441\u0435\u043d\u043e \u0443\u0440\u043e\u043d\u0430:"}),(0,Cn.jsx)("span",{children:o.damageDealt})]}),(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043e \u0442\u0435\u0445\u043d\u0438\u043a:"}),(0,Cn.jsx)("span",{children:o.techniquesUsed})]}),(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0443\u0434\u0430\u0440\u044b:"}),(0,Cn.jsx)("span",{children:o.criticalHits})]}),(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u0423\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f:"}),(0,Cn.jsx)("span",{children:o.dodges})]})]})]})]}),a&&s&&(0,Cn.jsxs)(nl,{children:[(0,Cn.jsx)(el,{children:"\u041d\u0430\u0433\u0440\u0430\u0434\u044b"}),(0,Cn.jsxs)(al,{children:[(0,Cn.jsxs)(il,{children:[(0,Cn.jsx)("span",{children:"\u2728"}),(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("div",{children:"\u041e\u043f\u044b\u0442"}),(0,Cn.jsxs)("span",{children:["+",s.experience]})]})]}),s.currency&&"object"===typeof s.currency?Object.entries(s.currency).map((e=>{let[t,r]=e;if(r<=0)return null;let n="\ud83d\udcb0",a=t;return"gold"===t?(n="\ud83e\ude99",a="\u0417\u043e\u043b\u043e\u0442\u043e"):"silver"===t?(n="\ud83d\udcbf",a="\u0421\u0435\u0440\u0435\u0431\u0440\u043e"):"copper"===t&&(n="\ud83d\udd36",a="\u041c\u0435\u0434\u044c"),(0,Cn.jsxs)(il,{children:[(0,Cn.jsx)("span",{children:n}),(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("div",{children:a}),(0,Cn.jsxs)("span",{children:["+",r]})]})]},`currency-${t}`)})):(0,Cn.jsxs)(il,{children:[(0,Cn.jsx)("span",{children:"\ud83e\ude99"}),(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("div",{children:"\u0417\u043e\u043b\u043e\u0442\u043e"}),(0,Cn.jsxs)("span",{children:["+",s.currency]})]})]}),s.items.map(((e,t)=>(0,Cn.jsxs)(il,{children:[(0,Cn.jsx)("span",{children:e.icon}),(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("div",{children:e.name}),(0,Cn.jsxs)("span",{children:["x",e.quantity]})]})]},t)))]})]}),(0,Cn.jsxs)(rl,{children:[(0,Cn.jsx)("span",{children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0431\u043e\u044f:"}),(0,Cn.jsx)("span",{children:(c=l,`${Math.floor(c/60)}:${(c%60).toString().padStart(2,"0")}`)})]}),(0,Cn.jsx)(ol,{onClick:r,children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"})]})});var c},ll="physical",cl={id:"basicAttack",name:"\u041e\u0431\u044b\u0447\u043d\u0430\u044f \u0430\u0442\u0430\u043a\u0430",description:"\u041f\u0440\u043e\u0441\u0442\u0430\u044f \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0430\u0442\u0430\u043a\u0430",type:"attack",damage:10,damageType:ll,energyCost:0,cooldown:0,icon:"\u2694\ufe0f"};var dl=r(9193);const ul=function(e){var t,r,a,i,o,s;let{enemy:l,onEnd:c,weatherEffects:d}=e;const{state:u,actions:p}=Nn(),h=u.player.spiritPets.pets.find((e=>e.id===u.player.spiritPets.activePetId)),m=u.combat.inCombat&&u.combat.enemyCombatState&&u.combat.enemyCombatState.id===l.id;console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0431\u043e\u044f:",{hasSavedState:m,enemyId:l.id,savedEnemyId:null===(t=u.combat.enemyCombatState)||void 0===t?void 0:t.id,inCombat:u.combat.inCombat,savedEnemyHealth:null===(r=u.combat.enemyCombatState)||void 0===r||null===(a=r.stats)||void 0===a?void 0:a.health});const[f,y]=(0,n.useState)((()=>{if(m){console.log("\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430:",u.combat.enemyCombatState);let e={...u.combat.enemyCombatState};return(!e.stats||e.stats.health<=0)&&(console.log("\u26a0\ufe0f \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u043e \u043d\u0443\u043b\u0435\u0432\u043e\u0435 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435 \u0432\u0440\u0430\u0433\u0430, \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c!"),e.stats?e.stats.health=Math.ceil(.3*e.stats.maxHealth):e.stats={...l.stats,health:Math.ceil(.3*l.stats.health),maxHealth:l.stats.health,energy:l.stats.energy,maxEnergy:l.stats.energy}),e.attacks&&Array.isArray(e.attacks)&&0!==e.attacks.length||(console.log("\u26a0\ufe0f \u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0430\u0442\u0430\u043a\u0438 \u0443 \u0432\u0440\u0430\u0433\u0430, \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c!"),e.attacks=l.attacks||[]),e}return{...l,stats:{...l.stats,health:l.stats.health,maxHealth:l.stats.health,energy:l.stats.energy,maxEnergy:l.stats.energy},effects:[]}})),[g,v]=(0,n.useState)((()=>{var e,t,r,n,a,i,o,s,l;const c=(null===(e=u.player.equipmentBonuses)||void 0===e?void 0:e.combat)||{};if(console.log("CombatManager: Applying equipment bonuses:",c),console.log("CombatManager: Player base stats:",u.player.secondaryStats),m&&u.combat.playerCombatState)return console.log("\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u0433\u0440\u043e\u043a\u0430:",u.combat.playerCombatState),{name:u.player.name,level:u.player.cultivation.level,icon:u.player.avatar,stats:{...u.combat.playerCombatState.stats},effects:[...u.combat.playerCombatState.effects]};let d=u.player.stats.maxHealth||100,p=d,f=u.player.stats.maxEnergy||100,y=f;console.log("CombatManager: \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435 \u043f\u0440\u0438 \u0432\u0445\u043e\u0434\u0435 \u0432 \u0431\u043e\u0439:",d),console.log("CombatManager: \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f \u043f\u0440\u0438 \u0432\u0445\u043e\u0434\u0435 \u0432 \u0431\u043e\u0439:",f);let g={health:p,maxHealth:d,energy:y,maxEnergy:f,physicalAttack:((null===(t=u.player.secondaryStats)||void 0===t?void 0:t.physicalAttack)||0)+(c.physicalDamage||0),magicalAttack:((null===(r=u.player.secondaryStats)||void 0===r?void 0:r.magicalAttack)||0)+(c.magicDamage||0),physicalDefense:((null===(n=u.player.secondaryStats)||void 0===n?void 0:n.physicalDefense)||0)+(c.physicalDefense||0),spiritualDefense:((null===(a=u.player.secondaryStats)||void 0===a?void 0:a.magicalDefense)||0)+(c.magicDefense||0),accuracy:(null===(i=u.player.secondaryStats)||void 0===i?void 0:i.accuracy)||90,evasion:((null===(o=u.player.secondaryStats)||void 0===o?void 0:o.evasion)||0)+(c.dodgeChance||0),criticalChance:((null===(s=u.player.secondaryStats)||void 0===s?void 0:s.critChance)||5)+(c.critChance||0),criticalDamage:(null===(l=u.player.secondaryStats)||void 0===l?void 0:l.critDamage)||50};return h&&(g.maxHealth+=5*h.vitality,g.maxEnergy+=5*h.spirit,g.physicalDefense+=h.strength,g.spiritualDefense+=h.intelligence,g.criticalChance+=.01*h.agility),console.log("CombatManager: Final player combat stats:",g),{name:u.player.name,level:u.player.cultivation.level,icon:u.player.avatar,stats:g,effects:[]}})),[x,b]=(0,n.useState)((()=>!m||void 0===u.combat.isPlayerTurn||(console.log("\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0445\u043e\u0434 \u0438\u0433\u0440\u043e\u043a\u0430:",u.combat.isPlayerTurn),u.combat.isPlayerTurn))),[w,_]=(0,n.useState)(!1),[E,T]=(0,n.useState)((()=>m&&Array.isArray(u.combat.log)&&u.combat.log.length>0?(console.log("\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0431\u043e\u0435\u0432\u043e\u0439 \u043b\u043e\u0433, \u0437\u0430\u043f\u0438\u0441\u0435\u0439:",u.combat.log.length),[...u.combat.log]):[])),[S,j]=(0,n.useState)((()=>m&&u.combat.combatStats?(console.log("\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c \u0431\u043e\u0435\u0432\u0443\u044e \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0443:",u.combat.combatStats),u.combat.combatStats):{player:{damageDealt:0,techniquesUsed:0,criticalHits:0,dodges:0},enemy:{damageDealt:0,techniquesUsed:0,criticalHits:0,dodges:0}})),[C]=(0,n.useState)((()=>m?u.combat.startTime:Date.now())),[k,I]=(0,n.useState)(!1),[A,N]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(!k){var e,t,r,n,a,i,o,s,l,c,d,h,m,y,v,b;(g.stats.health!==(null===(e=u.combat)||void 0===e||null===(t=e.playerCombatState)||void 0===t||null===(r=t.stats)||void 0===r?void 0:r.health)||(null===f||void 0===f||null===(n=f.stats)||void 0===n?void 0:n.health)!==(null===(a=u.combat)||void 0===a||null===(i=a.enemyCombatState)||void 0===i||null===(o=i.stats)||void 0===o?void 0:o.health)||x!==(null===(s=u.combat)||void 0===s?void 0:s.isPlayerTurn)||E.length!==(null===(l=u.combat)||void 0===l||null===(c=l.log)||void 0===c?void 0:c.length)||S.player.damageDealt!==(null===(d=u.combat)||void 0===d||null===(h=d.combatStats)||void 0===h||null===(m=h.player)||void 0===m?void 0:m.damageDealt)||S.enemy.damageDealt!==(null===(y=u.combat)||void 0===y||null===(v=y.combatStats)||void 0===v||null===(b=v.enemy)||void 0===b?void 0:b.damageDealt))&&(console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0431\u043e\u044f \u0432 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 (\u0435\u0441\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f)"),p.updateCombatState({inCombat:!0,enemyCombatState:f,playerCombatState:{stats:{...g.stats},effects:[...g.effects]},isPlayerTurn:x,log:E,combatStats:S,startTime:C}))}}),[g.stats.health,null===f||void 0===f||null===(i=f.stats)||void 0===i?void 0:i.health,x,E.length,S.player.damageDealt,S.enemy.damageDealt,k]);const D=(0,n.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";T((r=>[...r,{message:e,type:t,timestamp:Date.now()}]))}),[]),M=(0,n.useCallback)(((e,t)=>{j((r=>({...r,[e]:{...r[e],...t}})))}),[]),R=d||(null===(o=u.weather)||void 0===o?void 0:o.weatherEffects)||{combat:{damageModifiers:{},hitChanceModifier:1,critChanceModifier:1,dodgeChanceModifier:1}},P=((0,n.useCallback)((e=>R&&R.combat?(e.player&&(e.player.hitChance=(e.player.hitChance||.9)*R.combat.hitChanceModifier,e.player.dodgeChance=(e.player.dodgeChance||.1)*R.combat.dodgeChanceModifier,e.player.critChance=(e.player.critChance||.05)*R.combat.critChanceModifier),e):e),[R]),(0,n.useCallback)((e=>R&&R.combat&&R.combat.damageModifiers&&R.combat.damageModifiers[e]||1),[R])),L=(0,n.useCallback)((()=>R&&R.combat?{hitChanceModifier:R.combat.hitChanceModifier||1,critChanceModifier:R.combat.critChanceModifier||1,dodgeChanceModifier:R.combat.dodgeChanceModifier||1}:{hitChanceModifier:1,critChanceModifier:1,dodgeChanceModifier:1}),[R]),$=(0,n.useCallback)((function(e,t,r){var n,a;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"physical";console.log("\ud83d\udd0d calculateDamage \u043f\u043e\u043b\u0443\u0447\u0438\u043b \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:",{"\u0431\u0430\u0437\u043e\u0432\u044b\u0439\u0423\u0440\u043e\u043d":r,"\u0442\u0438\u043f\u0423\u0440\u043e\u043d\u0430":i,"\u0430\u0442\u0430\u043a\u0443\u044e\u0449\u0438\u0439":e.name,"\u0437\u0430\u0449\u0438\u0442\u043d\u0438\u043a":t.name});const o="technique"===(null===(n=e.action)||void 0===n?void 0:n.type)&&(null===(a=e.action)||void 0===a?void 0:a.calculatedDamage)===r;let s=0;e.effects&&e.effects.length>0?(console.log("\u2694\ufe0f \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u0430\u0442\u0430\u043a\u0443\u044e\u0449\u0435\u0433\u043e \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u0443\u0440\u043e\u043d\u0430:",e.effects),e.effects.forEach((e=>{if("combat_damage"===e.effectType||"combat_damage"===e.originalType||"combat_damage"===e.type||"combat_damage (thunderstorm)"===e.effectType||e.name.includes("\u0423\u0440\u043e\u043d \u0432 \u0431\u043e\u044e")||!0===e.isCombatEffect){const t="number"===typeof e.modifier?e.modifier:"number"===typeof e.value?e.value:0,r=Math.abs(t)>1?t/100:t;s+=r,console.log(`\u2694\ufe0f \u042d\u0444\u0444\u0435\u043a\u0442 "${e.name}" \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 ${Math.abs(t)>1?t+"%":100*t+"%"} \u043a \u0443\u0440\u043e\u043d\u0443 (${r} \u0434\u0440\u043e\u0431\u043d\u044b\u0439)`)}if(e.effectType===`${i}_damage`||e.originalType===`${i}_damage`||e.type===`${i}_damage`){const t="number"===typeof e.modifier?e.modifier:"number"===typeof e.value?e.value:0,r=Math.abs(t)>1?t/100:t;s+=r,console.log(`\u2694\ufe0f \u042d\u0444\u0444\u0435\u043a\u0442 "${e.name}" \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 ${Math.abs(t)>1?t+"%":100*t+"%"} \u043a \u0443\u0440\u043e\u043d\u0443 \u0442\u0438\u043f\u0430 ${i} (${r} \u0434\u0440\u043e\u0431\u043d\u044b\u0439)`)}})),console.log(`\u2694\ufe0f \u0421\u0443\u043c\u043c\u0430\u0440\u043d\u044b\u0439 \u0431\u043e\u043d\u0443\u0441 \u043a \u0443\u0440\u043e\u043d\u0443 \u043e\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432: ${(100*s).toFixed(0)}%`)):console.log("\u2694\ufe0f \u0423 \u0430\u0442\u0430\u043a\u0443\u044e\u0449\u0435\u0433\u043e \u043d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u0434\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u0443\u0440\u043e\u043d\u0430");const l=P(i);if(o||r>0&&e.isTechniqueDamage){console.log("\ud83d\udd04 \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043f\u0440\u0435\u0434\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0439 \u0443\u0440\u043e\u043d \u0442\u0435\u0445\u043d\u0438\u043a\u0438 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e:",r);const t=(1+s)*l,n=Math.max(1,Math.floor(r*t));console.log(`\ud83e\uddee \u0418\u0442\u043e\u0433\u043e\u0432\u044b\u0439 \u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044c \u0443\u0440\u043e\u043d\u0430: ${t.toFixed(2)} (\u043f\u043e\u0433\u043e\u0434\u0430: ${l}, \u044d\u0444\u0444\u0435\u043a\u0442\u044b: ${(1+s).toFixed(2)})`),console.log(`\ud83e\uddee \u0418\u0442\u043e\u0433\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u043d: ${r} \xd7 ${t.toFixed(2)} = ${n}`);const{critChanceModifier:a}=L(),i=e.stats.criticalChance||5,o=i*a;console.log(`\ud83c\udfaf \u0428\u0430\u043d\u0441 \u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0443\u0434\u0430\u0440\u0430: ${i}% \xd7 ${a} = ${o}%`);const c=100*Math.random()<o;if(c){const t=1+(e.stats.criticalDamage||50)/100,r=Math.floor(n*t);return console.log(`\ud83d\udca5 \u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0434\u0430\u0440! ${n} \xd7 ${t} = ${r}`),{damage:r,isCritical:c,weatherModifier:l,damageBonus:s}}return{damage:n,isCritical:!1,weatherModifier:l,damageBonus:s}}const c="physical"===i?e.stats.physicalAttack||10:e.stats.magicalAttack||10;console.log("\ud83d\udd04 \u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0439 \u0440\u0430\u0441\u0447\u0435\u0442 \u0434\u043b\u044f \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0430\u0442\u0430\u043a\u0438:",c);let d="physical"===i?t.stats.physicalDefense:t.stats.spiritualDefense;if(t.effects&&t.effects.length>0){let e=0;t.effects.forEach((t=>{t.stats&&("physical"===i&&t.stats.physicalDefense?(e+=t.stats.physicalDefense,console.log(`\ud83d\udee1\ufe0f \u042d\u0444\u0444\u0435\u043a\u0442 "${t.name}" \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 ${t.stats.physicalDefense} \u043a \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0437\u0430\u0449\u0438\u0442\u0435`)):"spiritual"===i&&t.stats.spiritualDefense&&(e+=t.stats.spiritualDefense,console.log(`\ud83d\udee1\ufe0f \u042d\u0444\u0444\u0435\u043a\u0442 "${t.name}" \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 ${t.stats.spiritualDefense} \u043a \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u0437\u0430\u0449\u0438\u0442\u0435`)))})),e>0&&(console.log(`\ud83d\udee1\ufe0f \u0412\u0441\u0435\u0433\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e ${e} \u043a \u0437\u0430\u0449\u0438\u0442\u0435 \u043e\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432`),d+=e)}const u=d/(d+100);console.log(`\ud83d\udee1\ufe0f \u0418\u0442\u043e\u0433\u043e\u0432\u0430\u044f \u0437\u0430\u0449\u0438\u0442\u0430: ${d}, \u043a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u0441\u043d\u0438\u0436\u0435\u043d\u0438\u044f \u0443\u0440\u043e\u043d\u0430: ${u.toFixed(2)} (${Math.floor(100*u)}%)`);const p=(1+s)*l,h=Math.max(1,Math.floor(c*(1-u)*p));console.log(`\ud83e\uddee \u0418\u0442\u043e\u0433\u043e\u0432\u044b\u0439 \u043c\u043d\u043e\u0436\u0438\u0442\u0435\u043b\u044c \u0443\u0440\u043e\u043d\u0430: ${p.toFixed(2)} (\u043f\u043e\u0433\u043e\u0434\u0430: ${l}, \u044d\u0444\u0444\u0435\u043a\u0442\u044b: ${(1+s).toFixed(2)})`),console.log(`\ud83e\uddee \u0424\u043e\u0440\u043c\u0443\u043b\u0430 \u0443\u0440\u043e\u043d\u0430: ${c} \xd7 ${(1-u).toFixed(2)} \xd7 ${p.toFixed(2)} = ${h}`);const{critChanceModifier:m}=L(),f=e.stats.criticalChance||5,y=f*m;console.log(`\ud83c\udfaf \u0428\u0430\u043d\u0441 \u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0443\u0434\u0430\u0440\u0430: ${f}% \xd7 ${m} = ${y}%`);const g=100*Math.random()<y;if(g){const t=1+(e.stats.criticalDamage||50)/100,r=Math.floor(h*t);return console.log(`\ud83d\udca5 \u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0434\u0430\u0440! ${h} \xd7 ${t} = ${r}`),{damage:r,isCritical:g,weatherModifier:l,damageBonus:s}}return{damage:h,isCritical:!1,weatherModifier:l,damageBonus:s}}),[P,L]),O=(0,n.useCallback)(((e,t)=>{"player"===e?v((e=>({...e,stats:{...e.stats,health:Math.max(0,e.stats.health-t)}}))):y((e=>({...e,stats:{...e.stats,health:Math.max(0,e.stats.health-t)}})))}),[]),q=(0,n.useCallback)((async e=>{console.log("\ud83d\udd0d handleAction \u0432\u044b\u0437\u0432\u0430\u043d \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c:",{action:e,actionType:e.type,actionTypeJSON:JSON.stringify(e.type),actionTypeIsString:"string"===typeof e.type,actionTypeConstructor:e.type?e.type.constructor.name:"undefined",actionHasTypeProp:"type"in e,actionName:e.name,actionID:e.id}),_(!0);const t=x?g:f,r=x?f:g,n=x?"player":"enemy",a=x?"enemy":"player",i=L().hitChanceModifier||1,o=(t.stats.accuracy||90)*i,s=r.stats.evasion||0,l=Math.min(95,Math.max(20,80+(o-s)/10)),c=100*Math.random();if(console.log(`\u0410\u0442\u0430\u043a\u0430 ${t.name}: \u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c ${o}, \u0423\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u0435 ${s}, \u0428\u0430\u043d\u0441 \u043f\u043e\u043f\u0430\u0434\u0430\u043d\u0438\u044f ${l.toFixed(1)}%, \u0411\u0440\u043e\u0441\u043e\u043a ${c.toFixed(1)}`),c>=l)return D(`${r.name} \u0443\u043a\u043b\u043e\u043d\u044f\u0435\u0442\u0441\u044f \u043e\u0442 \u0430\u0442\u0430\u043a\u0438 ${t.name}!`,"dodge"),M(a,{dodges:S[a].dodges+1}),void _(!1);let d=0,h=!1;switch(e.type){case"attack":{const e=t.stats.physicalAttack||10,n=$(t,r,e,"physical");d=n.damage,h=n.isCritical;break}case"technique":{if(console.log("\ud83d\uded1 \u0422\u0415\u0425\u041d\u0418\u041a\u0410: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f",{"\u0442\u0435\u0445\u043d\u0438\u043a\u0430\u0418\u043c\u044f":e.name,"\u0442\u0435\u0445\u043d\u0438\u043a\u0430ID":e.id,"\u0431\u0430\u0437\u043e\u0432\u044b\u0439\u0423\u0440\u043e\u043d":e.damage,"\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0439\u0423\u0440\u043e\u043d":e.calculatedDamage,"\u0437\u0430\u0442\u0440\u0430\u0442\u044b\u042d\u043d\u0435\u0440\u0433\u0438\u0438":e.energyCost,"\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430\u044f\u042d\u043d\u0435\u0440\u0433\u0438\u044f":t.stats.energy,"\u0430\u0442\u0430\u043a\u0443\u044e\u0449\u0438\u0439":{"\u0438\u043c\u044f":t.name,"\u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435":t.stats.health,"\u043c\u0430\u043a\u0441\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435":t.stats.maxHealth,"\u044d\u043d\u0435\u0440\u0433\u0438\u044f":t.stats.energy,"\u043c\u0430\u043a\u0441\u042d\u043d\u0435\u0440\u0433\u0438\u044f":t.stats.maxEnergy}}),x&&(t.stats.energy=t.stats.maxEnergy||100,console.log("\u26a1 \u0418\u0421\u041f\u0420\u0410\u0412\u041b\u0415\u041d\u0418\u0415: \u042d\u043d\u0435\u0440\u0433\u0438\u044f \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0430 \u043d\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c:",t.stats.energy)),t.stats.energy<e.energyCost)return console.log("\u274c \u041e\u0428\u0418\u0411\u041a\u0410: \u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0438",{"\u044d\u043d\u0435\u0440\u0433\u0438\u044f":t.stats.energy,"\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f":e.energyCost}),D(`\u0423 ${t.name} \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f ${e.name}!`,"system"),void _(!1);console.log("\u2705 \u0422\u0415\u0425\u041d\u0418\u041a\u0410: \u0414\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f",{"\u044d\u043d\u0435\u0440\u0433\u0438\u044f":t.stats.energy,"\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f":e.energyCost}),console.log("\ud83e\uddee \u0420\u0410\u0421\u0427\u0415\u0422: \u041d\u0430\u0447\u0430\u043b\u043e \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u0443\u0440\u043e\u043d\u0430 \u0434\u043b\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0438",{"\u0431\u0430\u0437\u043e\u0432\u044b\u0439\u0423\u0440\u043e\u043d":e.damage,"\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0439\u0423\u0440\u043e\u043d":e.calculatedDamage,"\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0439\u0423\u0440\u043e\u043d":e.calculatedDamage||e.damage,"\u0442\u0438\u043f\u0423\u0440\u043e\u043d\u0430":e.damageType});const a={...t,isTechniqueDamage:!0},i=$(a,r,e.calculatedDamage||e.damage,e.damageType);console.log("\ud83d\udcca \u0420\u0415\u0417\u0423\u041b\u042c\u0422\u0410\u0422: \u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0439 \u0443\u0440\u043e\u043d",{"\u0438\u0442\u043e\u0433\u043e\u0432\u044b\u0439\u0423\u0440\u043e\u043d":i.damage,"\u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439":i.isCritical}),d=i.damage,h=i.isCritical,"player"===n?v((t=>({...t,stats:{...t.stats,energy:t.stats.energy-e.energyCost}}))):y((t=>({...t,stats:{...t.stats,energy:t.stats.energy-e.energyCost}}))),M(n,{techniquesUsed:S[n].techniquesUsed+1}),e.effects&&e.effects.forEach((e=>{"enemy"===e.target?y((t=>({...t,effects:[...t.effects,e]}))):v((t=>({...t,effects:[...t.effects,e]}))),D(`${e.name} \u043f\u0440\u0438\u043c\u0435\u043d\u0451\u043d \u043a ${"enemy"===e.target?r.name:t.name}!`,"effect")}));break}case"petAbility":{const n=u.player.spiritPets.pets.find((e=>e.id===u.player.spiritPets.activePetId));if(!n)return D("\u041e\u0448\u0438\u0431\u043a\u0430: \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u043f\u0438\u0442\u043e\u043c\u0435\u0446 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d!","system"),void _(!1);if(n.loyalty<=25)return D(`\u041f\u0438\u0442\u043e\u043c\u0435\u0446 ${n.name} \u043e\u0442\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u043c\u043e\u0433\u0430\u0442\u044c \u0438 \u0443\u0431\u0435\u0433\u0430\u0435\u0442 \u0441 \u043f\u043e\u043b\u044f \u0431\u043e\u044f!`,"system"),p.removeFleePet(n.id),_(!1),void b(!1);if(n.hunger<20)return D(`\u041f\u0438\u0442\u043e\u043c\u0446\u0443 ${n.name} \u043d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u0441\u044b\u0442\u043e\u0441\u0442\u0438 (${n.hunger}%) \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438!`,"system"),void _(!1);const a=Math.floor((1.5*n.strength+.5*n.intelligence)*(e.damageMultiplier||1)),i=t.stats.physicalAttack||0,o={...t,isTechniqueDamage:!0},s=$(o,r,e.calculatedDamage||a+i,e.damageType||"physical");d=s.damage,h=s.isCritical,console.log(`\ud83d\udc3e \u041f\u0438\u0442\u043e\u043c\u0435\u0446 \u0434\u043e \u0430\u0442\u0430\u043a\u0438: ${n.name}, \u0441\u044b\u0442\u043e\u0441\u0442\u044c ${n.hunger}%, \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c ${n.loyalty}%`),console.log("\u041f\u0418\u0422\u041e\u041c\u0415\u0426 \u0418\u0421\u041f\u041e\u041b\u042c\u0417\u0423\u0415\u0422 \u0421\u041f\u041e\u0421\u041e\u0411\u041d\u041e\u0421\u0422\u042c - \u041d\u0410\u0427\u0410\u041b\u041e \u0418\u0421\u041f\u041e\u041b\u042c\u0417\u041e\u0412\u0410\u041d\u0418\u042f"),console.log(`ID \u043f\u0438\u0442\u043e\u043c\u0446\u0430: ${n.id}, ID \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438: ${e.id}`),console.log(`\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0434\u043e: \u0441\u044b\u0442\u043e\u0441\u0442\u044c ${n.hunger}%, \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c ${n.loyalty}%`);const l=n.hunger,c=n.loyalty,m=20,f=Math.round(100/Math.max(n.hunger,1)*5);console.log(`\u0420\u0410\u0421\u0427\u0415\u0422 \u0412 \u041a\u041e\u041c\u041f\u041e\u041d\u0415\u041d\u0422\u0415: \u041f\u0438\u0442\u043e\u043c\u0435\u0446 \u0442\u0435\u0440\u044f\u0435\u0442 ${f}% \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 (\u0441\u044b\u0442\u043e\u0441\u0442\u044c: ${n.hunger}%)`),console.log(`\u0424\u041e\u0420\u041c\u0423\u041b\u0410 \u0412 \u041a\u041e\u041c\u041f\u041e\u041d\u0415\u041d\u0422\u0415: 5 * (100 / ${n.hunger}) = ${f}`),p.usePetAbility({petId:n.id,abilityId:e.id});const g=Math.max(0,l-m),w=Math.max(0,c-f);console.log(`\u041b\u041e\u041a\u0410\u041b\u042c\u041d\u042b\u0419 \u0420\u0410\u0421\u0427\u0415\u0422: \u041f\u0438\u0442\u043e\u043c\u0435\u0446 ${n.name}: \u0441\u044b\u0442\u043e\u0441\u0442\u044c ${g}%, \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c ${w}%`),D(`\u041f\u0438\u0442\u043e\u043c\u0435\u0446 ${n.name}: \u0441\u044b\u0442\u043e\u0441\u0442\u044c \u0441\u043d\u0438\u0437\u0438\u043b\u0430\u0441\u044c \u0441 ${l}% \u0434\u043e ${g}%, \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u043d\u0438\u0437\u0438\u043b\u0430\u0441\u044c \u0441 ${c}% \u0434\u043e ${w}%`,"info"),x&&v((e=>{const t={...n,hunger:g,loyalty:w};u.player.spiritPets.pets.map((e=>e.id===n.id?t:e));return setTimeout((()=>{p.updateSpiritPet({id:n.id,updates:{hunger:g,loyalty:w,lastUsedAbility:new Date}})}),0),e}));const E=u.player.spiritPets.pets.find((e=>e.id===n.id)),T={fire:"\u043e\u0433\u043d\u0435\u043d\u043d\u043e\u0433\u043e",water:"\u0432\u043e\u0434\u043d\u043e\u0433\u043e",earth:"\u0437\u0435\u043c\u043b\u044f\u043d\u043e\u0433\u043e",wind:"\u0432\u0435\u0442\u0440\u044f\u043d\u043e\u0433\u043e",lightning:"\u043c\u043e\u043b\u043d\u0438\u0435\u0432\u043e\u0433\u043e",wood:"\u0434\u0440\u0435\u0432\u0435\u0441\u043d\u043e\u0433\u043e",metal:"\u043c\u0435\u0442\u0430\u043b\u043b\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e",darkness:"\u0442\u0435\u043d\u0435\u0432\u043e\u0433\u043e",light:"\u0441\u0432\u0435\u0442\u043b\u043e\u0433\u043e"}[n.type]||"";D(`${t.name} \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 ${e.name} ${T} \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u0438 \u043d\u0430\u043d\u043e\u0441\u0438\u0442 ${d} \u0443\u0440\u043e\u043d\u0430 ${r.name}${h?" (\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0434\u0430\u0440!)":""}`,h?"critical":"damage"),E&&D(`\u041f\u0438\u0442\u043e\u043c\u0435\u0446 ${E.name}: \u0441\u044b\u0442\u043e\u0441\u0442\u044c ${E.hunger}%, \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c ${E.loyalty}%`,"info"),e.effects&&e.effects.forEach((e=>{"enemy"===e.target?(y((t=>({...t,effects:[...t.effects,e]}))),D(`${e.name} \u043f\u0440\u0438\u043c\u0435\u043d\u0451\u043d \u043a ${r.name}!`,"effect")):(v((t=>({...t,effects:[...t.effects,e]}))),D(`${e.name} \u043f\u0440\u0438\u043c\u0435\u043d\u0451\u043d \u043a ${t.name}!`,"effect"))}));break}case"defend":{const e={type:"protect",name:"\u0417\u0430\u0449\u0438\u0442\u043d\u0430\u044f \u0441\u0442\u043e\u0439\u043a\u0430",duration:2,stats:{physicalDefense:Math.floor(.75*t.stats.physicalDefense),spiritualDefense:Math.floor(.75*t.stats.spiritualDefense)}};"player"===n?v((t=>({...t,effects:[...t.effects,e]}))):y((t=>({...t,effects:[...t.effects,e]}))),D(`${t.name} \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0437\u0430\u0449\u0438\u0442\u043d\u0443\u044e \u0441\u0442\u043e\u0439\u043a\u0443!`,"buff");break}case"flee":if(100*Math.random()<30)return D(`${t.name} \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u0431\u0435\u0433\u0430\u0435\u0442 \u0441 \u043f\u043e\u043b\u044f \u0431\u043e\u044f!`,"system"),void U(!1);D(`${t.name} \u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u0441\u0431\u0435\u0436\u0430\u0442\u044c, \u043d\u043e \u0431\u0435\u0437\u0443\u0441\u043f\u0435\u0448\u043d\u043e!`,"system");break}if(d>0){if(O(a,d),D(`${t.name} \u043d\u0430\u043d\u043e\u0441\u0438\u0442 ${d} \u0443\u0440\u043e\u043d\u0430 ${r.name}${h?" (\u041a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0443\u0434\u0430\u0440!)":""}`,h?"critical":"damage"),M(n,{damageDealt:S[n].damageDealt+d,criticalHits:S[n].criticalHits+(h?1:0)}),"enemy"===a&&f.stats.health<=0)return void U(!0);if("player"===a&&g.stats.health<=0)return void U(!1)}v((e=>({...e,effects:e.effects.map((e=>({...e,duration:e.duration-1}))).filter((e=>e.duration>0))}))),y((e=>({...e,effects:e.effects.map((e=>({...e,duration:e.duration-1}))).filter((e=>e.duration>0))}))),_(!1),b(!x)}),[x,g,f,S,$,O,D,M]),U=(0,n.useCallback)((e=>{I(!0);const t=Math.floor((Date.now()-C)/1e3),r=Date.now(),n={victory:e,enemy:{id:f.id,name:f.name,level:f.level||1,type:f.type||"unknown"},combatStats:{...S},duration:t,timestamp:r,location:u.world.currentLocation};if(console.log("\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435 \u0431\u043e\u044f, \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430:",n),p.updateCombatState({inCombat:!1,enemyCombatState:null,playerCombatState:null,isPlayerTurn:!0,log:[],combatStats:{player:{damageDealt:0,techniquesUsed:0,criticalHits:0,dodges:0},enemy:{damageDealt:0,techniquesUsed:0,criticalHits:0,dodges:0}},startTime:null,lastCombatResult:n}),p.addCombatHistory?(console.log("\ud83d\udcc8 \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0431\u043e\u044f \u0432 \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0438\u0433\u0440\u043e\u043a\u0430"),p.addCombatHistory(n)):console.error("\u274c \u041c\u0435\u0442\u043e\u0434 addCombatHistory \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d, \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0431\u043e\u044f \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u0438\u0441\u0442\u043e\u0440\u0438\u044e"),e){var a;const e=Math.floor(f.experience*(1+.2*Math.random()));let r=Math.floor(f.currency.min+Math.random()*(f.currency.max-f.currency.min));const n=Math.floor(r/1e4);r%=1e4;const i=Math.floor(r/100);r%=100;const o={gold:n,silver:i,copper:r};Object.keys(o).forEach((e=>{0===o[e]&&delete o[e]})),0===Object.keys(o).length&&(o.copper=1),console.log("\u041d\u0430\u0433\u0440\u0430\u0434\u0430 \u0432\u0430\u043b\u044e\u0442\u043e\u0439 \u0437\u0430 \u0431\u043e\u0439:",o);const s=(null===(a=R.exploration)||void 0===a?void 0:a.resourceQualityModifier)||1,l=f.loot.filter((e=>100*Math.random()<e.chance*s)).map((e=>({...e,quantity:1})));N({victory:!0,playerStats:S.player,enemyStats:S.enemy,duration:t,rewards:{experience:e,currency:o,items:l}}),p.addExperience&&p.addExperience(e),console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u0430\u0433\u0440\u0430\u0434\u044b \u0432 \u0432\u0438\u0434\u0435 \u0432\u0430\u043b\u044e\u0442\u044b \u043f\u043e\u0441\u043b\u0435 \u0431\u043e\u044f:",o),p.updateCurrency?p.updateCurrency(o,!0):(console.error("\u0424\u0443\u043d\u043a\u0446\u0438\u044f updateCurrency \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c dispatch \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e"),p.dispatch({type:ACTION_TYPES.UPDATE_CURRENCY,payload:o,isAdditive:!0})),l.forEach((e=>{p.addItem&&p.addItem(e)}))}else N({victory:!1,playerStats:S.player,enemyStats:S.enemy,duration:t})}),[f,S,C,p]);(0,n.useEffect)((()=>{if(!x&&!w&&!k){var e;if(console.log("\u0425\u043e\u0434 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430: \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f...",{enemy:f?"enemy exists":"enemy is null",enemyAttacks:null!==f&&void 0!==f&&f.attacks?`${f.attacks.length} attacks found`:"no attacks",enemyStats:null!==f&&void 0!==f&&f.stats?"stats exist":"no stats",enemyEnergy:null===f||void 0===f||null===(e=f.stats)||void 0===e?void 0:e.energy}),!f||!f.stats||"number"!==typeof f.stats.energy)return console.warn("\u26a0\ufe0f \u041f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u0430\u0442\u0430\u043a\u0443"),void setTimeout((()=>{q({type:"attack"})}),500);const t=setTimeout((()=>{if(!f.attacks||!Array.isArray(f.attacks)||0===f.attacks.length)return console.warn("\u26a0\ufe0f \u0423 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430 \u043d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0430\u0442\u0430\u043a, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u0430\u0442\u0430\u043a\u0443"),void q({type:"attack"});console.log("\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0430\u0442\u0430\u043a \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430:",{"\u0432\u0441\u0435\u0433\u043e\u0410\u0442\u0430\u043a":f.attacks.length,"\u044d\u043d\u0435\u0440\u0433\u0438\u044f\u041f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430":f.stats.energy});try{const e=f.attacks.filter((e=>"number"!==typeof e.energyCost?(console.warn(`\u0410\u0442\u0430\u043a\u0430 "${e.name}" \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f energyCost:`,e.energyCost),!1):e.energyCost<=f.stats.energy));if(console.log(`\u041d\u0430\u0439\u0434\u0435\u043d\u043e ${e.length} \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0434\u043b\u044f \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430`),e.length>0){const t=100*Math.random();let r=0;const n=e.find((e=>{const n="number"===typeof e.chance?e.chance:50;return r+=n,t<r}))||e[0];console.log("\u041f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a \u0432\u044b\u0431\u0440\u0430\u043b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435:",n.name),q({type:"technique",...n})}else console.log("\u0423 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430 \u043d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u044d\u043d\u0435\u0440\u0433\u0438\u0438, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u0430\u0442\u0430\u043a\u0443"),q({type:"attack"})}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0445\u043e\u0434\u0430 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430:",e),q({type:"attack"})}}),300);return()=>clearTimeout(t)}}),[x,w,k,null===f||void 0===f?void 0:f.id,null===f||void 0===f||null===(s=f.stats)||void 0===s?void 0:s.energy,q]);const F=f.stats.physicalDefense,z=F/(F+100),B=Math.max(1,Math.floor(g.stats.physicalAttack*(1-z))),G=[{...cl,calculatedDamage:B},...u.player.techniques.map((e=>{const t=("physical"===e.damageType?g.stats.physicalAttack:g.stats.magicalAttack)+e.damage,r=f.stats.physicalDefense,n=r/(r+100),a=Math.max(1,Math.floor(t*(1-n)));return{...e,type:"technique",calculatedDamage:a}})),{type:"defend",name:"\u0417\u0430\u0449\u0438\u0442\u0430",description:"\u0423\u0432\u0435\u043b\u0438\u0447\u0438\u0432\u0430\u0435\u0442 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u0443\u044e \u0437\u0430\u0449\u0438\u0442\u0443 \u043d\u0430 75% \u043d\u0430 2 \u0445\u043e\u0434\u0430",icon:"\ud83d\udee1\ufe0f"},{type:"flee",name:"\u041f\u043e\u0431\u0435\u0433",description:"30% \u0448\u0430\u043d\u0441 \u0441\u0431\u0435\u0436\u0430\u0442\u044c \u0438\u0437 \u0431\u043e\u044f",icon:"\ud83c\udfc3"}];if(h){const e=h.abilities.map((e=>{var t;const r=null===(t=dl.petTypeAbilities[h.type])||void 0===t?void 0:t.find((t=>t.id===e)),n={fire:"\u041e\u0433\u043d\u0435\u043d\u043d\u044b\u0439",water:"\u0412\u043e\u0434\u043d\u044b\u0439",earth:"\u0417\u0435\u043c\u043b\u044f\u043d\u043e\u0439",wind:"\u0412\u0435\u0442\u0440\u044f\u043d\u043e\u0439",lightning:"\u041c\u043e\u043b\u043d\u0438\u0435\u0432\u044b\u0439",wood:"\u0414\u0440\u0435\u0432\u0435\u0441\u043d\u044b\u0439",metal:"\u041c\u0435\u0442\u0430\u043b\u043b\u0438\u0447\u0435\u0441\u043a\u0438\u0439",darkness:"\u0422\u0435\u043d\u0435\u0432\u043e\u0439",light:"\u0421\u0432\u0435\u0442\u043b\u044b\u0439"},a={fire_breath:"\u041e\u0433\u043d\u0435\u043d\u043d\u043e\u0435 \u0434\u044b\u0445\u0430\u043d\u0438\u0435",heat_aura:"\u0410\u0443\u0440\u0430 \u0436\u0430\u0440\u0430",meteor_strike:"\u041c\u0435\u0442\u0435\u043e\u0440\u0438\u0442\u043d\u044b\u0439 \u0443\u0434\u0430\u0440",water_splash:"\u0412\u043e\u0434\u044f\u043d\u043e\u0439 \u0432\u0441\u043f\u043b\u0435\u0441\u043a",healing_rain:"\u0418\u0441\u0446\u0435\u043b\u044f\u044e\u0449\u0438\u0439 \u0434\u043e\u0436\u0434\u044c",tidal_wave:"\u041f\u0440\u0438\u043b\u0438\u0432\u043d\u0430\u044f \u0432\u043e\u043b\u043d\u0430",stone_armor:"\u041a\u0430\u043c\u0435\u043d\u043d\u0430\u044f \u0431\u0440\u043e\u043d\u044f",earth_spike:"\u0417\u0435\u043c\u043b\u044f\u043d\u043e\u0439 \u0448\u0438\u043f",earthquake:"\u0417\u0435\u043c\u043b\u0435\u0442\u0440\u044f\u0441\u0435\u043d\u0438\u0435",swift_winds:"\u0411\u044b\u0441\u0442\u0440\u044b\u0435 \u0432\u0435\u0442\u0440\u0430",wind_slash:"\u0412\u0435\u0442\u0440\u044f\u043d\u043e\u0439 \u0440\u0430\u0437\u0440\u0435\u0437",cyclone:"\u0426\u0438\u043a\u043b\u043e\u043d",wind_breath:"\u0412\u0435\u0442\u0440\u044f\u043d\u043e\u0435 \u0434\u044b\u0445\u0430\u043d\u0438\u0435"};if(r){const e=Math.floor((1.5*h.strength+.5*h.intelligence)*(r.damageMultiplier||1))+(g.stats.physicalAttack||0);return{...r,type:"petAbility",petId:h.id,name:a[r.id]||r.name||`\u0421\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430 (${r.id})`,description:r.description||`${n[h.type]||""} \u043f\u0438\u0442\u043e\u043c\u0435\u0446 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043e\u0441\u043e\u0431\u0443\u044e \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c, \u043d\u0430\u043d\u043e\u0441\u044f\u0449\u0443\u044e ${e} \u0443\u0440\u043e\u043d\u0430.`,damage:e,calculatedDamage:e,hungerCost:20,disabled:h.hunger<20,icon:"fire"===r.element?"\ud83d\udd25":"water"===r.element?"\ud83d\udca7":"earth"===r.element?"\ud83c\udf0b":"wind"===r.element?"\ud83c\udf2a\ufe0f":"\u26a1"}}const i=a[e]||`\u0421\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430 (${e})`;return console.warn(`\u0421\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c ${e} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u0434\u043b\u044f \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u0442\u0438\u043f\u0430 ${h.type}`),{type:"petAbility",petId:h.id,id:e,name:i,description:`${n[h.type]||""} \u043f\u0438\u0442\u043e\u043c\u0435\u0446 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 \u043e\u0441\u043e\u0431\u0443\u044e \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c.`,damage:g.stats.physicalAttack+Math.floor(1.5*h.strength),calculatedDamage:g.stats.physicalAttack+Math.floor(1.5*h.strength),damageType:"physical",hungerCost:20,disabled:h.hunger<20,icon:"\ud83d\udc3e"}})).map((e=>({...e,disabled:h.hunger<20,className:h.hunger<20?"pet-ability-disabled":""})));G.push(...e)}return k?(0,Cn.jsx)(sl,{results:A,onClose:()=>c(A)}):(console.log("CombatManager \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442 \u0432 CombatInterface:",{player:g?"player OK":"player is "+typeof g,playerType:typeof g,enemy:f?"enemy OK":"enemy is "+typeof f,enemyType:typeof f,playerActions:Array.isArray(G)?`${G.length} actions`:typeof G}),g&&"object"===typeof g?f&&"object"===typeof f?g.stats&&f.stats?(0,Cn.jsx)(Qs,{player:g,enemy:f,playerActions:G,onActionSelect:q,isPlayerTurn:x,disabled:w,combatLog:E}):(console.error("CombatManager: \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 stats \u0443 player \u0438\u043b\u0438 enemy",{playerStats:g.stats,enemyStats:f.stats}),(0,Cn.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430: \u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442"})):(console.error("CombatManager: enemy \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d \u0438\u043b\u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c",f),(0,Cn.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430: \u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442"})):(console.error("CombatManager: player \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d \u0438\u043b\u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u043c",g),(0,Cn.jsx)("div",{children:"\u041e\u0448\u0438\u0431\u043a\u0430: \u0414\u0430\u043d\u043d\u044b\u0435 \u0438\u0433\u0440\u043e\u043a\u0430 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442"})))},{unifiedDatabase:pl,initializeDatabaseConnection:hl}=r(8153),{Sequelize:ml}=r(8568);let fl;async function yl(){if(!fl){const{db:e}=await hl();fl=e}return fl}async function gl(){try{const e=await yl(),t=await pl.query("SELECT time_of_day, category, modifier FROM enemy_time_modifiers",{type:e.QueryTypes.SELECT}),r={};return t.forEach((e=>{r[e.time_of_day]||(r[e.time_of_day]={}),r[e.time_of_day][e.category]=parseFloat(e.modifier)})),r}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u043e\u0432 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0441\u0443\u0442\u043e\u043a:",e),{"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":{spirit_beast:1.2,bandit:.8,undead:.5,elemental:1.1},"\u0443\u0442\u0440\u043e":{spirit_beast:1.1,bandit:1,undead:.3,elemental:1},"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":{spirit_beast:1,bandit:1.2,undead:.2,elemental:.9},"\u0434\u0435\u043d\u044c":{spirit_beast:1,bandit:1.2,undead:.1,elemental:.8},"\u0432\u0435\u0447\u0435\u0440":{spirit_beast:1.1,bandit:1,undead:.7,elemental:1},"\u043d\u043e\u0447\u044c":{spirit_beast:.8,bandit:.6,undead:1.5,elemental:1.2}}}}let vl={"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":{spirit_beast:1.2,bandit:.8,undead:.5,elemental:1.1},"\u0443\u0442\u0440\u043e":{spirit_beast:1.1,bandit:1,undead:.3,elemental:1},"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":{spirit_beast:1,bandit:1.2,undead:.2,elemental:.9},"\u0434\u0435\u043d\u044c":{spirit_beast:1,bandit:1.2,undead:.1,elemental:.8},"\u0432\u0435\u0447\u0435\u0440":{spirit_beast:1.1,bandit:1,undead:.7,elemental:1},"\u043d\u043e\u0447\u044c":{spirit_beast:.8,bandit:.6,undead:1.5,elemental:1.2}};async function xl(){try{const e=await yl(),t=await pl.query("SELECT weather_type, category, modifier FROM enemy_weather_modifiers",{type:e.QueryTypes.SELECT}),r={};return t.forEach((e=>{r[e.weather_type]||(r[e.weather_type]={}),r[e.weather_type][e.category]=parseFloat(e.modifier)})),r}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043c\u043e\u0434\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u043e\u0432 \u043f\u043e\u0433\u043e\u0434\u044b:",e),{"\u042f\u0441\u043d\u043e":{spirit_beast:1,bandit:1.1,undead:.9,elemental:1},"\u041e\u0431\u043b\u0430\u0447\u043d\u043e":{spirit_beast:1,bandit:1,undead:1,elemental:1},"\u0414\u043e\u0436\u0434\u044c":{spirit_beast:.8,bandit:.7,undead:1,elemental:1.2,water_elemental:1.5},"\u0413\u0440\u043e\u0437\u0430":{spirit_beast:.6,bandit:.5,undead:1.1,elemental:1.3,lightning_elemental:2},"\u0422\u0443\u043c\u0430\u043d":{spirit_beast:.9,bandit:1.1,undead:1.3,elemental:.8,ghost:1.6},"\u0421\u043d\u0435\u0433":{spirit_beast:.7,bandit:.6,undead:.9,elemental:1.1,ice_elemental:1.8}}}}let bl={"\u042f\u0441\u043d\u043e":{spirit_beast:1,bandit:1.1,undead:.9,elemental:1},"\u041e\u0431\u043b\u0430\u0447\u043d\u043e":{spirit_beast:1,bandit:1,undead:1,elemental:1},"\u0414\u043e\u0436\u0434\u044c":{spirit_beast:.8,bandit:.7,undead:1,elemental:1.2,water_elemental:1.5},"\u0413\u0440\u043e\u0437\u0430":{spirit_beast:.6,bandit:.5,undead:1.1,elemental:1.3,lightning_elemental:2},"\u0422\u0443\u043c\u0430\u043d":{spirit_beast:.9,bandit:1.1,undead:1.3,elemental:.8,ghost:1.6},"\u0421\u043d\u0435\u0433":{spirit_beast:.7,bandit:.6,undead:.9,elemental:1.1,ice_elemental:1.8}};async function wl(){try{const e=await yl(),t=await pl.query("SELECT * FROM enemies",{type:e.QueryTypes.SELECT}),r=await Promise.all(t.map((e=>async function(e){try{const t=await yl(),[r]=await pl.query("SELECT * FROM enemies WHERE id = :enemyId",{replacements:{enemyId:e},type:t.QueryTypes.SELECT});if(!r)throw new Error(`\u0412\u0440\u0430\u0433 \u0441 ID ${e} \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d`);const[n]=await pl.query("SELECT * FROM enemy_stats WHERE enemy_id = :enemyId",{replacements:{enemyId:e},type:t.QueryTypes.SELECT}),a=await pl.query("SELECT * FROM enemy_attacks WHERE enemy_id = :enemyId",{replacements:{enemyId:e},type:t.QueryTypes.SELECT}),i=await Promise.all(a.map((async e=>{const r=(await pl.query("SELECT * FROM enemy_attack_effects WHERE attack_id = :attackId",{replacements:{attackId:e.id},type:t.QueryTypes.SELECT})).map((e=>{const t={type:e.type,duration:e.duration};return e.stat_name&&e.stat_value&&(t.stats={[e.stat_name]:e.stat_value}),t}));return{name:e.name,damage:e.damage,type:e.type,chance:e.chance,...e.energy_cost>0?{energyCost:e.energy_cost}:{},...r.length>0?{effects:r}:{}}}))),o=(await pl.query("SELECT * FROM enemy_loot WHERE enemy_id = :enemyId",{replacements:{enemyId:e},type:t.QueryTypes.SELECT})).map((e=>({id:e.item_id,name:e.name,chance:e.chance,icon:e.icon}))),[s]=await pl.query("SELECT * FROM enemy_currency WHERE enemy_id = :enemyId",{replacements:{enemyId:e},type:t.QueryTypes.SELECT});return{id:r.id,name:r.name,icon:r.icon,description:r.description,level:r.level,category:r.category,stats:{health:n.health,energy:n.energy,physicalDefense:n.physical_defense,spiritualDefense:n.spiritual_defense,accuracy:n.accuracy,evasion:n.evasion},attacks:i,experience:r.experience,currency:{min:s.min_amount,max:s.max_amount},loot:o}}catch(t){return console.error(`\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432\u0440\u0430\u0433\u0430 ${e}:`,t),null}}(e.id))));return r.filter((e=>null!==e))}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0432\u0441\u0435\u0445 \u0432\u0440\u0430\u0433\u043e\u0432:",e),[]}}async function _l(){try{const e=await yl(),t=await pl.query("SELECT * FROM enemy_spawns",{type:e.QueryTypes.SELECT}),r={};return t.forEach((e=>{r[e.location_id]||(r[e.location_id]=[]);const t={id:e.enemy_id,minLevel:e.min_level,maxLevel:e.max_level,weight:e.weight};(e.time_of_day||e.weather_condition)&&(t.conditions={},e.time_of_day&&(t.conditions.timeOfDay=[e.time_of_day]),e.weather_condition&&(t.conditions.weather=[e.weather_condition])),r[e.location_id].push(t)})),r}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0442\u043e\u0447\u0435\u043a \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0440\u0430\u0433\u043e\u0432:",e),{starting_area:[{id:"training_dummy",minLevel:1,maxLevel:2,weight:70},{id:"weak_spirit_beast",minLevel:3,maxLevel:4,weight:30}],mountain_path:[{id:"weak_spirit_beast",minLevel:3,maxLevel:5,weight:40},{id:"mountain_bandit",minLevel:5,maxLevel:7,weight:60},{id:"night_wraith",minLevel:7,maxLevel:9,weight:20,conditions:{timeOfDay:["\u043d\u043e\u0447\u044c","\u0440\u0430\u0441\u0441\u0432\u0435\u0442"]}}],ancient_ruins:[{id:"mountain_bandit",minLevel:6,maxLevel:8,weight:30},{id:"ancient_guardian",minLevel:10,maxLevel:12,weight:70},{id:"night_wraith",minLevel:8,maxLevel:10,weight:50,conditions:{timeOfDay:["\u043d\u043e\u0447\u044c"]}}],forest_lake:[{id:"weak_spirit_beast",minLevel:4,maxLevel:6,weight:60},{id:"water_elemental",minLevel:6,maxLevel:8,weight:40,conditions:{weather:["\u0414\u043e\u0436\u0434\u044c","\u0413\u0440\u043e\u0437\u0430"]}}],thunder_peak:[{id:"weak_spirit_beast",minLevel:5,maxLevel:7,weight:30},{id:"mountain_bandit",minLevel:7,maxLevel:9,weight:40},{id:"lightning_spirit",minLevel:8,maxLevel:10,weight:30,conditions:{weather:["\u0413\u0440\u043e\u0437\u0430"]}}]}}}let El=[],Tl={starting_area:[{id:"training_dummy",minLevel:1,maxLevel:2,weight:70},{id:"weak_spirit_beast",minLevel:3,maxLevel:4,weight:30}],mountain_path:[{id:"weak_spirit_beast",minLevel:3,maxLevel:5,weight:40},{id:"mountain_bandit",minLevel:5,maxLevel:7,weight:60},{id:"night_wraith",minLevel:7,maxLevel:9,weight:20,conditions:{timeOfDay:["\u043d\u043e\u0447\u044c","\u0440\u0430\u0441\u0441\u0432\u0435\u0442"]}}],ancient_ruins:[{id:"mountain_bandit",minLevel:6,maxLevel:8,weight:30},{id:"ancient_guardian",minLevel:10,maxLevel:12,weight:70},{id:"night_wraith",minLevel:8,maxLevel:10,weight:50,conditions:{timeOfDay:["\u043d\u043e\u0447\u044c"]}}],forest_lake:[{id:"weak_spirit_beast",minLevel:4,maxLevel:6,weight:60},{id:"water_elemental",minLevel:6,maxLevel:8,weight:40,conditions:{weather:["\u0414\u043e\u0436\u0434\u044c","\u0413\u0440\u043e\u0437\u0430"]}}],thunder_peak:[{id:"weak_spirit_beast",minLevel:5,maxLevel:7,weight:30},{id:"mountain_bandit",minLevel:7,maxLevel:9,weight:40},{id:"lightning_spirit",minLevel:8,maxLevel:10,weight:30,conditions:{weather:["\u0413\u0440\u043e\u0437\u0430"]}}]};(async function(){try{vl=await gl(),bl=await xl(),El=await wl(),Tl=await _l(),console.log("\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u0432\u0440\u0430\u0433\u0430\u0445 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b \u0438\u0437 \u0411\u0414")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u0432\u0440\u0430\u0433\u0430\u0445:",e)}})().catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u0432\u0440\u0430\u0433\u0430\u0445:",e)}));const Sl=nr.div`
  position: relative;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
`,jl=nr.div`
  width: 100%;
  height: 100%;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
`,Cl=nr.div`
  background: rgba(30, 30, 30, 0.95);
  border-radius: 8px;
  padding: 10px 15px;
  margin-bottom: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-left: 3px solid #d4af37;
`,kl=nr.div`
  display: flex;
  align-items: center;
  gap: 15px;
`,Il=nr.div`
  font-size: 1.8rem;
`,Al=nr.div`
  display: flex;
  flex-direction: column;
`,Nl=nr.div`
  color: #d4af37;
  font-size: 1.1rem;
`,Dl=nr.div`
  color: #aaa;
  font-size: 0.9rem;
`,Ml=nr.div`
  color: #aaa;
  font-size: 0.8rem;
  max-width: 50%;
  
  span {
    color: ${e=>e.positive?"#a3be8c":"#bf616a"};
  }
`,Rl=e=>{switch(e){case"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":return"\ud83c\udf05";case"\u0443\u0442\u0440\u043e":return"\ud83c\udf04";case"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":return"\u2600\ufe0f";case"\u0434\u0435\u043d\u044c":return"\ud83c\udf1e";case"\u0432\u0435\u0447\u0435\u0440":return"\ud83c\udf07";case"\u043d\u043e\u0447\u044c":return"\ud83c\udf19";default:return"\u23f0"}},Pl=e=>{switch(e){case"\u042f\u0441\u043d\u043e":return"\u2600\ufe0f";case"\u041e\u0431\u043b\u0430\u0447\u043d\u043e":return"\u2601\ufe0f";case"\u0414\u043e\u0436\u0434\u044c":return"\ud83c\udf27\ufe0f";case"\u0413\u0440\u043e\u0437\u0430":return"\u26c8\ufe0f";case"\u0422\u0443\u043c\u0430\u043d":return"\ud83c\udf2b\ufe0f";case"\u0421\u043d\u0435\u0433":return"\u2744\ufe0f";default:return"\ud83c\udf08"}},Ll=nr.div`
  background: rgba(30, 30, 30, 0.95);
  border-radius: 8px;
  padding: 20px;
`,$l=nr.h2`
  color: #d4af37;
  margin: 0 0 10px 0;
`,Ol=nr.p`
  color: #aaa;
  margin: 0;
  line-height: 1.6;
`,ql=nr.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 15px;
`,Ul=nr.div`
  background: rgba(30, 30, 30, 0.95);
  border-radius: 8px;
  padding: 15px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid transparent;
  
  ${e=>e.available&&"\n    &:hover {\n      border-color: #d4af37;\n      transform: translateY(-2px);\n    }\n  "}
  
  ${e=>!e.available&&"\n    opacity: 0.7;\n    cursor: not-allowed;\n  "}
`,Fl=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
`,zl=nr.div`
  font-size: 2rem;
`,Bl=nr.div`
  flex: 1;
`,Gl=nr.h3`
  color: #d4af37;
  margin: 0;
  font-size: 1.1rem;
`,Wl=nr.div`
  color: ${e=>e.available?"#aaa":"#f44336"};
  font-size: 0.9rem;
`,Hl=nr.p`
  color: #aaa;
  margin: 0 0 10px 0;
  font-size: 0.9rem;
`,Vl=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 5px;
  font-size: 0.8rem;
  color: #aaa;
`,Ql=nr.div`
  display: flex;
  justify-content: space-between;
`,Yl=nr.div`
  margin-top: 10px;
  padding-top: 10px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
`,Kl=nr.div`
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 0.8rem;
  color: #aaa;
  
  span {
    color: #d4af37;
  }
`;const Xl=function(e){var t,r,a,i,o,s,l;let{areaId:c}=e;const{state:d,actions:u}=Nn(),[p,h]=(0,n.useState)(null),m={weatherType:"\u042f\u0441\u043d\u043e",timeOfDay:"\u0434\u0435\u043d\u044c",weatherIntensity:5,weatherEffects:{combat:{damageModifiers:{},hitChanceModifier:1,dodgeChanceModifier:1,critChanceModifier:1,enemySpawnRateModifier:1}}},f={...m,...d.weather||{},weatherEffects:{...m.weatherEffects,...(null===(t=d.weather)||void 0===t?void 0:t.weatherEffects)||{},combat:{...m.weatherEffects.combat,...(null===(r=d.weather)||void 0===r||null===(a=r.weatherEffects)||void 0===a?void 0:a.combat)||{}}}},y=e=>{var t,r;const n=El.find((t=>t.id===e.id));if(!n)return null;const a=`${c}_${e.id}`,i=null===(t=d.world)||void 0===t||null===(r=t.generatedEnemies)||void 0===r?void 0:r[a];if(i)return console.log(`\ud83c\udfae \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430: ${a}`,{level:i.level,requiredLevel:i.requiredLevel}),i;const o=(e=>Math.floor(e.minLevel+Math.random()*(e.maxLevel-e.minLevel+1)))(e),s=1+.1*(o-n.level),l={...n,level:o,requiredLevel:e.minLevel,stats:{...n.stats,health:Math.floor(n.stats.health*s),energy:Math.floor(n.stats.energy*s),physicalDefense:Math.floor(n.stats.physicalDefense*s),spiritualDefense:Math.floor(n.stats.spiritualDefense*s)},attacks:n.attacks.map((e=>({...e,damage:Math.floor(e.damage*s)}))),experience:Math.floor(n.experience*s),currency:{min:Math.floor(n.currency.min*s),max:Math.floor(n.currency.max*s)}};return u.cacheGeneratedEnemy(c,e.id,l),console.log(`\ud83c\udfae \u0421\u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u043d \u0438 \u043a\u044d\u0448\u0438\u0440\u043e\u0432\u0430\u043d \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a: ${a}`,{level:l.level,requiredLevel:l.requiredLevel}),l},g=async function(e,t,r){try{const n=(await _l())[e];if(!n)return[];const a=await wl(),i=await gl(),o=await xl();return n.filter((e=>{if(e.conditions){if(e.conditions.timeOfDay&&!e.conditions.timeOfDay.includes(t))return!1;if(e.conditions.weather&&!e.conditions.weather.includes(r))return!1}return!0})).map((e=>{const n={...e},s=a.find((t=>t.id===e.id));if(s&&s.category){var l,c;const a=((null===(l=i[t])||void 0===l?void 0:l[s.category])||1)*((null===(c=o[r])||void 0===c?void 0:c[s.category])||1);n.weight=Math.round(e.weight*a)}return n})).filter((e=>e.weight>0))}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043c\u043e\u0434\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0441\u043f\u0430\u0432\u043d\u043e\u0432 \u0432\u0440\u0430\u0433\u043e\u0432:",n);const a=Tl[e];return a?a.filter((e=>{if(e.conditions){if(e.conditions.timeOfDay&&!e.conditions.timeOfDay.includes(t))return!1;if(e.conditions.weather&&!e.conditions.weather.includes(r))return!1}return!0})).map((e=>{const n={...e},a=El.find((t=>t.id===e.id));if(a&&a.category){var i,o;const s=((null===(i=vl[t])||void 0===i?void 0:i[a.category])||1)*((null===(o=bl[r])||void 0===o?void 0:o[a.category])||1);n.weight=Math.round(e.weight*s)}return n})).filter((e=>e.weight>0)):[]}}(c,f.timeOfDay,f.weatherType).map((e=>({...y(e),available:d.player.cultivation.level>=e.minLevel})));return(0,Cn.jsx)(Sl,{children:p?(0,Cn.jsx)(ul,{enemy:p,onEnd:e=>{h(null)},weatherEffects:f.weatherEffects}):(0,Cn.jsxs)(jl,{children:[(0,Cn.jsxs)(Cl,{children:[(0,Cn.jsxs)(kl,{children:[(0,Cn.jsxs)(Il,{children:[Pl(f.weatherType),Rl(f.timeOfDay)]}),(0,Cn.jsxs)(Al,{children:[(0,Cn.jsx)(Nl,{children:f.weatherType}),(0,Cn.jsxs)(Dl,{children:[f.formattedTime||"12:00"," (",f.timeOfDay,")"]})]})]}),(0,Cn.jsxs)(Ml,{children:[void 0!==(null===(i=f.weatherEffects)||void 0===i||null===(o=i.combat)||void 0===o?void 0:o.hitChanceModifier)&&1!==f.weatherEffects.combat.hitChanceModifier&&(0,Cn.jsxs)("div",{children:["\u0428\u0430\u043d\u0441 \u043f\u043e\u043f\u0430\u0434\u0430\u043d\u0438\u044f:",(0,Cn.jsxs)("span",{positive:f.weatherEffects.combat.hitChanceModifier>1,children:[f.weatherEffects.combat.hitChanceModifier>1?" +":" -",Math.abs(Math.round(100*(f.weatherEffects.combat.hitChanceModifier-1))),"%"]})]}),void 0!==(null===(s=f.weatherEffects)||void 0===s||null===(l=s.combat)||void 0===l?void 0:l.critChanceModifier)&&1!==f.weatherEffects.combat.critChanceModifier&&(0,Cn.jsxs)("div",{children:["\u0428\u0430\u043d\u0441 \u043a\u0440\u0438\u0442\u0430:",(0,Cn.jsxs)("span",{positive:f.weatherEffects.combat.critChanceModifier>1,children:[f.weatherEffects.combat.critChanceModifier>1?" +":" -",Math.abs(Math.round(100*(f.weatherEffects.combat.critChanceModifier-1))),"%"]})]})]})]}),(0,Cn.jsxs)(Ll,{children:[(0,Cn.jsxs)($l,{children:["starting_area"===c&&"\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u0430\u044f \u043f\u043b\u043e\u0449\u0430\u0434\u043a\u0430","mountain_path"===c&&"\u0413\u043e\u0440\u043d\u0430\u044f \u0442\u0440\u043e\u043f\u0430","ancient_ruins"===c&&"\u0414\u0440\u0435\u0432\u043d\u0438\u0435 \u0440\u0443\u0438\u043d\u044b"]}),(0,Cn.jsxs)(Ol,{children:["starting_area"===c&&"\u0411\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0434\u043b\u044f \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0445 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432. \u0417\u0434\u0435\u0441\u044c \u043e\u0431\u0438\u0442\u0430\u044e\u0442 \u0441\u043b\u0430\u0431\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u0437\u0432\u0435\u0440\u0438, \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0435 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438.","mountain_path"===c&&"\u0418\u0437\u0432\u0438\u043b\u0438\u0441\u0442\u0430\u044f \u0442\u0440\u043e\u043f\u0430, \u0432\u0435\u0434\u0443\u0449\u0430\u044f \u0432 \u0433\u043e\u0440\u044b. \u0417\u0434\u0435\u0441\u044c \u043c\u043e\u0436\u043d\u043e \u0432\u0441\u0442\u0440\u0435\u0442\u0438\u0442\u044c \u0431\u043e\u043b\u0435\u0435 \u0441\u0438\u043b\u044c\u043d\u044b\u0445 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u043e\u0432 \u0438 \u043d\u0430\u0439\u0442\u0438 \u0440\u0435\u0434\u043a\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b.","ancient_ruins"===c&&"\u0417\u0430\u0433\u0430\u0434\u043e\u0447\u043d\u044b\u0435 \u0440\u0443\u0438\u043d\u044b \u0434\u0440\u0435\u0432\u043d\u0435\u0439 \u0446\u0438\u0432\u0438\u043b\u0438\u0437\u0430\u0446\u0438\u0438. \u0412 \u044d\u0442\u043e\u043c \u043e\u043f\u0430\u0441\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435 \u043e\u0431\u0438\u0442\u0430\u044e\u0442 \u043c\u043e\u0433\u0443\u0449\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0434\u0443\u0445\u0438 \u0438 \u0445\u0440\u0430\u043d\u044f\u0442\u0441\u044f \u0434\u0440\u0435\u0432\u043d\u0438\u0435 \u0441\u043e\u043a\u0440\u043e\u0432\u0438\u0449\u0430."]})]}),(0,Cn.jsx)(ql,{children:g.map((e=>(0,Cn.jsxs)(Ul,{available:e.available,onClick:()=>(e=>{e.available&&(e&&"object"===typeof e?e.stats?(console.log("CombatArea: \u0412\u044b\u0431\u0440\u0430\u043d \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a \u0434\u043b\u044f \u0431\u043e\u044f:",e.name,e),h(e)):console.error("CombatArea: \u0423 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0432\u0440\u0430\u0433\u0430 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 stats",e):console.error("CombatArea: \u041f\u043e\u043f\u044b\u0442\u043a\u0430 \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0433\u043e \u0432\u0440\u0430\u0433\u0430",e))})(e),children:[(0,Cn.jsxs)(Fl,{children:[(0,Cn.jsx)(zl,{children:e.icon}),(0,Cn.jsxs)(Bl,{children:[(0,Cn.jsx)(Gl,{children:e.name}),(0,Cn.jsx)(Wl,{available:e.available,children:e.available?`\u0423\u0440\u043e\u0432\u0435\u043d\u044c ${e.level}`:`\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0443\u0440\u043e\u0432\u0435\u043d\u044c ${e.requiredLevel}`})]})]}),(0,Cn.jsx)(Hl,{children:e.description}),(0,Cn.jsxs)(Vl,{children:[(0,Cn.jsxs)(Ql,{children:[(0,Cn.jsx)("span",{children:"\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435:"}),(0,Cn.jsx)("span",{children:e.stats.health})]}),(0,Cn.jsxs)(Ql,{children:[(0,Cn.jsx)("span",{children:"\u0417\u0430\u0449\u0438\u0442\u0430:"}),(0,Cn.jsxs)("span",{children:[e.stats.physicalDefense,"/",e.stats.spiritualDefense]})]}),(0,Cn.jsxs)(Ql,{children:[(0,Cn.jsx)("span",{children:"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{children:e.stats.accuracy})]}),(0,Cn.jsxs)(Ql,{children:[(0,Cn.jsx)("span",{children:"\u0423\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u0435:"}),(0,Cn.jsx)("span",{children:e.stats.evasion})]})]}),(0,Cn.jsxs)(Yl,{children:[(0,Cn.jsxs)(Kl,{children:[(0,Cn.jsx)("span",{children:"\u2728"})," ",e.experience," \u043e\u043f\u044b\u0442\u0430"]}),(0,Cn.jsxs)(Kl,{children:[(0,Cn.jsx)("span",{children:"\ud83d\udcb0"})," ",e.currency.min,"-",e.currency.max," \u043c\u043e\u043d\u0435\u0442"]}),e.loot.map(((e,t)=>(0,Cn.jsxs)(Kl,{children:[(0,Cn.jsx)("span",{children:e.icon||"\ud83d\udce6"}),e.name," (",Math.floor(e.chance),"%)"]},t)))]})]},e.id)))})]})})},Jl=nr.div`
  display: grid;
  grid-template-columns: 1fr 300px;
  gap: 20px;
  overflow-x: hidden; /*    */
`,Zl=rr`
  0%, 100% { opacity: 0.8; }
  50% { opacity: 1; }
`,ec=rr`
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-3px); }
`,tc=rr`
  0% { background-position: -100% 0; }
  100% { background-position: 200% 0; }
`,rc=rr`
  0% { background-position: 0% 0%; }
  100% { background-position: 20% 100%; }
`,nc=rr`
  0% { background-position: 0 0; }
  100% { background-position: 10px 100px; }
`,ac=rr`
  0%, 100% { opacity: 0.5; }
  50% { opacity: 0.7; }
`,ic=rr`
  0%, 95%, 100% { 
    box-shadow: inset 0 0 100vw 0 rgba(255, 255, 255, 0);
  }
  97% {
    box-shadow: inset 0 0 100vw 0 rgba(255, 255, 255, 0.2);
  }
`,oc=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 15px;
  margin-bottom: 15px;
  display: flex;
  flex-direction: column;
  gap: 15px;
`,sc=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
`,lc=nr.div`
  display: flex;
  flex-direction: column;
  gap: 5px;
`,cc=nr.div`
  color: #aaa;
  font-size: 0.8rem;
`,dc=nr.div`
  color: #f0f0f0;
  font-size: 1rem;
  display: flex;
  align-items: center;
  gap: 5px;
`,uc=nr.div`
  font-size: 1.5rem;
  animation: ${Zl} 3s infinite ease-in-out;
  animation: ${ec} 3s infinite ease-in-out;
`,pc=nr.div`
  width: 100%;
  height: 8px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  margin-top: 8px;
  position: relative;
  overflow: hidden;
  
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: ${e=>e.progress||0}%;
    background: linear-gradient(to right, 
      #FFC107 0%, 
      #FFD54F 25%, 
      #4FC3F7 50%, 
      #0D47A1 75%, 
      #311B92 100%
    );
    border-radius: 4px;
    transition: width 0.5s ease-in-out;
  }
`,hc=nr.div`
  width: 100%;
  height: 8px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  margin-top: 8px;
  position: relative;
  overflow: hidden;
  
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: ${e=>e.progress||0}%;
    ${e=>{switch(e.season){case"spring":return Ft`background: linear-gradient(to right, #81C784, #C5E1A5, #AED581);`;case"summer":return Ft`background: linear-gradient(to right, #FFD54F, #FFA726, #FF9800);`;case"autumn":return Ft`background: linear-gradient(to right, #A1887F, #8D6E63, #795548);`;case"winter":return Ft`background: linear-gradient(to right, #B3E5FC, #81D4FA, #4FC3F7);`;default:return Ft`background: linear-gradient(to right, #81C784, #FFD54F, #A1887F, #B3E5FC);`}}}
    border-radius: 4px;
    transition: width 0.5s ease-in-out;
  }
`,mc=(nr.div`
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 5px;
`,nr.div`
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 1rem;
  color: ${e=>{switch(e.season){case"spring":return"#AED581";case"summer":return"#FFD54F";case"autumn":return"#A1887F";case"winter":return"#81D4FA";default:return"#fff"}}};
`),fc=nr.div`
  font-size: 0.9rem;
  color: #aaa;
`,yc=nr.div`
  font-size: 0.8rem;
  color: #bbb;
  display: flex;
  align-items: center;
  gap: 5px;
  margin-top: 5px;
  
  span {
    color: #d4af37;
  }
`,gc=Ft`
  background: linear-gradient(
    to right,
    rgba(255, 215, 0, 0) 0%,
    rgba(255, 215, 0, 0.5) 50%,
    rgba(255, 215, 0, 0) 100%
  );
  background-size: 200% auto;
  animation: ${tc} 3s linear infinite;
`,vc=nr.div`
  margin-top: 8px;
  padding: 8px 10px;
  border-radius: 4px;
  background: rgba(255, 215, 0, 0.1);
  border: 1px dashed rgba(255, 215, 0, 0.3);
  ${e=>e.active&&gc}
`,xc=nr.div`
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 0.9rem;
  color: #d4af37;
  margin-bottom: 5px;
`,bc=nr.div`
  font-size: 0.8rem;
  color: #bbb;
  margin-bottom: 5px;
`,wc=nr.div`
  width: 100%;
  height: 4px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 2px;
  margin-top: 5px;
  position: relative;
  overflow: hidden;
  
  &::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: ${e=>100-e.progress||0}%;
    background: linear-gradient(to right, #d4af37, #ffd700);
    border-radius: 2px;
    transition: width 0.5s ease-in-out;
  }
`,_c=nr.div`
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  padding: 8px 12px;
  margin-top: 10px;
  font-size: 0.8rem;
  color: #aaa;
  
  p {
    margin: 5px 0;
  }
  
  span {
    color: ${e=>e.positive?"#a3be8c":"#bf616a"};
  }
`,Ec=e=>{switch(e){case"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":return"\ud83c\udf05";case"\u0443\u0442\u0440\u043e":return"\ud83c\udf04";case"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":return"\u2600\ufe0f";case"\u0434\u0435\u043d\u044c":return"\ud83c\udf1e";case"\u0432\u0435\u0447\u0435\u0440":return"\ud83c\udf07";case"\u043d\u043e\u0447\u044c":return"\ud83c\udf19";default:return"\u23f0"}},Tc=e=>{switch(e){case"\u042f\u0441\u043d\u043e":return"\u2600\ufe0f";case"\u041e\u0431\u043b\u0430\u0447\u043d\u043e":return"\u2601\ufe0f";case"\u0414\u043e\u0436\u0434\u044c":return"\ud83c\udf27\ufe0f";case"\u0413\u0440\u043e\u0437\u0430":return"\u26c8\ufe0f";case"\u0422\u0443\u043c\u0430\u043d":return"\ud83c\udf2b\ufe0f";case"\u0421\u043d\u0435\u0433":return"\u2744\ufe0f";default:return"\ud83c\udf08"}},Sc=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
  position: relative;
  overflow: hidden;
  transition: all 0.5s ease-in-out;
  
  /*    */
  ${e=>{switch(e.daytimePeriod){case"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":return Ft`filter: brightness(0.9) sepia(0.2);`;case"\u0443\u0442\u0440\u043e":return Ft`filter: brightness(1.1) contrast(1.05);`;case"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":return Ft`filter: brightness(1.2) contrast(1.1);`;case"\u0434\u0435\u043d\u044c":return Ft`filter: brightness(1.15) contrast(1.05);`;case"\u0432\u0435\u0447\u0435\u0440":return Ft`filter: brightness(0.9) sepia(0.15);`;case"\u043d\u043e\u0447\u044c":return Ft`filter: brightness(0.7) contrast(1.2) saturate(0.8);`;case"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c":return Ft`filter: brightness(0.6) contrast(1.3) saturate(0.7);`;default:return""}}}
  
  /*   */
  ${e=>{switch(e.season){case"spring":return Ft`
          &::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(150, 255, 150, 0.05);
            pointer-events: none;
            z-index: 1;
          }
        `;case"summer":return Ft`
          &::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 200, 100, 0.05);
            pointer-events: none;
            z-index: 1;
          }
        `;case"autumn":return Ft`
          &::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 150, 50, 0.05);
            pointer-events: none;
            z-index: 1;
          }
        `;case"winter":return Ft`
          &::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(200, 230, 255, 0.05);
            pointer-events: none;
            z-index: 1;
          }
        `;default:return""}}}
`,jc=nr.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 2;
  
  ${e=>{switch(e.weather){case"rain":return Ft`
          background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><line x1="20" y1="0" x2="10" y2="30" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="30" y1="10" x2="20" y2="40" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="40" y1="0" x2="30" y2="30" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="50" y1="5" x2="40" y2="35" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="60" y1="0" x2="50" y2="30" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="70" y1="10" x2="60" y2="40" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="80" y1="0" x2="70" y2="30" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/><line x1="90" y1="5" x2="80" y2="35" stroke="rgba(200, 200, 255, 0.5)" stroke-width="1"/></svg>');
          background-repeat: repeat;
          opacity: ${e.intensity||.7};
          animation: ${rc} 0.5s linear infinite;
        `;case"snow":return Ft`
          background-image: 
            radial-gradient(circle at 50% 50%, white 0.5px, transparent 1px),
            radial-gradient(circle at 70% 30%, white 0.5px, transparent 1px);
          background-size: 100px 100px, 150px 150px;
          opacity: ${e.intensity||.5};
          animation: ${nc} 20s linear infinite;
        `;case"fog":return Ft`
          background: linear-gradient(to bottom, rgba(255, 255, 255, 0.1), rgba(200, 200, 200, 0.2));
          opacity: ${e.intensity||.5};
          animation: ${ac} 20s ease-in-out infinite;
        `;case"thunderstorm":return Ft`
          background-color: rgba(255, 255, 255, 0);
          box-shadow: inset 0 0 100vw 0 rgba(255, 255, 255, 0);
          animation: ${ic} ${10+20*Math.random()}s ease-out infinite;
          opacity: ${e.intensity||.2};
        `;case"cloudy":return Ft`
          background-image: 
            radial-gradient(circle at 30% 40%, rgba(220, 220, 220, 0.3) 20px, transparent 30px),
            radial-gradient(circle at 70% 50%, rgba(220, 220, 220, 0.3) 30px, transparent 40px);
          background-size: 200px 200px;
          opacity: ${e.intensity||.3};
        `;default:return""}}}
`,Cc=nr.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 3;
  
  ${e=>{switch(e.event){case"bloom":return Ft`
          box-shadow: inset 0 0 100px rgba(255, 230, 230, 0.3);
          background: 
            radial-gradient(circle at 30% 40%, rgba(255, 200, 200, 0.1) 0px, transparent 100px),
            radial-gradient(circle at 70% 60%, rgba(255, 200, 200, 0.1) 0px, transparent 100px);
        `;case"spirit_tide":return Ft`
          background: linear-gradient(to bottom, 
            rgba(100, 150, 255, 0.05) 0%, 
            rgba(100, 200, 255, 0.1) 50%, 
            rgba(100, 150, 255, 0.05) 100%);
        `;case"solstice":return Ft`
          box-shadow: inset 0 0 150px rgba(255, 200, 100, 0.3);
        `;case"meteor_shower":return Ft`
          background-image: linear-gradient(to bottom right, transparent 80%, rgba(255, 255, 255, 0.2) 80.5%, transparent 81%);
          background-size: 200px 200px;
          animation: ${rc} 1s linear infinite;
        `;case"ice_tribulation":return Ft`
          background: radial-gradient(circle at center, rgba(200, 230, 255, 0.1) 0%, transparent 100%);
          box-shadow: inset 0 0 100px rgba(200, 230, 255, 0.2);
        `;case"blizzard":return Ft`
          background-image: 
            radial-gradient(circle at 50% 50%, white 1px, transparent 2px),
            radial-gradient(circle at 70% 30%, white 1px, transparent 2px);
          background-size: 50px 50px, 70px 70px;
          opacity: 0.7;
          animation: ${nc} 5s linear infinite;
        `;default:return""}}}
`,kc=nr.div`
  display: grid;
  grid-template-columns: repeat(10, 1fr);
  gap: 2px;
  width: 100%;
  height: 100%;
  min-height: 500px;
`,Ic=nr.div`
  background: ${e=>"mountain"===e.type?"#8B4513":"forest"===e.type?"#228B22":"water"===e.type?"#4682B4":"city"===e.type?"#DAA520":"dungeon"===e.type?"#800000":"#556B2F"};
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  cursor: pointer;
  position: relative;
  transition: all 0.2s ease;
  
  &:hover {
    transform: scale(1.05);
    z-index: 1;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
  }
  
  ${e=>e.isPlayerLocation&&"\n    &::after {\n      content: '\u25cf';\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      color: #fff;\n      font-size: 1.2rem;\n      text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);\n    }\n  "}
`,Ac=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
`,Nc=nr.div`
  margin-bottom: 20px;
  padding-bottom: 20px;
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
`,Dc=nr.h2`
  color: #d4af37;
  margin: 0 0 5px;
`,Mc=nr.div`
  color: #aaa;
  font-size: 0.9rem;
  margin-bottom: 10px;
`,Rc=nr.p`
  color: #f0f0f0;
  font-size: 0.9rem;
  line-height: 1.4;
  margin: 0 0 20px;
`,Pc=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-bottom: 20px;
`,Lc=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 10px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
`,$c=nr.span`
  color: #aaa;
`,Oc=nr.span`
  color: #f0f0f0;
`,qc=nr.button`
  width: 100%;
  padding: 10px;
  background: rgba(212, 175, 55, 0.2);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #d4af37;
  font-size: 0.9rem;
  cursor: pointer;
  margin-bottom: 10px;
  transition: all 0.2s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.3);
  }
  
  &:disabled {
    background: #333;
    border-color: #666;
    color: #666;
    cursor: not-allowed;
  }
`,Uc=nr(qc)`
  background: rgba(150, 150, 150, 0.2);
  border-color: #aaa;
  color: #aaa;
  
  &:hover {
    background: rgba(150, 150, 150, 0.3);
  }
`,Fc=[{id:1,name:"\u0414\u043e\u043b\u0438\u043d\u0430 \u041d\u0430\u0447\u0430\u043b\u0430",type:"forest",x:3,y:3,description:"\u041c\u0435\u0441\u0442\u043e, \u0433\u0434\u0435 \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442 \u0441\u0432\u043e\u0439 \u043f\u0443\u0442\u044c \u043c\u043e\u043b\u043e\u0434\u044b\u0435 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u044b.",resources:[{id:1,name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u0442\u0440\u0430\u0432\u044b",amount:"\u041c\u0430\u043b\u043e"}]},{id:2,name:"\u0413\u043e\u0440\u044b \u041e\u0431\u043b\u0430\u0447\u043d\u043e\u0433\u043e \u041f\u0438\u043a\u0430",type:"mountain",x:5,y:2,description:"\u0412\u044b\u0441\u043e\u043a\u0438\u0435 \u0433\u043e\u0440\u044b, \u043e\u043a\u0443\u0442\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u043b\u0430\u043a\u0430\u043c\u0438 \u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0435\u0439.",resources:[{id:2,name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043a\u0430\u043c\u043d\u0438",amount:"\u0421\u0440\u0435\u0434\u043d\u0435"}]},{id:3,name:"\u0413\u043e\u0440\u043e\u0434 \u0412\u043e\u0441\u0442\u043e\u0447\u043d\u043e\u0433\u043e \u0412\u0435\u0442\u0440\u0430",type:"city",x:7,y:5,description:"\u041a\u0440\u0443\u043f\u043d\u044b\u0439 \u0433\u043e\u0440\u043e\u0434, \u0446\u0435\u043d\u0442\u0440 \u0442\u043e\u0440\u0433\u043e\u0432\u043b\u0438 \u0438 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438.",resources:[{id:3,name:"\u0422\u043e\u0432\u0430\u0440\u044b",amount:"\u041c\u043d\u043e\u0433\u043e"}]},{id:4,name:"\u041e\u0437\u0435\u0440\u043e \u041e\u0442\u0440\u0430\u0436\u0435\u043d\u0438\u0439",type:"water",x:2,y:6,description:"\u041c\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043e\u0437\u0435\u0440\u043e, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043e\u0442\u0440\u0430\u0436\u0430\u044e\u0442\u0441\u044f \u0437\u0432\u0435\u0437\u0434\u044b \u0434\u0430\u0436\u0435 \u0434\u043d\u0435\u043c.",resources:[{id:4,name:"\u0412\u043e\u0434\u043d\u044b\u0435 \u044d\u0441\u0441\u0435\u043d\u0446\u0438\u0438",amount:"\u041c\u043d\u043e\u0433\u043e"}]},{id:5,name:"\u041f\u0435\u0449\u0435\u0440\u0430 \u0422\u044b\u0441\u044f\u0447\u0438 \u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0439",type:"dungeon",x:8,y:8,description:"\u0414\u0440\u0435\u0432\u043d\u0435\u0435 \u043c\u0435\u0441\u0442\u043e \u0438\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0439 \u0434\u043b\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432.",resources:[{id:5,name:"\u0421\u043e\u043a\u0440\u043e\u0432\u0438\u0449\u0430",amount:"\u0420\u0435\u0434\u043a\u043e"}]},{id:6,name:"\u0422\u0443\u043c\u0430\u043d\u043d\u044b\u0439 \u041b\u0435\u0441",type:"forest",x:1,y:1,description:"\u0414\u0440\u0435\u0432\u043d\u0438\u0439 \u043b\u0435\u0441, \u043e\u043a\u0443\u0442\u0430\u043d\u043d\u044b\u0439 \u0432\u0435\u0447\u043d\u044b\u043c \u0442\u0443\u043c\u0430\u043d\u043e\u043c, \u0433\u0434\u0435 \u0440\u0430\u0441\u0442\u0443\u0442 \u0440\u0435\u0434\u043a\u0438\u0435 \u0432\u0438\u0434\u044b \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u0433\u0440\u0438\u0431\u043e\u0432.",resources:[{id:6,name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u0433\u0440\u0438\u0431\u044b",amount:"\u0421\u0440\u0435\u0434\u043d\u0435"}]},{id:7,name:"\u0412\u0443\u043b\u043a\u0430\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u041f\u0438\u043a",type:"mountain",x:9,y:2,description:"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u0432\u0443\u043b\u043a\u0430\u043d, \u0438\u0441\u0442\u043e\u0447\u0430\u044e\u0449\u0438\u0439 \u043e\u0433\u043d\u0435\u043d\u043d\u0443\u044e \u0446\u0438, \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0434\u043b\u044f \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u043e\u0432 \u043e\u0433\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0443\u0442\u0438.",resources:[{id:7,name:"\u041e\u0433\u043d\u0435\u043d\u043d\u044b\u0435 \u043a\u0440\u0438\u0441\u0442\u0430\u043b\u043b\u044b",amount:"\u0420\u0435\u0434\u043a\u043e"}]},{id:8,name:"\u0414\u0435\u0440\u0435\u0432\u043d\u044f \u0420\u0435\u0447\u043d\u043e\u0433\u043e \u041a\u0430\u043c\u043d\u044f",type:"city",x:4,y:7,description:"\u041d\u0435\u0431\u043e\u043b\u044c\u0448\u043e\u0435 \u043f\u043e\u0441\u0435\u043b\u0435\u043d\u0438\u0435 \u0443 \u043f\u043e\u0434\u043d\u043e\u0436\u0438\u044f \u0433\u043e\u0440, \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e\u0435 \u043c\u0430\u0441\u0442\u0435\u0440\u0430\u043c\u0438-\u0440\u0435\u043c\u0435\u0441\u043b\u0435\u043d\u043d\u0438\u043a\u0430\u043c\u0438 \u0438 \u0446\u0435\u043b\u0435\u0431\u043d\u044b\u043c\u0438 \u0442\u0440\u0430\u0432\u0430\u043c\u0438.",resources:[{id:8,name:"\u0420\u0435\u0434\u043a\u0438\u0435 \u0440\u0443\u043a\u043e\u0434\u0435\u043b\u0438\u044f",amount:"\u041c\u043d\u043e\u0433\u043e"}]},{id:9,name:"\u041b\u0435\u0434\u044f\u043d\u043e\u0435 \u041e\u0437\u0435\u0440\u043e",type:"water",x:6,y:9,description:"\u041e\u0437\u0435\u0440\u043e, \u043d\u0435 \u0442\u0430\u044e\u0449\u0435\u0435 \u0434\u0430\u0436\u0435 \u043b\u0435\u0442\u043e\u043c, \u0441 \u0432\u043e\u0434\u043e\u0439, \u043d\u0430\u0441\u044b\u0449\u0435\u043d\u043d\u043e\u0439 \u0447\u0438\u0441\u0442\u0435\u0439\u0448\u0435\u0439 \u0438\u043d\u044c-\u044d\u043d\u0435\u0440\u0433\u0438\u0435\u0439.",resources:[{id:9,name:"\u0418\u043d\u044c-\u044d\u0441\u0441\u0435\u043d\u0446\u0438\u044f",amount:"\u041c\u043d\u043e\u0433\u043e"}]},{id:10,name:"\u0417\u0430\u043f\u0440\u0435\u0442\u043d\u044b\u0435 \u0420\u0443\u0438\u043d\u044b",type:"dungeon",x:2,y:3,description:"\u0414\u0440\u0435\u0432\u043d\u0438\u0435 \u0440\u0443\u0438\u043d\u044b \u0437\u0430\u0431\u044b\u0442\u043e\u0439 \u0446\u0438\u0432\u0438\u043b\u0438\u0437\u0430\u0446\u0438\u0438, \u043f\u043e\u043b\u043d\u044b\u0435 \u043e\u043f\u0430\u0441\u043d\u044b\u0445 \u043b\u043e\u0432\u0443\u0448\u0435\u043a \u0438 \u0431\u0435\u0441\u0446\u0435\u043d\u043d\u044b\u0445 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u043e\u0432.",resources:[{id:10,name:"\u0414\u0440\u0435\u0432\u043d\u0438\u0435 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u044b",amount:"\u0420\u0435\u0434\u043a\u043e"}]}],zc={mountain:"mountain_path",forest:"starting_area",dungeon:"ancient_ruins",city:"starting_area",water:"starting_area"};const Bc=function(){var e,t,r,a,i,o,s,l,c,d,u,p,h,m,f,y;const{state:g,actions:v}=Nn(),[x,b]=(0,n.useState)(null),[w,_]=(0,n.useState)(!1),[E,T]=(0,n.useState)(null),S=(null===g||void 0===g?void 0:g.world)||{},j=(null===g||void 0===g||null===(e=g.player)||void 0===e?void 0:e.location)||{x:3,y:3},C=(null===S||void 0===S||null===(t=S.map)||void 0===t?void 0:t.locations)||Fc,k=(null===g||void 0===g||null===(r=g.player)||void 0===r?void 0:r.cultivation)||{},[I,A]=(0,n.useReducer)((e=>e+1),0),N=Sa(),{hour:D,minute:M,formattedTime:R,isDayTime:P,daytimePeriod:L,currentWeather:$,weatherIntensity:O,dayCount:q,season:U,seasonDay:F,seasonLength:z,activeEvent:B,eventRemainingTime:G,nextWeatherChange:W,forceUpdateCounter:H,worldTime:V}=N,Q=(60*D+M)/1440*100,Y=F/z*100,K=["spring","summer","autumn","winter"],X=K.indexOf(U),J=K[(X+1)%K.length],Z=B?G/120*100:0;(0,n.useEffect)((()=>{const e=()=>{console.log("\u23f0 MapTab TimeWeatherPanel: \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0440\u0435\u043c\u0435\u043d\u0438"),A()};return window.addEventListener("manual_time_update",e),A(),console.log("\u26a1 MapTab TimeWeatherPanel: \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0430 \u043d\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f",{hour:D,minute:M,formattedTime:R,worldTime:V,counter:H}),()=>{window.removeEventListener("manual_time_update",e)}}),[]),(0,n.useEffect)((()=>{A(),console.log("\ud83d\udd04 MapTab TimeWeatherPanel: \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0438\u0437-\u0437\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445",{hour:D,minute:M,formattedTime:R,worldTime:V,counter:H})}),[D,M,R,V,H]);const ee={clear:"\u042f\u0441\u043d\u043e",cloudy:"\u041e\u0431\u043b\u0430\u0447\u043d\u043e",rain:"\u0414\u043e\u0436\u0434\u044c",thunderstorm:"\u0413\u0440\u043e\u0437\u0430",fog:"\u0422\u0443\u043c\u0430\u043d",snow:"\u0421\u043d\u0435\u0433"},te={spring:"\u0412\u0435\u0441\u043d\u0430",summer:"\u041b\u0435\u0442\u043e",autumn:"\u041e\u0441\u0435\u043d\u044c",winter:"\u0417\u0438\u043c\u0430"},re={bloom:{name:"\u0426\u0432\u0435\u0442\u0435\u043d\u0438\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u0442\u0440\u0430\u0432",description:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u0442\u0440\u0430\u0432\u044b \u0446\u0432\u0435\u0442\u0443\u0442, \u043f\u043e\u0432\u044b\u0448\u0430\u044f \u0438\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e.",icon:"\ud83c\udf38"},spirit_tide:{name:"\u041f\u0440\u0438\u043b\u0438\u0432 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",description:"\u041f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u0430\u044f \u043a\u043e\u043d\u0446\u0435\u043d\u0442\u0440\u0430\u0446\u0438\u044f \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0443\u0441\u043a\u043e\u0440\u044f\u0435\u0442 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044e.",icon:"\ud83c\udf0a"},solstice:{name:"\u0421\u043e\u043b\u043d\u0446\u0435\u0441\u0442\u043e\u044f\u043d\u0438\u0435",description:"\u041f\u0438\u043a \u0441\u043e\u043b\u043d\u0435\u0447\u043d\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0443\u0441\u0438\u043b\u0438\u0432\u0430\u0435\u0442 \u043e\u0433\u043d\u0435\u043d\u043d\u0443\u044e \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044e.",icon:"\u2600\ufe0f"},meteor_shower:{name:"\u041c\u0435\u0442\u0435\u043e\u0440\u0438\u0442\u043d\u044b\u0439 \u0434\u043e\u0436\u0434\u044c",description:"\u041f\u0430\u0434\u0430\u044e\u0449\u0438\u0435 \u0437\u0432\u0435\u0437\u0434\u044b \u043f\u0440\u0438\u043d\u043e\u0441\u044f\u0442 \u0440\u0435\u0434\u043a\u0438\u0435 \u043a\u043e\u0441\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b.",icon:"\u2604\ufe0f"},harvest:{name:"\u0421\u0431\u043e\u0440 \u0443\u0440\u043e\u0436\u0430\u044f",description:"\u0412\u0440\u0435\u043c\u044f \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u043f\u043b\u043e\u0434\u044b \u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c\u0441\u044f \u043a \u0437\u0438\u043c\u0435.",icon:"\ud83c\udf3e"},spirit_wind:{name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u0432\u0435\u0442\u0435\u0440",description:"\u0421\u0438\u043b\u044c\u043d\u044b\u0435 \u0432\u0435\u0442\u0440\u0430 \u0434\u0435\u043b\u0430\u044e\u0442 \u043f\u0435\u0440\u0435\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u0435 \u043b\u0435\u0433\u0447\u0435.",icon:"\ud83c\udf2c\ufe0f"},ice_tribulation:{name:"\u041b\u0435\u0434\u044f\u043d\u0430\u044f \u0442\u0440\u0438\u0431\u0443\u043b\u044f\u0446\u0438\u044f",description:"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u043b\u044c\u0434\u043e\u043c \u0438 \u0445\u043e\u043b\u043e\u0434\u043e\u043c \u0434\u043b\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432.",icon:"\u2744\ufe0f"},blizzard:{name:"\u041c\u0435\u0442\u0435\u043b\u044c",description:"\u0421\u0438\u043b\u044c\u043d\u044b\u0439 \u0441\u043d\u0435\u0433\u043e\u043f\u0430\u0434 \u0437\u0430\u0442\u0440\u0443\u0434\u043d\u044f\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u0435.",icon:"\ud83c\udf28\ufe0f"}};return w&&E?(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)(Uc,{onClick:()=>_(!1),children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u043a\u0430\u0440\u0442\u0435"}),(0,Cn.jsx)(Xl,{areaId:E})]}):(0,Cn.jsxs)(Jl,{children:[(0,Cn.jsxs)("div",{children:[(0,Cn.jsxs)(oc,{children:[(0,Cn.jsxs)(sc,{children:[(0,Cn.jsxs)(lc,{children:[(0,Cn.jsx)(cc,{children:"\u0422\u0435\u043a\u0443\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f"}),(0,Cn.jsxs)(dc,{children:[(0,Cn.jsx)(uc,{children:Ec(L)}),R," (",L,")"]})]}),(0,Cn.jsxs)(lc,{children:[(0,Cn.jsx)(cc,{children:"\u041f\u043e\u0433\u043e\u0434\u0430"}),(0,Cn.jsxs)(dc,{children:[(0,Cn.jsx)(uc,{children:Tc(ee[$]||"\u042f\u0441\u043d\u043e")}),ee[$]||"\u042f\u0441\u043d\u043e",O&&`(${Math.round(10*O)}/10)`]})]})]}),(0,Cn.jsxs)(cc,{children:["\u0426\u0438\u043a\u043b \u0434\u043d\u044f (\u0414\u0435\u043d\u044c ",q,")"]}),(0,Cn.jsx)(pc,{progress:Q}),(0,Cn.jsxs)(sc,{children:[(0,Cn.jsxs)(lc,{children:[(0,Cn.jsx)(cc,{children:"\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u0441\u0435\u0437\u043e\u043d"}),(0,Cn.jsxs)(mc,{season:U,children:[{spring:"\ud83c\udf31",summer:"\u2600\ufe0f",autumn:"\ud83c\udf42",winter:"\u2744\ufe0f"}[U]," ",te[U]]}),(0,Cn.jsx)(hc,{season:U,progress:Y})]}),(0,Cn.jsxs)(lc,{children:[(0,Cn.jsxs)(fc,{children:["\u0414\u0435\u043d\u044c ",F," \u0438\u0437 ",z]}),(0,Cn.jsxs)(yc,{children:["\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0441\u0435\u0437\u043e\u043d: ",(0,Cn.jsx)("span",{children:te[J]})," \u0447\u0435\u0440\u0435\u0437 ",z-F," \u0434\u043d\u0435\u0439"]})]})]}),(0,Cn.jsxs)(cc,{children:["\u0414\u043e \u0441\u043c\u0435\u043d\u044b \u043f\u043e\u0433\u043e\u0434\u044b: ",W," \u043c\u0438\u043d."]}),B&&(0,Cn.jsxs)(vc,{active:!0,children:[(0,Cn.jsxs)(xc,{children:[(null===(a=re[B])||void 0===a?void 0:a.icon)||"\ud83c\udf1f"," ",(null===(i=re[B])||void 0===i?void 0:i.name)||"\u041e\u0441\u043e\u0431\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435"]}),(0,Cn.jsx)(bc,{children:(null===(o=re[B])||void 0===o?void 0:o.description)||"\u041f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043e\u0441\u043e\u0431\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435, \u0432\u043b\u0438\u044f\u044e\u0449\u0435\u0435 \u043d\u0430 \u043e\u043a\u0440\u0443\u0436\u0430\u044e\u0449\u0438\u0439 \u043c\u0438\u0440."}),(0,Cn.jsxs)(cc,{children:["\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0432\u0440\u0435\u043c\u0435\u043d\u0438: ",G," \u043c\u0438\u043d."]}),(0,Cn.jsx)(wc,{progress:Z})]})]}),(0,Cn.jsxs)(Sc,{daytimePeriod:L,season:U,children:[(0,Cn.jsx)(jc,{weather:$,intensity:O}),B&&(0,Cn.jsx)(Cc,{event:B}),(0,Cn.jsx)(kc,{children:C.map((e=>{const t={};switch(e.type){case"forest":"spring"===U&&(t.resourceBonus=1.2),"rain"===$&&(t.energyRecovery=1.1);break;case"mountain":"winter"===U&&(t.cultivationSpeed=1.15),"thunderstorm"===$&&(t.insightChance=1.2);break;case"water":"summer"===U&&(t.cooldown=.8),"clear"===$&&(t.spiritualEnergy=1.2);break;case"city":"autumn"===U&&(t.tradeBonus=1.15),"fog"===$&&(t.stealthBonus=1.3);break;case"dungeon":"winter"===U&&(t.defenseBonus=1.1),"thunderstorm"===$&&(t.attackBonus=1.2)}let r={};return"\u043d\u043e\u0447\u044c"!==L&&"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c"!==L||("water"===e.type&&(r.glow="0 0 15px rgba(100, 150, 255, 0.3)"),"dungeon"===e.type&&(r.glow="0 0 10px rgba(255, 50, 50, 0.2)")),(0,Cn.jsx)(Ic,{type:e.type,isPlayerLocation:e.x===j.x&&e.y===j.y,style:r,onClick:()=>(e=>{b(e)})(e),"data-effects":Object.keys(t).length>0?"active":"none"},e.id)}))})]})]}),(0,Cn.jsx)(Ac,{children:x?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsxs)(Nc,{children:[(0,Cn.jsx)(Dc,{children:x.name}),(0,Cn.jsxs)(Mc,{children:["mountain"===x.type&&"\u0413\u043e\u0440\u044b","forest"===x.type&&"\u041b\u0435\u0441","water"===x.type&&"\u0412\u043e\u0434\u043e\u0435\u043c","city"===x.type&&"\u0413\u043e\u0440\u043e\u0434","dungeon"===x.type&&"\u041f\u043e\u0434\u0437\u0435\u043c\u0435\u043b\u044c\u0435"]})]}),(0,Cn.jsx)(Rc,{children:x.description}),x.resources&&(0,Cn.jsx)(Pc,{children:x.resources.map((e=>(0,Cn.jsxs)(Lc,{children:[(0,Cn.jsx)($c,{children:e.name}),(0,Cn.jsx)(Oc,{children:e.amount})]},e.id)))}),x.x!==j.x||x.y!==j.y?(0,Cn.jsxs)(qc,{onClick:()=>{if(!x)return;const e=5*(Math.abs(x.x-j.x)+Math.abs(x.y-j.y));(k.energy||0)<e?v.addNotification&&v.addNotification({message:"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u043f\u0443\u0442\u0435\u0448\u0435\u0441\u0442\u0432\u0438\u044f",type:"error"}):(v.updateCultivation&&v.updateCultivation({energy:(k.energy||0)-e}),v.updateLocation&&v.updateLocation(x),v.addNotification&&v.addNotification({message:`\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u043b\u0438\u0441\u044c \u0432 ${x.name}`,type:"success"}))},disabled:(k.energy||0)<5*(Math.abs(x.x-j.x)+Math.abs(x.y-j.y)),children:["\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u0432 \u043f\u0443\u0442\u044c (",5*(Math.abs(x.x-j.x)+Math.abs(x.y-j.y))," \u044d\u043d\u0435\u0440\u0433\u0438\u0438)"]}):(0,Cn.jsx)(qc,{onClick:()=>{const e=j.type||"forest";T(zc[e]||"starting_area"),_(!0)},children:"\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u044c \u043c\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u044c"}),x&&(0,Cn.jsxs)(Cn.Fragment,{children:[(()=>{const e={};switch(x.type){case"forest":e.baseEnergy={value:"+5%",positive:!0},e.basePerception={value:"+10%",positive:!0},"spring"===U&&(e.resourceBonus={value:"+20% \u043a \u0441\u0431\u043e\u0440\u0443 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432",positive:!0}),"rain"===$&&(e.energyRecovery={value:"+10% \u043a \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u0438",positive:!0});break;case"mountain":e.baseStrength={value:"+5%",positive:!0},e.baseStamina={value:"+15%",positive:!0},"winter"===U&&(e.cultivationSpeed={value:"+15% \u043a \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438",positive:!0}),"thunderstorm"===$&&(e.insightChance={value:"+20% \u043a \u0448\u0430\u043d\u0441\u0443 \u043e\u0437\u0430\u0440\u0435\u043d\u0438\u044f",positive:!0});break;case"water":e.baseWisdom={value:"+10%",positive:!0},e.baseHealing={value:"+15%",positive:!0},"summer"===U&&(e.cooldown={value:"-20% \u043a \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0430\u0432\u044b\u043a\u043e\u0432",positive:!0}),"clear"===$&&(e.spiritualEnergy={value:"+20% \u043a \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044e \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",positive:!0});break;case"city":e.baseSocial={value:"+20%",positive:!0},e.baseLuck={value:"+5%",positive:!0},"autumn"===U&&(e.tradeBonus={value:"+15% \u043a \u0432\u044b\u0433\u043e\u0434\u0435 \u043f\u0440\u0438 \u0442\u043e\u0440\u0433\u043e\u0432\u043b\u0435",positive:!0}),"fog"===$&&(e.stealthBonus={value:"+30% \u043a \u0441\u043a\u0440\u044b\u0442\u043d\u043e\u0441\u0442\u0438",positive:!0});break;case"dungeon":e.baseAttack={value:"+10%",positive:!0},e.baseDefense={value:"+5%",positive:!0},"winter"===U&&(e.defenseBonus={value:"+10% \u043a \u0437\u0430\u0449\u0438\u0442\u0435",positive:!0}),"thunderstorm"===$&&(e.attackBonus={value:"+20% \u043a \u0430\u0442\u0430\u043a\u0435",positive:!0})}switch(L){case"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":"forest"===x.type&&(e.dawnPerception={value:"+15% \u043a \u0432\u043e\u0441\u043f\u0440\u0438\u044f\u0442\u0438\u044e",positive:!0}),"water"===x.type&&(e.dawnMeditation={value:"+25% \u043a \u044d\u0444\u0444\u0435\u043a\u0442\u0443 \u043c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u0438",positive:!0});break;case"\u0434\u0435\u043d\u044c":"mountain"===x.type&&(e.dayStamina={value:"+10% \u043a \u0432\u044b\u043d\u043e\u0441\u043b\u0438\u0432\u043e\u0441\u0442\u0438",positive:!0});break;case"\u043d\u043e\u0447\u044c":case"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c":"water"===x.type&&(e.nightEnergy={value:"+20% \u043a \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",positive:!0}),"dungeon"===x.type&&(e.nightMonsterStrength={value:"+15% \u043a \u0441\u0438\u043b\u0435 \u043c\u043e\u043d\u0441\u0442\u0440\u043e\u0432",positive:!1})}if(B)switch(B){case"bloom":"forest"===x.type&&(e.bloomHerbQuality={value:"+50% \u043a \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0443 \u0442\u0440\u0430\u0432",positive:!0});break;case"spirit_tide":"water"===x.type&&(e.tideSpiritualPower={value:"+40% \u043a \u0441\u0438\u043b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u0442\u0435\u0445\u043d\u0438\u043a",positive:!0});break;case"solstice":"mountain"===x.type&&(e.solsticeCultivation={value:"+30% \u043a \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438",positive:!0});break;case"meteor_shower":e.meteorRareMaterials={value:"\u0428\u0430\u043d\u0441 \u043d\u0430\u0439\u0442\u0438 \u0440\u0435\u0434\u043a\u0438\u0435 \u043c\u0430\u0442\u0435\u0440\u0438\u0430\u043b\u044b",positive:!0}}return(0,Cn.jsxs)(_c,{style:{marginTop:"15px"},children:[(0,Cn.jsx)("h4",{style:{margin:"0 0 10px 0",color:"#d4af37"},children:"\u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u043b\u043e\u043a\u0430\u0446\u0438\u0438:"}),(0,Cn.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,Cn.jsx)("p",{style:{color:"#bbb",marginBottom:"5px"},children:"\u0411\u0430\u0437\u043e\u0432\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b:"}),Object.entries(e).filter((e=>{let[t]=e;return t.startsWith("base")})).map(((e,t)=>{let[r,n]=e;return(0,Cn.jsxs)("p",{children:[r.replace("base",""),": ",(0,Cn.jsx)("span",{positive:n.positive?"true":"false",children:n.value})]},t)}))]}),Object.entries(e).filter((e=>{let[t]=e;return!t.startsWith("base")})).length>0&&(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("p",{style:{color:"#bbb",marginBottom:"5px"},children:"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b:"}),Object.entries(e).filter((e=>{let[t]=e;return!t.startsWith("base")})).map(((e,t)=>{let[r,n]=e;return(0,Cn.jsx)("p",{children:(0,Cn.jsx)("span",{positive:n.positive?"true":"false",children:n.value})},t)}))]})]})})(),x.x===j.x&&x.y===j.y&&(0,Cn.jsxs)(_c,{children:[(0,Cn.jsxs)("h4",{style:{margin:"10px 0 8px 0",color:"#d4af37"},children:["\u042d\u0444\u0444\u0435\u043a\u0442\u044b \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043f\u043e\u0433\u043e\u0434\u044b",Array.isArray(N.weatherEffects)&&N.weatherEffects.length>1&&` (${N.weatherEffects.length})`]}),!N.weatherEffects||Array.isArray(N.weatherEffects)&&0===N.weatherEffects.length||"object"===typeof N.weatherEffects&&0===Object.keys(N.weatherEffects).length?(0,Cn.jsx)("p",{style:{color:"#aaa",fontStyle:"italic"},children:"\u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u043f\u043e\u0433\u043e\u0434\u044b"}):(0,Cn.jsx)(Cn.Fragment,{children:Array.isArray(N.weatherEffects)?N.weatherEffects.map(((e,t)=>(0,Cn.jsxs)("p",{children:[e.type||"\u042d\u0444\u0444\u0435\u043a\u0442",":",(0,Cn.jsx)("span",{positive:e.modifier>0||e.positive?"true":"false",children:e.modifier?(e.modifier>0?" +":" ")+("number"===typeof e.modifier?Math.round(e.modifier):e.modifier)+(e.target?` \u043a ${e.target}`:""):e.description||""})]},t))):(0,Cn.jsxs)(Cn.Fragment,{children:[void 0!==(null===(s=N.weatherEffects)||void 0===s||null===(l=s.exploration)||void 0===l?void 0:l.movementEnergyCostModifier)&&1!==N.weatherEffects.exploration.movementEnergyCostModifier&&(0,Cn.jsxs)("p",{children:["\u0417\u0430\u0442\u0440\u0430\u0442\u044b \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u043d\u0430 \u043f\u0435\u0440\u0435\u0434\u0432\u0438\u0436\u0435\u043d\u0438\u0435:",(0,Cn.jsxs)("span",{positive:N.weatherEffects.exploration.movementEnergyCostModifier<1?"true":"false",children:[N.weatherEffects.exploration.movementEnergyCostModifier<1?" -":" +",Math.abs(Math.round(100*(N.weatherEffects.exploration.movementEnergyCostModifier-1))),"%"]})]}),void 0!==(null===(c=N.weatherEffects)||void 0===c||null===(d=c.exploration)||void 0===d?void 0:d.resourceFindRateModifier)&&1!==N.weatherEffects.exploration.resourceFindRateModifier&&(0,Cn.jsxs)("p",{children:["\u0428\u0430\u043d\u0441 \u043d\u0430\u0439\u0442\u0438 \u0440\u0435\u0441\u0443\u0440\u0441\u044b:",(0,Cn.jsxs)("span",{positive:N.weatherEffects.exploration.resourceFindRateModifier>1?"true":"false",children:[N.weatherEffects.exploration.resourceFindRateModifier>1?" +":" -",Math.abs(Math.round(100*(N.weatherEffects.exploration.resourceFindRateModifier-1))),"%"]})]}),void 0!==(null===(u=N.weatherEffects)||void 0===u||null===(p=u.exploration)||void 0===p?void 0:p.resourceQualityModifier)&&1!==N.weatherEffects.exploration.resourceQualityModifier&&(0,Cn.jsxs)("p",{children:["\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432:",(0,Cn.jsxs)("span",{positive:N.weatherEffects.exploration.resourceQualityModifier>1?"true":"false",children:[N.weatherEffects.exploration.resourceQualityModifier>1?" +":" -",Math.abs(Math.round(100*(N.weatherEffects.exploration.resourceQualityModifier-1))),"%"]})]}),void 0!==(null===(h=N.weatherEffects)||void 0===h||null===(m=h.combat)||void 0===m?void 0:m.enemySpawnRateModifier)&&1!==N.weatherEffects.combat.enemySpawnRateModifier&&(0,Cn.jsxs)("p",{children:["\u0427\u0430\u0441\u0442\u043e\u0442\u0430 \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0440\u0430\u0433\u043e\u0432:",(0,Cn.jsxs)("span",{positive:N.weatherEffects.combat.enemySpawnRateModifier<1?"true":"false",children:[N.weatherEffects.combat.enemySpawnRateModifier<1?" -":" +",Math.abs(Math.round(100*(N.weatherEffects.combat.enemySpawnRateModifier-1))),"%"]})]}),void 0!==(null===(f=N.weatherEffects)||void 0===f||null===(y=f.system)||void 0===y?void 0:y.specialEncounterChance)&&N.weatherEffects.system.specialEncounterChance>0&&(0,Cn.jsxs)("p",{children:["\u0428\u0430\u043d\u0441 \u043e\u0441\u043e\u0431\u044b\u0445 \u0432\u0441\u0442\u0440\u0435\u0447:",(0,Cn.jsxs)("span",{positive:"true",children:["+",Math.round(100*N.weatherEffects.system.specialEncounterChance),"%"]})]})]})})]})]})]}):(0,Cn.jsx)("div",{style:{textAlign:"center",color:"#aaa"},children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043b\u043e\u043a\u0430\u0446\u0438\u044e \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0434\u0435\u0442\u0430\u043b\u0435\u0439"})})]})};var Gc=r(9892);const Wc=nr.div`
  display: flex;
  gap: 20px;
  height: 100%;
`,Hc=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  padding: 20px;
  overflow-y: auto;
`,Vc=nr.div`
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
`,Qc=nr.button`
  background: ${e=>e.active?"rgba(212, 175, 55, 0.2)":"rgba(0, 0, 0, 0.3)"};
  color: ${e=>e.active?"#d4af37":"#f0f0f0"};
  border: 1px solid ${e=>e.active?"#d4af37":"transparent"};
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.1);
    border-color: #d4af37;
  }
`,Yc=nr.div`
  background: rgba(30, 30, 30, 0.95);
  border-radius: 6px;
  padding: 15px;
  margin-bottom: 15px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid transparent;
  
  &:hover {
    border-color: #d4af37;
    transform: translateX(5px);
  }
  
  ${e=>e.selected&&"\n    border-color: #d4af37;\n    background: rgba(212, 175, 55, 0.1);\n  "}
`,Kc=nr.h3`
  color: #d4af37;
  margin: 0 0 10px 0;
  font-size: 1.1rem;
`,Xc=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 10px;
  font-size: 0.9rem;
`,Jc=nr.span`
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.8rem;
  
  ${e=>{switch(e.level){case"\u041b\u0435\u0433\u043a\u043e":return"background: rgba(76, 175, 80, 0.2); color: #4caf50;";case"\u0421\u0440\u0435\u0434\u043d\u0435":return"background: rgba(255, 152, 0, 0.2); color: #ff9800;";case"\u0421\u043b\u043e\u0436\u043d\u043e":return"background: rgba(244, 67, 54, 0.2); color: #f44336;";default:return""}}}
`,Zc=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  padding: 20px;
  display: flex;
  flex-direction: column;
`,ed=nr.div`
  margin-bottom: 20px;
`,td=nr.h2`
  color: #d4af37;
  margin: 0 0 10px 0;
`,rd=nr.p`
  color: #aaa;
  line-height: 1.6;
  margin-bottom: 20px;
`,nd=nr.div`
  margin-bottom: 20px;
`,ad=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
  padding: 10px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  
  ${e=>e.completed&&"\n    color: #4caf50;\n    text-decoration: line-through;\n  "}
`,id=nr.div`
  margin-top: auto;
`,od=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px;
  background: rgba(212, 175, 55, 0.1);
  border-radius: 4px;
  margin-bottom: 8px;
`,sd=nr.button`
  background: ${e=>e.disabled?"rgba(0, 0, 0, 0.3)":"rgba(212, 175, 55, 0.2)"};
  color: ${e=>e.disabled?"#666":"#d4af37"};
  border: 1px solid ${e=>e.disabled?"transparent":"#d4af37"};
  padding: 12px 24px;
  border-radius: 4px;
  cursor: ${e=>e.disabled?"not-allowed":"pointer"};
  margin-top: 20px;
  transition: all 0.3s ease;
  
  &:hover:not(:disabled) {
    background: rgba(212, 175, 55, 0.3);
  }
`;const ld=function(){const{state:e,actions:t}=Nn(),[r,a]=(0,n.useState)("\u0432\u0441\u0435"),[i,o]=(0,n.useState)(null),s=[...Gc.quests.filter((t=>!e.player.progress.quests.completed.find((e=>e.id===t.id)))),...e.player.progress.quests.active,...e.player.progress.quests.completed].filter((e=>"\u0432\u0441\u0435"===r||e.category===r)),l=i&&"active"===i.status&&i.objectives.every((e=>e.completed));return(0,Cn.jsxs)(Wc,{children:[(0,Cn.jsxs)(Hc,{children:[(0,Cn.jsx)(Vc,{children:Gc.questCategories.map((e=>(0,Cn.jsx)(Qc,{active:r===e.name,onClick:()=>a(e.name),children:e.name.charAt(0).toUpperCase()+e.name.slice(1)},e.id)))}),s.map((e=>(0,Cn.jsxs)(Yc,{selected:(null===i||void 0===i?void 0:i.id)===e.id,onClick:()=>(e=>{o(e)})(e),children:[(0,Cn.jsx)(Kc,{children:e.title}),(0,Cn.jsx)("div",{children:e.description}),(0,Cn.jsxs)(Xc,{children:[(0,Cn.jsx)(Jc,{level:e.difficulty,children:e.difficulty}),(0,Cn.jsxs)("span",{children:["completed"===e.status&&"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e","active"===e.status&&"\u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435","available"===e.status&&`\u0423\u0440\u043e\u0432\u0435\u043d\u044c ${e.requiredLevel}`]})]})]},e.id)))]}),i&&(0,Cn.jsxs)(Zc,{children:[(0,Cn.jsxs)(ed,{children:[(0,Cn.jsx)(td,{children:i.title}),(0,Cn.jsx)(Jc,{level:i.difficulty,children:i.difficulty})]}),(0,Cn.jsx)(rd,{children:i.description}),(0,Cn.jsxs)(nd,{children:[(0,Cn.jsx)("h3",{children:"\u0426\u0435\u043b\u0438:"}),i.objectives.map((e=>(0,Cn.jsxs)(ad,{completed:e.completed,children:[e.completed?"\u2713":"\u25cb"," ",e.text]},e.id)))]}),(0,Cn.jsxs)(id,{children:[(0,Cn.jsx)("h3",{children:"\u041d\u0430\u0433\u0440\u0430\u0434\u044b:"}),i.rewards.map(((e,t)=>(0,Cn.jsxs)(od,{children:[(0,Cn.jsx)("span",{children:e.icon}),"currency"===e.type&&("object"===typeof e.amount?Object.entries(e.amount).map((e=>{let[t,r]=e,n=t;return"gold"===t&&(n="\u0437\u043e\u043b\u043e\u0442\u0430"),"silver"===t&&(n="\u0441\u0435\u0440\u0435\u0431\u0440\u0430"),"copper"===t&&(n="\u043c\u0435\u0434\u0438"),`${r} ${n}`})).join(", "):`${e.amount} \u0437\u043e\u043b\u043e\u0442\u0430`),"experience"===e.type&&`${e.amount} \u043e\u043f\u044b\u0442\u0430`,"item"===e.type&&e.name,"technique"===e.type&&e.name]},t)))]}),"available"===i.status?(0,Cn.jsx)(sd,{onClick:()=>{if(i){if(e.player.cultivation.level<i.requiredLevel)return void t.addNotification({message:`\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 ${i.requiredLevel}`,type:"error"});t.acceptQuest(i.id),t.addNotification({message:`\u0412\u044b \u043f\u0440\u0438\u043d\u044f\u043b\u0438 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 "${i.title}"`,type:"success"})}},disabled:e.player.cultivation.level<i.requiredLevel,children:e.player.cultivation.level<i.requiredLevel?`\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0443\u0440\u043e\u0432\u0435\u043d\u044c ${i.requiredLevel}`:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435"}):"active"===i.status&&(0,Cn.jsx)(sd,{onClick:()=>{if(i){if(!i.objectives.every((e=>e.completed)))return void t.addNotification({message:"\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u0446\u0435\u043b\u0438 \u0437\u0430\u0434\u0430\u043d\u0438\u044f",type:"error"});t.completeQuest(i.id)}},disabled:!l,children:l?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435":"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u0446\u0435\u043b\u0438"})]})]})},cd=nr.div`
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 20px;
  overflow-y: auto;
  max-height: calc(100vh - 150px);
`,dd=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
`,ud=nr.div`
  margin-bottom: 20px;
  padding-bottom: 20px;
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
  text-align: center;
`,pd=nr.h2`
  color: #d4af37;
  margin: 0 0 5px;
`,hd=nr.div`
  color: #aaa;
  font-size: 0.9rem;
  margin-bottom: 10px;
`,md=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-bottom: 20px;
`,fd=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 10px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
`,yd=nr.span`
  color: #aaa;
`,gd=nr.span`
  color: #f0f0f0;
`,vd=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
`,xd=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
`,bd=nr.h3`
  color: #d4af37;
  margin: 0;
`,wd=nr.span`
  color: #aaa;
`,_d=nr.div`
  display: flex;
  flex-direction: column;
`,Ed=nr.div`
  color: #f0f0f0;
  margin-bottom: 5px;
`,Td=nr.div`
  color: #aaa;
  font-size: 0.8rem;
`,Sd=nr.div`
  color: #d4af37;
`,jd=nr.button`
  width: 100%;
  padding: 10px;
  background: rgba(212, 175, 55, 0.2);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #d4af37;
  font-size: 0.9rem;
  cursor: pointer;
  margin-bottom: 10px;
  transition: all 0.2s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.3);
  }
  
  &:disabled {
    background: #333;
    border-color: #666;
    color: #666;
    cursor: not-allowed;
  }
`,Cd=nr.div`
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(212, 175, 55, 0.2);
`,kd=nr.h3`
  color: #d4af37;
  margin: 0 0 10px;
`,Id=nr.p`
  color: #f0f0f0;
  font-size: 0.9rem;
  line-height: 1.4;
  margin: 0 0 15px;
`,Ad={name:"\u0421\u0435\u043a\u0442\u0430 \u0412\u043e\u0441\u0445\u043e\u0434\u044f\u0449\u0435\u0433\u043e \u041e\u0431\u043b\u0430\u043a\u0430",rank:"\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0430\u044f",influence:100,resources:50,territories:1,benefits:[{type:"cultivation_speed",modifier:5},{type:"resource_gathering",modifier:3},{type:"energy_regen",modifier:1},{type:"technique_discount",modifier:2},{type:"max_energy",modifier:10}],members:[{id:1,name:"\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438",role:"\u0413\u043b\u0430\u0432\u0430 \u0441\u0435\u043a\u0442\u044b",cultivationLevel:30},{id:2,name:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0427\u0436\u0430\u043d",role:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430",cultivationLevel:25},{id:3,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0412\u0430\u043d",role:"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:15},{id:4,name:"\u0423\u0447\u0435\u043d\u0438\u0446\u0430 \u041c\u044d\u0439",role:"\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:12},{id:5,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0427\u0435\u043d",role:"\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0443\u0447\u0435\u043d\u0438\u043a",cultivationLevel:8}]};const Nd=nr.div`
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(212, 175, 55, 0.2);
`,Dd=nr.h3`
  color: #d4af37;
  margin: 0 0 10px;
  font-size: 1rem;
`,Md=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
`,Rd=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 10px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
`,Pd=nr.span`
  color: #aaa;
  font-size: 0.8rem;
`,Ld=nr.span`
  color: #d4af37;
  font-size: 0.8rem;
`,$d=nr.div`
  margin-top: 20px;
  padding: 15px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  border: 1px solid rgba(212, 175, 55, 0.3);
`,Od=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
`,qd=nr.h3`
  color: #d4af37;
  margin: 0;
  font-size: 1.1rem;
`,Ud=nr.span`
  color: #aaa;
  font-size: 0.9rem;
`,Fd=nr.div`
  margin-bottom: 15px;
`,zd=nr.div`
  color: #f0f0f0;
  font-size: 0.9rem;
  margin-bottom: 5px;
`,Bd=nr.div`
  height: 8px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  
  &:after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: ${e=>Math.min(100,e.current/e.max*100)}%;
    background: #d4af37;
    border-radius: 4px;
  }
`,Gd=nr.div`
  margin-bottom: 15px;
`,Wd=nr.p`
  color: #aaa;
  font-size: 0.85rem;
  line-height: 1.4;
  margin: 0 0 10px;
`,Hd=nr.div`
  color: #aaa;
  font-size: 0.75rem;
  margin-top: 5px;
`,Vd=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px;
  background: ${e=>e.selected?"rgba(212, 175, 55, 0.2)":"rgba(0, 0, 0, 0.2)"};
  border: 1px solid ${e=>e.selected?"rgba(212, 175, 55, 0.5)":"transparent"};
  border-radius: 4px;
  margin-bottom: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.1);
  }
  
  &:last-child {
    margin-bottom: 0;
  }
`,Qd=function(){var e,t;const{state:a,actions:i}=Nn(),[o,s]=(0,n.useState)(null),l=(null===a||void 0===a||null===(e=a.player)||void 0===e||e.sect,(null===a||void 0===a||null===(t=a.player)||void 0===t?void 0:t.cultivation)||{});(0,n.useEffect)((()=>{(async()=>{try{var e;null!==(e=a.sect)&&void 0!==e&&e.sect||!i.loadUserSect||await i.loadUserSect()}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e \u0441\u0435\u043a\u0442\u0435:",t),i.addNotification({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0441\u0435\u043a\u0442\u0435",type:"error"})}})()}),[]);const c=a.sect||{},d=c.sect||Ad,{collectAllSectBenefits:u,getBenefitValueByType:p}=r(592),h=u(c),m=e=>p(h,e,0);return(0,Cn.jsxs)(cd,{children:[(0,Cn.jsxs)(dd,{children:[(0,Cn.jsxs)(ud,{children:[(0,Cn.jsx)(pd,{children:d.name}),(0,Cn.jsxs)(hd,{children:["\u0420\u0430\u043d\u0433: ",d.rank]})]}),(0,Cn.jsxs)(md,{children:[(0,Cn.jsxs)(fd,{children:[(0,Cn.jsx)(yd,{children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c"}),(0,Cn.jsx)(gd,{children:d.level||1})]}),(0,Cn.jsxs)(fd,{children:[(0,Cn.jsx)(yd,{children:"\u041e\u043f\u044b\u0442"}),(0,Cn.jsxs)(gd,{children:[d.experience||0,"/",d.requiredExperience||100]})]}),(0,Cn.jsxs)(fd,{children:[(0,Cn.jsx)(yd,{children:"\u0412\u043b\u0438\u044f\u043d\u0438\u0435"}),(0,Cn.jsx)(gd,{children:d.influence||0})]}),(0,Cn.jsxs)(fd,{children:[(0,Cn.jsx)(yd,{children:"\u0420\u0435\u0441\u0443\u0440\u0441\u044b"}),(0,Cn.jsx)(gd,{children:d.resources||0})]}),(0,Cn.jsxs)(fd,{children:[(0,Cn.jsx)(yd,{children:"\u0422\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438"}),(0,Cn.jsx)(gd,{children:d.territories||0})]}),(0,Cn.jsxs)(fd,{children:[(0,Cn.jsx)(yd,{children:"\u0427\u043b\u0435\u043d\u044b"}),(0,Cn.jsx)(gd,{children:(d.members||[]).length})]})]}),(0,Cn.jsxs)(Nd,{children:[(0,Cn.jsx)(Dd,{children:"\u0411\u043e\u043d\u0443\u0441\u044b \u0441\u0435\u043a\u0442\u044b"}),(0,Cn.jsxs)(Md,{children:[(0,Cn.jsxs)(Rd,{children:[(0,Cn.jsx)(Pd,{children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"}),(0,Cn.jsxs)(Ld,{children:["+",m("cultivation_speed"),"%"]})]}),(0,Cn.jsxs)(Rd,{children:[(0,Cn.jsx)(Pd,{children:"\u0421\u0431\u043e\u0440 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432"}),(0,Cn.jsxs)(Ld,{children:["+",m("resource_gathering"),"%"]})]}),(0,Cn.jsxs)(Rd,{children:[(0,Cn.jsx)(Pd,{children:"\u0420\u0435\u0433\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u0438"}),(0,Cn.jsxs)(Ld,{children:["+",m("energy_regen")," \u0435\u0434/\u0447\u0430\u0441"]})]}),(0,Cn.jsxs)(Rd,{children:[(0,Cn.jsx)(Pd,{children:"\u0421\u043a\u0438\u0434\u043a\u0430 \u043d\u0430 \u0442\u0435\u0445\u043d\u0438\u043a\u0438"}),(0,Cn.jsxs)(Ld,{children:["-",m("technique_discount"),"%"]})]}),(0,Cn.jsxs)(Rd,{children:[(0,Cn.jsx)(Pd,{children:"\u041c\u0430\u043a\u0441. \u044d\u043d\u0435\u0440\u0433\u0438\u044f"}),(0,Cn.jsxs)(Ld,{children:["+",m("max_energy")," \u0435\u0434"]})]})]})]}),(0,Cn.jsxs)(Cd,{children:[(0,Cn.jsx)(kd,{children:"\u0412\u043a\u043b\u0430\u0434 \u0432 \u0441\u0435\u043a\u0442\u0443"}),(0,Cn.jsx)(Id,{children:"\u0412\u043d\u0435\u0441\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u0432\u043a\u043b\u0430\u0434 \u0432 \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u0435 \u0441\u0435\u043a\u0442\u044b, \u043f\u043e\u0442\u0440\u0430\u0442\u0438\u0432 \u0434\u0443\u0445\u043e\u0432\u043d\u0443\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u044e. \u042d\u0442\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442 \u0432\u0430\u0448\u0435 \u0432\u043b\u0438\u044f\u043d\u0438\u0435 \u0438 \u043f\u043e\u043c\u043e\u0436\u0435\u0442 \u0441\u0435\u043a\u0442\u0435 \u0441\u0442\u0430\u0442\u044c \u0441\u0438\u043b\u044c\u043d\u0435\u0435."}),(0,Cn.jsx)(jd,{onClick:async()=>{if((l.energy||0)<20)i.addNotification({message:"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u0432\u043a\u043b\u0430\u0434\u0430 \u0432 \u0441\u0435\u043a\u0442\u0443",type:"error"});else try{if(i.contributeToSect){const e=await i.contributeToSect(a.player.id,d.id,20);if(i.addNotification({message:e.message||"\u0412\u044b \u0432\u043d\u0435\u0441\u043b\u0438 \u0432\u043a\u043b\u0430\u0434 \u0432 \u0440\u0430\u0437\u0432\u0438\u0442\u0438\u0435 \u0441\u0435\u043a\u0442\u044b",type:"success"}),e.leveledUp){i.addNotification({message:`\u0421\u0435\u043a\u0442\u0430 "${d.name}" \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0430 ${e.newLevel} \u0443\u0440\u043e\u0432\u043d\u044f!`,type:"achievement"});const t={...d,level:e.newLevel,experience:e.sectExperience,requiredExperience:e.sectRequiredExperience,rank:e.sectRank,influence:e.sectInfluence};i.dispatch({type:Yr.UPDATE_SECT,payload:t}),i.dispatch({type:Yr.UPDATE_RELATIONSHIP_AND_LOYALTY,payload:{name:d.name,value:t.loyalty||0}})}}}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u043d\u0435\u0441\u0435\u043d\u0438\u0438 \u0432\u043a\u043b\u0430\u0434\u0430 \u0432 \u0441\u0435\u043a\u0442\u0443:",e),i.addNotification({message:e.message||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0432\u043d\u0435\u0441\u0442\u0438 \u0432\u043a\u043b\u0430\u0434 \u0432 \u0441\u0435\u043a\u0442\u0443",type:"error"})}},disabled:(l.energy||0)<20,children:"\u0412\u043d\u0435\u0441\u0442\u0438 \u0432\u043a\u043b\u0430\u0434 (20 \u044d\u043d\u0435\u0440\u0433\u0438\u0438)"})]})]}),(0,Cn.jsxs)(vd,{children:[(0,Cn.jsxs)(xd,{children:[(0,Cn.jsx)(bd,{children:"\u0427\u043b\u0435\u043d\u044b \u0441\u0435\u043a\u0442\u044b"}),(0,Cn.jsxs)(wd,{children:[(d.members||[]).length," \u0447\u0435\u043b\u043e\u0432\u0435\u043a"]})]}),(d.members||[]).map((e=>(0,Cn.jsxs)(Vd,{onClick:()=>(e=>{if(console.log("[DEBUG] \u0412\u044b\u0431\u0440\u0430\u043d \u0447\u043b\u0435\u043d \u0441\u0435\u043a\u0442\u044b:",e),"undefined"!==typeof window)try{const t=localStorage.getItem(`sect_member_${e.id}`);if(t){const r=JSON.parse(t);console.log("[DEBUG] \u041d\u0430\u0439\u0434\u0435\u043d\u044b \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 localStorage:",r),e={...e,level:r.level||e.level,experience:r.experience||e.experience,requiredExperience:r.requiredExperience||e.requiredExperience,loyalty:r.loyalty||e.loyalty},console.log("[DEBUG] \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0439 \u0447\u043b\u0435\u043d \u0441\u0435\u043a\u0442\u044b \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u0437 localStorage:",e)}}catch(Lg){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0438\u0437 localStorage:",Lg)}s(e),i.selectSectMember&&i.selectSectMember(e)})(e),selected:o&&o.id===e.id,children:[(0,Cn.jsxs)(_d,{children:[(0,Cn.jsx)(Ed,{children:e.name}),(0,Cn.jsx)(Td,{children:e.role})]}),(0,Cn.jsxs)(Sd,{children:[e.level||1," \u0443\u0440\u043e\u0432\u0435\u043d\u044c",e.loyalty&&(0,Cn.jsxs)(Hd,{children:["\u041b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c: ",e.loyalty,"%"]})]})]},e.id))),o&&(0,Cn.jsxs)($d,{children:[(0,Cn.jsxs)(Od,{children:[(0,Cn.jsx)(qd,{children:o.name}),(0,Cn.jsx)(Ud,{children:o.role})]}),(0,Cn.jsxs)(Fd,{children:[(0,Cn.jsxs)(zd,{children:["\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441: ",o.experience||0,"/",o.requiredExperience||100]}),(0,Cn.jsx)(Bd,{current:o.experience||0,max:o.requiredExperience||100})]}),(0,Cn.jsx)(Gd,{children:(0,Cn.jsx)(Wd,{children:"\u0421\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u0430\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u0441 \u044d\u0442\u0438\u043c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u043c \u043f\u043e\u0432\u044b\u0441\u0438\u0442 \u0435\u0433\u043e \u043e\u043f\u044b\u0442 \u0438 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c. \u0412\u044b \u0442\u0430\u043a\u0436\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0435 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u043f\u044b\u0442\u0430 \u043e\u0442 \u043e\u0431\u043c\u0435\u043d\u0430 \u0437\u043d\u0430\u043d\u0438\u044f\u043c\u0438."})}),(0,Cn.jsx)(jd,{onClick:()=>(async e=>{if(!o)return;if((l.energy||0)<5)i.addNotification({message:"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438",type:"error"});else try{if(i.trainSectMember){console.log("[DEBUG] \u041d\u0430\u0447\u0438\u043d\u0430\u0435\u043c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0443 \u0441 \u0447\u043b\u0435\u043d\u043e\u043c \u0441\u0435\u043a\u0442\u044b:",o);const t=await i.trainSectMember(a.player.id,e,1);console.log("[DEBUG] \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438:",t),i.addNotification({message:t.message||`\u0412\u044b \u043f\u0440\u043e\u0432\u0435\u043b\u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0443 \u0441 ${o.name}`,type:"success"}),t.userGainedXP>0&&i.addNotification({message:`\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 ${t.userGainedXP} \u043e\u043f\u044b\u0442\u0430 \u043e\u0442 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u043e\u0439 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438`,type:"info"}),t.memberLeveledUp&&i.addNotification({message:`${t.memberName} \u043f\u043e\u0432\u044b\u0441\u0438\u043b \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u0434\u043e ${t.memberNewLevel}!`,type:"achievement"});const r={...o,level:t.memberLevel,experience:t.memberExperience,requiredExperience:t.memberRequiredExperience,loyalty:t.memberLoyalty,role:t.memberRole};console.log("[DEBUG] \u041e\u0431\u043d\u043e\u0432\u043b\u044f\u0435\u043c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b \u0432 UI:",r),s(r);const n={...d,members:d.members.map((r=>r.id===e?{...r,level:t.memberLevel,experience:t.memberExperience,requiredExperience:t.memberRequiredExperience,loyalty:t.memberLoyalty,role:t.memberRole}:r))};i.dispatch({type:Yr.UPDATE_SECT,payload:n})}}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0435 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b:",t),i.addNotification({message:t.message||"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u043e\u0432\u0435\u0441\u0442\u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0443",type:"error"})}})(o.id),disabled:(l.energy||0)<5||c.loading,children:c.loading?"\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430...":`\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c ${o.name} (5 \u044d\u043d\u0435\u0440\u0433\u0438\u0438)`})]})]})]})};var Yd,Kd=new Uint8Array(16);function Xd(){if(!Yd&&!(Yd="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Yd(Kd)}const Jd=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const Zd=function(e){return"string"===typeof e&&Jd.test(e)};for(var eu=[],tu=0;tu<256;++tu)eu.push((tu+256).toString(16).substr(1));const ru=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(eu[e[t+0]]+eu[e[t+1]]+eu[e[t+2]]+eu[e[t+3]]+"-"+eu[e[t+4]]+eu[e[t+5]]+"-"+eu[e[t+6]]+eu[e[t+7]]+"-"+eu[e[t+8]]+eu[e[t+9]]+"-"+eu[e[t+10]]+eu[e[t+11]]+eu[e[t+12]]+eu[e[t+13]]+eu[e[t+14]]+eu[e[t+15]]).toLowerCase();if(!Zd(r))throw TypeError("Stringified UUID is invalid");return r};const nu=function(e,t,r){var n=(e=e||{}).random||(e.rng||Xd)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return ru(n)};const au=class{static async getUserGroups(e){try{const t=(await Dr().getCollection("groups")).where("memberIds","array-contains",e),r=await t.get(),n=[];for(const e of r.docs){const t={id:e.id,...e.data()};t.members=await this.getGroupMembers(t.id),n.push(t)}return n}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",t),t}}static async getGroupById(e){try{const t=await Dr().getCollection("groups"),r=await t.doc(e).get();if(!r.exists)throw new Error("\u0413\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const n={id:r.id,...r.data()};return n.members=await this.getGroupMembers(e),n}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0433\u0440\u0443\u043f\u043f\u044b:",t),t}}static async getGroupMembers(e){try{const n=await Dr().getCollection("group_members"),a=await n.where("groupId","==",e).get(),i=[];for(const e of a.docs){const n={id:e.id,...e.data()},a=await Dr().getCollection("users"),o=await a.doc(n.userId).get();var t,r;if(o.exists)n.user={id:o.id,name:o.data().name,avatar:o.data().avatar,cultivationLevel:(null===(t=o.data().cultivation)||void 0===t?void 0:t.level)||1,cultivationStage:(null===(r=o.data().cultivation)||void 0===r?void 0:r.stage)||"\u041d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0439"};i.push(n)}return i}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u0433\u0440\u0443\u043f\u043f\u044b:",n),n}}static async createGroup(e,t){try{var r,n;if(!t)throw new Error("ID \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d");const a=await Dr().getCollection("groups");if((await a.where("leaderId","==",t).get()).size>=3)throw new Error("\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d \u043b\u0438\u043c\u0438\u0442 \u0433\u0440\u0443\u043f\u043f \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 3)");const i=await Dr().getCollection("users"),o=await i.doc(t).get();if(!o.exists)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");const s=o.data()||{},l={id:o.id,...s},c=(null===(r=l.cultivation)||void 0===r?void 0:r.level)||1;if(c<(e.minCultivationLevel||1))throw new Error("\u0412\u0430\u0448 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044e");const d=new Date,u=nu(),p={id:u,name:e.name,description:e.description||"",leaderId:t,memberIds:[t],maxMembers:e.maxMembers||10,minCultivationLevel:e.minCultivationLevel||1,isPrivate:e.isPrivate||!1,requiresApproval:e.requiresApproval||!1,createdAt:d.toISOString(),updatedAt:d.toISOString()};await a.doc(u).set(p);const h=nu(),m={id:h,groupId:u,userId:t,role:"leader",specialization:e.leaderSpecialization||e.specialization||null,joinedAt:d.toISOString()},f=await Dr().getCollection("group_members");return await f.doc(h).set(m),m.user={id:t,name:l.name||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440",avatar:l.avatar||null,cultivationLevel:c,cultivationStage:(null===(n=l.cultivation)||void 0===n?void 0:n.stage)||"\u041d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0439"},p.members=[m],p}catch(a){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f\u044b:",a),a}}static async updateGroup(e,t,r){try{const n=await Dr().getCollection("groups"),a=await n.doc(e).get();if(!a.exists)throw new Error("\u0413\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const i={id:a.id,...a.data()};if(i.leaderId!==r)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c \u0435\u0451 \u0434\u0430\u043d\u043d\u044b\u0435");const o=new Date,s={...i,name:t.name||i.name,description:void 0!==t.description?t.description:i.description,maxMembers:t.maxMembers||i.maxMembers,minCultivationLevel:t.minCultivationLevel||i.minCultivationLevel,isPrivate:void 0!==t.isPrivate?t.isPrivate:i.isPrivate,requiresApproval:void 0!==t.requiresApproval?t.requiresApproval:i.requiresApproval,updatedAt:o.toISOString()};return await n.doc(e).update({name:s.name,description:s.description,maxMembers:s.maxMembers,minCultivationLevel:s.minCultivationLevel,isPrivate:s.isPrivate,requiresApproval:s.requiresApproval,updatedAt:s.updatedAt}),s.members=await this.getGroupMembers(e),s}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f\u044b:",n),n}}static async deleteGroup(e,t){try{const r=await Dr().getCollection("groups"),n=await r.doc(e).get();if(!n.exists)throw new Error("\u0413\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");if(n.data().leaderId!==t)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0435\u0451");const a=await Dr().getCollection("group_members"),i=await a.where("groupId","==",e).get();return await Dr().transaction((async t=>{i.forEach((e=>{t.delete(e.ref)})),t.delete(r.doc(e))})),!0}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f\u044b:",r),r}}static async addMember(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"member",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{var a,i;const o=await Dr().getCollection("groups"),s=await o.doc(e).get();if(!s.exists)throw new Error("\u0413\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const l={id:s.id,...s.data()};if(l.memberIds.length>=l.maxMembers)throw new Error("\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u0432 \u0433\u0440\u0443\u043f\u043f\u0435");if(l.memberIds.includes(t))throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const c=await Dr().getCollection("users"),d=await c.doc(t).get();if(!d.exists)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");const u={id:d.id,...d.data()},p=(null===(a=u.cultivation)||void 0===a?void 0:a.level)||1;if(p<l.minCultivationLevel)throw new Error("\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044e");const h=new Date,m=nu(),f={id:m,groupId:e,userId:t,role:r,specialization:n,joinedAt:h.toISOString()};await o.doc(e).update({memberIds:[...l.memberIds,t],updatedAt:h.toISOString()});const y=await Dr().getCollection("group_members");return await y.doc(m).set(f),f.user={id:t,name:u.name,avatar:u.avatar,cultivationLevel:p,cultivationStage:(null===(i=u.cultivation)||void 0===i?void 0:i.stage)||"\u041d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0439"},f}catch(o){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443:",o),o}}static async removeMember(e,t,r){try{const n=await Dr().getCollection("groups"),a=await n.doc(e).get();if(!a.exists)throw new Error("\u0413\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const i={id:a.id,...a.data()},o=await Dr().getCollection("group_members"),s=await o.where("groupId","==",e).where("userId","==",t).get();if(s.empty)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const l=s.docs[0],c={id:l.id,...l.data()},d=await o.where("groupId","==",e).where("userId","==",r).get();let u=null;if(!d.empty){u=d.docs[0].data().role}if(t!==r&&"leader"!==u&&("officer"!==u||"leader"===c.role||"officer"===c.role))throw new Error("\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b");if("leader"===c.role&&i.memberIds.length>1){const r=await o.where("groupId","==",e).where("role","==","officer").get();let a=null;if(r.empty){const r=await o.where("groupId","==",e).where("userId","!=",t).get();r.empty||(a=r.docs[0].data().userId)}else a=r.docs[0].data().userId;a&&(await o.where("groupId","==",e).where("userId","==",a).get().then((e=>{e.empty||e.docs[0].ref.update({role:"leader"})})),await n.doc(e).update({leaderId:a}))}return await l.ref.delete(),await n.doc(e).update({memberIds:i.memberIds.filter((e=>e!==t)),updatedAt:(new Date).toISOString()}),!0}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430 \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b:",n),n}}static async updateMemberRole(e,t,r,n){try{const a=await Dr().getCollection("groups"),i=await a.doc(e).get();if(!i.exists)throw new Error("\u0413\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");if(i.data().leaderId!==n&&"leader"===r)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0437\u043d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u043b\u0438\u0434\u0435\u0440\u0430");const o=await Dr().getCollection("group_members"),s=await o.where("groupId","==",e).where("userId","==",n).get();if(s.empty)throw new Error("\u0412\u044b \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const l=s.docs[0].data().role;if("leader"!==l&&"officer"!==l)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c \u0440\u043e\u043b\u0438");const c=await o.where("groupId","==",e).where("userId","==",t).get();if(c.empty)throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const d=c.docs[0],u={id:d.id,...d.data()};if("officer"===l&&("leader"===u.role||"officer"===u.role))throw new Error("\u041e\u0444\u0438\u0446\u0435\u0440 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c \u0440\u043e\u043b\u0438 \u043b\u0438\u0434\u0435\u0440\u0430 \u0438\u043b\u0438 \u0434\u0440\u0443\u0433\u0438\u0445 \u043e\u0444\u0438\u0446\u0435\u0440\u043e\u0432");"leader"===r&&(await o.where("groupId","==",e).where("role","==","leader").get().then((e=>{e.empty||e.docs[0].ref.update({role:"officer"})})),await a.doc(e).update({leaderId:t})),await d.ref.update({role:r}),await a.doc(e).update({updatedAt:(new Date).toISOString()});return{...u,role:r}}catch(a){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0440\u043e\u043b\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430:",a),a}}static async sendInvitation(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";try{var a;const i=await database.collection("groups").doc(e).get();if(!i.exists)throw new Error("\u0413\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const o=i.data(),s=await database.collection("group_members").where("groupId","==",e).where("userId","==",r).get();if(s.empty)throw new Error("\u0412\u044b \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const l=s.docs[0].data().role;if("leader"!==l&&"officer"!==l)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f");if(o.memberIds.includes(t))throw new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");if(!(await database.collection("group_invitations").where("groupId","==",e).where("inviteeId","==",t).where("status","==","pending").get()).empty)throw new Error("\u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u043e\u0436\u0438\u0434\u0430\u044e\u0449\u0435\u0435 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435");const c=await database.collection("users").doc(t).get();if(!c.exists)throw new Error("\u041f\u0440\u0438\u0433\u043b\u0430\u0448\u0430\u0435\u043c\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");const d=c.data(),u=(null===(a=d.cultivation)||void 0===a?void 0:a.level)||1;if(u<o.minCultivationLevel)throw new Error(`\u0423\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (${u}) \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044e \u0433\u0440\u0443\u043f\u043f\u044b (${o.minCultivationLevel})`);const p=new Date,h=new Date(p.getTime()+2592e5),m=nu(),f={id:m,groupId:e,inviterId:r,inviteeId:t,status:"pending",message:n,expiresAt:h.toISOString(),createdAt:p.toISOString(),updatedAt:p.toISOString()};await database.collection("group_invitations").doc(m).set(f),f.group={id:o.id,name:o.name,description:o.description};const y=await database.collection("users").doc(r).get();return y.exists&&(f.inviter={id:r,name:y.data().name,avatar:y.data().avatar}),f.invitee={id:t,name:d.name,avatar:d.avatar},f}catch(i){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f \u0432 \u0433\u0440\u0443\u043f\u043f\u0443:",i),i}}static async getUserInvitations(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pending";try{let r=database.collection("group_invitations").where("inviteeId","==",e);t&&(r=Array.isArray(t)?r.where("status","in",t):r.where("status","==",t)),r=r.orderBy("createdAt","desc");const n=await r.get(),a=[];for(const e of n.docs){const t={id:e.id,...e.data()},r=await database.collection("groups").doc(t.groupId).get();r.exists&&(t.group={id:r.id,name:r.data().name,description:r.data().description,memberCount:r.data().memberIds?r.data().memberIds.length:0,maxMembers:r.data().maxMembers});const n=await database.collection("users").doc(t.inviterId).get();n.exists&&(t.inviter={id:n.id,name:n.data().name,avatar:n.data().avatar}),a.push(t)}return a}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",r),r}}static async respondToInvitation(e,t,r){try{const n=await database.collection("group_invitations").doc(e).get();if(!n.exists)throw new Error("\u041f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e");const a=n.data();if(a.inviteeId!==r)throw new Error("\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u043e\u0442\u0432\u0435\u0442\u0430 \u043d\u0430 \u044d\u0442\u043e \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435");if("pending"!==a.status)throw new Error("\u041d\u0435\u043b\u044c\u0437\u044f \u043e\u0442\u0432\u0435\u0442\u0438\u0442\u044c \u043d\u0430 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043d\u0435 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0435 \u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f");const i=new Date;if(new Date(a.expiresAt)<i)throw new Error("\u0421\u0440\u043e\u043a \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f \u0438\u0441\u0442\u0435\u043a");const o={status:"accept"===t?"accepted":"declined",updatedAt:i.toISOString()};return await database.collection("group_invitations").doc(e).update(o),"accept"===t&&await this.addMember(a.groupId,r),{success:!0,status:o.status}}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u0432\u0435\u0442\u0435 \u043d\u0430 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435:",n),n}}static async getGroupActivities(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=database.collection("group_activities").where("groupId","==",e);t.status&&(r=Array.isArray(t.status)?r.where("status","in",t.status):r.where("status","==",t.status));const n=t.sortField||"createdAt",a=t.sortDirection||"desc";r=r.orderBy(n,a),t.limit&&(r=r.limit(t.limit));const i=await r.get(),o=[];for(const e of i.docs){const r={id:e.id,...e.data()};if(t.includeParticipants){const e=await database.collection("group_activity_participants").where("activityId","==",r.id).get();r.participants=e.docs.map((e=>({id:e.id,...e.data()})))}o.push(r)}return o}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439 \u0433\u0440\u0443\u043f\u043f\u044b:",r),r}}static async createGroupActivity(e,t,r){try{const n=await database.collection("groups").doc(e).get();if(!n.exists)throw new Error("\u0413\u0440\u0443\u043f\u043f\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const a=n.data(),i=await database.collection("group_members").where("groupId","==",e).where("userId","==",r).get();if(i.empty)throw new Error("\u0412\u044b \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const o=i.docs[0].data().role;if("leader"!==o&&"officer"!==o)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438");const s=new Date,l=nu(),c={id:l,groupId:e,creatorId:r,name:t.name,description:t.description||"",type:t.type||"exploration",location:t.location||"",minParticipants:t.minParticipants||2,maxParticipants:t.maxParticipants||a.maxMembers,startTime:t.startTime||null,endTime:t.endTime||null,status:"planned",createdAt:s.toISOString(),updatedAt:s.toISOString()};return await database.collection("group_activities").doc(l).set(c),c}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",n),n}}static async joinGroupActivity(e,t){try{const r=await database.collection("group_activities").doc(e).get();if(!r.exists)throw new Error("\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const n=r.data();if((await database.collection("group_members").where("groupId","==",n.groupId).where("userId","==",t).get()).empty)throw new Error("\u0412\u044b \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const a=await database.collection("group_activity_participants").where("activityId","==",e).get();if(a.size>=n.maxParticipants)throw new Error("\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u0434\u043b\u044f \u044d\u0442\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438");if(!(await database.collection("group_activity_participants").where("activityId","==",e).where("userId","==",t).get()).empty)throw new Error("\u0412\u044b \u0443\u0436\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438");const i=new Date,o=nu(),s={id:o,activityId:e,userId:t,role:"participant",joinedAt:i.toISOString()};return await database.collection("group_activity_participants").doc(o).set(s),s}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0438 \u043a \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",r),r}}};const iu=class{static async getAllActivityTypes(){try{return(await Nr.unifiedDatabase.collection("group_activity_types").get()).docs.map((e=>({id:e.id,...e.data()})))}catch(e){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0432\u0438\u0434\u043e\u0432 \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u044b\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439:",e),e}}static async getActivityById(e){try{const t=await Nr.unifiedDatabase.collection("group_activities").doc(e).get();if(!t.exists)throw new Error("\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const r={id:t.id,...t.data()};if(r.typeId){const e=await Nr.unifiedDatabase.collection("group_activity_types").doc(r.typeId).get();e.exists&&(r.type={id:e.id,...e.data()})}return r.participants=await this.getActivityParticipants(e),r}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",t),t}}static async getGroupActivities(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=Nr.unifiedDatabase.collection("group_activities").where("groupId","==",e);t.status&&(r=Array.isArray(t.status)?r.where("status","in",t.status):r.where("status","==",t.status));const n=t.sortField||"createdAt",a=t.sortDirection||"desc";r=r.orderBy(n,a),t.limit&&(r=r.limit(t.limit));const i=await r.get(),o=[];for(const e of i.docs){const r={id:e.id,...e.data()};if(t.includeType&&r.typeId){const e=await Nr.unifiedDatabase.collection("group_activity_types").doc(r.typeId).get();e.exists&&(r.type={id:e.id,...e.data()})}if(t.includeParticipants)r.participants=await this.getActivityParticipants(r.id);else{const e=await Nr.unifiedDatabase.collection("group_activity_participants").where("activityId","==",r.id).get();r.participantCount=e.size}o.push(r)}return o}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439 \u0433\u0440\u0443\u043f\u043f\u044b:",r),r}}static async getActivityParticipants(e){try{const n=await Nr.unifiedDatabase.collection("group_activity_participants").where("activityId","==",e).get(),a=[];for(const e of n.docs){const n={id:e.id,...e.data()},i=await Nr.unifiedDatabase.collection("users").doc(n.userId).get();var t,r;if(i.exists)n.user={id:i.id,name:i.data().name,avatar:i.data().avatar,cultivationLevel:(null===(t=i.data().cultivation)||void 0===t?void 0:t.level)||1,cultivationStage:(null===(r=i.data().cultivation)||void 0===r?void 0:r.stage)||"\u041d\u0430\u0447\u0438\u043d\u0430\u044e\u0449\u0438\u0439"};a.push(n)}return a}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",n),n}}static async createActivity(e,t,r){try{const n=await Nr.unifiedDatabase.collection("groups").doc(e).get();if(!n.exists)throw new Error("\u0413\u0440\u0443\u043f\u043a\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const a=n.data(),i=await Nr.unifiedDatabase.collection("group_members").where("groupId","==",e).where("userId","==",r).get();if(i.empty)throw new Error("\u0412\u044b \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const o=i.docs[0].data().role;if("leader"!==o&&"officer"!==o)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438");let s=null;if(t.typeId){const e=await Nr.unifiedDatabase.collection("group_activity_types").doc(t.typeId).get();if(!e.exists)throw new Error("\u0423\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0442\u0438\u043f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d");s=e.data()}const l=new Date,c=nu(),d={id:c,groupId:e,creatorId:r,name:t.name,description:t.description||"",typeId:t.typeId||null,location:t.location||"",minParticipants:t.minParticipants||2,maxParticipants:t.maxParticipants||a.maxMembers,difficulty:t.difficulty||"normal",requiredLevel:t.requiredLevel||1,startTime:t.startTime||null,endTime:t.endTime||null,duration:t.duration||60,rewards:t.rewards||{experience:0,resources:[],items:[]},requirements:t.requirements||{minCultivationLevel:1,items:[]},status:"planned",createdAt:l.toISOString(),updatedAt:l.toISOString()};await Nr.unifiedDatabase.collection("group_activities").doc(c).set(d);const u=nu(),p={id:u,activityId:c,userId:r,role:"organizer",status:"confirmed",joinedAt:l.toISOString()};return await Nr.unifiedDatabase.collection("group_activity_participants").doc(u).set(p),{...d,participants:[p]}}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",n),n}}static async updateActivity(e,t,r){try{const n=await Nr.unifiedDatabase.collection("group_activities").doc(e).get();if(!n.exists)throw new Error("\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const a=n.data();if(a.creatorId!==r){const e=await Nr.unifiedDatabase.collection("groups").doc(a.groupId).get();if(!e.exists||e.data().leaderId!==r)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0438\u043b\u0438 \u043b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435")}const i=new Date,o={...t,updatedAt:i.toISOString()};return await Nr.unifiedDatabase.collection("group_activities").doc(e).update(o),{...a,...o}}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",n),n}}static async cancelActivity(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{const n=await Nr.unifiedDatabase.collection("group_activities").doc(e).get();if(!n.exists)throw new Error("\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");if(n.data().creatorId!==t)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u043c\u043e\u0436\u0435\u0442 \u0435\u0435 \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c");const a=new Date;return await Nr.unifiedDatabase.collection("group_activities").doc(e).update({status:"canceled",cancelReason:r,updatedAt:a.toISOString()}),{success:!0,message:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u0430"}}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043c\u0435\u043d\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",n),n}}static async joinActivity(e,t){try{const r=await Nr.unifiedDatabase.collection("group_activities").doc(e).get();if(!r.exists)throw new Error("\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");const n=r.data();if((await Nr.unifiedDatabase.collection("group_members").where("groupId","==",n.groupId).where("userId","==",t).get()).empty)throw new Error("\u0412\u044b \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b");const a=new Date,i=nu(),o={id:i,activityId:e,userId:t,status:"confirmed",joinedAt:a.toISOString()};return await Nr.unifiedDatabase.collection("group_activity_participants").doc(i).set(o),{success:!0,participant:o}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0438 \u043a \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",r),r}}static async leaveActivity(e,t){try{const r=await Nr.unifiedDatabase.collection("group_activity_participants").where("activityId","==",e).where("userId","==",t).get();if(r.empty)throw new Error("\u0412\u044b \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u043c \u044d\u0442\u043e\u0439 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438");return await r.docs[0].ref.delete(),{success:!0,message:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u043a\u0438\u043d\u0443\u043b\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043a\u0438\u0434\u0430\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",r),r}}static async startActivity(e,t){try{const r=await Nr.unifiedDatabase.collection("group_activities").doc(e).get();if(!r.exists)throw new Error("\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");if(r.data().creatorId!==t)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0430\u0442\u044c \u0435\u0435");const n=new Date;return await Nr.unifiedDatabase.collection("group_activities").doc(e).update({status:"active",startedAt:n.toISOString(),updatedAt:n.toISOString()}),{success:!0,message:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043d\u0430\u0447\u0430\u0442\u0430"}}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043d\u0430\u0447\u0430\u043b\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",r),r}}static async completeActivity(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{const n=await Nr.unifiedDatabase.collection("group_activities").doc(e).get();if(!n.exists)throw new Error("\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430");if(n.data().creatorId!==t)throw new Error("\u0422\u043e\u043b\u044c\u043a\u043e \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u043c\u043e\u0436\u0435\u0442 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0435\u0435");const a=new Date;return await Nr.unifiedDatabase.collection("group_activities").doc(e).update({status:"completed",completedAt:a.toISOString(),updatedAt:a.toISOString()}),{success:!0,message:`\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 (${r?"\u0443\u0441\u043f\u0435\u0445":"\u043d\u0435\u0443\u0434\u0430\u0447\u0430"})`}}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",n),n}}},ou=e=>({type:Yr.SET_CURRENT_GROUP,payload:e}),su=e=>({type:Yr.SET_CURRENT_ACTIVITY,payload:e}),lu=e=>async t=>{try{const r=await au.getUserGroups(e);return t((e=>({type:Yr.SET_GROUPS,payload:e}))(r)),r}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",r),r}},cu=e=>async t=>{try{const r=await iu.getActivities(e);return t((e=>({type:Yr.SET_GROUP_ACTIVITIES,payload:e}))(r)),r}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u044b\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439:",r),r}},du=(e,t)=>async r=>{try{const n=await iu.startActivity(e,t);return r({type:Yr.UPDATE_ACTIVITY_INSTANCE,payload:n}),n}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",n),n}},uu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async r=>{try{r({type:Yr.FETCH_GROUP_ACTIVITY_INSTANCES,payload:{groupId:e,filters:t,loading:!0}});const n=await iu.getGroupActivityInstances(e,t);return r({type:Yr.SET_GROUP_ACTIVITY_INSTANCES,payload:n}),n}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439 \u0433\u0440\u0443\u043f\u043f\u044b:",n),n}}},pu="GroupListItem_groupItem__bdugp",hu="GroupListItem_selected__FS0Nt",mu="GroupListItem_header__7ZhIa",fu="GroupListItem_groupName__-48Y0",yu="GroupListItem_activityBadge__BuNO5",gu="GroupListItem_infoRow__F9Zj8",vu="GroupListItem_label__ES2At",xu="GroupListItem_value__vw-mv",bu="GroupListItem_activityInfo__udEff",wu="GroupListItem_activityName__LrtVw",_u="GroupListItem_activityStatus__5t4pe",Eu=e=>{var t;let{group:r,isSelected:n,onClick:a}=e;const i=r.members?r.members.length:0,o=r.activityInstances&&r.activityInstances.some((e=>"preparing"===e.status||"in_progress"===e.status));return(0,Cn.jsxs)("li",{className:`${pu} ${n?hu:""}`,onClick:a,children:[(0,Cn.jsxs)("div",{className:mu,children:[(0,Cn.jsx)("h4",{className:fu,children:r.name}),o&&(0,Cn.jsx)("div",{className:yu,children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"})]}),(0,Cn.jsxs)("div",{className:gu,children:[(0,Cn.jsx)("span",{className:vu,children:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438:"}),(0,Cn.jsxs)("span",{className:xu,children:[i,"/",r.maxMembers]})]}),(0,Cn.jsxs)("div",{className:gu,children:[(0,Cn.jsx)("span",{className:vu,children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)("span",{className:xu,children:r.isPrivate?"\u0417\u0430\u043a\u0440\u044b\u0442\u0430\u044f":"\u041e\u0442\u043a\u0440\u044b\u0442\u0430\u044f"})]}),(0,Cn.jsxs)("div",{className:gu,children:[(0,Cn.jsx)("span",{className:vu,children:"\u041b\u0438\u0434\u0435\u0440:"}),(0,Cn.jsx)("span",{className:xu,children:r.leader?r.leader.username:"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"})]}),r.activityInstances&&r.activityInstances.length>0&&(0,Cn.jsxs)("div",{className:bu,children:[(0,Cn.jsx)("div",{className:wu,children:(null===(t=r.activityInstances[0].activityType)||void 0===t?void 0:t.name)||"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),(0,Cn.jsx)("div",{className:_u,children:"in_progress"===r.activityInstances[0].status?"\u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435":"preparing"===r.activityInstances[0].status?"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430":"completed"===r.activityInstances[0].status?"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430":"failed"===r.activityInstances[0].status?"\u041f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u0430":"\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u0430"})]})]})},Tu="GroupList_groupList__1vwlr",Su="GroupList_title__4NbdF",ju="GroupList_list__fakHA",Cu="GroupList_emptyMessage__KifK3",ku="GroupList_footer__tvHlG",Iu="GroupList_helpText__k-DS0",Au=e=>{let{groups:t=[],selectedGroup:r,onSelectGroup:n}=e;const a=Array.isArray(t)?t:[];return(0,Cn.jsxs)("div",{className:Tu,children:[(0,Cn.jsx)("h3",{className:Su,children:"\u041c\u043e\u0438 \u0433\u0440\u0443\u043f\u043f\u044b"}),0===a.length?(0,Cn.jsx)("div",{className:Cu,children:"\u0423 \u0432\u0430\u0441 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442 \u0433\u0440\u0443\u043f\u043f. \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043d\u043e\u0432\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u0443 \u0438\u043b\u0438 \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u0435\u0441\u044c \u043a \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439."}):(0,Cn.jsx)("ul",{className:ju,children:a.map((e=>(0,Cn.jsx)(Eu,{group:e,isSelected:r&&r.id===e.id,onClick:()=>n(e)},e.id)))}),(0,Cn.jsx)("div",{className:ku,children:(0,Cn.jsx)("div",{className:Iu,children:"\u0413\u0440\u0443\u043f\u043f\u044b \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0442\u044c\u0441\u044f \u0441 \u0434\u0440\u0443\u0433\u0438\u043c\u0438 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u0430\u043c\u0438 \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043e\u0441\u043e\u0431\u044b\u0445 \u0437\u0430\u0434\u0430\u0447 \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0446\u0435\u043d\u043d\u044b\u0445 \u043d\u0430\u0433\u0440\u0430\u0434."})})]})},Nu=nr.button`
  padding: ${e=>"small"===e.size?"6px 12px":"large"===e.size?"12px 20px":"8px 16px"};
  background-color: ${e=>"primary"===e.variant?"#d4af37":"secondary"===e.variant?"#4a4a4a":"danger"===e.variant?"#c43b3b":"success"===e.variant?"#4a8f52":"warning"===e.variant?"#c49b3b":"info"===e.variant?"#3b7ac4":"#7e6839"};
  color: #fff;
  border: none;
  border-radius: 4px;
  font-size: ${e=>"small"===e.size?"14px":"large"===e.size?"18px":"16px"};
  font-weight: 500;
  cursor: ${e=>e.disabled?"not-allowed":"pointer"};
  opacity: ${e=>e.disabled?.6:1};
  transition: background-color 0.2s, transform 0.1s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  position: relative;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);

  &:hover {
    background-color: ${e=>"primary"===e.variant?"#e8c347":"secondary"===e.variant?"#5a5a5a":"danger"===e.variant?"#d44c4c":"success"===e.variant?"#5aa062":"warning"===e.variant?"#d5ac4c":"info"===e.variant?"#4c8bd5":"#9a844f"};
    ${e=>!e.disabled&&"transform: translateY(-1px);"}
  }

  &:active {
    ${e=>!e.disabled&&"transform: translateY(1px);"}
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
  }

  ${e=>e.fullWidth&&"width: 100%;"}
  ${e=>e.className&&e.className}
`,Du=nr.span`
  display: flex;
  align-items: center;
  justify-content: center;
`,Mu=e=>{let{children:t,variant:r="default",size:n="medium",disabled:a=!1,fullWidth:i=!1,icon:o,iconPosition:s="start",onClick:l,className:c,...d}=e;return(0,Cn.jsxs)(Nu,{variant:r,size:n,disabled:a,fullWidth:i,onClick:a?void 0:l,className:c,...d,children:[o&&"start"===s&&(0,Cn.jsx)(Du,{children:o}),t,o&&"end"===s&&(0,Cn.jsx)(Du,{children:o})]})},Ru="MemberList_memberList__XFhoP",Pu="MemberList_memberItem__MkksJ",Lu="MemberList_selected__LjpF1",$u="MemberList_memberInfo__iMPkB",Ou="MemberList_nameWrapper__PtfFW",qu="MemberList_role__CCGch",Uu="MemberList_username__7eEwp",Fu="MemberList_currentUser__+pJ4s",zu="MemberList_stats__Bp02n",Bu="MemberList_level__IgcUw",Gu="MemberList_specialization__KZpTf",Wu="MemberList_memberActions__n7d6Z",Hu="MemberList_leaderNote__fcE7T",Vu="MemberList_promoteButton__pHTSX",Qu="MemberList_demoteButton__djUt3",Yu="MemberList_transferButton__ce1SG",Ku="MemberList_kickButton__ikXWX",Xu=e=>{let{members:t,leaderId:r,currentUserId:a,currentUserRole:i}=e;const{actions:o}=In(),[s,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(!1),u=e=>{switch(e){case"damage":return"\ud83d\udd25";case"tank":return"\ud83d\udee1\ufe0f";case"support":return"\u2728";case"control":return"\ud83c\udf00";case"healer":return"\ud83d\udc9a";default:return"\ud83d\udcca"}},p=e=>{switch(e){case"damage":return"\u0423\u0440\u043e\u043d";case"tank":return"\u0417\u0430\u0449\u0438\u0442\u0430";case"support":return"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430";case"control":return"\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u044c";case"healer":return"\u041b\u0435\u0447\u0435\u043d\u0438\u0435";default:return"\u0423\u043d\u0438\u0432\u0435\u0440\u0441\u0430\u043b"}},h=e=>"leader"===i||"officer"===i&&"member"===e.role;return(0,Cn.jsx)("div",{className:Ru,children:t.map((e=>{const t=(e=>{switch(e){case"leader":return{icon:"\ud83d\udc51",name:"\u041b\u0438\u0434\u0435\u0440"};case"officer":return{icon:"\u2694\ufe0f",name:"\u041e\u0444\u0438\u0446\u0435\u0440"};default:return{icon:"\ud83d\udc64",name:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a"}}})(e.role),n=e.userId===r,m=e.userId===a,f=h(e)&&!m;return(0,Cn.jsxs)("div",{className:`${Pu} ${(null===s||void 0===s?void 0:s.userId)===e.userId?Lu:""}`,onClick:()=>l((null===s||void 0===s?void 0:s.userId)===e.userId?null:e),children:[(0,Cn.jsxs)("div",{className:$u,children:[(0,Cn.jsxs)("div",{className:Ou,children:[(0,Cn.jsx)("span",{className:qu,children:t.icon}),(0,Cn.jsxs)("span",{className:Uu,children:[e.user.username,m&&(0,Cn.jsx)("span",{className:Fu,children:" (\u0412\u044b)"})]})]}),(0,Cn.jsxs)("div",{className:zu,children:[(0,Cn.jsxs)("span",{className:Bu,children:["\u0423\u0440\u043e\u0432\u0435\u043d\u044c ",e.user.cultivationLevel]}),(0,Cn.jsxs)("span",{className:Gu,children:[u(e.specialization)," ",p(e.specialization)]})]})]}),(null===s||void 0===s?void 0:s.userId)===e.userId&&(0,Cn.jsxs)("div",{className:Wu,children:[n&&"leader"===i&&(0,Cn.jsx)("span",{className:Hu,children:"\u041b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b"}),"leader"===i&&!n&&"member"===e.role&&(0,Cn.jsx)(Mu,{className:Vu,onClick:()=>(async e=>{if("leader"===i)if("member"===e.role){d(!0);try{o.addNotification({message:`${e.user.username} \u043f\u043e\u0432\u044b\u0448\u0435\u043d \u0434\u043e \u041e\u0444\u0438\u0446\u0435\u0440\u0430`,type:"success"}),l(null)}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430:",t),o.addNotification({message:`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0432\u044b\u0441\u0438\u0442\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430: ${t.message}`,type:"error"})}finally{d(!1)}}else o.addNotification({message:"\u042d\u0442\u043e\u0442 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a \u0443\u0436\u0435 \u0438\u043c\u0435\u0435\u0442 \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u0443\u044e \u0440\u043e\u043b\u044c",type:"error"});else o.addNotification({message:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u0432\u044b\u0448\u0430\u0442\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432",type:"error"})})(e),disabled:c,children:"\u041f\u043e\u0432\u044b\u0441\u0438\u0442\u044c \u0434\u043e \u043e\u0444\u0438\u0446\u0435\u0440\u0430"}),"leader"===i&&"officer"===e.role&&(0,Cn.jsx)(Mu,{className:Qu,onClick:()=>(async e=>{if("leader"===i)if("officer"===e.role){d(!0);try{o.addNotification({message:`${e.user.username} \u043f\u043e\u043d\u0438\u0436\u0435\u043d \u0434\u043e \u043e\u0431\u044b\u0447\u043d\u043e\u0433\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430`,type:"success"}),l(null)}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043d\u0438\u0436\u0435\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430:",t),o.addNotification({message:`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043d\u0438\u0437\u0438\u0442\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430: ${t.message}`,type:"error"})}finally{d(!1)}}else o.addNotification({message:"\u042d\u0442\u043e\u0442 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a \u043d\u0435 \u0438\u043c\u0435\u0435\u0442 \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u043e\u0439 \u0440\u043e\u043b\u0438",type:"error"});else o.addNotification({message:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043f\u043e\u043d\u0438\u0436\u0430\u0442\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432",type:"error"})})(e),disabled:c,children:"\u041f\u043e\u043d\u0438\u0437\u0438\u0442\u044c \u0434\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430"}),"leader"===i&&!n&&(0,Cn.jsx)(Mu,{className:Yu,onClick:()=>(async e=>{if("leader"===i)if(e.userId!==r){if(window.confirm(`\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u043e ${e.user.username}?`)){d(!0);try{o.addNotification({message:`\u041b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e ${e.user.username}`,type:"success"}),l(null)}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435 \u043b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u0430:",t),o.addNotification({message:`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u043e: ${t.message}`,type:"error"})}finally{d(!1)}}}else o.addNotification({message:"\u0412\u044b \u0443\u0436\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0435\u0441\u044c \u043b\u0438\u0434\u0435\u0440\u043e\u043c \u0433\u0440\u0443\u043f\u043f\u044b",type:"error"});else o.addNotification({message:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u043e",type:"error"})})(e),disabled:c,children:"\u041f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u043b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u043e"}),f&&(0,Cn.jsx)(Mu,{className:Ku,onClick:()=>(async e=>{if(h(e))if(e.userId!==r){if(window.confirm(`\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c ${e.user.username} \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b?`)){d(!0);try{o.addNotification({message:`${e.user.username} \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b`,type:"success"}),l(null)}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430:",t),o.addNotification({message:`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430: ${t.message}`,type:"error"})}finally{d(!1)}}}else o.addNotification({message:"\u041d\u0435\u043b\u044c\u0437\u044f \u0438\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043b\u0438\u0434\u0435\u0440\u0430 \u0433\u0440\u0443\u043f\u043f\u044b",type:"error"});else o.addNotification({message:"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u043f\u0440\u0430\u0432 \u0434\u043b\u044f \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u044d\u0442\u043e\u0433\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430",type:"error"})})(e),disabled:c,children:"\u0418\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0438\u0437 \u0433\u0440\u0443\u043f\u043f\u044b"})]})]},e.userId)}))})},Ju="ActivityList_activityList__g-7yG",Zu="ActivityList_title__tNBfN",ep="ActivityList_emptyMessage__iDzea",tp="ActivityList_list__UCNEd",rp="ActivityList_activityItem__Rmjuh",np="ActivityList_selected__p0BPZ",ap="ActivityList_header__CGfRY",ip="ActivityList_nameContainer__1etHj",op="ActivityList_typeIcon__2Ijha",sp="ActivityList_name__qt419",lp="ActivityList_difficulty__F96xX",cp="ActivityList_difficultyEasy__hG+1I",dp="ActivityList_difficultyMedium__eKpOe",up="ActivityList_difficultyHard__9JAV9",pp="ActivityList_difficultyExtreme__QTz6A",hp="ActivityList_difficultyLegendary__GG5Jp",mp="ActivityList_typeName__t-kFo",fp="ActivityList_infoRow__eAhax",yp="ActivityList_label__DN5OZ",gp="ActivityList_value__6QugU",vp="ActivityList_location__PCdvB",xp="ActivityList_locationIcon__EOQkA",bp="ActivityList_locationName__-AUcJ",wp=e=>{let{activities:t=[],selectedActivity:r,onSelectActivity:n}=e;const a=Array.isArray(t)?t:[],i=e=>{switch(e){case"raid":return"\ud83c\udff0";case"hunt":return"\ud83c\udff9";case"expedition":return"\ud83e\udded";case"tournament":return"\ud83c\udfc6";case"caravan":return"\ud83d\udc2a";case"tribulation":return"\u26a1";case"craft":return"\u2692\ufe0f";default:return"\ud83d\udcdc"}},o=e=>{switch(e){case"raid":return"\u0420\u0435\u0439\u0434";case"hunt":return"\u041e\u0445\u043e\u0442\u0430";case"expedition":return"\u042d\u043a\u0441\u043f\u0435\u0434\u0438\u0446\u0438\u044f";case"tournament":return"\u0422\u0443\u0440\u043d\u0438\u0440";case"caravan":return"\u041a\u0430\u0440\u0430\u0432\u0430\u043d";case"tribulation":return"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u0441\u0442\u0438\u0445\u0438\u0438";case"craft":return"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u0430";default:return"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}},s=e=>{switch(e){case"easy":return"\u041b\u0435\u0433\u043a\u0430\u044f";case"medium":return"\u0421\u0440\u0435\u0434\u043d\u044f\u044f";case"hard":return"\u0422\u044f\u0436\u0435\u043b\u0430\u044f";case"extreme":return"\u042d\u043a\u0441\u0442\u0440\u0435\u043c\u0430\u043b\u044c\u043d\u0430\u044f";case"legendary":return"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u0430\u044f";default:return"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c"}},l=e=>{switch(e){case"easy":return cp;case"medium":return dp;case"hard":return up;case"extreme":return pp;case"legendary":return hp;default:return""}};return(0,Cn.jsxs)("div",{className:Ju,children:[(0,Cn.jsx)("h3",{className:Zu,children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438"}),0===a.length?(0,Cn.jsx)("div",{className:ep,children:"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439 \u0434\u043b\u044f \u0432\u0430\u0448\u0435\u0439 \u0433\u0440\u0443\u043f\u043f\u044b."}):(0,Cn.jsx)("ul",{className:tp,children:a.map((e=>(0,Cn.jsxs)("li",{className:`${rp} ${(null===r||void 0===r?void 0:r.id)===e.id?np:""}`,onClick:()=>n(e),children:[(0,Cn.jsxs)("div",{className:ap,children:[(0,Cn.jsxs)("div",{className:ip,children:[(0,Cn.jsx)("span",{className:op,children:i(e.type)}),(0,Cn.jsx)("h4",{className:sp,children:e.name})]}),(0,Cn.jsx)("span",{className:`${lp} ${l(e.difficulty)}`,children:s(e.difficulty)})]}),(0,Cn.jsx)("div",{className:mp,children:o(e.type)}),(0,Cn.jsxs)("div",{className:fp,children:[(0,Cn.jsx)("span",{className:yp,children:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438:"}),(0,Cn.jsxs)("span",{className:gp,children:[e.minParticipants||1,"-",e.maxParticipants||5]})]}),(0,Cn.jsxs)("div",{className:fp,children:[(0,Cn.jsx)("span",{className:yp,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c:"}),(0,Cn.jsxs)("span",{className:gp,children:[e.minCultivationLevel||1,"+ (\u0440\u0435\u043a. ",e.recommendedCultivationLevel||e.minCultivationLevel||1,"+)"]})]}),(0,Cn.jsxs)("div",{className:fp,children:[(0,Cn.jsx)("span",{className:yp,children:"\u0414\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsxs)("span",{className:gp,children:[e.duration||30," \u043c\u0438\u043d."]})]}),e.location&&(0,Cn.jsxs)("div",{className:vp,children:[(0,Cn.jsx)("span",{className:xp,children:"\ud83d\udccd"}),(0,Cn.jsx)("span",{className:bp,children:e.location})]})]},e.id)))})]})},_p="ActivityDetails_activityDetails__lPd3A",Ep="ActivityDetails_header__W-Yef",Tp="ActivityDetails_title__NGfJC",Sp="ActivityDetails_type__Mokkj",jp="ActivityDetails_description__tuy8z",Cp="ActivityDetails_section__FsKCq",kp="ActivityDetails_sectionTitle__ucBa1",Ip="ActivityDetails_infoGrid__CAHD2",Ap="ActivityDetails_infoItem__LumtD",Np="ActivityDetails_label__a8i8R",Dp="ActivityDetails_value__OttgP",Mp="ActivityDetails_warning__CmWBf",Rp="ActivityDetails_difficultySelector__wrAAN",Pp="ActivityDetails_diffButton__FuX4C",Lp="ActivityDetails_selected__x+Rnb",$p="ActivityDetails_difficultyEasy__Rvt2t",Op="ActivityDetails_difficultyMedium__aZXig",qp="ActivityDetails_difficultyHard__HoZ-e",Up="ActivityDetails_difficultyExtreme__kTtIC",Fp="ActivityDetails_difficultyLegendary__8RO1x",zp="ActivityDetails_legendaryWarning__i8FDD",Bp="ActivityDetails_optionGroup__p8v1T",Gp="ActivityDetails_checkboxLabel__9Ee9N",Wp="ActivityDetails_radioLabel__Sidgb",Hp="ActivityDetails_checkboxText__YRLFs",Vp="ActivityDetails_radioText__XBLCT",Qp="ActivityDetails_rewards__lKKF5",Yp="ActivityDetails_rewardsList__uca2o",Kp="ActivityDetails_rewardItem__mbJKR",Xp="ActivityDetails_rewardIcon__DgD7J",Jp="ActivityDetails_rewardName__OqqU9",Zp="ActivityDetails_rewardBonus__e7Kql",eh="ActivityDetails_actions__bDWOI",th="ActivityDetails_createButton__zuMaM",rh="ActivityDetails_startButton__nQ3AU",nh="ActivityDetails_permissionMessage__OFpqF",ah="ActivityDetails_createdActivity__pDXZk",ih="ActivityDetails_createdInfo__uJvJb",oh="ActivityDetails_createdLabel__NoIPS",sh="ActivityDetails_createdValue__XLggK",lh=e=>{var t,r,a,i,o,s;let{activity:l,group:c,onCreateActivityInstance:d,onStartActivity:u,canManageActivities:p}=e;const{state:h}=Nn(),[m,f]=(0,n.useState)("medium"),[y,g]=(0,n.useState)({}),[v,x]=(0,n.useState)(!1),[b,w]=(0,n.useState)(null),_={easy:"\u041b\u0435\u0433\u043a\u0430\u044f",medium:"\u0421\u0440\u0435\u0434\u043d\u044f\u044f",hard:"\u0422\u044f\u0436\u0435\u043b\u0430\u044f",extreme:"\u042d\u043a\u0441\u0442\u0440\u0435\u043c\u0430\u043b\u044c\u043d\u0430\u044f",legendary:"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u0430\u044f"},E={raid:"\u0420\u0435\u0439\u0434",hunt:"\u041e\u0445\u043e\u0442\u0430",expedition:"\u042d\u043a\u0441\u043f\u0435\u0434\u0438\u0446\u0438\u044f",tournament:"\u0422\u0443\u0440\u043d\u0438\u0440",caravan:"\u041a\u0430\u0440\u0430\u0432\u0430\u043d",tribulation:"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u0441\u0442\u0438\u0445\u0438\u0438",craft:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u0430"},T=e=>{switch(e){case"easy":return $p;case"medium":return Op;case"hard":return qp;case"extreme":return Up;case"legendary":return Fp;default:return""}},S=()=>{const e=c.members.length>=l.minParticipants,t=c.members.every((e=>e.user.cultivationLevel>=l.minCultivationLevel)),r=c.activityInstances&&c.activityInstances.some((e=>e.activityId===l.id&&("preparing"===e.status||"in_progress"===e.status))),n="legendary"!==m||c.members.every((e=>e.user.cultivationLevel>=6));return e&&t&&!r&&n};return(0,Cn.jsxs)("div",{className:_p,children:[(0,Cn.jsxs)("div",{className:Ep,children:[(0,Cn.jsx)("h3",{className:Tp,children:l.name}),(0,Cn.jsx)("div",{className:Sp,children:E[l.type]||l.type})]}),(0,Cn.jsx)("div",{className:jp,children:l.description}),(0,Cn.jsxs)("div",{className:Cp,children:[(0,Cn.jsx)("h4",{className:kp,children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438"}),(0,Cn.jsxs)("div",{className:Ip,children:[(0,Cn.jsxs)("div",{className:Ap,children:[(0,Cn.jsx)("span",{className:Np,children:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438:"}),(0,Cn.jsxs)("span",{className:Dp,children:[l.minParticipants,"-",l.maxParticipants,c.members.length<l.minParticipants&&(0,Cn.jsx)("span",{className:Mp,children:"\u26a0\ufe0f \u0412 \u0433\u0440\u0443\u043f\u043f\u0435 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"})]})]}),(0,Cn.jsxs)("div",{className:Ap,children:[(0,Cn.jsx)("span",{className:Np,children:"\u041c\u0438\u043d. \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438:"}),(0,Cn.jsxs)("span",{className:Dp,children:[l.minCultivationLevel,!c.members.every((e=>e.user.cultivationLevel>=l.minCultivationLevel))&&(0,Cn.jsx)("span",{className:Mp,children:"\u26a0\ufe0f \u041d\u0435 \u0432\u0441\u0435 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u043c"})]})]}),(0,Cn.jsxs)("div",{className:Ap,children:[(0,Cn.jsx)("span",{className:Np,children:"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsxs)("span",{className:Dp,children:[l.duration," \u043c\u0438\u043d."]})]}),(0,Cn.jsxs)("div",{className:Ap,children:[(0,Cn.jsx)("span",{className:Np,children:"\u041f\u0435\u0440\u0435\u0437\u0430\u0440\u044f\u0434\u043a\u0430:"}),(0,Cn.jsx)("span",{className:Dp,children:l.cooldown>=1440?`${Math.floor(l.cooldown/1440)} \u0434\u043d.`:l.cooldown>=60?`${Math.floor(l.cooldown/60)} \u0447.`:`${l.cooldown} \u043c\u0438\u043d.`})]}),l.location&&(0,Cn.jsxs)("div",{className:Ap,children:[(0,Cn.jsx)("span",{className:Np,children:"\u041b\u043e\u043a\u0430\u0446\u0438\u044f:"}),(0,Cn.jsx)("span",{className:Dp,children:l.location})]})]})]}),b?(0,Cn.jsxs)("div",{className:Cp,children:[(0,Cn.jsx)("h4",{className:kp,children:"\u0421\u043e\u0437\u0434\u0430\u043d\u043d\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),(0,Cn.jsxs)("div",{className:ah,children:[(0,Cn.jsxs)("div",{className:ih,children:[(0,Cn.jsx)("span",{className:oh,children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)("span",{className:sh,children:E[l.type]||l.type})]}),(0,Cn.jsxs)("div",{className:ih,children:[(0,Cn.jsx)("span",{className:oh,children:"\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:`${sh} ${T(b.difficulty)}`,children:_[b.difficulty]||b.difficulty})]}),(0,Cn.jsxs)("div",{className:ih,children:[(0,Cn.jsx)("span",{className:oh,children:"\u0421\u0442\u0430\u0442\u0443\u0441:"}),(0,Cn.jsx)("span",{className:sh,children:"preparing"===b.status?"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430":"in_progress"===b.status?"\u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435":"completed"===b.status?"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430":"failed"===b.status?"\u041f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u0430":"\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u0430"})]}),(0,Cn.jsxs)("div",{className:ih,children:[(0,Cn.jsx)("span",{className:oh,children:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438:"}),(0,Cn.jsx)("span",{className:sh,children:b.participants.length})]})]}),(0,Cn.jsxs)("div",{className:eh,children:[(0,Cn.jsx)(Mu,{onClick:async()=>{if(p&&b){x(!0);try{await u(b.id)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",e)}finally{x(!1)}}},disabled:!p||v||"preparing"!==b.status,className:rh,children:v?"\u0417\u0430\u043f\u0443\u0441\u043a...":"\u041d\u0430\u0447\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),"preparing"!==b.status&&(0,Cn.jsx)("div",{className:Mp,children:"\u042d\u0442\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0443\u0436\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430 \u0438\u043b\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"})]})]}):(0,Cn.jsxs)("div",{className:Cp,children:[(0,Cn.jsx)("h4",{className:kp,children:"\u0412\u044b\u0431\u043e\u0440 \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u0438"}),(0,Cn.jsx)("div",{className:Rp,children:["easy","medium","hard","extreme","legendary"].map((e=>(0,Cn.jsx)("button",{className:`${Pp} ${m===e?Lp:""} ${T(e)}`,onClick:()=>f(e),disabled:v,children:_[e]},e)))}),"legendary"===m&&(0,Cn.jsx)("div",{className:zp,children:"\u26a0\ufe0f \u0414\u043b\u044f \u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u043e\u0439 \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u0441\u0435 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u044b \u0438\u043c\u0435\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 6+"}),(()=>{switch(l.type){case"raid":return(0,Cn.jsx)("div",{className:Bp,children:(0,Cn.jsxs)("label",{className:Gp,children:[(0,Cn.jsx)("input",{type:"checkbox",checked:y.useTimeLimit||!1,onChange:e=>g({...y,useTimeLimit:e.target.checked}),disabled:v||null!==b}),(0,Cn.jsx)("span",{className:Hp,children:"\u041e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0435 \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 (\u0431\u043e\u043d\u0443\u0441 \u043a \u043d\u0430\u0433\u0440\u0430\u0434\u0430\u043c +20%)"})]})});case"hunt":return(0,Cn.jsx)("div",{className:Bp,children:(0,Cn.jsxs)("label",{className:Gp,children:[(0,Cn.jsx)("input",{type:"checkbox",checked:y.wildHunt||!1,onChange:e=>g({...y,wildHunt:e.target.checked}),disabled:v||null!==b}),(0,Cn.jsx)("span",{className:Hp,children:"\u0414\u0438\u043a\u0430\u044f \u043e\u0445\u043e\u0442\u0430 (\u0440\u0435\u0434\u043a\u0438\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0430, \u043f\u043e\u0432\u044b\u0448\u0435\u043d\u043d\u044b\u0439 \u0440\u0438\u0441\u043a)"})]})});case"expedition":return(0,Cn.jsxs)("div",{className:Bp,children:[(0,Cn.jsxs)("label",{className:Wp,children:[(0,Cn.jsx)("input",{type:"radio",name:"expeditionFocus",value:"combat",checked:"combat"===y.expeditionFocus,onChange:()=>g({...y,expeditionFocus:"combat"}),disabled:v||null!==b}),(0,Cn.jsx)("span",{className:Vp,children:"\u0411\u043e\u0435\u0432\u043e\u0439 \u0444\u043e\u043a\u0443\u0441 (\u0431\u043e\u043b\u044c\u0448\u0435 \u0441\u0440\u0430\u0436\u0435\u043d\u0438\u0439)"})]}),(0,Cn.jsxs)("label",{className:Wp,children:[(0,Cn.jsx)("input",{type:"radio",name:"expeditionFocus",value:"exploration",checked:"exploration"===y.expeditionFocus,onChange:()=>g({...y,expeditionFocus:"exploration"}),disabled:v||null!==b}),(0,Cn.jsx)("span",{className:Vp,children:"\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0444\u043e\u043a\u0443\u0441 (\u043f\u043e\u0438\u0441\u043a \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432)"})]})]});default:return null}})(),(0,Cn.jsxs)("div",{className:Qp,children:[(0,Cn.jsx)("h4",{className:kp,children:"\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 \u043d\u0430\u0433\u0440\u0430\u0434\u044b:"}),(0,Cn.jsxs)("div",{className:Yp,children:[(0,Cn.jsxs)("div",{className:Kp,children:[(0,Cn.jsx)("span",{className:Xp,children:"\ud83d\udd2e"}),(0,Cn.jsx)("span",{className:Jp,children:"\u041e\u043f\u044b\u0442 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"}),(0,Cn.jsxs)("span",{className:Zp,children:["easy"===m&&"-20%","hard"===m&&"+30%","extreme"===m&&"+70%","legendary"===m&&"+150%"]})]}),(null===(t=l.rewardStructure)||void 0===t||null===(r=t.resources)||void 0===r?void 0:r.length)>0&&(0,Cn.jsxs)("div",{className:Kp,children:[(0,Cn.jsx)("span",{className:Xp,children:"\ud83c\udf3f"}),(0,Cn.jsx)("span",{className:Jp,children:"\u0420\u0435\u0434\u043a\u0438\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b"}),(0,Cn.jsxs)("span",{className:Zp,children:["easy"===m&&"-20%","hard"===m&&"+30%","extreme"===m&&"+70%","legendary"===m&&"+150%"]})]}),(null===(a=l.rewardStructure)||void 0===a||null===(i=a.items)||void 0===i?void 0:i.length)>0&&(0,Cn.jsxs)("div",{className:Kp,children:[(0,Cn.jsx)("span",{className:Xp,children:"\ud83d\udce6"}),(0,Cn.jsx)("span",{className:Jp,children:"\u041f\u0440\u0435\u0434\u043c\u0435\u0442\u044b"}),(0,Cn.jsxs)("span",{className:Zp,children:["easy"===m&&"\u041e\u0431\u044b\u0447\u043d\u044b\u0435","medium"===m&&"\u041d\u0435\u043e\u0431\u044b\u0447\u043d\u044b\u0435","hard"===m&&"\u0420\u0435\u0434\u043a\u0438\u0435","extreme"===m&&"\u042d\u043f\u0438\u0447\u0435\u0441\u043a\u0438\u0435","legendary"===m&&"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0435"]})]}),(null===(o=l.rewardStructure)||void 0===o||null===(s=o.reputation)||void 0===s?void 0:s.length)>0&&(0,Cn.jsxs)("div",{className:Kp,children:[(0,Cn.jsx)("span",{className:Xp,children:"\ud83d\udc51"}),(0,Cn.jsx)("span",{className:Jp,children:"\u0420\u0435\u043f\u0443\u0442\u0430\u0446\u0438\u044f"}),(0,Cn.jsxs)("span",{className:Zp,children:["easy"===m&&"-20%","hard"===m&&"+30%","extreme"===m&&"+70%","legendary"===m&&"+150%"]})]})]})]}),(0,Cn.jsxs)("div",{className:eh,children:[(0,Cn.jsx)(Mu,{onClick:async()=>{if(p){x(!0);try{const e=await d(l.id,m,y);w(e)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",e)}finally{x(!1)}}},disabled:!p||v||!S(),className:th,children:v?"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),!p&&(0,Cn.jsx)("div",{className:nh,children:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438"}),p&&!S()&&(0,Cn.jsx)("div",{className:Mp,children:p?c.members.length<l.minParticipants?`\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u043c\u0438\u043d\u0438\u043c\u0443\u043c ${l.minParticipants} \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432`:c.members.every((e=>e.user.cultivationLevel>=l.minCultivationLevel))?"legendary"!==m||c.members.every((e=>e.user.cultivationLevel>=6))?c.activityInstances&&c.activityInstances.some((e=>e.activityId===l.id&&("preparing"===e.status||"in_progress"===e.status)))?"\u0423 \u0433\u0440\u0443\u043f\u043f\u044b \u0443\u0436\u0435 \u0435\u0441\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u044d\u0442\u043e\u0433\u043e \u0442\u0438\u043f\u0430":"":"\u0414\u043b\u044f \u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u043e\u0439 \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0432\u0441\u0435 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u044b \u0438\u043c\u0435\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c 6+":`\u0412\u0441\u0435 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u044b \u0438\u043c\u0435\u0442\u044c \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043d\u0435 \u043d\u0438\u0436\u0435 ${l.minCultivationLevel}`:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438"})]})]})]})},ch=nr.div`
  width: 100%;
  height: ${e=>e.height||"10px"};
  background-color: ${e=>e.backgroundColor||"rgba(0, 0, 0, 0.2)"};
  border-radius: ${e=>e.height?parseInt(e.height)/2+"px":"5px"};
  overflow: hidden;
  margin: ${e=>e.margin||"0"};
  box-shadow: ${e=>e.showShadow?"inset 0 1px 3px rgba(0, 0, 0, 0.2)":"none"};
  position: relative;
`,dh=nr.div`
  height: 100%;
  width: ${e=>Math.min(Math.max(e.progress,0),100)}%;
  background-color: ${e=>e.color?e.color:e.progress<25?"#c43b3b":e.progress<50?"#c49b3b":e.progress<75?"#8bc43b":"#4a8f52"};
  transition: width 0.3s ease, background-color 0.3s ease;
  border-radius: ${e=>e.height?parseInt(e.height)/2+"px":"5px"};
  
  /*       */
  background-image: ${e=>e.gradient?"linear-gradient(to right, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.3))":"none"};
  
  /*    hover */
  position: relative;
  overflow: hidden;
  
  &::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%);
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  
  ${e=>e.interactive&&"\n    &:hover::after {\n      opacity: 0.8;\n    }\n  "}
`,uh=nr.div`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: ${e=>e.labelColor||"#fff"};
  font-size: ${e=>e.labelSize||"12px"};
  font-weight: bold;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.7);
  z-index: 1;
  white-space: nowrap;
`,ph=nr.div`
  display: flex;
  justify-content: space-between;
  margin-top: 5px;
`,hh=nr.div`
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background-color: ${e=>e.active?"#d4af37":"rgba(150, 150, 150, 0.3)"};
  transition: background-color 0.3s ease;
  position: relative;
  
  &::after {
    content: '${e=>e.stage}';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    font-size: 10px;
    color: rgba(255, 255, 255, 0.7);
    margin-top: 3px;
  }
`,mh=e=>{let{progress:t=0,color:r,height:n="10px",backgroundColor:a,showLabel:i=!1,labelText:o,labelColor:s,labelSize:l,margin:c,showShadow:d=!0,gradient:u=!0,interactive:p=!1,stages:h=0,currentStage:m=0,className:f}=e;const y=o||`${Math.round(t)}%`;return(0,Cn.jsxs)("div",{className:f,children:[(0,Cn.jsxs)(ch,{height:n,backgroundColor:a,margin:c,showShadow:d,children:[(0,Cn.jsx)(dh,{progress:t,color:r,height:n,gradient:u,interactive:p}),i&&(0,Cn.jsx)(uh,{labelColor:s,labelSize:l,children:y})]}),h>0&&(0,Cn.jsx)(ph,{children:Array.from({length:h},((e,t)=>(0,Cn.jsx)(hh,{active:t<m,stage:t+1},t)))})]})},fh={activityInstance:"ActivityInstance_activityInstance__a+F8w",header:"ActivityInstance_header__x1z+t",titleContainer:"ActivityInstance_titleContainer__8v1DX",typeIcon:"ActivityInstance_typeIcon__AKIDR",title:"ActivityInstance_title__I+9xO",status:"ActivityInstance_status__i-sSD",statusPreparing:"ActivityInstance_statusPreparing__aiMQM",statusInProgress:"ActivityInstance_statusInProgress__Hy4LG",statusCompleted:"ActivityInstance_statusCompleted__ChauF",statusFailed:"ActivityInstance_statusFailed__mAoNj",statusAbandoned:"ActivityInstance_statusAbandoned__TlxHw",infoSection:"ActivityInstance_infoSection__7Szyr",infoGrid:"ActivityInstance_infoGrid__ud8V1",infoItem:"ActivityInstance_infoItem__wXl37",label:"ActivityInstance_label__lX1mp",value:"ActivityInstance_value__B9Zy1",difficultyEasy:"ActivityInstance_difficultyEasy__-5odU",difficultyMedium:"ActivityInstance_difficultyMedium__endXn",difficultyHard:"ActivityInstance_difficultyHard__C-juo",difficultyExtreme:"ActivityInstance_difficultyExtreme__Czcl2",difficultyLegendary:"ActivityInstance_difficultyLegendary__d8aUJ",progressContainer:"ActivityInstance_progressContainer__tQUKu",progressBar:"ActivityInstance_progressBar__ZlDB-",progressBarFill:"ActivityInstance_progressBarFill__jk-f-",progressText:"ActivityInstance_progressText__puFdS",error:"ActivityInstance_error__2LkVR",preparingMessage:"ActivityInstance_preparingMessage__ZMQhj",eventSection:"ActivityInstance_eventSection__N+vfu",eventTitle:"ActivityInstance_eventTitle__InZau",eventDescription:"ActivityInstance_eventDescription__RANU8",eventOptions:"ActivityInstance_eventOptions__1bjZE",optionButton:"ActivityInstance_optionButton__rrDhH",eventResult:"ActivityInstance_eventResult__gijps",resultTitle:"ActivityInstance_resultTitle__FveH6",success:"ActivityInstance_success__B0yGT",failure:"ActivityInstance_failure__C7DX-",resultDescription:"ActivityInstance_resultDescription__9DTJY",resultRewards:"ActivityInstance_resultRewards__psihj",resultPenalties:"ActivityInstance_resultPenalties__nc31q",rewardsTitle:"ActivityInstance_rewardsTitle__fA4hk",penaltiesTitle:"ActivityInstance_penaltiesTitle__Jj3i+",rewardsList:"ActivityInstance_rewardsList__Sx8S8",penaltiesList:"ActivityInstance_penaltiesList__ahu62",rewardItem:"ActivityInstance_rewardItem__+B22O",penaltyItem:"ActivityInstance_penaltyItem__AbvHT",rewardIcon:"ActivityInstance_rewardIcon__uBCSB",penaltyIcon:"ActivityInstance_penaltyIcon__S5A4U",rewardName:"ActivityInstance_rewardName__t7KAk",penaltyName:"ActivityInstance_penaltyName__uGDBO",rewardValue:"ActivityInstance_rewardValue__GDEhA",penaltyValue:"ActivityInstance_penaltyValue__PiGp-",nextButton:"ActivityInstance_nextButton__tR9Tj",actionsSection:"ActivityInstance_actionsSection__mNG+W",startButton:"ActivityInstance_startButton__jTbh1",failButton:"ActivityInstance_failButton__Rs4aC",abandonButton:"ActivityInstance_abandonButton__Xo-hj",closeButton:"ActivityInstance_closeButton__aSAe7",resultSection:"ActivityInstance_resultSection__FOs2y",noRewards:"ActivityInstance_noRewards__a7vHF",failReason:"ActivityInstance_failReason__yCJr9",loading:"ActivityInstance_loading__u+6sa"},yh=e=>{var t,r,a,i;let{instance:o,onComplete:s}=e;const{state:l,actions:c}=Nn(),{user:d}=l.player,[u,p]=(0,n.useState)(!1),[h,m]=(0,n.useState)(null),[f,y]=(0,n.useState)(null),[g,v]=(0,n.useState)(null),x=Array.isArray(null===o||void 0===o?void 0:o.participants)?o.participants:[],b=(null===(t=x.find((e=>e.userId===(null===d||void 0===d?void 0:d.id))))||void 0===t?void 0:t.role)||"member",w="leader"===b||"officer"===b,_=e=>{switch(e){case"raid":return"\ud83c\udff0";case"hunt":return"\ud83c\udff9";case"expedition":return"\ud83e\udded";case"tournament":return"\ud83c\udfc6";case"caravan":return"\ud83d\udc2a";case"tribulation":return"\u26a1";case"craft":return"\u2692\ufe0f";default:return"\ud83d\udcdc"}},E=e=>{switch(e){case"raid":return"\u0420\u0435\u0439\u0434";case"hunt":return"\u041e\u0445\u043e\u0442\u0430";case"expedition":return"\u042d\u043a\u0441\u043f\u0435\u0434\u0438\u0446\u0438\u044f";case"tournament":return"\u0422\u0443\u0440\u043d\u0438\u0440";case"caravan":return"\u041a\u0430\u0440\u0430\u0432\u0430\u043d";case"tribulation":return"\u0418\u0441\u043f\u044b\u0442\u0430\u043d\u0438\u0435 \u0441\u0442\u0438\u0445\u0438\u0438";case"craft":return"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u0430";default:return"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}},T=e=>{switch(e){case"easy":return"\u041b\u0435\u0433\u043a\u0430\u044f";case"medium":return"\u0421\u0440\u0435\u0434\u043d\u044f\u044f";case"hard":return"\u0422\u044f\u0436\u0435\u043b\u0430\u044f";case"extreme":return"\u042d\u043a\u0441\u0442\u0440\u0435\u043c\u0430\u043b\u044c\u043d\u0430\u044f";case"legendary":return"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u0430\u044f";default:return"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c"}},S=e=>{switch(e){case"easy":return fh.difficultyEasy;case"medium":return fh.difficultyMedium;case"hard":return fh.difficultyHard;case"extreme":return fh.difficultyExtreme;case"legendary":return fh.difficultyLegendary;default:return""}};(0,n.useEffect)((()=>{"in_progress"!==(null===o||void 0===o?void 0:o.status)||f||g||j()}),[null===o||void 0===o?void 0:o.currentStage,null===o||void 0===o?void 0:o.status]);const j=()=>{var e;const t=(null===o||void 0===o||null===(e=o.activityType)||void 0===e?void 0:e.type)||"generic",r=(null===o||void 0===o?void 0:o.currentStage)||1,n=C(t,r),a=Math.floor(Math.random()*n.length);y(n[a]),v(null)},C=(e,t)=>{var r;return(null===(r={raid:{1:[{id:"scout",title:"\u0420\u0430\u0437\u0432\u0435\u0434\u043a\u0430 \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438",description:"\u041f\u0435\u0440\u0435\u0434 \u0432\u0430\u043c\u0438 \u0440\u0430\u0441\u043a\u0438\u043d\u0443\u043b\u0441\u044f \u0434\u0440\u0435\u0432\u043d\u0438\u0439 \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441. \u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0445 \u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u044f\u0445 \u0438 \u0441\u043e\u043a\u0440\u043e\u0432\u0438\u0449\u0430\u0445.",options:["\u041e\u0441\u0442\u043e\u0440\u043e\u0436\u043d\u043e\u0435 \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0435","\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0437\u0432\u0435\u0434\u0447\u0438\u043a\u0430","\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0435 \u0432\u043e\u0441\u043f\u0440\u0438\u044f\u0442\u0438\u0435"]},{id:"entrance",title:"\u0412\u0445\u043e\u0434 \u0432 \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441",description:"\u0412\u044b \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0445 \u043f\u0443\u0442\u0435\u0439 \u0432\u043d\u0443\u0442\u0440\u044c \u0434\u0440\u0435\u0432\u043d\u0435\u0433\u043e \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u0430.",options:["\u0413\u043b\u0430\u0432\u043d\u044b\u0439 \u0432\u0445\u043e\u0434","\u0421\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043f\u0440\u043e\u0445\u043e\u0434","\u041f\u0440\u043e\u0431\u0438\u0442\u044c \u0441\u0442\u0435\u043d\u0443 \u0441\u0438\u043b\u043e\u0439"]}],2:[{id:"encounter",title:"\u041f\u0435\u0440\u0432\u043e\u0435 \u0441\u0442\u043e\u043b\u043a\u043d\u043e\u0432\u0435\u043d\u0438\u0435",description:"\u041d\u0430 \u043f\u0443\u0442\u0438 \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0433\u0440\u0443\u043f\u043f\u0430 \u0441\u0442\u0440\u0430\u0436\u0435\u0439 \u0434\u0440\u0435\u0432\u043d\u0435\u0433\u043e \u043a\u043e\u043c\u043f\u043b\u0435\u043a\u0441\u0430!",options:["\u0410\u0442\u0430\u043a\u043e\u0432\u0430\u0442\u044c \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e","\u041f\u043e\u043f\u044b\u0442\u0430\u0442\u044c\u0441\u044f \u043e\u0431\u043e\u0439\u0442\u0438","\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0434\u043e\u0433\u043e\u0432\u043e\u0440\u0438\u0442\u044c\u0441\u044f"]},{id:"trap",title:"\u0414\u0440\u0435\u0432\u043d\u044f\u044f \u043b\u043e\u0432\u0443\u0448\u043a\u0430",description:"\u041f\u0440\u043e\u0445\u043e\u0434\u044f \u043f\u043e \u043a\u043e\u0440\u0438\u0434\u043e\u0440\u0443, \u0432\u044b \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043b\u0438 \u0434\u0440\u0435\u0432\u043d\u044e\u044e \u043b\u043e\u0432\u0443\u0448\u043a\u0443.",options:["\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0435\u0445\u043d\u0438\u043a\u043e\u0439","\u0423\u043a\u043b\u043e\u043d\u0438\u0442\u044c\u0441\u044f","\u041f\u043e\u0436\u0435\u0440\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0441\u0443\u0440\u0441\u0430\u043c\u0438 \u0434\u043b\u044f \u043d\u0435\u0439\u0442\u0440\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438"]}],3:[{id:"treasure",title:"\u0421\u043e\u043a\u0440\u043e\u0432\u0438\u0449\u043d\u0438\u0446\u0430",description:"\u0412\u044b \u043d\u0430\u0448\u043b\u0438 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435 \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u043e\u0432, \u043d\u043e \u043e\u043d\u043e \u043e\u0445\u0440\u0430\u043d\u044f\u0435\u0442\u0441\u044f \u043c\u043e\u0449\u043d\u044b\u043c\u0438 \u043f\u0435\u0447\u0430\u0442\u044f\u043c\u0438.",options:["\u0412\u0437\u043b\u043e\u043c\u0430\u0442\u044c \u043f\u0435\u0447\u0430\u0442\u0438","\u0418\u0441\u043a\u0430\u0442\u044c \u043e\u0431\u0445\u043e\u0434\u043d\u043e\u0439 \u043f\u0443\u0442\u044c","\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u043a\u043b\u044e\u0447"]}]},hunt:{1:[{id:"track",title:"\u041f\u043e\u0438\u0441\u043a \u0441\u043b\u0435\u0434\u043e\u0432",description:"\u0412\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u043d\u0430\u0439\u0442\u0438 \u0441\u043b\u0435\u0434\u044b \u0440\u0435\u0434\u043a\u043e\u0433\u043e \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0433\u043e \u0437\u0432\u0435\u0440\u044f.",options:["\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u044c \u043e\u043a\u0440\u0435\u0441\u0442\u043d\u043e\u0441\u0442\u0438","\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u0438\u043c\u0430\u043d\u043a\u0443","\u0421\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u0443 \u043c\u0435\u0441\u0442\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439"]}]},expedition:{1:[{id:"path",title:"\u0412\u044b\u0431\u043e\u0440 \u043f\u0443\u0442\u0438",description:"\u041f\u0435\u0440\u0435\u0434 \u0432\u0430\u043c\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0445 \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u043e\u0432 \u044d\u043a\u0441\u043f\u0435\u0434\u0438\u0446\u0438\u0438.",options:["\u0413\u043e\u0440\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0432\u0430\u043b","\u041b\u0435\u0441\u043d\u0430\u044f \u0442\u0440\u043e\u043f\u0430","\u041f\u043e\u0434\u0437\u0435\u043c\u043d\u044b\u0435 \u0442\u0443\u043d\u043d\u0435\u043b\u0438"]}]}}[e])||void 0===r?void 0:r[t])||[{id:"generic",title:`\u042d\u0442\u0430\u043f ${t}`,description:`\u0412\u0430\u0448\u0430 \u0433\u0440\u0443\u043f\u043f\u0430 \u043f\u0440\u043e\u0434\u0432\u0438\u0433\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u044d\u0442\u0430\u043f ${t} \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438.`,options:["\u0414\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u043e\u0441\u0442\u043e\u0440\u043e\u0436\u043d\u043e","\u0414\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0448\u0438\u0442\u0435\u043b\u044c\u043d\u043e","\u0418\u043c\u043f\u0440\u043e\u0432\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c"]}]},k=()=>[{type:"experience",value:Math.floor(100*Math.random())+50},{type:"resource",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0440\u0438\u0441\u0442\u0430\u043b\u043b",quantity:Math.floor(3*Math.random())+1}],I=()=>[{type:"health",value:Math.floor(20*Math.random())+10},{type:"energy",value:Math.floor(30*Math.random())+15}],A=async()=>{if("leader"===b){if(window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u044d\u0442\u0443 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c? \u042d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043b\u044c\u0437\u044f \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c.")){p(!0),m(null);try{const e="\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u043e \u043b\u0438\u0434\u0435\u0440\u043e\u043c \u0433\u0440\u0443\u043f\u043f\u044b";await c.dispatch(((e,t,r)=>async n=>{try{const a=await iu.abandonActivity(e,t,r);return n({type:Yr.UPDATE_ACTIVITY_INSTANCE,payload:a}),a}catch(h){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043c\u0435\u043d\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",h),h}})(o.id,e,d.id)),s&&s()}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043c\u0435\u043d\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",e),m(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c: ${e.message}`)}finally{p(!1)}}}else c.addNotification({message:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c",type:"error"})};var N,D,M,R,P,L,$,O;return"preparing"===(null===o||void 0===o?void 0:o.status)?(0,Cn.jsxs)("div",{className:fh.activityInstance,children:[(0,Cn.jsx)("div",{className:fh.header,children:(0,Cn.jsxs)("div",{className:fh.titleContainer,children:[(0,Cn.jsx)("span",{className:fh.typeIcon,children:_(null===(N=o.activityType)||void 0===N?void 0:N.type)}),(0,Cn.jsx)("h3",{className:fh.title,children:(null===(D=o.activityType)||void 0===D?void 0:D.name)||"\u0413\u0440\u0443\u043f\u043f\u043e\u0432\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),(0,Cn.jsx)("span",{className:`${fh.status} ${fh.statusPreparing}`,children:"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430"})]})}),(0,Cn.jsx)("div",{className:fh.infoSection,children:(0,Cn.jsxs)("div",{className:fh.infoGrid,children:[(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)("span",{className:fh.value,children:E(null===(M=o.activityType)||void 0===M?void 0:M.type)})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:`${fh.value} ${S(o.difficulty)}`,children:T(o.difficulty)})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u042d\u0442\u0430\u043f\u044b:"}),(0,Cn.jsx)("span",{className:fh.value,children:o.totalStages||3})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438:"}),(0,Cn.jsx)("span",{className:fh.value,children:x.length})]})]})}),(0,Cn.jsx)("div",{className:fh.preparingMessage,children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d\u0430 \u0438 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u043a\u0430. \u041b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0433\u0443\u0442 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c."}),h&&(0,Cn.jsx)("div",{className:fh.error,children:h}),(0,Cn.jsxs)("div",{className:fh.actions,children:[w&&(0,Cn.jsx)(Mu,{onClick:()=>c.dispatch(du(o.id,d.id)),disabled:u,className:fh.startButton,children:u?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":"\u041d\u0430\u0447\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),"leader"===b&&(0,Cn.jsx)(Mu,{onClick:A,disabled:u,className:fh.abandonButton,children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"})]})]}):"completed"===(null===o||void 0===o?void 0:o.status)||"failed"===(null===o||void 0===o?void 0:o.status)||"abandoned"===(null===o||void 0===o?void 0:o.status)?(0,Cn.jsxs)("div",{className:fh.activityInstance,children:[(0,Cn.jsx)("div",{className:fh.header,children:(0,Cn.jsxs)("div",{className:fh.titleContainer,children:[(0,Cn.jsx)("span",{className:fh.typeIcon,children:_(null===(R=o.activityType)||void 0===R?void 0:R.type)}),(0,Cn.jsx)("h3",{className:fh.title,children:(null===(P=o.activityType)||void 0===P?void 0:P.name)||"\u0413\u0440\u0443\u043f\u043f\u043e\u0432\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),"completed"===o.status&&(0,Cn.jsx)("span",{className:`${fh.status} ${fh.statusCompleted}`,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"}),"failed"===o.status&&(0,Cn.jsx)("span",{className:`${fh.status} ${fh.statusFailed}`,children:"\u041f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u0430"}),"abandoned"===o.status&&(0,Cn.jsx)("span",{className:`${fh.status} ${fh.statusAbandoned}`,children:"\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u0430"})]})}),(0,Cn.jsx)("div",{className:fh.infoSection,children:(0,Cn.jsxs)("div",{className:fh.infoGrid,children:[(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)("span",{className:fh.value,children:E(null===(L=o.activityType)||void 0===L?void 0:L.type)})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:`${fh.value} ${S(o.difficulty)}`,children:T(o.difficulty)})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u041d\u0430\u0447\u0430\u043b\u043e:"}),(0,Cn.jsx)("span",{className:fh.value,children:o.startedAt?new Date(o.startedAt).toLocaleString():"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435:"}),(0,Cn.jsx)("span",{className:fh.value,children:o.completedAt?new Date(o.completedAt).toLocaleString():"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"})]})]})}),"completed"===o.status&&(0,Cn.jsxs)("div",{className:fh.resultSection,children:[(0,Cn.jsx)("h4",{className:fh.resultTitle,children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430!"}),Array.isArray(o.rewards)&&o.rewards.length>0?(0,Cn.jsxs)("div",{className:fh.rewardsList,children:[(0,Cn.jsx)("h5",{className:fh.rewardsTitle,children:"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0435 \u043d\u0430\u0433\u0440\u0430\u0434\u044b:"}),o.rewards.map((e=>(0,Cn.jsxs)("div",{className:fh.rewardItem,children:["experience"===e.rewardType&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("span",{className:fh.rewardIcon,children:"\ud83d\udd2e"}),(0,Cn.jsx)("span",{className:fh.rewardName,children:"\u041e\u043f\u044b\u0442 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"}),(0,Cn.jsxs)("span",{className:fh.rewardValue,children:["+",e.quantity]})]}),"resource"===e.rewardType&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("span",{className:fh.rewardIcon,children:"\ud83c\udf3f"}),(0,Cn.jsx)("span",{className:fh.rewardName,children:e.rewardId}),(0,Cn.jsxs)("span",{className:fh.rewardValue,children:["x",e.quantity]})]}),"item"===e.rewardType&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("span",{className:fh.rewardIcon,children:"\ud83d\udce6"}),(0,Cn.jsx)("span",{className:fh.rewardName,children:e.rewardId}),(0,Cn.jsxs)("span",{className:fh.rewardValue,children:["x",e.quantity]})]})]},e.id)))]}):(0,Cn.jsx)("div",{className:fh.noRewards,children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043d\u0430\u0433\u0440\u0430\u0434\u0430\u0445 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430"})]}),"failed"===o.status&&(0,Cn.jsxs)("div",{className:fh.resultSection,children:[(0,Cn.jsx)("h4",{className:fh.resultTitle,children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u0430"}),(null===($=o.specialConditions)||void 0===$?void 0:$.reason)&&(0,Cn.jsxs)("div",{className:fh.failReason,children:["\u041f\u0440\u0438\u0447\u0438\u043d\u0430: ",o.specialConditions.reason]})]}),"abandoned"===o.status&&(0,Cn.jsxs)("div",{className:fh.resultSection,children:[(0,Cn.jsx)("h4",{className:fh.resultTitle,children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u0430"}),(null===(O=o.specialConditions)||void 0===O?void 0:O.abandonReason)&&(0,Cn.jsxs)("div",{className:fh.failReason,children:["\u041f\u0440\u0438\u0447\u0438\u043d\u0430: ",o.specialConditions.abandonReason]})]}),(0,Cn.jsx)("div",{className:fh.actions,children:(0,Cn.jsx)(Mu,{onClick:s,className:fh.closeButton,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})})]}):(0,Cn.jsxs)("div",{className:fh.activityInstance,children:[(0,Cn.jsx)("div",{className:fh.header,children:(0,Cn.jsxs)("div",{className:fh.titleContainer,children:[(0,Cn.jsx)("span",{className:fh.typeIcon,children:_(null===(r=o.activityType)||void 0===r?void 0:r.type)}),(0,Cn.jsx)("h3",{className:fh.title,children:(null===(a=o.activityType)||void 0===a?void 0:a.name)||"\u0413\u0440\u0443\u043f\u043f\u043e\u0432\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"}),(0,Cn.jsx)("span",{className:`${fh.status} ${fh.statusInProgress}`,children:"\u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435"})]})}),(0,Cn.jsxs)("div",{className:fh.infoSection,children:[(0,Cn.jsxs)("div",{className:fh.infoGrid,children:[(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)("span",{className:fh.value,children:E(null===(i=o.activityType)||void 0===i?void 0:i.type)})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:`${fh.value} ${S(o.difficulty)}`,children:T(o.difficulty)})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u042d\u0442\u0430\u043f:"}),(0,Cn.jsxs)("span",{className:fh.value,children:[o.currentStage||1,"/",o.totalStages||3]})]}),(0,Cn.jsxs)("div",{className:fh.infoItem,children:[(0,Cn.jsx)("span",{className:fh.label,children:"\u041d\u0430\u0447\u0430\u043b\u043e:"}),(0,Cn.jsx)("span",{className:fh.value,children:o.startedAt?new Date(o.startedAt).toLocaleString():"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"})]})]}),(0,Cn.jsxs)("div",{className:fh.progressContainer,children:[(0,Cn.jsx)(mh,{progress:o.progress||0,className:fh.progressBar,showLabel:!0,height:"15px",color:"#d4af37"}),(0,Cn.jsxs)("span",{className:fh.progressText,children:["\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441: ",Math.round(o.progress||0),"%"]})]})]}),h&&(0,Cn.jsx)("div",{className:fh.error,children:h}),(0,Cn.jsx)("div",{className:fh.eventSection,children:f&&!g?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("h4",{className:fh.eventTitle,children:f.title}),(0,Cn.jsx)("p",{className:fh.eventDescription,children:f.description}),(0,Cn.jsx)("div",{className:fh.eventOptions,children:f.options.map(((e,t)=>(0,Cn.jsx)(Mu,{onClick:()=>(e=>{if(!f)return;const t=f.options[e],r=Math.random()<.7,n={success:r,description:r?`\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043f\u0440\u0430\u0432\u0438\u043b\u0438\u0441\u044c \u0441 \u0437\u0430\u0434\u0430\u0447\u0435\u0439, \u0432\u044b\u0431\u0440\u0430\u0432 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 "${t}".`:`\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u0432\u044b\u0431\u043e\u0440 "${t}" \u043f\u0440\u0438\u0432\u0435\u043b \u043a \u043e\u0441\u043b\u043e\u0436\u043d\u0435\u043d\u0438\u044f\u043c.`,rewards:r?k():[],penalties:r?[]:I()};v(n)})(t),disabled:u,className:fh.optionButton,children:e},t)))})]}):g?(0,Cn.jsxs)("div",{className:fh.eventResult,children:[(0,Cn.jsx)("h4",{className:`${fh.resultTitle} ${g.success?fh.success:fh.failure}`,children:g.success?"\u0423\u0441\u043f\u0435\u0445!":"\u041d\u0435\u0443\u0434\u0430\u0447\u0430!"}),(0,Cn.jsx)("p",{className:fh.resultDescription,children:g.description}),g.rewards.length>0&&(0,Cn.jsxs)("div",{className:fh.resultRewards,children:[(0,Cn.jsx)("h5",{className:fh.rewardsTitle,children:"\u041d\u0430\u0433\u0440\u0430\u0434\u044b:"}),(0,Cn.jsx)("ul",{className:fh.rewardsList,children:g.rewards.map(((e,t)=>(0,Cn.jsxs)("li",{className:fh.rewardItem,children:["experience"===e.type&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("span",{className:fh.rewardIcon,children:"\ud83d\udd2e"}),(0,Cn.jsx)("span",{className:fh.rewardName,children:"\u041e\u043f\u044b\u0442 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"}),(0,Cn.jsxs)("span",{className:fh.rewardValue,children:["+",e.value]})]}),"resource"===e.type&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("span",{className:fh.rewardIcon,children:"\ud83c\udf3f"}),(0,Cn.jsx)("span",{className:fh.rewardName,children:e.name}),(0,Cn.jsxs)("span",{className:fh.rewardValue,children:["x",e.quantity]})]})]},t)))})]}),g.penalties.length>0&&(0,Cn.jsxs)("div",{className:fh.resultPenalties,children:[(0,Cn.jsx)("h5",{className:fh.penaltiesTitle,children:"\u041f\u043e\u0442\u0435\u0440\u0438:"}),(0,Cn.jsx)("ul",{className:fh.penaltiesList,children:g.penalties.map(((e,t)=>(0,Cn.jsxs)("li",{className:fh.penaltyItem,children:["health"===e.type&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("span",{className:fh.penaltyIcon,children:"\u2764\ufe0f"}),(0,Cn.jsx)("span",{className:fh.penaltyName,children:"\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435"}),(0,Cn.jsxs)("span",{className:fh.penaltyValue,children:["-",e.value]})]}),"energy"===e.type&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("span",{className:fh.penaltyIcon,children:"\u26a1"}),(0,Cn.jsx)("span",{className:fh.penaltyName,children:"\u042d\u043d\u0435\u0440\u0433\u0438\u044f"}),(0,Cn.jsxs)("span",{className:fh.penaltyValue,children:["-",e.value]})]})]},t)))})]}),w&&(0,Cn.jsx)(Mu,{onClick:async()=>{if(w)if(g){p(!0),m(null);try{const e=o.currentStage+1,t={battleLog:{stage:o.currentStage,event:f,result:g,timestamp:(new Date).toISOString()}};e>o.totalStages?(await c.dispatch(((e,t,r)=>async n=>{try{const a=await iu.completeActivity(e,t,r);return n({type:Yr.UPDATE_ACTIVITY_INSTANCE,payload:a}),a.rewards&&a.rewards.length>0&&n({type:Yr.ADD_REWARDS,payload:a.rewards}),a}catch(h){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",h),h}})(o.id,t,d.id)),s&&s()):(await c.dispatch(((e,t,r,n)=>async a=>{try{const i=await iu.updateActivityProgress(e,t,r,n);return a({type:Yr.UPDATE_ACTIVITY_INSTANCE,payload:i}),i}catch(h){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",h),h}})(o.id,e,t,d.id)),y(null),v(null))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0435 \u043a \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c\u0443 \u044d\u0442\u0430\u043f\u0443:",e),m(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c\u0443 \u044d\u0442\u0430\u043f\u0443: ${e.message}`)}finally{p(!1)}}else c.addNotification({message:"\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u043d\u0443\u0436\u043d\u043e \u0432\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f",type:"error"});else c.addNotification({message:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c\u044e",type:"error"})},disabled:u,className:fh.nextButton,children:u?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":o.currentStage===o.totalStages?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c":"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c\u0443 \u044d\u0442\u0430\u043f\u0443"})]}):(0,Cn.jsx)("div",{className:fh.loading,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u044f..."})}),(0,Cn.jsxs)("div",{className:fh.actionsSection,children:[w&&(0,Cn.jsx)(Mu,{onClick:async()=>{if(w){if(window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u044d\u0442\u0443 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043a\u0430\u043a \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043d\u0443\u044e? \u042d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043b\u044c\u0437\u044f \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c.")){p(!0),m(null);try{const e={reason:"\u041e\u0442\u043c\u0435\u0447\u0435\u043d\u043e \u043b\u0438\u0434\u0435\u0440\u043e\u043c \u0433\u0440\u0443\u043f\u043f\u044b \u043a\u0430\u043a \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043d\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c",timestamp:(new Date).toISOString()};await c.dispatch(((e,t,r)=>async n=>{try{const a=await iu.failActivity(e,t,r);return n({type:Yr.UPDATE_ACTIVITY_INSTANCE,payload:a}),a}catch(h){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043c\u0435\u0442\u043a\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u043a\u0430\u043a \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043d\u043e\u0439:",h),h}})(o.id,e,d.id)),s&&s()}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043c\u0435\u0442\u043a\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u043a\u0430\u043a \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043d\u043e\u0439:",e),m(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u043a\u0430\u043a \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043d\u0443\u044e: ${e.message}`)}finally{p(!1)}}}else c.addNotification({message:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c\u044e",type:"error"})},disabled:u,className:fh.failButton,children:"\u041e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u043a\u0430\u043a \u043f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043d\u0443\u044e"}),"leader"===b&&(0,Cn.jsx)(Mu,{onClick:A,disabled:u,className:fh.abandonButton,children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c"})]})]})},gh="GroupDetails_groupDetails__2ob-8",vh="GroupDetails_header__-PjTa",xh="GroupDetails_titleContainer__lukBq",bh="GroupDetails_title__fT3CX",wh="GroupDetails_privateLabel__1fqN3",_h="GroupDetails_description__0jCN7",Eh="GroupDetails_actions__WT4x3",Th="GroupDetails_editButton__iIsMz",Sh="GroupDetails_leaveButton__svZo7",jh="GroupDetails_tabs__SHn7J",Ch="GroupDetails_tab__mwwmm",kh="GroupDetails_active__SdlqH",Ih="GroupDetails_badge__fkI3q",Ah="GroupDetails_error__ZVXAb",Nh="GroupDetails_tabContent__1FScj",Dh="GroupDetails_loading__R8uKe",Mh="GroupDetails_activitiesContainer__DGW3O",Rh="GroupDetails_groupInfo__bs8gK",Ph="GroupDetails_infoSection__NQxpO",Lh="GroupDetails_sectionTitle__0bjoV",$h="GroupDetails_infoRow__udR94",Oh="GroupDetails_label__uCS0w",qh="GroupDetails_value__wJ23S",Uh="GroupDetails_activeActivitiesContainer__Twbx7",Fh="GroupDetails_instancesList__kgnwV",zh="GroupDetails_instanceItem__nPERz",Bh="GroupDetails_instanceHeader__T1+eN",Gh="GroupDetails_instanceTitle__ZnKs4",Wh="GroupDetails_instanceStatus__MkupA",Hh="GroupDetails_statusPreparing__-ZSnt",Vh="GroupDetails_statusInProgress__1E-sd",Qh="GroupDetails_statusCompleted__r5alF",Yh="GroupDetails_statusFailed__7oYbA",Kh="GroupDetails_statusAbandoned__2Baxv",Xh="GroupDetails_instanceInfo__AIyS0",Jh="GroupDetails_instanceDetail__gPC7w",Zh="GroupDetails_instanceLabel__kPSjx",em="GroupDetails_instanceValue__q-JEe",tm="GroupDetails_emptyMessage__Yv9Go",rm=e=>{var t;let{group:r,activityInstances:a=[],onRefresh:i}=e;const{state:o,actions:s}=Nn(),{user:l}=o.player,{activities:c,currentActivity:d}=o.groups||{activities:[],currentActivity:null},[u,p]=(0,n.useState)("members"),[h,m]=(0,n.useState)(null),[f,y]=(0,n.useState)(!1),[g,v]=(0,n.useState)(null),x=Array.isArray(r.members)?r.members:[],b=Array.isArray(a)?a:[],w=(null===(t=x.find((e=>e.userId===l.id)))||void 0===t?void 0:t.role)||"member",_="leader"===w||"officer"===w;(0,n.useEffect)((()=>{"activities"!==u||c&&0!==c.length||E(),"active_activities"===u&&i&&i()}),[u]);const E=async()=>{y(!0),v(null);try{const e=x.map((e=>{var t;return(null===(t=e.user)||void 0===t?void 0:t.cultivationLevel)||1})),t={minCultivationLevel:e.length>0?Math.min(...e):1};await s.dispatch(cu(t))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439:",e),v("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438")}finally{y(!1)}};return(0,Cn.jsxs)("div",{className:gh,children:[(0,Cn.jsxs)("div",{className:vh,children:[(0,Cn.jsxs)("div",{className:xh,children:[(0,Cn.jsx)("h3",{className:bh,children:r.name}),r.isPrivate&&(0,Cn.jsx)("span",{className:wh,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u0430\u044f"})]}),(0,Cn.jsxs)("div",{className:Eh,children:["leader"===w&&(0,Cn.jsx)(Mu,{className:Th,onClick:()=>{},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,Cn.jsx)(Mu,{className:Sh,onClick:()=>{"leader"===w&&r.members.length>1&&!window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b? \u041b\u0438\u0434\u0435\u0440\u0441\u0442\u0432\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0443, \u0435\u0441\u043b\u0438 \u0432\u044b \u043f\u043e\u043a\u0438\u043d\u0435\u0442\u0435 \u0433\u0440\u0443\u043f\u043f\u0443.")||(s.dispatch({type:"LEAVE_GROUP",payload:{groupId:r.id,userId:l.id}}),s.addNotification({message:`\u0412\u044b \u043f\u043e\u043a\u0438\u043d\u0443\u043b\u0438 \u0433\u0440\u0443\u043f\u043f\u0443 "${r.name}"`,type:"info"}))},children:"\u041f\u043e\u043a\u0438\u043d\u0443\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443"})]})]}),r.description&&(0,Cn.jsx)("div",{className:_h,children:r.description}),(0,Cn.jsxs)("div",{className:jh,children:[(0,Cn.jsxs)("button",{className:`${Ch} ${"members"===u?kh:""}`,onClick:()=>p("members"),children:["\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438 (",x.length,"/",r.maxMembers||10,")"]}),(0,Cn.jsx)("button",{className:`${Ch} ${"activities"===u?kh:""}`,onClick:()=>p("activities"),children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438"}),(0,Cn.jsxs)("button",{className:`${Ch} ${"active_activities"===u?kh:""}`,onClick:()=>p("active_activities"),children:["\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438",b.filter((e=>"in_progress"===e.status||"preparing"===e.status)).length>0&&(0,Cn.jsx)("span",{className:Ih,children:b.filter((e=>"in_progress"===e.status||"preparing"===e.status)).length})]}),(0,Cn.jsx)("button",{className:`${Ch} ${"details"===u?kh:""}`,onClick:()=>p("details"),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"})]}),g&&(0,Cn.jsx)("div",{className:Ah,children:g}),(0,Cn.jsx)("div",{className:Nh,children:f?(0,Cn.jsx)("div",{className:Dh,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}):(0,Cn.jsxs)(Cn.Fragment,{children:["members"===u&&(0,Cn.jsx)(Xu,{members:x,leaderId:r.leaderId,currentUserId:l.id,currentUserRole:w}),"activities"===u&&(0,Cn.jsxs)("div",{className:Mh,children:[(0,Cn.jsx)(wp,{activities:c||[],selectedActivity:d,onSelectActivity:e=>{s.dispatch(su(e))}}),d&&(0,Cn.jsx)(lh,{activity:d,group:r,onCreateActivityInstance:async(e,t,n)=>{if(_){y(!0),v(null);try{const a=await s.dispatch(((e,t,r,n,a)=>async i=>{try{const o=await iu.createActivityInstance(e,t,r,n,a);return i({type:Yr.CREATE_ACTIVITY_INSTANCE,payload:o}),i(su(o)),o}catch(g){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",g),g}})(r.id,e,t,n,l.id));return s.addNotification({message:`\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c "${a.activityType.name}" \u0441\u043e\u0437\u0434\u0430\u043d\u0430`,type:"success"}),a}catch(a){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",a),v(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c: ${a.message}`),a}finally{y(!1)}}else s.addNotification({message:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438",type:"error"})},onStartActivity:async e=>{if(_){y(!0),v(null);try{const t=await s.dispatch(du(e,l.id));return s.addNotification({message:`\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c "${t.activityType.name}" \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430`,type:"success"}),t}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:",t),v(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c: ${t.message}`),t}finally{y(!1)}}else s.addNotification({message:"\u0422\u043e\u043b\u044c\u043a\u043e \u043b\u0438\u0434\u0435\u0440 \u0438\u043b\u0438 \u043e\u0444\u0438\u0446\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b \u043c\u043e\u0436\u0435\u0442 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c",type:"error"})},canManageActivities:_})]}),"active_activities"===u&&(0,Cn.jsx)("div",{className:Uh,children:h?(0,Cn.jsx)(yh,{instance:h,onComplete:()=>{m(null),i&&i()}}):b.length>0?(0,Cn.jsxs)("div",{className:Fh,children:[(0,Cn.jsx)("h4",{className:Lh,children:"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0433\u0440\u0443\u043f\u043f\u044b"}),b.filter((e=>e&&("in_progress"===e.status||"preparing"===e.status))).map((e=>{var t;return(0,Cn.jsxs)("div",{className:zh,onClick:()=>m(e),children:[(0,Cn.jsxs)("div",{className:Bh,children:[(0,Cn.jsx)("div",{className:Gh,children:(null===(t=e.activityType)||void 0===t?void 0:t.name)||"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u044b"}),(0,Cn.jsx)("div",{className:`${Wh} ${"in_progress"===e.status?Vh:"preparing"===e.status?Hh:"completed"===e.status?Qh:"failed"===e.status?Yh:Kh}`,children:"in_progress"===e.status?"\u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435":"preparing"===e.status?"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430":"completed"===e.status?"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430":"failed"===e.status?"\u041f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u0430":"\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u0430"})]}),(0,Cn.jsxs)("div",{className:Xh,children:[(0,Cn.jsxs)("div",{className:Jh,children:[(0,Cn.jsx)("span",{className:Zh,children:"\u0421\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:em,children:"easy"===e.difficulty?"\u041b\u0435\u0433\u043a\u0430\u044f":"medium"===e.difficulty?"\u0421\u0440\u0435\u0434\u043d\u044f\u044f":"hard"===e.difficulty?"\u0422\u044f\u0436\u0435\u043b\u0430\u044f":"extreme"===e.difficulty?"\u042d\u043a\u0441\u0442\u0440\u0435\u043c\u0430\u043b\u044c\u043d\u0430\u044f":"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u0430\u044f"})]}),(0,Cn.jsxs)("div",{className:Jh,children:[(0,Cn.jsx)("span",{className:Zh,children:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438:"}),(0,Cn.jsx)("span",{className:em,children:e.participants.length})]}),"in_progress"===e.status&&(0,Cn.jsxs)("div",{className:Jh,children:[(0,Cn.jsx)("span",{className:Zh,children:"\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441:"}),(0,Cn.jsxs)("span",{className:em,children:[Math.round(e.progress||0),"%"]})]})]})]},e.id)})),0===b.filter((e=>e&&("in_progress"===e.status||"preparing"===e.status))).length&&(0,Cn.jsx)("div",{className:tm,children:"\u0412 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u0443 \u0433\u0440\u0443\u043f\u043f\u044b \u043d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0439."}),(0,Cn.jsx)("h4",{className:Lh,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439"}),b.filter((e=>e&&e.status&&"in_progress"!==e.status&&"preparing"!==e.status)).slice(0,5).map((e=>{var t;return(0,Cn.jsxs)("div",{className:zh,onClick:()=>m(e),children:[(0,Cn.jsxs)("div",{className:Bh,children:[(0,Cn.jsx)("div",{className:Gh,children:(null===(t=e.activityType)||void 0===t?void 0:t.name)||"\u0410\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u044b"}),(0,Cn.jsx)("div",{className:`${Wh} ${"completed"===e.status?Qh:"failed"===e.status?Yh:Kh}`,children:"completed"===e.status?"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430":"failed"===e.status?"\u041f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u0430":"\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u0430"})]}),(0,Cn.jsxs)("div",{className:Jh,children:[(0,Cn.jsx)("span",{className:Zh,children:"\u0414\u0430\u0442\u0430:"}),(0,Cn.jsx)("span",{className:em,children:new Date(e.completedAt||e.abandonedAt||e.startedAt).toLocaleDateString()})]})]},e.id)})),0===b.filter((e=>e&&e.status&&"in_progress"!==e.status&&"preparing"!==e.status)).length&&(0,Cn.jsx)("div",{className:tm,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439 \u043f\u0443\u0441\u0442\u0430."})]}):(0,Cn.jsx)("div",{className:tm,children:'\u0423 \u0433\u0440\u0443\u043f\u043f\u044b \u043f\u043e\u043a\u0430 \u043d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439. \u041f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043d\u0430 \u0432\u043a\u043b\u0430\u0434\u043a\u0443 "\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438", \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0430\u0448\u0443 \u043f\u0435\u0440\u0432\u0443\u044e \u0433\u0440\u0443\u043f\u043f\u043e\u0432\u0443\u044e \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c.'})}),"details"===u&&(0,Cn.jsxs)("div",{className:Rh,children:[(0,Cn.jsxs)("div",{className:Ph,children:[(0,Cn.jsx)("h4",{className:Lh,children:"\u041e\u0431\u0449\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),(0,Cn.jsxs)("div",{className:$h,children:[(0,Cn.jsx)("span",{className:Oh,children:"\u0421\u043e\u0437\u0434\u0430\u043d\u0430:"}),(0,Cn.jsx)("span",{className:qh,children:new Date(r.createdAt).toLocaleDateString()})]}),(0,Cn.jsxs)("div",{className:$h,children:[(0,Cn.jsx)("span",{className:Oh,children:"\u0422\u0438\u043f \u0433\u0440\u0443\u043f\u043f\u044b:"}),(0,Cn.jsx)("span",{className:qh,children:r.isPrivate?"\u0417\u0430\u043a\u0440\u044b\u0442\u0430\u044f (\u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f\u043c)":"\u041e\u0442\u043a\u0440\u044b\u0442\u0430\u044f"})]}),(0,Cn.jsxs)("div",{className:$h,children:[(0,Cn.jsx)("span",{className:Oh,children:"\u0422\u0440\u0435\u0431\u0443\u0435\u043c\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c:"}),(0,Cn.jsxs)("span",{className:qh,children:["\u0423\u0440\u043e\u0432\u0435\u043d\u044c ",r.minCultivationLevel,"+"]})]}),(0,Cn.jsxs)("div",{className:$h,children:[(0,Cn.jsx)("span",{className:Oh,children:"\u041e\u0434\u043e\u0431\u0440\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u044f:"}),(0,Cn.jsx)("span",{className:qh,children:r.requiresApproval?"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f":"\u041d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f"})]})]}),(0,Cn.jsxs)("div",{className:Ph,children:[(0,Cn.jsx)("h4",{className:Lh,children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0433\u0440\u0443\u043f\u043f\u044b"}),(0,Cn.jsxs)("div",{className:$h,children:[(0,Cn.jsx)("span",{className:Oh,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:"}),(0,Cn.jsx)("span",{className:qh,children:Array.isArray(r.activityInstances)?r.activityInstances.filter((e=>e&&"completed"===e.status)).length:0})]}),(0,Cn.jsxs)("div",{className:$h,children:[(0,Cn.jsx)("span",{className:Oh,children:"\u041f\u0440\u043e\u0432\u0430\u043b\u0435\u043d\u043d\u044b\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:"}),(0,Cn.jsx)("span",{className:qh,children:Array.isArray(r.activityInstances)?r.activityInstances.filter((e=>e&&"failed"===e.status)).length:0})]}),(0,Cn.jsxs)("div",{className:$h,children:[(0,Cn.jsx)("span",{className:Oh,children:"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438:"}),(0,Cn.jsx)("span",{className:qh,children:Array.isArray(r.activityInstances)?r.activityInstances.filter((e=>e&&("in_progress"===e.status||"preparing"===e.status))).length:0})]})]})]})]})})]})},nm="CreateGroupForm_formContainer__GHbg+",am="CreateGroupForm_title__pg55i",im="CreateGroupForm_form__t-kbF",om="CreateGroupForm_formGroup__kIy19",sm="CreateGroupForm_label__w+HFq",lm="CreateGroupForm_input__VmIn4",cm="CreateGroupForm_textarea__sGPvz",dm="CreateGroupForm_select__4Zm-9",um="CreateGroupForm_fieldHint__erNS8",pm="CreateGroupForm_checkboxGroup__+gLxs",hm="CreateGroupForm_checkboxLabel__GYbPX",mm="CreateGroupForm_checkboxText__UYAHN",fm="CreateGroupForm_actions__KhBU-",ym="CreateGroupForm_cancelButton__slN2T",gm="CreateGroupForm_submitButton__3hTtL",vm=e=>{let{onSubmit:t,onCancel:r,loading:a}=e;const{state:i}=In(),{cultivation:o}=i.player,[s,l]=(0,n.useState)({name:"",description:"",maxMembers:5,minCultivationLevel:1,isPrivate:!1,requiresApproval:!0,leaderSpecialization:"damage"}),c=e=>{const{name:t,value:r,type:n,checked:a}=e.target;l((e=>({...e,[t]:"checkbox"===n?a:r})))};return(0,Cn.jsxs)("div",{className:nm,children:[(0,Cn.jsx)("h3",{className:am,children:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u0433\u0440\u0443\u043f\u043f\u044b"}),(0,Cn.jsxs)("form",{className:im,onSubmit:e=>{e.preventDefault(),s.name.trim()?t(s):alert("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b")},children:[(0,Cn.jsxs)("div",{className:om,children:[(0,Cn.jsx)("label",{htmlFor:"name",className:sm,children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b"}),(0,Cn.jsx)("input",{type:"text",id:"name",name:"name",className:lm,value:s.name,onChange:c,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b",required:!0,maxLength:30,disabled:a}),(0,Cn.jsx)("div",{className:um,children:"\u041e\u0442 2 \u0434\u043e 30 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"})]}),(0,Cn.jsxs)("div",{className:om,children:[(0,Cn.jsx)("label",{htmlFor:"description",className:sm,children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),(0,Cn.jsx)("textarea",{id:"description",name:"description",className:cm,value:s.description,onChange:c,placeholder:"\u041e\u043f\u0438\u0448\u0438\u0442\u0435 \u0446\u0435\u043b\u044c \u0432\u0430\u0448\u0435\u0439 \u0433\u0440\u0443\u043f\u043f\u044b",rows:3,maxLength:200,disabled:a}),(0,Cn.jsx)("div",{className:um,children:"\u0414\u043e 200 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"})]}),(0,Cn.jsxs)("div",{className:om,children:[(0,Cn.jsx)("label",{htmlFor:"maxMembers",className:sm,children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"}),(0,Cn.jsxs)("select",{id:"maxMembers",name:"maxMembers",className:dm,value:s.maxMembers,onChange:c,disabled:a,children:[(0,Cn.jsx)("option",{value:2,children:"2 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u0430"}),(0,Cn.jsx)("option",{value:3,children:"3 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u0430"}),(0,Cn.jsx)("option",{value:4,children:"4 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u0430"}),(0,Cn.jsx)("option",{value:5,children:"5 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432"}),o&&o.level>=4&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("option",{value:6,children:"6 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432"}),(0,Cn.jsx)("option",{value:7,children:"7 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432"})]}),o&&o.level>=7&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("option",{value:8,children:"8 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432"}),(0,Cn.jsx)("option",{value:9,children:"9 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432"}),(0,Cn.jsx)("option",{value:10,children:"10 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432"})]})]})]}),(0,Cn.jsxs)("div",{className:om,children:[(0,Cn.jsx)("label",{htmlFor:"minCultivationLevel",className:sm,children:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"}),(0,Cn.jsxs)("select",{id:"minCultivationLevel",name:"minCultivationLevel",className:dm,value:s.minCultivationLevel,onChange:c,disabled:a,children:[(0,Cn.jsx)("option",{value:1,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 1 (\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430)"}),(0,Cn.jsx)("option",{value:2,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 2 (\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u0438\u044f)"}),(0,Cn.jsx)("option",{value:3,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 3 (\u041d\u0430\u043a\u043e\u043f\u043b\u0435\u043d\u0438\u0435 \u0446\u0438)"}),(0,Cn.jsx)("option",{value:4,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 4 (\u041e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u043c\u0435\u0440\u0438\u0434\u0438\u0430\u043d)"}),(0,Cn.jsx)("option",{value:5,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 5 (\u0417\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e)"}),(0,Cn.jsx)("option",{value:6,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 6 (\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438)"}),(0,Cn.jsx)("option",{value:7,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 7 (\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0434\u0443\u0448\u0438)"}),(0,Cn.jsx)("option",{value:8,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 8 (\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u0443\u0445\u0430)"}),(0,Cn.jsx)("option",{value:9,children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c 9 (\u0412\u044b\u0445\u043e\u0434 \u043d\u0438\u0448\u0438)"})]})]}),(0,Cn.jsxs)("div",{className:om,children:[(0,Cn.jsx)("label",{htmlFor:"leaderSpecialization",className:sm,children:"\u0412\u0430\u0448\u0430 \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0432 \u0433\u0440\u0443\u043f\u043f\u0435"}),(0,Cn.jsx)("select",{id:"leaderSpecialization",name:"leaderSpecialization",className:dm,value:s.leaderSpecialization,onChange:c,disabled:a,children:[{id:"damage",name:"\u0423\u0440\u043e\u043d",description:"\u0421\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0430 \u043d\u0430\u043d\u0435\u0441\u0435\u043d\u0438\u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u043d\u0430"},{id:"tank",name:"\u0417\u0430\u0449\u0438\u0442\u0430",description:"\u0421\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0430 \u043f\u043e\u0433\u043b\u043e\u0449\u0435\u043d\u0438\u0438 \u0443\u0440\u043e\u043d\u0430 \u0438 \u0437\u0430\u0449\u0438\u0442\u0435 \u0433\u0440\u0443\u043f\u043f\u044b"},{id:"support",name:"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430",description:"\u0421\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0430 \u0443\u0441\u0438\u043b\u0435\u043d\u0438\u0438 \u0441\u043e\u044e\u0437\u043d\u0438\u043a\u043e\u0432 \u0438 \u043e\u0441\u043b\u0430\u0431\u043b\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u043e\u0432"},{id:"control",name:"\u041a\u043e\u043d\u0442\u0440\u043e\u043b\u044c",description:"\u0421\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0435 \u043f\u043e\u043b\u044f \u0431\u043e\u044f \u0438 \u043e\u0431\u0435\u0437\u0434\u0432\u0438\u0436\u0438\u0432\u0430\u043d\u0438\u0438 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u043e\u0432"},{id:"healer",name:"\u041b\u0435\u0447\u0435\u043d\u0438\u0435",description:"\u0421\u043f\u0435\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043d\u0430 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044f \u0441\u043e\u044e\u0437\u043d\u0438\u043a\u043e\u0432"}].map((e=>(0,Cn.jsxs)("option",{value:e.id,children:[e.name," - ",e.description]},e.id)))})]}),(0,Cn.jsx)("div",{className:pm,children:(0,Cn.jsxs)("label",{className:hm,children:[(0,Cn.jsx)("input",{type:"checkbox",name:"isPrivate",checked:s.isPrivate,onChange:c,disabled:a}),(0,Cn.jsx)("span",{className:mm,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u0430\u044f \u0433\u0440\u0443\u043f\u043f\u0430 (\u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f\u043c)"})]})}),(0,Cn.jsx)("div",{className:pm,children:(0,Cn.jsxs)("label",{className:hm,children:[(0,Cn.jsx)("input",{type:"checkbox",name:"requiresApproval",checked:s.requiresApproval,onChange:c,disabled:a}),(0,Cn.jsx)("span",{className:mm,children:"\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u0442\u044c \u043e\u0434\u043e\u0431\u0440\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0432\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u044f"})]})}),(0,Cn.jsxs)("div",{className:fm,children:[(0,Cn.jsx)(Mu,{type:"button",onClick:r,className:ym,disabled:a,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,Cn.jsx)(Mu,{type:"submit",className:gm,disabled:a,children:a?"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443"})]})]})]})},xm="GroupsTab_groupsTab__+cxqB",bm="GroupsTab_header__Q33wy",wm="GroupsTab_createButton__Er0w8",_m="GroupsTab_error__jHYKi",Em="GroupsTab_invitations__5OFCV",Tm="GroupsTab_invitation__DRVTA",Sm="GroupsTab_invitationActions__STOvN",jm="GroupsTab_content__7FkXy",Cm="GroupsTab_groupList__IfwFP",km="GroupsTab_groupDetails__vSWaj",Im="GroupsTab_loading__Hbkb9",Am=()=>{const{state:e,actions:t}=Nn(),{user:r}=e.player,{list:a,currentGroup:i,currentActivity:o,activityInstances:s,invitations:l}=e.groups||{list:[],currentGroup:null,currentActivity:null,activityInstances:[],invitations:[]},c=Array.isArray(a)?a:[],d=Array.isArray(s)?s:[],u=Array.isArray(l)?l:[],[p,h]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),[y,g]=(0,n.useState)(null);(0,n.useEffect)((()=>{r&&r.id&&(b(),v())}),[r]),(0,n.useEffect)((()=>{const e=setInterval((()=>{r&&r.id&&v()}),3e4);return()=>clearInterval(e)}),[r]);const v=(0,n.useCallback)((async()=>{try{await t.dispatch(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pending";return async r=>{try{r({type:Yr.FETCH_USER_INVITATIONS,payload:{userId:e,status:t}});const n=await au.getUserInvitations(e,t);return r({type:Yr.SET_USER_INVITATIONS,payload:n}),n}catch(y){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",y),r({type:Yr.SET_ERROR,payload:`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f: ${y.message}`}),y}}}(r.id))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0439:",e),t.addNotification({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f",type:"error"})}}),[r,t]),x=(0,n.useCallback)((async(e,n)=>{try{await t.dispatch(((e,t,r)=>async n=>{try{const a=await au.respondToInvitation(e,t?"accept":"decline",r);return n({type:Yr.RESPOND_TO_INVITATION,payload:{invitationId:e,userId:r,accepted:t}}),t&&await n(lu(r)),a}catch(y){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u0432\u0435\u0442\u0435 \u043d\u0430 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435:",y),n({type:Yr.SET_ERROR,payload:`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435: ${y.message}`}),y}})(e,n,r.id)),t.addNotification({message:"\u041f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435 "+(n?"\u043f\u0440\u0438\u043d\u044f\u0442\u043e":"\u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u043e"),type:"success"}),v(),n&&b()}catch(a){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f:",a),t.addNotification({message:`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c ${n?"\u043f\u0440\u0438\u043d\u044f\u0442\u044c":"\u043e\u0442\u043a\u043b\u043e\u043d\u0438\u0442\u044c"} \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u0435`,type:"error"})}}),[r,t,v]);(0,n.useEffect)((()=>{i&&i.id&&w(i.id)}),[i]);const b=async()=>{f(!0),g(null);try{await t.dispatch(lu(r.id)),await t.dispatch(cu())}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0433\u0440\u0443\u043f\u043f:",e),g("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u044b. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.")}finally{f(!1)}},w=async e=>{f(!0);try{await t.dispatch(uu(e))}catch(r){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0435\u0439 \u0433\u0440\u0443\u043f\u043f\u044b:",r),t.addNotification({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u0438 \u0433\u0440\u0443\u043f\u043f\u044b",type:"error"})}finally{f(!1)}};return(0,Cn.jsxs)("div",{className:xm,children:[(0,Cn.jsxs)("div",{className:bm,children:[(0,Cn.jsx)("h2",{children:"\u0413\u0440\u0443\u043f\u043f\u044b \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u043e\u0432"}),!p&&(0,Cn.jsx)(Mu,{onClick:()=>h(!0),className:wm,disabled:m,children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443"})]}),y&&(0,Cn.jsx)("div",{className:_m,children:y}),p?(0,Cn.jsx)(vm,{onSubmit:async e=>{f(!0),g(null);try{if(!r||!r.id)throw new Error("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043d\u043e\u0432\u0430.");await t.dispatch(((e,t)=>async r=>{try{const n=await au.createGroup(e,t);return r({type:Yr.CREATE_GROUP,payload:n}),n}catch(y){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f\u044b:",y),y}})(e,r.id)),h(!1),t.addNotification({message:`\u0413\u0440\u0443\u043f\u043f\u0430 "${e.name}" \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0430`,type:"success"})}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u0433\u0440\u0443\u043f\u043f\u044b:",n),g(`\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443: ${n.message}`)}finally{f(!1)}},onCancel:()=>h(!1),loading:m}):(0,Cn.jsxs)("div",{className:jm,children:[u.length>0&&(0,Cn.jsxs)("div",{className:Em,children:[(0,Cn.jsxs)("h3",{children:["\u041d\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f (",u.length,")"]}),(0,Cn.jsx)("ul",{children:u.map((e=>{var t,r;return(0,Cn.jsxs)("li",{className:Tm,children:[(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("strong",{children:null===(t=e.group)||void 0===t?void 0:t.name})," \u043e\u0442 ",null===(r=e.inviter)||void 0===r?void 0:r.name,e.message&&(0,Cn.jsx)("p",{children:e.message})]}),(0,Cn.jsxs)("div",{className:Sm,children:[(0,Cn.jsx)(Mu,{onClick:()=>x(e.id,!0),small:!0,primary:!0,children:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c"}),(0,Cn.jsx)(Mu,{onClick:()=>x(e.id,!1),small:!0,secondary:!0,children:"\u041e\u0442\u043a\u043b\u043e\u043d\u0438\u0442\u044c"})]})]},e.id)}))})]}),m?(0,Cn.jsx)("div",{className:Im,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0433\u0440\u0443\u043f\u043f..."}):(0,Cn.jsxs)(Cn.Fragment,{children:[o&&o.status&&"completed"!==o.status&&"failed"!==o.status&&(0,Cn.jsx)(yh,{instance:o,onComplete:()=>b(),onUpdate:()=>{i&&w(i.id)}}),(!o||!o.status||"completed"===o.status||"failed"===o.status)&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)("div",{className:Cm,children:(0,Cn.jsx)(Au,{groups:c,selectedGroup:i,onSelectGroup:e=>{t.dispatch(ou(e))}})}),i&&(0,Cn.jsx)("div",{className:km,children:(0,Cn.jsx)(rm,{group:i,activityInstances:d,onRefresh:()=>{i&&i.id&&w(i.id)}})})]})]})]})]})};var Nm=r(280);const Dm=nr.div`
  display: flex;
  gap: 20px;
  height: 100%;
`,Mm=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  padding: 20px;
  overflow-y: auto;
`,Rm=nr.div`
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
`,Pm=nr.button`
  background: ${e=>e.active?"rgba(212, 175, 55, 0.2)":"rgba(0, 0, 0, 0.3)"};
  color: ${e=>e.active?"#d4af37":"#f0f0f0"};
  border: 1px solid ${e=>e.active?"#d4af37":"transparent"};
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.1);
    border-color: #d4af37;
  }
`,Lm=nr.div`
  background: rgba(30, 30, 30, 0.95);
  border-radius: 6px;
  padding: 15px;
  margin-bottom: 15px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid transparent;
  position: relative;
  
  ${e=>e.element&&`\n    &::before {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: linear-gradient(135deg, ${e.elementColor}20 0%, transparent 100%);\n      border-radius: 6px;\n      pointer-events: none;\n    }\n  `}
  
  &:hover {
    border-color: #d4af37;
    transform: translateX(5px);
  }
  
  ${e=>e.selected&&"\n    border-color: #d4af37;\n    background: rgba(212, 175, 55, 0.1);\n  "}
  
  ${e=>!e.available&&"\n    opacity: 0.7;\n    cursor: not-allowed;\n    \n    &:hover {\n      transform: none;\n    }\n  "}
`,$m=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
`,Om=nr.span`
  font-size: 1.5rem;
`,qm=nr.h3`
  color: #d4af37;
  margin: 0;
  font-size: 1.1rem;
`,Um=nr.p`
  color: #aaa;
  margin: 0 0 10px 0;
  font-size: 0.9rem;
`,Fm=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 5px;
  font-size: 0.8rem;
  color: #aaa;
`,zm=nr.div`
  display: flex;
  justify-content: space-between;
`,Bm=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  padding: 20px;
  display: flex;
  flex-direction: column;
`,Gm=nr.div`
  margin-bottom: 20px;
`,Wm=nr.h2`
  color: #d4af37;
  margin: 0 0 10px 0;
  display: flex;
  align-items: center;
  gap: 10px;
`,Hm=nr.p`
  color: #aaa;
  line-height: 1.6;
  margin-bottom: 20px;
`,Vm=nr.div`
  margin-bottom: 20px;
`,Qm=nr.div`
  display: flex;
  justify-content: space-between;
  padding: 8px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  margin-bottom: 8px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,Ym=nr.button`
  background: ${e=>e.disabled?"rgba(0, 0, 0, 0.3)":"rgba(212, 175, 55, 0.2)"};
  color: ${e=>e.disabled?"#666":"#d4af37"};
  border: 1px solid ${e=>e.disabled?"transparent":"#d4af37"};
  padding: 12px 24px;
  border-radius: 4px;
  cursor: ${e=>e.disabled?"not-allowed":"pointer"};
  margin-bottom: 20px;
  transition: all 0.3s ease;
  
  &:hover:not(:disabled) {
    background: rgba(212, 175, 55, 0.3);
  }
`,Km=(e,t)=>{if(!e||!t)return!1;for(const[r,n]of Object.entries(t))if((e[r]||0)<n)return!1;return!0};const Xm=function(){const{state:e,actions:t}=Nn(),[r,a]=(0,n.useState)("\u0432\u0441\u0435"),[i,o]=(0,n.useState)(null),s=Nm.techniques.map((t=>({...t,learned:e.player.techniques.find((e=>e.id===t.id)),available:e.player.cultivation.level>=t.requiredLevel}))).filter((e=>"\u0432\u0441\u0435"===r||e.type===r));return(0,Cn.jsxs)(Dm,{children:[(0,Cn.jsxs)(Mm,{children:[(0,Cn.jsx)(Rm,{children:Nm.techniqueCategories.map((e=>(0,Cn.jsx)(Pm,{active:r===e.name,onClick:()=>a(e.name),children:e.name.charAt(0).toUpperCase()+e.name.slice(1)},e.id)))}),s.map((e=>(0,Cn.jsxs)(Lm,{selected:(null===i||void 0===i?void 0:i.id)===e.id,available:e.available,element:e.element,elementColor:e.element?Nm.elementColors[e.element]:null,onClick:()=>(e=>{o(e)})(e),children:[(0,Cn.jsxs)($m,{children:[(0,Cn.jsx)(Om,{children:e.icon}),(0,Cn.jsxs)(qm,{children:[e.name,e.learned&&` (\u0423\u0440. ${e.learned.level||1})`]})]}),(0,Cn.jsx)(Um,{children:e.description}),(0,Cn.jsxs)(Fm,{children:[(0,Cn.jsxs)(zm,{children:[(0,Cn.jsx)("span",{children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)("span",{children:e.type})]}),(0,Cn.jsxs)(zm,{children:[(0,Cn.jsx)("span",{children:"\u042d\u043d\u0435\u0440\u0433\u0438\u044f:"}),(0,Cn.jsx)("span",{children:e.energyCost})]}),e.cooldown>0&&(0,Cn.jsxs)(zm,{children:[(0,Cn.jsx)("span",{children:"\u041f\u0435\u0440\u0435\u0437\u0430\u0440\u044f\u0434\u043a\u0430:"}),(0,Cn.jsxs)("span",{children:[e.cooldown,"\u0441"]})]}),(0,Cn.jsxs)(zm,{children:[(0,Cn.jsx)("span",{children:"\u0422\u0440\u0435\u0431\u0443\u0435\u043c\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c:"}),(0,Cn.jsx)("span",{children:e.requiredLevel})]})]})]},e.id)))]}),i&&(0,Cn.jsxs)(Bm,{children:[(0,Cn.jsxs)(Gm,{children:[(0,Cn.jsxs)(Wm,{children:[(0,Cn.jsx)(Om,{children:i.icon}),i.name,i.learned&&` (\u0423\u0440. ${i.learned.level||1})`]}),(0,Cn.jsx)(Hm,{children:i.description})]}),i.learned?(0,Cn.jsx)(Ym,{onClick:()=>{if(!i||!i.learned)return;const r=i.learned.level||1;if(r>=i.maxLevel)return void t.addNotification({message:"\u0422\u0435\u0445\u043d\u0438\u043a\u0430 \u0443\u0436\u0435 \u0434\u043e\u0441\u0442\u0438\u0433\u043b\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f",type:"info"});const n=i.upgradeCost(r+1);e.player.cultivation.experience<n.experience||!Km(e.player.inventory.currency,n.currency)?t.addNotification({message:"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0434\u043b\u044f \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0438",type:"error"}):(t.upgradeTechnique({techniqueId:i.id,cost:n}),o({...i,learned:{...i.learned,level:r+1}}),t.addNotification({message:`\u0422\u0435\u0445\u043d\u0438\u043a\u0430 "${i.name}" \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0430 \u0434\u043e \u0443\u0440\u043e\u0432\u043d\u044f ${r+1}!`,type:"success"}))},disabled:i.learned.level>=i.maxLevel||e.player.cultivation.experience<i.upgradeCost(i.learned.level+1).experience||!Km(e.player.inventory.currency,i.upgradeCost(i.learned.level+1).currency),children:i.learned.level>=i.maxLevel?"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c":(()=>{const e=i.upgradeCost(i.learned.level+1),t=Object.entries(e.currency).map((e=>{let[t,r]=e;return`${r} ${"gold"===t?"\u0437\u043e\u043b\u043e\u0442\u0430":"silver"===t?"\u0441\u0435\u0440\u0435\u0431\u0440\u0430":"\u043c\u0435\u0434\u0438"}`})).join(", ");return`\u0423\u043b\u0443\u0447\u0448\u0438\u0442\u044c (${e.experience} \u043e\u043f\u044b\u0442\u0430, ${t})`})()}):(0,Cn.jsx)(Ym,{onClick:()=>{if(!i||!i.available||i.learned)return;const r=i.upgradeCost(1);e.player.cultivation.experience<r.experience||!Km(e.player.inventory.currency,r.currency)?t.addNotification({message:"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u0434\u043b\u044f \u0438\u0437\u0443\u0447\u0435\u043d\u0438\u044f \u0442\u0435\u0445\u043d\u0438\u043a\u0438",type:"error"}):(t.learnTechnique({...i,cost:r}),o({...i,learned:{id:i.id,name:i.name,level:1,experience:0,learnedAt:(new Date).toISOString()}}),t.addNotification({message:`\u0412\u044b \u0438\u0437\u0443\u0447\u0438\u043b\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u0443 "${i.name}"!`,type:"success"}))},disabled:!i.available||e.player.cultivation.experience<i.upgradeCost(1).experience||!Km(e.player.inventory.currency,i.upgradeCost(1).currency),children:i.available?(()=>{const e=i.upgradeCost(1),t=Object.entries(e.currency).map((e=>{let[t,r]=e;return`${r} ${"gold"===t?"\u0437\u043e\u043b\u043e\u0442\u0430":"silver"===t?"\u0441\u0435\u0440\u0435\u0431\u0440\u0430":"\u043c\u0435\u0434\u0438"}`})).join(", ");return`\u0418\u0437\u0443\u0447\u0438\u0442\u044c (${e.experience} \u043e\u043f\u044b\u0442\u0430, ${t})`})():`\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f ${i.requiredLevel} \u0443\u0440\u043e\u0432\u0435\u043d\u044c`}),(0,Cn.jsxs)(Vm,{children:[(0,Cn.jsx)("h3",{children:"\u042d\u0444\u0444\u0435\u043a\u0442\u044b:"}),i.effects&&i.effects.length>0?i.effects.map(((e,t)=>(0,Cn.jsxs)(Qm,{children:[(0,Cn.jsxs)("span",{children:[e.name,":"]}),(0,Cn.jsxs)("span",{children:[e.duration?`${e.duration} \u0441\u0435\u043a.`:"",e.damage?` ${e.damage} \u0443\u0440\u043e\u043d\u0430`:"",e.healing?` ${e.healing} \u0438\u0441\u0446\u0435\u043b\u0435\u043d\u0438\u044f`:"",e.stats?Object.entries(e.stats).map((e=>{let[t,r]=e;return` ${t}: ${r>0?"+":""}${r}`})).join(", "):""]})]},t))):(0,Cn.jsxs)(Qm,{children:[(0,Cn.jsx)("span",{children:"\u041d\u0435\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432"}),(0,Cn.jsx)("span",{children:"-"})]})]})]})]})},Jm=nr.div`
  display: grid;
  grid-template-columns: 300px 1fr;
  gap: 20px;
`,Zm=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 10px;
  height: 100%;
  overflow-y: auto;
`,ef=nr.div`
  margin-bottom: 20px;
  
  &:last-child {
    margin-bottom: 0;
  }
`,tf=nr.h3`
  color: #d4af37;
  margin: 0 0 10px;
  font-size: 1.1rem;
  padding: 5px 10px;
  background: rgba(212, 175, 55, 0.1);
  border-radius: 4px;
`,rf=nr.div`
  padding: 10px;
  margin-bottom: 5px;
  background: ${e=>e.isSelected?"rgba(212, 175, 55, 0.2)":"rgba(0, 0, 0, 0.2)"};
  border: 1px solid ${e=>e.isSelected?"#d4af37":"transparent"};
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.1);
  }
  
  &:last-child {
    margin-bottom: 0;
  }
`,nf=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
`,af=nr.div`
  color: #f0f0f0;
  margin-bottom: 5px;
`,of=nr.div`
  color: #aaa;
  font-size: 0.8rem;
`,sf=nr.div`
  color: ${e=>e.level>=75?"#4caf50":e.level>=50?"#d4af37":e.level>=25?"#ff9800":"#f44336"};
`,lf=nr.div`
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid #d4af37;
  border-radius: 8px;
  padding: 20px;
`,cf=nr.div`
  margin-bottom: 20px;
  padding-bottom: 20px;
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
`,df=nr.h2`
  color: #d4af37;
  margin: 0 0 5px;
`,uf=nr.div`
  color: #aaa;
  font-size: 0.9rem;
  margin-bottom: 10px;
`,pf=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-bottom: 20px;
`,hf=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 10px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
`,mf=nr.span`
  color: #aaa;
`,ff=nr.span`
  color: #f0f0f0;
`,yf=nr.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-bottom: 20px;
`,gf=nr.button`
  width: 100%;
  padding: 10px;
  background: rgba(212, 175, 55, 0.2);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #d4af37;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.3);
  }
  
  &:disabled {
    background: #333;
    border-color: #666;
    color: #666;
    cursor: not-allowed;
  }
`,vf=nr.div`
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid rgba(212, 175, 55, 0.2);
`,xf=nr.h3`
  color: #d4af37;
  margin: 0 0 10px;
`,bf=nr.div`
  color: #f0f0f0;
  font-size: 0.9rem;
  line-height: 1.4;
  
  > div {
    margin-bottom: 5px;
    padding-bottom: 5px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    
    &:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }
  }
`,wf=[{id:1,name:"\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438",role:"\u041d\u0430\u0441\u0442\u0430\u0432\u043d\u0438\u043a",level:80,events:["\u0412\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0443\u0440\u043e\u043a \u043e\u0442 \u041c\u0430\u0441\u0442\u0435\u0440\u0430 \u041b\u0438","\u041c\u0430\u0441\u0442\u0435\u0440 \u041b\u0438 \u043f\u043e\u0445\u0432\u0430\u043b\u0438\u043b \u0432\u0430\u0448 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441"]},{id:2,name:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0427\u0436\u0430\u043d",role:"\u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0430 \u0441\u0435\u043a\u0442\u044b",level:60,events:["\u0412\u044b \u043f\u043e\u043c\u043e\u0433\u043b\u0438 \u0421\u0442\u0430\u0440\u0435\u0439\u0448\u0438\u043d\u0435 \u0427\u0436\u0430\u043d\u0443 \u0441\u043e\u0431\u0440\u0430\u0442\u044c \u0442\u0440\u0430\u0432\u044b"]},{id:3,name:"\u0423\u0447\u0435\u043d\u0438\u043a \u0412\u0430\u043d",role:"\u0421\u043e\u0443\u0447\u0435\u043d\u0438\u043a",level:45,events:["\u0412\u044b \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 \u0412\u0430\u043d\u043e\u043c","\u0412\u044b \u043e\u0434\u043e\u043b\u0436\u0438\u043b\u0438 \u0412\u0430\u043d\u0443 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0430\u043c\u0435\u043d\u044c"]},{id:4,name:"\u0423\u0447\u0435\u043d\u0438\u0446\u0430 \u041c\u044d\u0439",role:"\u0421\u043e\u0443\u0447\u0435\u043d\u0438\u0446\u0430",level:40,events:["\u041c\u044d\u0439 \u043f\u043e\u0434\u0435\u043b\u0438\u043b\u0430\u0441\u044c \u0441 \u0432\u0430\u043c\u0438 \u0442\u0435\u0445\u043d\u0438\u043a\u043e\u0439 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438"]},{id:5,name:"\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446 \u0427\u0435\u043d",role:"\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446",level:30,events:["\u0412\u044b \u043a\u0443\u043f\u0438\u043b\u0438 \u0442\u043e\u0432\u0430\u0440\u044b \u0443 \u0427\u0435\u043d\u0430","\u0427\u0435\u043d \u0434\u0430\u043b \u0432\u0430\u043c \u0441\u043a\u0438\u0434\u043a\u0443"]},{id:6,name:"\u0413\u043b\u0430\u0432\u0430 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439",role:"\u0413\u043b\u0430\u0432\u0430 \u0432\u0440\u0430\u0436\u0434\u0435\u0431\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u043d\u0430",level:10,events:["\u0413\u043b\u0430\u0432\u0430 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439 \u0443\u0433\u0440\u043e\u0436\u0430\u043b \u0432\u0430\u043c","\u0412\u044b \u0438\u0437\u0431\u0435\u0436\u0430\u043b\u0438 \u043b\u043e\u0432\u0443\u0448\u043a\u0438 \u043a\u043b\u0430\u043d\u0430 \u0421\u044e\u0439"]}];const _f=function(){var e,t,r;const{state:a,actions:i}=Nn(),[o,s]=(0,n.useState)(null);let l=null===a||void 0===a||null===(e=a.player)||void 0===e||null===(t=e.social)||void 0===t?void 0:t.relationships;var c;(!l||Array.isArray(l)&&0===l.length)&&(l=null===a||void 0===a||null===(c=a.player)||void 0===c?void 0:c.relationships,console.log("\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0438\u0437 player.relationships:",l)),l||(l=wf,console.log("\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c defaultRelationships")),Array.isArray(l)||(l="object"===typeof l&&null!==l?Object.values(l):wf,console.log("Relationships \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u044b \u0438\u0437 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0432 \u043c\u0430\u0441\u0441\u0438\u0432:",l));const d=(null===a||void 0===a||null===(r=a.player)||void 0===r?void 0:r.cultivation)||{},u={friends:{title:"\u0414\u0440\u0443\u0437\u044c\u044f",characters:Array.isArray(l)?l.filter((e=>e&&"object"===typeof e&&"number"===typeof e.level&&e.level>=75)):[]},allies:{title:"\u0421\u043e\u044e\u0437\u043d\u0438\u043a\u0438",characters:Array.isArray(l)?l.filter((e=>e&&"object"===typeof e&&"number"===typeof e.level&&e.level>=50&&e.level<75)):[]},neutral:{title:"\u041d\u0435\u0439\u0442\u0440\u0430\u043b\u044c\u043d\u044b\u0435",characters:Array.isArray(l)?l.filter((e=>e&&"object"===typeof e&&"number"===typeof e.level&&e.level>=25&&e.level<50)):[]},enemies:{title:"\u0412\u0440\u0430\u0433\u0438",characters:Array.isArray(l)?l.filter((e=>e&&"object"===typeof e&&"number"===typeof e.level&&e.level<25)):[]}},p=e=>{if(!o)return;const t={chat:5,gift:10,train:20,quest:30}[e];if((d.energy||0)<t)return void(i.addNotification&&i.addNotification({message:"\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438 \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f",type:"error"}));i.updateCultivation&&i.updateCultivation({energy:(d.energy||0)-t});const r={chat:Math.floor(3*Math.random())+1,gift:Math.floor(5*Math.random())+3,train:Math.floor(7*Math.random())+5,quest:Math.floor(10*Math.random())+7}[e],n={...o,level:Math.min(100,o.level+r)},a={chat:`\u0412\u044b \u043f\u043e\u0431\u0435\u0441\u0435\u0434\u043e\u0432\u0430\u043b\u0438 \u0441 ${o.name}`,gift:`\u0412\u044b \u043f\u043e\u0434\u0430\u0440\u0438\u043b\u0438 \u043f\u043e\u0434\u0430\u0440\u043e\u043a ${o.name}`,train:`\u0412\u044b \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 ${o.name}`,quest:`\u0412\u044b \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u043b\u0438 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u0434\u043b\u044f ${o.name}`}[e],l={...n,events:o.events?[...o.events,a]:[a]};i.updateRelationship?(console.log("\u0412\u044b\u0437\u044b\u0432\u0430\u0435\u043c updateRelationship \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438:",l),i.updateRelationship(l)):console.error("\u0424\u0443\u043d\u043a\u0446\u0438\u044f updateRelationship \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u0432 actions"),s(l),i.addNotification&&i.addNotification({message:`\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441 ${o.name} \u0443\u043b\u0443\u0447\u0448\u0438\u043b\u0438\u0441\u044c \u043d\u0430 ${r}`,type:"success"})};return(0,Cn.jsxs)(Jm,{children:[(0,Cn.jsx)(Zm,{children:Object.entries(u).map((e=>{let[t,r]=e;return r.characters.length>0&&(0,Cn.jsxs)(ef,{children:[(0,Cn.jsx)(tf,{children:r.title}),r.characters.map((e=>(0,Cn.jsx)(rf,{isSelected:o&&o.id===e.id,onClick:()=>(e=>{s(e)})(e),children:(0,Cn.jsxs)(nf,{children:[(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)(af,{children:e.name}),(0,Cn.jsx)(of,{children:e.role})]}),(0,Cn.jsx)(sf,{level:e.level,children:e.level})]})},e.id)))]},t)}))}),(0,Cn.jsx)(lf,{children:o?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsxs)(cf,{children:[(0,Cn.jsx)(df,{children:o.name}),(0,Cn.jsx)(uf,{children:o.role})]}),(0,Cn.jsxs)(pf,{children:[(0,Cn.jsxs)(hf,{children:[(0,Cn.jsx)(mf,{children:"\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0435"}),(0,Cn.jsxs)(ff,{children:[o.level,"/100"]})]}),(0,Cn.jsxs)(hf,{children:[(0,Cn.jsx)(mf,{children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),(0,Cn.jsx)(ff,{children:o.level>=75?"\u0414\u0440\u0443\u0433":o.level>=50?"\u0421\u043e\u044e\u0437\u043d\u0438\u043a":o.level>=25?"\u041d\u0435\u0439\u0442\u0440\u0430\u043b\u044c\u043d\u044b\u0439":"\u0412\u0440\u0430\u0433"})]})]}),(0,Cn.jsxs)(yf,{children:[(0,Cn.jsx)(gf,{onClick:()=>p("chat"),disabled:(d.energy||0)<5,children:"\u0411\u0435\u0441\u0435\u0434\u0430 (5 \u044d\u043d\u0435\u0440\u0433\u0438\u0438)"}),(0,Cn.jsx)(gf,{onClick:()=>p("gift"),disabled:(d.energy||0)<10,children:"\u041f\u043e\u0434\u0430\u0440\u043e\u043a (10 \u044d\u043d\u0435\u0440\u0433\u0438\u0438)"}),(0,Cn.jsx)(gf,{onClick:()=>p("train"),disabled:(d.energy||0)<20,children:"\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 (20 \u044d\u043d\u0435\u0440\u0433\u0438\u0438)"}),(0,Cn.jsx)(gf,{onClick:()=>p("quest"),disabled:(d.energy||0)<30,children:"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 (30 \u044d\u043d\u0435\u0440\u0433\u0438\u0438)"})]}),(0,Cn.jsxs)(vf,{children:[(0,Cn.jsx)(xf,{children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439"}),(0,Cn.jsxs)(bf,{children:[o.events&&o.events.map(((e,t)=>(0,Cn.jsx)("div",{children:e},t))),(!o.events||0===o.events.length)&&(0,Cn.jsx)("div",{children:"\u0423 \u0432\u0430\u0441 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442 \u0438\u0441\u0442\u043e\u0440\u0438\u0438 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u0441 \u044d\u0442\u0438\u043c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u043c"})]})]})]}):(0,Cn.jsx)("div",{style:{textAlign:"center",color:"#aaa"},children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f"})})]})},Ef=[{id:"ach1",title:"\u041f\u0435\u0440\u0432\u044b\u0435 \u0448\u0430\u0433\u0438",description:"\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0438\u0442\u0435 1 \u0443\u0440\u043e\u0432\u043d\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438",icon:"\ud83d\udc63",category:"\u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",rewards:[{type:"experience",amount:50,icon:"\u2728"},{type:"currency",amount:200,icon:"\ud83d\udcb0"}],condition:e=>{try{return!!(e&&e.player&&e.player.cultivation)&&("number"===typeof e.player.cultivation.level&&e.player.cultivation.level>=1)}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 "\u041f\u0435\u0440\u0432\u044b\u0435 \u0448\u0430\u0433\u0438":',t),!1}},progress:e=>{try{return e&&e.player&&e.player.cultivation?{current:"number"===typeof e.player.cultivation.level?e.player.cultivation.level:0,required:1}:{current:0,required:1}}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435 "\u041f\u0435\u0440\u0432\u044b\u0435 \u0448\u0430\u0433\u0438":',t),{current:0,required:1}}}},{id:"ach2",title:"\u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u043e\u043d\u0435\u0440 \u0442\u0435\u0445\u043d\u0438\u043a",description:"\u0418\u0437\u0443\u0447\u0438\u0442\u0435 5 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u0442\u0435\u0445\u043d\u0438\u043a \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438",icon:"\ud83d\udcda",category:"\u0442\u0435\u0445\u043d\u0438\u043a\u0438",rewards:[{type:"experience",amount:100,icon:"\u2728"},{type:"item",name:"\u0421\u0432\u0438\u0442\u043e\u043a \u0437\u0430\u0431\u044b\u0442\u043e\u0439 \u0442\u0435\u0445\u043d\u0438\u043a\u0438",icon:"\ud83d\udcdc"}],condition:e=>{try{return!!(e&&e.player&&e.player.techniques)&&(Array.isArray(e.player.techniques)&&e.player.techniques.length>=5)}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 "\u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u043e\u043d\u0435\u0440 \u0442\u0435\u0445\u043d\u0438\u043a":',t),!1}},progress:e=>{try{return e&&e.player?{current:Array.isArray(e.player.techniques)?e.player.techniques.length:0,required:5}:{current:0,required:5}}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435 "\u041a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u043e\u043d\u0435\u0440 \u0442\u0435\u0445\u043d\u0438\u043a":',t),{current:0,required:5}}}},{id:"ach3",title:"\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c",description:"\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 10 \u043d\u043e\u0432\u044b\u0445 \u043b\u043e\u043a\u0430\u0446\u0438\u0439",icon:"\ud83d\uddfa\ufe0f",category:"\u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435",rewards:[{type:"experience",amount:150,icon:"\u2728"},{type:"currency",amount:1e3,icon:"\ud83d\udcb0"},{type:"item",name:"\u041a\u0430\u0440\u0442\u0430 \u0441\u043e\u043a\u0440\u043e\u0432\u0438\u0449",icon:"\ud83d\uddfa\ufe0f"}],condition:e=>{try{if(!e||!e.player||!e.player.progress||!e.player.progress.discoveries)return!1;const r=e.player.progress.discoveries;if("object"!==typeof r||null===r||Array.isArray(r))return!1;try{let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e>=10}catch(t){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0435 discoveries:",t),!1}}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 "\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c":',t),!1}},progress:e=>{try{if(!e||!e.player||!e.player.progress||!e.player.progress.discoveries)return{current:0,required:10};const r=e.player.progress.discoveries;let n=0;if(r&&"object"===typeof r&&!Array.isArray(r)&&null!==r)try{for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&n++}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0435 discoveries:",t)}return{current:n,required:10}}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435 "\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c":',t),{current:0,required:10}}}},{id:"ach4",title:"\u041c\u0430\u0441\u0442\u0435\u0440 \u043c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u0438",description:"\u041d\u0430\u043a\u043e\u043f\u0438\u0442\u0435 1000 \u0435\u0434\u0438\u043d\u0438\u0446 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438",icon:"\ud83e\uddd8",category:"\u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",rewards:[{type:"experience",amount:200,icon:"\u2728"},{type:"item",name:"\u041f\u0438\u043b\u044e\u043b\u044f \u043a\u043e\u043d\u0446\u0435\u043d\u0442\u0440\u0430\u0446\u0438\u0438",icon:"\ud83d\udc8a"}],condition:e=>{try{return!!(e&&e.player&&e.player.cultivation)&&("number"===typeof e.player.cultivation.energy&&e.player.cultivation.energy>=1e3)}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 "\u041c\u0430\u0441\u0442\u0435\u0440 \u043c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u0438":',t),!1}},progress:e=>{try{return e&&e.player&&e.player.cultivation?{current:"number"===typeof e.player.cultivation.energy?e.player.cultivation.energy:0,required:1e3}:{current:0,required:1e3}}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435 "\u041c\u0430\u0441\u0442\u0435\u0440 \u043c\u0435\u0434\u0438\u0442\u0430\u0446\u0438\u0438":',t),{current:0,required:1e3}}}},{id:"ach5",title:"\u041f\u043e\u043c\u043e\u0449\u043d\u0438\u043a",description:"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 10 \u0437\u0430\u0434\u0430\u043d\u0438\u0439",icon:"\ud83e\udd1d",category:"\u0437\u0430\u0434\u0430\u043d\u0438\u044f",rewards:[{type:"experience",amount:200,icon:"\u2728"},{type:"currency",amount:1500,icon:"\ud83d\udcb0"},{type:"reputation",amount:500,icon:"\u2b50"}],condition:e=>{try{return!!(e&&e.player&&e.player.progress&&e.player.progress.quests&&e.player.progress.quests.completed)&&(Array.isArray(e.player.progress.quests.completed)&&e.player.progress.quests.completed.length>=10)}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 "\u041f\u043e\u043c\u043e\u0449\u043d\u0438\u043a":',t),!1}},progress:e=>{try{return e&&e.player&&e.player.progress&&e.player.progress.quests?{current:Array.isArray(e.player.progress.quests.completed)?e.player.progress.quests.completed.length:0,required:10}:{current:0,required:10}}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435 "\u041f\u043e\u043c\u043e\u0449\u043d\u0438\u043a":',t),{current:0,required:10}}}},{id:"ach6",title:"\u0411\u043e\u0433\u0430\u0442\u0441\u0442\u0432\u043e",description:"\u041d\u0430\u043a\u043e\u043f\u0438\u0442\u0435 10000 \u043c\u043e\u043d\u0435\u0442",icon:"\ud83d\udcb0",category:"\u044d\u043a\u043e\u043d\u043e\u043c\u0438\u043a\u0430",rewards:[{type:"item",name:"\u041a\u043e\u0448\u0435\u043b\u044c \u0443\u0434\u0430\u0447\u0438",icon:"\ud83d\udc5d"},{type:"currency",amount:2e3,icon:"\ud83d\udcb0"}],condition:e=>{try{if(!e||!e.player||!e.player.inventory)return!1;const r=e.player.inventory.currency;if(void 0===r||null===r)return!1;if("number"===typeof r)return r>=1e4;if("object"===typeof r&&!Array.isArray(r)&&null!==r){let e=0;try{for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)){const n=r[t];"number"===typeof n&&(e+=n)}return e>=1e4}catch(t){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0435 \u0432\u0430\u043b\u044e\u0442\u044b:",t),!1}}return!1}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 "\u0411\u043e\u0433\u0430\u0442\u0441\u0442\u0432\u043e":',t),!1}},progress:e=>{try{if(!e||!e.player||!e.player.inventory)return{current:0,required:1e4};const r=e.player.inventory.currency;let n=0;if("number"===typeof r)n=r;else if("object"===typeof r&&null!==r&&!Array.isArray(r))try{for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e)){const t=r[e];"number"===typeof t&&(n+=t)}}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0435 \u0432\u0430\u043b\u044e\u0442\u044b \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435:",t)}return{current:n,required:1e4}}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435 "\u0411\u043e\u0433\u0430\u0442\u0441\u0442\u0432\u043e":',t),{current:0,required:1e4}}}},{id:"ach7",title:"\u041c\u0430\u0441\u0442\u0435\u0440 \u0431\u043e\u0435\u0432\u044b\u0445 \u0438\u0441\u043a\u0443\u0441\u0441\u0442\u0432",description:"\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0438\u0442\u0435 10 \u0443\u0440\u043e\u0432\u043d\u044f \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438",icon:"\ud83e\udd4b",category:"\u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f",rewards:[{type:"experience",amount:500,icon:"\u2728"},{type:"technique",name:"\u0418\u0441\u043a\u0443\u0441\u0441\u0442\u0432\u043e \u0411\u0435\u0441\u0441\u043c\u0435\u0440\u0442\u043d\u043e\u0433\u043e \u041c\u0435\u0447\u0430",icon:"\u2694\ufe0f"},{type:"currency",amount:5e3,icon:"\ud83d\udcb0"}],condition:e=>{try{return!!(e&&e.player&&e.player.cultivation)&&("number"===typeof e.player.cultivation.level&&e.player.cultivation.level>=10)}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 "\u041c\u0430\u0441\u0442\u0435\u0440 \u0431\u043e\u0435\u0432\u044b\u0445 \u0438\u0441\u043a\u0443\u0441\u0441\u0442\u0432":',t),!1}},progress:e=>{try{return e&&e.player&&e.player.cultivation?{current:"number"===typeof e.player.cultivation.level?e.player.cultivation.level:0,required:10}:{current:0,required:10}}catch(t){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435 "\u041c\u0430\u0441\u0442\u0435\u0440 \u0431\u043e\u0435\u0432\u044b\u0445 \u0438\u0441\u043a\u0443\u0441\u0441\u0442\u0432":',t),{current:0,required:10}}}},{id:"ach8",title:"\u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0432\u044f\u0437\u0438",description:"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0434\u0440\u0443\u0436\u0435\u0441\u043a\u0438\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0441 5 NPC",icon:"\ud83e\udd1d",category:"\u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0435",rewards:[{type:"reputation",amount:1e3,icon:"\u2b50"},{type:"currency",amount:1e3,icon:"\ud83d\udcb0"}],condition:e=>{try{if(!e||!e.player)return!1;let n=null;if(e.player.social&&e.player.social.relationships?n=e.player.social.relationships:e.player.relationships&&(n=e.player.relationships),!n)return!1;try{let e=0;if(Array.isArray(n))try{e=n.filter((e=>e&&"object"===typeof e&&"number"===typeof e.level&&e.level>=75)).length}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 filter \u0434\u043b\u044f relationships:",t),e=0;for(let r=0;r<n.length;r++){const t=n[r];t&&"object"===typeof t&&"number"===typeof t.level&&t.level>=75&&e++}}else if("object"===typeof n)for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=n[t];r&&"object"===typeof r&&!Array.isArray(r)&&"number"===typeof r.level&&r.level>=75&&e++}return e>=5}catch(r){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439:",r),!1}}catch(r){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0438 "\u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0432\u044f\u0437\u0438":',r),!1}},progress:e=>{try{if(!e||!e.player)return{current:0,required:5};let n=null;if(e.player.social&&e.player.social.relationships?n=e.player.social.relationships:e.player.relationships&&(n=e.player.relationships),!n)return{current:0,required:5};try{let e=0;if(Array.isArray(n))try{e=n.filter((e=>e&&"object"===typeof e&&"number"===typeof e.level&&e.level>=75)).length}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 filter \u0434\u043b\u044f relationships \u0432 progress:",t),e=0;for(let r=0;r<n.length;r++){const t=n[r];t&&"object"===typeof t&&"number"===typeof t.level&&t.level>=75&&e++}}else if("object"===typeof n)for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=n[t];r&&"object"===typeof r&&!Array.isArray(r)&&"number"===typeof r.level&&r.level>=75&&e++}return{current:e,required:5}}catch(r){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0435 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439:",r),{current:0,required:5}}}catch(r){return console.error('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0435 "\u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0432\u044f\u0437\u0438":',r),{current:0,required:5}}}}],Tf=[{id:"all",name:"\u0432\u0441\u0435"},{id:"cultivation",name:"\u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f"},{id:"techniques",name:"\u0442\u0435\u0445\u043d\u0438\u043a\u0438"},{id:"exploration",name:"\u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435"},{id:"quests",name:"\u0437\u0430\u0434\u0430\u043d\u0438\u044f"},{id:"economy",name:"\u044d\u043a\u043e\u043d\u043e\u043c\u0438\u043a\u0430"},{id:"social",name:"\u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0435"}],Sf=nr.div`
  display: flex;
  gap: 20px;
  height: 100%;
`,jf=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  padding: 20px;
  overflow-y: auto;
`,Cf=nr.div`
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
`,kf=nr.button`
  background: ${e=>e.active?"rgba(212, 175, 55, 0.2)":"rgba(0, 0, 0, 0.3)"};
  color: ${e=>e.active?"#d4af37":"#f0f0f0"};
  border: 1px solid ${e=>e.active?"#d4af37":"transparent"};
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.1);
    border-color: #d4af37;
  }
`,If=nr.div`
  background: rgba(30, 30, 30, 0.95);
  border-radius: 6px;
  padding: 15px;
  margin-bottom: 15px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid transparent;
  
  &:hover {
    border-color: #d4af37;
    transform: translateX(5px);
  }
  
  ${e=>e.selected&&"\n    border-color: #d4af37;\n    background: rgba(212, 175, 55, 0.1);\n  "}
  
  ${e=>e.completed&&"\n    border-color: #4caf50;\n    &::after {\n      content: '\u2713';\n      color: #4caf50;\n      position: absolute;\n      right: 15px;\n      top: 15px;\n    }\n  "}
`,Af=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
`,Nf=nr.span`
  font-size: 1.5rem;
`,Df=nr.h3`
  color: #d4af37;
  margin: 0;
  font-size: 1.1rem;
`,Mf=nr.p`
  color: #aaa;
  margin: 0 0 10px 0;
  font-size: 0.9rem;
`,Rf=nr.div`
  width: 100%;
  height: 4px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 2px;
  overflow: hidden;
  
  &::after {
    content: '';
    display: block;
    width: ${e=>100*e.progress}%;
    height: 100%;
    background: ${e=>e.completed?"#4caf50":"#d4af37"};
    transition: width 0.3s ease;
  }
`,Pf=nr.div`
  font-size: 0.8rem;
  color: #aaa;
  text-align: right;
  margin-top: 5px;
`,Lf=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 8px;
  padding: 20px;
  display: flex;
  flex-direction: column;
`,$f=nr.div`
  margin-bottom: 20px;
`,Of=nr.h2`
  color: #d4af37;
  margin: 0 0 10px 0;
  display: flex;
  align-items: center;
  gap: 10px;
`,qf=nr.p`
  color: #aaa;
  line-height: 1.6;
  margin-bottom: 20px;
`,Uf=nr.div`
  margin-top: auto;
`,Ff=nr.div`
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px;
  background: rgba(212, 175, 55, 0.1);
  border-radius: 4px;
  margin-bottom: 8px;
`,zf=nr.div`
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 6px;
`,Bf=nr.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 5px;
  
  &:last-child {
    margin-bottom: 0;
  }
`;const Gf=function(){const{state:e}=Nn(),[t,r]=(0,n.useState)("\u0432\u0441\u0435"),[a,i]=(0,n.useState)(null),[o,s]=(0,n.useState)({total:0,completed:0,points:0});(0,n.useEffect)((()=>{const t=Ef.filter((t=>t.condition(e)));s({total:Ef.length,completed:t.length,points:t.reduce(((e,t)=>e+t.rewards.reduce(((e,t)=>e+(t.amount||0)),0)),0)})}),[e]);const l=Ef.filter((e=>"\u0432\u0441\u0435"===t||e.category===t));return(0,Cn.jsxs)(Sf,{children:[(0,Cn.jsxs)(jf,{children:[(0,Cn.jsx)(Cf,{children:Tf.map((e=>(0,Cn.jsx)(kf,{active:t===e.name,onClick:()=>r(e.name),children:e.name.charAt(0).toUpperCase()+e.name.slice(1)},e.id)))}),(0,Cn.jsxs)(zf,{children:[(0,Cn.jsxs)(Bf,{children:[(0,Cn.jsx)("span",{children:"\u0412\u0441\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0439:"}),(0,Cn.jsx)("span",{children:o.total})]}),(0,Cn.jsxs)(Bf,{children:[(0,Cn.jsx)("span",{children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e:"}),(0,Cn.jsx)("span",{children:o.completed})]}),(0,Cn.jsxs)(Bf,{children:[(0,Cn.jsx)("span",{children:"\u041e\u0447\u043a\u0438 \u0434\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u0439:"}),(0,Cn.jsx)("span",{children:o.points})]})]}),l.map((t=>{const r=t.progress(e),n=t.condition(e);return(0,Cn.jsxs)(If,{selected:(null===a||void 0===a?void 0:a.id)===t.id,completed:n,onClick:()=>(e=>{i(e)})(t),children:[(0,Cn.jsxs)(Af,{children:[(0,Cn.jsx)(Nf,{children:t.icon}),(0,Cn.jsx)(Df,{children:t.title})]}),(0,Cn.jsx)(Mf,{children:t.description}),(0,Cn.jsx)(Rf,{progress:Math.min(r.current/r.required,1),completed:n}),(0,Cn.jsxs)(Pf,{children:[r.current," / ",r.required]})]},t.id)}))]}),a&&(0,Cn.jsxs)(Lf,{children:[(0,Cn.jsxs)($f,{children:[(0,Cn.jsxs)(Of,{children:[(0,Cn.jsx)(Nf,{children:a.icon}),a.title]}),(0,Cn.jsx)(qf,{children:a.description})]}),(0,Cn.jsxs)(zf,{children:[(0,Cn.jsxs)(Bf,{children:[(0,Cn.jsx)("span",{children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f:"}),(0,Cn.jsx)("span",{children:a.category})]}),(0,Cn.jsxs)(Bf,{children:[(0,Cn.jsx)("span",{children:"\u0421\u0442\u0430\u0442\u0443\u0441:"}),(0,Cn.jsx)("span",{style:{color:a.condition(e)?"#4caf50":"#f0f0f0"},children:a.condition(e)?"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e":"\u0412 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435"})]}),(0,Cn.jsxs)(Bf,{children:[(0,Cn.jsx)("span",{children:"\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441:"}),(0,Cn.jsxs)("span",{children:[a.progress(e).current," / ",a.progress(e).required]})]})]}),(0,Cn.jsxs)(Uf,{children:[(0,Cn.jsx)("h3",{children:"\u041d\u0430\u0433\u0440\u0430\u0434\u044b:"}),a.rewards.map(((e,t)=>(0,Cn.jsxs)(Ff,{children:[(0,Cn.jsx)("span",{children:e.icon}),"currency"===e.type&&`${e.amount} \u043c\u043e\u043d\u0435\u0442`,"experience"===e.type&&`${e.amount} \u043e\u043f\u044b\u0442\u0430`,"item"===e.type&&e.name,"reputation"===e.type&&`${e.amount} \u043e\u0447\u043a\u043e\u0432 \u0440\u0435\u043f\u0443\u0442\u0430\u0446\u0438\u0438`]},t)))]})]})]})},Wf=nr.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  padding: 20px;
  color: #f0f0f0;
`,Hf=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
`,Vf=nr.h2`
  font-size: 24px;
  margin: 0;
  color: #ffd700;
`,Qf=nr.div`
  display: flex;
  flex: 1;
  gap: 20px;
`,Yf=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 5px;
  padding: 15px;
  display: flex;
  flex-direction: column;
`,Kf=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 5px;
  padding: 15px;
  display: flex;
  flex-direction: column;
`,Xf=nr.div`
  display: flex;
  margin-bottom: 15px;
  border-bottom: 1px solid #444;
`,Jf=nr.button`
  background: ${e=>e.active?"rgba(255, 215, 0, 0.2)":"transparent"};
  color: ${e=>e.active?"#ffd700":"#ccc"};
  border: none;
  padding: 10px 15px;
  font-size: 16px;
  cursor: pointer;
  border-bottom: ${e=>e.active?"2px solid #ffd700":"none"};
  transition: all 0.3s;
  
  &:hover {
    background: rgba(255, 215, 0, 0.1);
    color: #ffd700;
  }
`,Zf=nr.div`
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
`,ey=nr.div`
  display: flex;
  background: ${e=>e.selected?"rgba(255, 215, 0, 0.1)":"rgba(30, 30, 30, 0.7)"};
  border: 1px solid ${e=>e.selected?"#ffd700":"#444"};
  border-radius: 5px;
  padding: 10px;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background: rgba(255, 215, 0, 0.05);
    border-color: #ffd700;
  }
`,ty=nr.div`
  width: 40px;
  height: 40px;
  background: #333;
  border-radius: 5px;
  margin-right: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
`,ry=nr.div`
  flex: 1;
`,ny=nr.div`
  font-weight: bold;
  color: ${e=>{switch(e.rarity){case"common":default:return"#aaa";case"uncommon":return"#1eff00";case"rare":return"#0070dd";case"epic":return"#a335ee";case"legendary":return"#ff8000"}}};
`,ay=nr.div`
  font-size: 14px;
  color: #aaa;
  margin-top: 5px;
`,iy=nr.div`
  padding: 15px;
  background: rgba(30, 30, 30, 0.7);
  border-radius: 5px;
  margin-top: 15px;
`,oy=nr.h3`
  margin: 0 0 10px 0;
  color: #ffd700;
`,sy=nr.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
`,ly=nr.div`
  color: #aaa;
`,cy=nr.div`
  color: #fff;
`,dy=nr.div`
  margin-top: 15px;
`,uy=nr.div`
  display: flex;
  align-items: center;
  margin-bottom: 8px;
  padding: 8px;
  border-radius: 4px;
  background: ${e=>e.available?"rgba(0, 128, 0, 0.1)":"rgba(128, 0, 0, 0.1)"};
`,py=nr.div`
  flex: 1;
  color: ${e=>e.available?"#5f5":"#f55"};
`,hy=nr.div`
  color: ${e=>e.available?"#5f5":"#f55"};
`,my=nr.button`
  background: ${e=>e.primary?"rgba(255, 215, 0, 0.2)":"rgba(80, 80, 80, 0.3)"};
  color: ${e=>e.primary?"#ffd700":"#ccc"};
  border: 1px solid ${e=>e.primary?"#ffd700":"#444"};
  border-radius: 5px;
  padding: 10px 15px;
  margin-top: 15px;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
  
  &:hover {
    background: ${e=>e.primary?"rgba(255, 215, 0, 0.3)":"rgba(80, 80, 80, 0.5)"};
  }
  
  &:disabled {
    background: rgba(50, 50, 50, 0.3);
    color: #666;
    border-color: #333;
    cursor: not-allowed;
  }
`,fy=nr.input`
  background: rgba(30, 30, 30, 0.7);
  color: #fff;
  border: 1px solid #444;
  border-radius: 5px;
  padding: 10px;
  margin-bottom: 15px;
  font-size: 16px;
  
  &::placeholder {
    color: #777;
  }
`,yy=nr.div`
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
`,gy=nr.select`
  background: rgba(30, 30, 30, 0.7);
  color: #fff;
  border: 1px solid #444;
  border-radius: 5px;
  padding: 8px;
  font-size: 14px;
`,vy=nr.div`
  text-align: center;
  padding: 20px;
  color: #777;
  font-style: italic;
`,xy=nr.div`
  margin-top: 20px;
  padding: 15px;
  border-radius: 5px;
  background: ${e=>e.success?"rgba(0, 128, 0, 0.2)":"rgba(128, 0, 0, 0.2)"};
  color: ${e=>e.success?"#5f5":"#f55"};
  text-align: center;
`,by=nr.div`
  margin-top: 20px;
  height: 20px;
  background: rgba(30, 30, 30, 0.7);
  border-radius: 10px;
  overflow: hidden;
`,wy=nr.div`
  height: 100%;
  width: ${e=>e.progress}%;
  background: linear-gradient(to right, #ffd700, #ffaa00);
  border-radius: 10px;
  transition: width 0.1s linear;
`,_y=()=>{const{state:e,actions:t}=Nn(),{player:r,cultivation:a}=e,[i,o]=(0,n.useState)("pills"),[s,l]=(0,n.useState)([]),[c,d]=(0,n.useState)(null),[u,p]=(0,n.useState)(""),[h,m]=(0,n.useState)("all"),[f,y]=(0,n.useState)(null),[g,v]=(0,n.useState)(0),[x,b]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{const e=(()=>{switch(i){case"pills":default:return"pill";case"talismans":return"talisman";case"weapons":return"weapon";case"armor":return"armor";case"accessories":return"accessory"}})();let t=[];"pill"===e?t=[{id:1,name:"\u041f\u0438\u043b\u044e\u043b\u044f \u0441\u0431\u043e\u0440\u0430 \u0446\u0438",description:"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043f\u0438\u043b\u044e\u043b\u044f, \u043f\u043e\u043c\u043e\u0433\u0430\u044e\u0449\u0430\u044f \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0438 \u043e\u0447\u0438\u0449\u0430\u0442\u044c \u0446\u0438.",type:"pill",rarity:"common",requiredLevel:1,requiredStage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",successRate:95,ingredients:[{id:"low_grade_herb",name:"\u0422\u0440\u0430\u0432\u0430 \u043d\u0438\u0437\u043a\u043e\u0433\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430",quantity:3},{id:"medium_grade_herb",name:"\u0422\u0440\u0430\u0432\u0430 \u0441\u0440\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430",quantity:1}]},{id:2,name:"\u041f\u0438\u043b\u044e\u043b\u044f \u0443\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u043b\u0430",description:"\u0423\u043a\u0440\u0435\u043f\u043b\u044f\u0435\u0442 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0442\u0435\u043b\u043e, \u043f\u043e\u0432\u044b\u0448\u0430\u044f \u0432\u044b\u043d\u043e\u0441\u043b\u0438\u0432\u043e\u0441\u0442\u044c \u0438 \u0441\u0438\u043b\u0443 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0442\u043e\u0440\u0430.",type:"pill",rarity:"uncommon",requiredLevel:3,requiredStage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",successRate:85,ingredients:[{id:"low_grade_herb",name:"\u0422\u0440\u0430\u0432\u0430 \u043d\u0438\u0437\u043a\u043e\u0433\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430",quantity:2},{id:"medium_grade_herb",name:"\u0422\u0440\u0430\u0432\u0430 \u0441\u0440\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430",quantity:2},{id:"spirit_iron",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u043e\u0435 \u0436\u0435\u043b\u0435\u0437\u043e",quantity:1}]},{id:3,name:"\u041f\u0438\u043b\u044e\u043b\u044f \u043e\u0447\u0438\u0449\u0435\u043d\u0438\u044f \u043c\u0435\u0440\u0438\u0434\u0438\u0430\u043d\u043e\u0432",description:"\u041e\u0447\u0438\u0449\u0430\u0435\u0442 \u0438 \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0435\u0442 \u043c\u0435\u0440\u0438\u0434\u0438\u0430\u043d\u044b, \u043e\u0431\u043b\u0435\u0433\u0447\u0430\u044f \u0446\u0438\u0440\u043a\u0443\u043b\u044f\u0446\u0438\u044e \u0446\u0438 \u043f\u043e \u0442\u0435\u043b\u0443.",type:"pill",rarity:"uncommon",requiredLevel:5,requiredStage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",successRate:80,ingredients:[{id:"medium_grade_herb",name:"\u0422\u0440\u0430\u0432\u0430 \u0441\u0440\u0435\u0434\u043d\u0435\u0433\u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430",quantity:3},{id:"water_essence",name:"\u0412\u043e\u0434\u043d\u0430\u044f \u044d\u0441\u0441\u0435\u043d\u0446\u0438\u044f",quantity:1},{id:"spirit_stone",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0430\u043c\u0435\u043d\u044c",quantity:2}]}]:"talisman"===e?t=[{id:4,name:"\u0422\u0430\u043b\u0438\u0441\u043c\u0430\u043d \u043e\u0442\u0440\u0430\u0436\u0435\u043d\u0438\u044f",description:"\u0411\u0430\u0437\u043e\u0432\u044b\u0439 \u0437\u0430\u0449\u0438\u0442\u043d\u044b\u0439 \u0442\u0430\u043b\u0438\u0441\u043c\u0430\u043d, \u043e\u0442\u0440\u0430\u0436\u0430\u044e\u0449\u0438\u0439 \u0441\u043b\u0430\u0431\u044b\u0435 \u0430\u0442\u0430\u043a\u0438.",type:"talisman",rarity:"common",requiredLevel:2,requiredStage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",successRate:90,ingredients:[{id:"spirit_paper",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u0431\u0443\u043c\u0430\u0433\u0430",quantity:2},{id:"spirit_ink",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u0447\u0435\u0440\u043d\u0438\u043b\u0430",quantity:1}]},{id:5,name:"\u0422\u0430\u043b\u0438\u0441\u043c\u0430\u043d \u043e\u0433\u043d\u0435\u043d\u043d\u043e\u0439 \u043f\u0442\u0438\u0446\u044b",description:"\u0410\u0442\u0430\u043a\u0443\u044e\u0449\u0438\u0439 \u0442\u0430\u043b\u0438\u0441\u043c\u0430\u043d, \u0432\u044b\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0430\u044e\u0449\u0438\u0439 \u043e\u0433\u043d\u0435\u043d\u043d\u0443\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u044e \u0432 \u0444\u043e\u0440\u043c\u0435 \u043f\u0442\u0438\u0446\u044b.",type:"talisman",rarity:"uncommon",requiredLevel:4,requiredStage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",successRate:80,ingredients:[{id:"spirit_paper",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u0431\u0443\u043c\u0430\u0433\u0430",quantity:3},{id:"spirit_ink",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u0447\u0435\u0440\u043d\u0438\u043b\u0430",quantity:2},{id:"fire_essence",name:"\u041e\u0433\u043d\u0435\u043d\u043d\u0430\u044f \u044d\u0441\u0441\u0435\u043d\u0446\u0438\u044f",quantity:2}]}]:"weapon"===e?t=[{id:6,name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0438\u043d\u0436\u0430\u043b",description:"\u041a\u0438\u043d\u0436\u0430\u043b, \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u044b\u0439 \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u0442\u044c \u0434\u0443\u0445\u043e\u0432\u043d\u0443\u044e \u044d\u043d\u0435\u0440\u0433\u0438\u044e \u0438 \u043d\u0430\u043d\u043e\u0441\u0438\u0442\u044c \u0443\u0440\u043e\u043d \u043a\u0430\u043a \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u043c, \u0442\u0430\u043a \u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u043c \u0442\u0435\u043b\u0430\u043c.",type:"weapon",rarity:"uncommon",requiredLevel:5,requiredStage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",successRate:70,ingredients:[{id:"spirit_iron",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u043e\u0435 \u0436\u0435\u043b\u0435\u0437\u043e",quantity:5},{id:"spirit_stone",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0430\u043c\u0435\u043d\u044c",quantity:3},{id:"spirit_essence",name:"\u042d\u0441\u0441\u0435\u043d\u0446\u0438\u044f \u0434\u0443\u0445\u0430",quantity:1}]},{id:7,name:"\u041c\u0435\u0447 \u043f\u044f\u0442\u0438 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432",description:"\u041c\u0435\u0447, \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u044b\u0439 \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u0442\u044c \u044d\u043d\u0435\u0440\u0433\u0438\u044e \u043f\u044f\u0442\u0438 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432, \u0443\u0441\u0438\u043b\u0438\u0432\u0430\u044f \u0430\u0442\u0430\u043a\u0438 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0439 \u0441\u0442\u0438\u0445\u0438\u0435\u0439.",type:"weapon",rarity:"rare",requiredLevel:3,requiredStage:"\u041e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0426\u0438",successRate:60,ingredients:[{id:"spirit_iron",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u043e\u0435 \u0436\u0435\u043b\u0435\u0437\u043e",quantity:8},{id:"spirit_crystal",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0440\u0438\u0441\u0442\u0430\u043b\u043b",quantity:3},{id:"fire_essence",name:"\u041e\u0433\u043d\u0435\u043d\u043d\u0430\u044f \u044d\u0441\u0441\u0435\u043d\u0446\u0438\u044f",quantity:2},{id:"water_essence",name:"\u0412\u043e\u0434\u043d\u0430\u044f \u044d\u0441\u0441\u0435\u043d\u0446\u0438\u044f",quantity:2}]}]:"armor"===e?t=[{id:8,name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043e\u0434\u0435\u0436\u0434\u044b \u043d\u0430\u0447\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f",description:"\u041e\u0434\u0435\u0436\u0434\u044b, \u043f\u0440\u043e\u043f\u0438\u0442\u0430\u043d\u043d\u044b\u0435 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0435\u0439, \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0449\u0438\u0435 \u0431\u0430\u0437\u043e\u0432\u0443\u044e \u0437\u0430\u0449\u0438\u0442\u0443 \u043e\u0442 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 \u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u0430\u0442\u0430\u043a.",type:"armor",rarity:"uncommon",requiredLevel:4,requiredStage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",successRate:75,ingredients:[{id:"spirit_silk",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u0448\u0435\u043b\u043a",quantity:6},{id:"spirit_thread",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u043d\u0438\u0442\u044c",quantity:4},{id:"spirit_essence",name:"\u042d\u0441\u0441\u0435\u043d\u0446\u0438\u044f \u0434\u0443\u0445\u0430",quantity:2}]}]:"accessory"===e&&(t=[{id:9,name:"\u041a\u043e\u043b\u044c\u0446\u043e \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0433\u043e \u0443\u0441\u0438\u043b\u0435\u043d\u0438\u044f",description:"\u041a\u043e\u043b\u044c\u0446\u043e, \u0443\u0441\u0438\u043b\u0438\u0432\u0430\u044e\u0449\u0435\u0435 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0435\u0439 \u0438 \u0443\u0441\u043a\u043e\u0440\u044f\u044e\u0449\u0435\u0435 \u0435\u0451 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435.",type:"accessory",rarity:"uncommon",requiredLevel:3,requiredStage:"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",successRate:80,ingredients:[{id:"spirit_iron",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u043e\u0435 \u0436\u0435\u043b\u0435\u0437\u043e",quantity:3},{id:"spirit_stone",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0430\u043c\u0435\u043d\u044c",quantity:2},{id:"spirit_essence",name:"\u042d\u0441\u0441\u0435\u043d\u0446\u0438\u044f \u0434\u0443\u0445\u0430",quantity:1}]},{id:10,name:"\u0410\u043c\u0443\u043b\u0435\u0442 \u043f\u044f\u0442\u0438 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432",description:"\u0410\u043c\u0443\u043b\u0435\u0442, \u0443\u0441\u0438\u043b\u0438\u0432\u0430\u044e\u0449\u0438\u0439 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c \u043d\u0430\u0434 \u044d\u043d\u0435\u0440\u0433\u0438\u044f\u043c\u0438 \u043f\u044f\u0442\u0438 \u0441\u0442\u0438\u0445\u0438\u0439 \u0438 \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0449\u0438\u0439 \u0437\u0430\u0449\u0438\u0442\u0443 \u043e\u0442 \u043d\u0438\u0445.",type:"accessory",rarity:"rare",requiredLevel:4,requiredStage:"\u041e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0426\u0438",successRate:70,ingredients:[{id:"spirit_stone",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0430\u043c\u0435\u043d\u044c",quantity:5},{id:"spirit_crystal",name:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u043a\u0440\u0438\u0441\u0442\u0430\u043b\u043b",quantity:2},{id:"fire_essence",name:"\u041e\u0433\u043d\u0435\u043d\u043d\u0430\u044f \u044d\u0441\u0441\u0435\u043d\u0446\u0438\u044f",quantity:1},{id:"water_essence",name:"\u0412\u043e\u0434\u043d\u0430\u044f \u044d\u0441\u0441\u0435\u043d\u0446\u0438\u044f",quantity:1}]}]),l(t),d(null)}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0440\u0435\u0446\u0435\u043f\u0442\u043e\u0432 \u0430\u043b\u0445\u0438\u043c\u0438\u0438:",e)}})()}),[i]);const w=n.useMemo((()=>s&&0!==s.length?s.filter((e=>{const t=""===u||e.name.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase()),r="all"===h||e.rarity===h,n=(null===a||void 0===a?void 0:a.stage)||"\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430",i=(null===a||void 0===a?void 0:a.level)||1,o=["\u0417\u0430\u043a\u0430\u043b\u043a\u0430 \u0442\u0435\u043b\u0430","\u041e\u0447\u0438\u0449\u0435\u043d\u0438\u0435 \u0426\u0438","\u0417\u043e\u043b\u043e\u0442\u043e\u0435 \u044f\u0434\u0440\u043e","\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u0443\u0448\u0438"],s=o.indexOf(n),l=o.indexOf(e.requiredStage);let c=!0;return s<l&&(c=!1),s===l&&i<e.requiredLevel&&(c=!1),t&&r})):[]),[s,u,h,a]),_=()=>{100*Math.random()<=c.successRate?(y("success"),b({name:c.name,description:c.description,rarity:c.rarity})):(y("failed"),b(null))},E=e=>{switch(e){case"pill":return"\ud83d\udc8a";case"talisman":return"\ud83d\udcdc";case"weapon":return"\u2694\ufe0f";case"armor":return"\ud83d\udee1\ufe0f";case"accessory":return"\ud83d\udc8d";default:return"?"}};return(0,Cn.jsxs)(Wf,{children:[(0,Cn.jsx)(Hf,{children:(0,Cn.jsx)(Vf,{children:"\u0410\u043b\u0445\u0438\u043c\u0438\u044f \u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432"})}),(0,Cn.jsxs)(Xf,{children:[(0,Cn.jsx)(Jf,{active:"pills"===i,onClick:()=>o("pills"),children:"\u041f\u0438\u043b\u044e\u043b\u0438"}),(0,Cn.jsx)(Jf,{active:"talismans"===i,onClick:()=>o("talismans"),children:"\u0422\u0430\u043b\u0438\u0441\u043c\u0430\u043d\u044b"}),(0,Cn.jsx)(Jf,{active:"weapons"===i,onClick:()=>o("weapons"),children:"\u041e\u0440\u0443\u0436\u0438\u0435"}),(0,Cn.jsx)(Jf,{active:"armor"===i,onClick:()=>o("armor"),children:"\u0411\u0440\u043e\u043d\u044f"}),(0,Cn.jsx)(Jf,{active:"accessories"===i,onClick:()=>o("accessories"),children:"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b"})]}),(0,Cn.jsxs)(Qf,{children:[(0,Cn.jsxs)(Yf,{children:[(0,Cn.jsx)(fy,{placeholder:"\u041f\u043e\u0438\u0441\u043a \u0440\u0435\u0446\u0435\u043f\u0442\u043e\u0432...",value:u,onChange:e=>p(e.target.value)}),(0,Cn.jsx)(yy,{children:(0,Cn.jsxs)(gy,{value:h,onChange:e=>m(e.target.value),children:[(0,Cn.jsx)("option",{value:"all",children:"\u041b\u044e\u0431\u0430\u044f \u0440\u0435\u0434\u043a\u043e\u0441\u0442\u044c"}),(0,Cn.jsx)("option",{value:"common",children:"\u041e\u0431\u044b\u0447\u043d\u044b\u0435"}),(0,Cn.jsx)("option",{value:"uncommon",children:"\u041d\u0435\u043e\u0431\u044b\u0447\u043d\u044b\u0435"}),(0,Cn.jsx)("option",{value:"rare",children:"\u0420\u0435\u0434\u043a\u0438\u0435"}),(0,Cn.jsx)("option",{value:"epic",children:"\u042d\u043f\u0438\u0447\u0435\u0441\u043a\u0438\u0435"}),(0,Cn.jsx)("option",{value:"legendary",children:"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0435"})]})}),(0,Cn.jsx)(Zf,{children:w.length>0?w.map((e=>(0,Cn.jsxs)(ey,{selected:c&&c.id===e.id,onClick:()=>d(e),children:[(0,Cn.jsx)(ty,{children:E(e.type)}),(0,Cn.jsxs)(ry,{children:[(0,Cn.jsx)(ny,{rarity:e.rarity,children:e.name}),(0,Cn.jsx)(ay,{children:e.description})]})]},e.id))):(0,Cn.jsx)(vy,{children:"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0445 \u0440\u0435\u0446\u0435\u043f\u0442\u043e\u0432 \u0432 \u044d\u0442\u043e\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"})})]}),(0,Cn.jsx)(Kf,{children:c?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(oy,{children:c.name}),(0,Cn.jsx)(ay,{children:c.description}),(0,Cn.jsxs)(iy,{children:[(0,Cn.jsxs)(sy,{children:[(0,Cn.jsx)(ly,{children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)(cy,{children:(()=>{switch(c.type){case"pill":return"\u041f\u0438\u043b\u044e\u043b\u044f";case"talisman":return"\u0422\u0430\u043b\u0438\u0441\u043c\u0430\u043d";case"weapon":return"\u041e\u0440\u0443\u0436\u0438\u0435";case"armor":return"\u0411\u0440\u043e\u043d\u044f";case"accessory":return"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440";default:return c.type}})()})]}),(0,Cn.jsxs)(sy,{children:[(0,Cn.jsx)(ly,{children:"\u0420\u0435\u0434\u043a\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)(cy,{style:{color:(()=>{switch(c.rarity){case"common":default:return"#aaa";case"uncommon":return"#1eff00";case"rare":return"#0070dd";case"epic":return"#a335ee";case"legendary":return"#ff8000"}})()},children:(()=>{switch(c.rarity){case"common":return"\u041e\u0431\u044b\u0447\u043d\u043e\u0435";case"uncommon":return"\u041d\u0435\u043e\u0431\u044b\u0447\u043d\u043e\u0435";case"rare":return"\u0420\u0435\u0434\u043a\u043e\u0435";case"epic":return"\u042d\u043f\u0438\u0447\u0435\u0441\u043a\u043e\u0435";case"legendary":return"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u043e\u0435";default:return c.rarity}})()})]}),(0,Cn.jsxs)(sy,{children:[(0,Cn.jsx)(ly,{children:"\u0422\u0440\u0435\u0431\u0443\u0435\u043c\u0430\u044f \u0441\u0442\u0443\u043f\u0435\u043d\u044c:"}),(0,Cn.jsx)(cy,{children:c.requiredStage})]}),(0,Cn.jsxs)(sy,{children:[(0,Cn.jsx)(ly,{children:"\u0422\u0440\u0435\u0431\u0443\u0435\u043c\u044b\u0439 \u0443\u0440\u043e\u0432\u0435\u043d\u044c:"}),(0,Cn.jsx)(cy,{children:c.requiredLevel})]}),(0,Cn.jsxs)(sy,{children:[(0,Cn.jsx)(ly,{children:"\u0428\u0430\u043d\u0441 \u0443\u0441\u043f\u0435\u0445\u0430:"}),(0,Cn.jsxs)(cy,{children:[c.successRate,"%"]})]})]}),(0,Cn.jsxs)(dy,{children:[(0,Cn.jsx)(oy,{children:"\u0418\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u044b:"}),c.ingredients.map((e=>{const t=(e=>{if(!r.inventory.items)return 0;const t=r.inventory.items.find((t=>t.itemId===e));return t?t.quantity:0})(e.id),n=t>=e.quantity;return(0,Cn.jsxs)(uy,{available:n,children:[(0,Cn.jsx)(py,{available:n,children:e.name}),(0,Cn.jsxs)(hy,{available:n,children:[t,"/",e.quantity]})]},e.id)}))]}),"crafting"===f&&(0,Cn.jsx)(by,{children:(0,Cn.jsx)(wy,{progress:g})}),f&&"crafting"!==f?"success"===f?(0,Cn.jsxs)(xy,{success:!0,children:[(0,Cn.jsx)("h3",{children:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!"}),(0,Cn.jsxs)("p",{children:["\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u043b\u0438 ",x.name]})]}):(0,Cn.jsxs)(xy,{success:!1,children:[(0,Cn.jsx)("h3",{children:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c!"}),(0,Cn.jsxs)("p",{children:["\u0412\u044b \u043d\u0435 \u0441\u043c\u043e\u0433\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u0442\u044c ",c.name,". \u0418\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u044b \u043f\u043e\u0442\u0440\u0430\u0447\u0435\u043d\u044b \u0432\u043f\u0443\u0441\u0442\u0443\u044e."]})]}):null,(0,Cn.jsx)(my,{primary:!0,onClick:async()=>{if(!c)return;y("crafting"),v(0);let e=0;const t=setInterval((()=>{e++,v(Math.min(100,e/60*100)),e>=60&&(clearInterval(t),_())}),50)},disabled:!(e=>{if(!e||!e.ingredients||!r.inventory.items)return!1;for(const t of e.ingredients){if(!r.inventory.items.find((e=>e.itemId===t.id&&e.quantity>=t.quantity)))return!1}return!0})(c)||"crafting"===f,children:"crafting"===f?"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]}):(0,Cn.jsx)(vy,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0446\u0435\u043f\u0442 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0434\u0435\u0442\u0430\u043b\u0435\u0439"})})]})]})},Ey=e=>{let{pet:t,isActive:r,onActivate:n,onFeed:a,onTrain:i,onViewDetails:o}=e;const s=e=>({fire:"#e74c3c",water:"#3498db",earth:"#8e44ad",wind:"#2ecc71",lightning:"#f1c40f",wood:"#27ae60",metal:"#95a5a6",darkness:"#34495e",light:"#f5f5f5"}[e]||"#bdc3c7"),l=(0,dl.calculateExpForLevel)(t.level),c=t.experience/l*100;(0,dl.calculateCombatBonus)(t);return(0,Cn.jsxs)("div",{className:"pet-card "+(r?"pet-card-active":""),style:{borderColor:s(t.type)},children:[(0,Cn.jsxs)("div",{className:"pet-card-header",style:{backgroundColor:s(t.type)},children:[(0,Cn.jsx)("h3",{className:"pet-name",children:t.name}),(0,Cn.jsx)("div",{className:"pet-type",children:dl.petTypeNames[t.type]}),r&&(0,Cn.jsx)("div",{className:"pet-active-badge",children:"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0439"})]}),(0,Cn.jsxs)("div",{className:"pet-card-body",children:[(0,Cn.jsxs)("div",{className:"pet-info-row",children:[(0,Cn.jsxs)("div",{className:"pet-level",children:["\u0423\u0440\u043e\u0432\u0435\u043d\u044c ",t.level]}),(0,Cn.jsxs)("div",{className:"pet-evolution",children:["\u0421\u0442\u0430\u0434\u0438\u044f: ",dl.evolutionStages[t.evolutionStage].name]})]}),(0,Cn.jsxs)("div",{className:"pet-exp-bar-container",children:[(0,Cn.jsx)("div",{className:"pet-exp-bar",style:{width:`${c}%`}}),(0,Cn.jsxs)("div",{className:"pet-exp-text",children:[t.experience," / ",l," \u043e\u043f\u044b\u0442\u0430"]})]}),(0,Cn.jsxs)("div",{className:"pet-stats-container",children:[(0,Cn.jsxs)("div",{className:"pet-stat",children:[(0,Cn.jsx)("span",{className:"stat-name",children:"\u0421\u0438\u043b\u0430:"}),(0,Cn.jsx)("span",{className:"stat-value",children:t.strength})]}),(0,Cn.jsxs)("div",{className:"pet-stat",children:[(0,Cn.jsx)("span",{className:"stat-name",children:"\u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442:"}),(0,Cn.jsx)("span",{className:"stat-value",children:t.intelligence})]}),(0,Cn.jsxs)("div",{className:"pet-stat",children:[(0,Cn.jsx)("span",{className:"stat-name",children:"\u041b\u043e\u0432\u043a\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:"stat-value",children:t.agility})]}),(0,Cn.jsxs)("div",{className:"pet-stat",children:[(0,Cn.jsx)("span",{className:"stat-name",children:"\u0416\u0438\u0432\u0443\u0447\u0435\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:"stat-value",children:t.vitality})]}),(0,Cn.jsxs)("div",{className:"pet-stat",children:[(0,Cn.jsx)("span",{className:"stat-name",children:"\u0414\u0443\u0445:"}),(0,Cn.jsx)("span",{className:"stat-value",children:t.spirit})]})]}),(0,Cn.jsxs)("div",{className:"pet-indicators",children:[(0,Cn.jsxs)("div",{className:"pet-indicator",children:[(0,Cn.jsx)("span",{className:"indicator-name",children:"\u0421\u044b\u0442\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("div",{className:"indicator-bar-container",children:(0,Cn.jsx)("div",{className:"indicator-bar",style:{width:`${t.hunger}%`,backgroundColor:t.hunger<30?"#e74c3c":"#2ecc71"}})}),(0,Cn.jsxs)("span",{className:"indicator-value",children:[t.hunger,"%"]})]}),(0,Cn.jsxs)("div",{className:"pet-indicator",children:[(0,Cn.jsx)("span",{className:"indicator-name",children:"\u041b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("div",{className:"indicator-bar-container",children:(0,Cn.jsx)("div",{className:"indicator-bar",style:{width:`${t.loyalty}%`,backgroundColor:t.loyalty<50?"#e74c3c":"#2ecc71"}})}),(0,Cn.jsxs)("span",{className:"indicator-value",children:[t.loyalty,"%"]}),t.loyalty<=50&&(0,Cn.jsx)("div",{className:"loyalty-warning",style:{color:t.loyalty<=25?"#e74c3c":"#e67e22",fontSize:"0.8rem",fontWeight:"bold",marginTop:"5px",textAlign:"center",padding:"3px",border:"1px solid "+(t.loyalty<=25?"#e74c3c":"#e67e22"),borderRadius:"4px",background:t.loyalty<=25?"rgba(231, 76, 60, 0.1)":"rgba(230, 126, 34, 0.1)"},children:t.loyalty<=25?"\u26a0\ufe0f \u041f\u0438\u0442\u043e\u043c\u0435\u0446 \u043c\u043e\u0436\u0435\u0442 \u0441\u0431\u0435\u0436\u0430\u0442\u044c \u0432 \u0431\u043e\u044e!":"\u26a0\ufe0f \u041b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u043d\u0438\u0436\u0430\u0435\u0442\u0441\u044f \u0431\u044b\u0441\u0442\u0440\u0435\u0435 \u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 \u0432 \u0431\u043e\u044e!"})]})]}),(0,Cn.jsxs)("div",{className:"pet-card-buttons",children:[!r&&(0,Cn.jsx)("button",{className:"pet-action-button activate-button",onClick:()=>n(t.id),children:"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u043c"}),(0,Cn.jsx)("button",{className:"pet-action-button feed-button",onClick:()=>a(t.id),children:"\u041f\u043e\u043a\u043e\u0440\u043c\u0438\u0442\u044c"}),(0,Cn.jsx)("button",{className:"pet-action-button train-button",onClick:()=>i(t.id),children:"\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,Cn.jsx)("button",{className:"pet-action-button details-button",onClick:()=>o(t),children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0441\u0442\u0438"})]})]})]})},Ty=e=>{let{pet:t,onClose:r,onSelect:n,availableFood:a}=e;return(0,Cn.jsx)("div",{className:"modal-overlay",children:(0,Cn.jsxs)("div",{className:"modal-content",children:[(0,Cn.jsxs)("div",{className:"modal-header",children:[(0,Cn.jsxs)("h3",{children:["\u041a\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u0430 ",t.name]}),(0,Cn.jsx)("button",{className:"modal-close",onClick:r,children:"\xd7"})]}),(0,Cn.jsxs)("div",{className:"modal-body",children:[(0,Cn.jsx)("p",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0435\u0434\u0443 \u0434\u043b\u044f \u043f\u0438\u0442\u043e\u043c\u0446\u0430:"}),a.length>0?(0,Cn.jsx)("div",{className:"food-items-list",children:a.map((e=>(0,Cn.jsxs)("div",{className:"food-item",onClick:()=>n(e.id),style:{padding:"10px",margin:"5px 0",border:"1px solid #444",borderRadius:"5px",display:"flex",flexDirection:"column",cursor:"pointer",transition:"background 0.2s",background:"rgba(30, 30, 30, 0.7)"},onMouseOver:e=>{e.currentTarget.style.background="rgba(80, 80, 80, 0.7)"},onMouseOut:e=>{e.currentTarget.style.background="rgba(30, 30, 30, 0.7)"},children:[(0,Cn.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Cn.jsx)("span",{style:{fontWeight:"bold",color:(()=>{switch(e.rarity){case"common":default:return"#aaa";case"uncommon":return"#1eff00";case"rare":return"#0070dd";case"epic":return"#a335ee";case"legendary":return"#ff8000"}})()},children:e.name}),(0,Cn.jsxs)("span",{children:["x",e.quantity]})]}),(0,Cn.jsx)("div",{style:{fontSize:"0.9em",color:"#aaa",marginTop:"3px"},children:e.description}),(0,Cn.jsxs)("div",{style:{display:"flex",marginTop:"5px"},children:[(0,Cn.jsxs)("div",{style:{flex:1,color:"#2ecc71",fontSize:"0.9em"},children:["\u0421\u044b\u0442\u043e\u0441\u0442\u044c: +",e.nutritionValue,"%"]}),(0,Cn.jsxs)("div",{style:{flex:1,color:"#e67e22",fontSize:"0.9em"},children:["\u041b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c: +",e.loyaltyBonus,"%"]})]})]},e.id)))}):(0,Cn.jsx)("p",{className:"no-food-message",style:{color:"#e74c3c"},children:"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u0435\u0434\u044b \u0434\u043b\u044f \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432. \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043a\u0443\u043f\u0438\u0442\u044c \u0435\u0451 \u0443 \u0421\u0442\u0430\u0440\u043e\u0433\u043e \u0427\u0435\u043d\u0430 \u043d\u0430 \u0440\u044b\u043d\u043a\u0435."})]})]})})},Sy=e=>{let{pet:t,onClose:r,onTrain:n}=e;return(0,Cn.jsx)("div",{className:"modal-overlay",children:(0,Cn.jsxs)("div",{className:"modal-content",children:[(0,Cn.jsxs)("div",{className:"modal-header",children:[(0,Cn.jsxs)("h3",{children:["\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u0438\u0442\u043e\u043c\u0446\u0430 ",t.name]}),(0,Cn.jsx)("button",{className:"modal-close",onClick:r,children:"\xd7"})]}),(0,Cn.jsxs)("div",{className:"modal-body",children:[(0,Cn.jsx)("p",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0443 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438:"}),(0,Cn.jsx)("p",{className:"training-info",children:"\u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e\u0432\u044b\u0441\u0438\u0442 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u0443\u044e \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0443 \u043d\u0430 1, \u043d\u043e \u0443\u043c\u0435\u043d\u044c\u0448\u0438\u0442 \u0441\u044b\u0442\u043e\u0441\u0442\u044c \u043d\u0430 15%."}),(0,Cn.jsxs)("div",{className:"training-buttons",children:[(0,Cn.jsxs)("button",{className:"training-button",onClick:()=>n(t.id,"strength"),disabled:t.hunger<30,children:["\u0421\u0438\u043b\u0430 (",t.strength,")"]}),(0,Cn.jsxs)("button",{className:"training-button",onClick:()=>n(t.id,"intelligence"),disabled:t.hunger<30,children:["\u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442 (",t.intelligence,")"]}),(0,Cn.jsxs)("button",{className:"training-button",onClick:()=>n(t.id,"agility"),disabled:t.hunger<30,children:["\u041b\u043e\u0432\u043a\u043e\u0441\u0442\u044c (",t.agility,")"]}),(0,Cn.jsxs)("button",{className:"training-button",onClick:()=>n(t.id,"vitality"),disabled:t.hunger<30,children:["\u0416\u0438\u0432\u0443\u0447\u0435\u0441\u0442\u044c (",t.vitality,")"]}),(0,Cn.jsxs)("button",{className:"training-button",onClick:()=>n(t.id,"spirit"),disabled:t.hunger<30,children:["\u0414\u0443\u0445 (",t.spirit,")"]})]}),t.hunger<30&&(0,Cn.jsx)("p",{className:"training-warning",children:"\u041f\u0438\u0442\u043e\u043c\u0435\u0446 \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0433\u043e\u043b\u043e\u0434\u0435\u043d \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438. \u041f\u043e\u043a\u043e\u0440\u043c\u0438\u0442\u0435 \u0435\u0433\u043e \u0441\u043d\u0430\u0447\u0430\u043b\u0430!"})]})]})})},jy=e=>{let{pet:t,onClose:r}=e;const n=t.abilities.map((e=>{var r;return(null===(r=dl.petTypeAbilities[t.type])||void 0===r?void 0:r.find((t=>t.id===e)))||{id:e,name:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u044c",description:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442"}})),a=(0,dl.calculateCombatBonus)(t),i=e=>{if(!e)return"\u041d\u0438\u043a\u043e\u0433\u0434\u0430";const t=new Date(e);return`${t.toLocaleDateString()} ${t.toLocaleTimeString()}`};return(0,Cn.jsx)("div",{className:"modal-overlay",children:(0,Cn.jsxs)("div",{className:"modal-content pet-details-modal",children:[(0,Cn.jsxs)("div",{className:"modal-header",children:[(0,Cn.jsxs)("h3",{children:[t.name," - ",dl.petTypeNames[t.type]]}),(0,Cn.jsx)("button",{className:"modal-close",onClick:r,children:"\xd7"})]}),(0,Cn.jsxs)("div",{className:"modal-body",children:[(0,Cn.jsxs)("div",{className:"pet-details-section",children:[(0,Cn.jsx)("h4",{children:"\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),(0,Cn.jsx)("p",{className:"pet-description",children:dl.petTypeDescriptions[t.type]}),(0,Cn.jsxs)("div",{className:"pet-details-row",children:[(0,Cn.jsxs)("div",{className:"pet-detail",children:[(0,Cn.jsx)("span",{className:"detail-label",children:"\u0423\u0440\u043e\u0432\u0435\u043d\u044c:"}),(0,Cn.jsx)("span",{className:"detail-value",children:t.level})]}),(0,Cn.jsxs)("div",{className:"pet-detail",children:[(0,Cn.jsx)("span",{className:"detail-label",children:"\u041e\u043f\u044b\u0442:"}),(0,Cn.jsxs)("span",{className:"detail-value",children:[t.experience," / ",(0,dl.calculateExpForLevel)(t.level)]})]}),(0,Cn.jsxs)("div",{className:"pet-detail",children:[(0,Cn.jsx)("span",{className:"detail-label",children:"\u0421\u0442\u0430\u0434\u0438\u044f \u044d\u0432\u043e\u043b\u044e\u0446\u0438\u0438:"}),(0,Cn.jsx)("span",{className:"detail-value",children:dl.evolutionStages[t.evolutionStage].name})]})]}),(0,Cn.jsx)("div",{className:"pet-evolution-description",children:dl.evolutionStages[t.evolutionStage].description})]}),(0,Cn.jsxs)("div",{className:"pet-details-section",children:[(0,Cn.jsx)("h4",{children:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438"}),(0,Cn.jsxs)("div",{className:"pet-details-stats",children:[(0,Cn.jsxs)("div",{className:"pet-detail-stat",children:[(0,Cn.jsx)("span",{className:"detail-stat-name",children:"\u0421\u0438\u043b\u0430:"}),(0,Cn.jsx)("span",{className:"detail-stat-value",children:t.strength})]}),(0,Cn.jsxs)("div",{className:"pet-detail-stat",children:[(0,Cn.jsx)("span",{className:"detail-stat-name",children:"\u0418\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442:"}),(0,Cn.jsx)("span",{className:"detail-stat-value",children:t.intelligence})]}),(0,Cn.jsxs)("div",{className:"pet-detail-stat",children:[(0,Cn.jsx)("span",{className:"detail-stat-name",children:"\u041b\u043e\u0432\u043a\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:"detail-stat-value",children:t.agility})]}),(0,Cn.jsxs)("div",{className:"pet-detail-stat",children:[(0,Cn.jsx)("span",{className:"detail-stat-name",children:"\u0416\u0438\u0432\u0443\u0447\u0435\u0441\u0442\u044c:"}),(0,Cn.jsx)("span",{className:"detail-stat-value",children:t.vitality})]}),(0,Cn.jsxs)("div",{className:"pet-detail-stat",children:[(0,Cn.jsx)("span",{className:"detail-stat-name",children:"\u0414\u0443\u0445:"}),(0,Cn.jsx)("span",{className:"detail-stat-value",children:t.spirit})]})]})]}),(0,Cn.jsxs)("div",{className:"pet-details-section",children:[(0,Cn.jsx)("h4",{children:"\u0411\u043e\u0435\u0432\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b"}),(0,Cn.jsxs)("div",{className:"pet-details-combat",children:[(0,Cn.jsxs)("div",{className:"pet-combat-bonus",children:[(0,Cn.jsx)("span",{className:"combat-bonus-name",children:"\u0410\u0442\u0430\u043a\u0430:"}),(0,Cn.jsxs)("span",{className:"combat-bonus-value",children:["+",a.attack]})]}),(0,Cn.jsxs)("div",{className:"pet-combat-bonus",children:[(0,Cn.jsx)("span",{className:"combat-bonus-name",children:"\u0417\u0430\u0449\u0438\u0442\u0430:"}),(0,Cn.jsxs)("span",{className:"combat-bonus-value",children:["+",a.defense]})]}),(0,Cn.jsxs)("div",{className:"pet-combat-bonus",children:[(0,Cn.jsx)("span",{className:"combat-bonus-name",children:"\u0421\u043a\u043e\u0440\u043e\u0441\u0442\u044c:"}),(0,Cn.jsxs)("span",{className:"combat-bonus-value",children:["+",a.speed]})]}),(0,Cn.jsxs)("div",{className:"pet-combat-bonus",children:[(0,Cn.jsx)("span",{className:"combat-bonus-name",children:"\u0428\u0430\u043d\u0441 \u043a\u0440\u0438\u0442.\u0443\u0434\u0430\u0440\u0430:"}),(0,Cn.jsxs)("span",{className:"combat-bonus-value",children:["+",(100*a.critChance).toFixed(1),"%"]})]}),(0,Cn.jsxs)("div",{className:"pet-combat-bonus",children:[(0,Cn.jsx)("span",{className:"combat-bonus-name",children:"\u0411\u043e\u043d\u0443\u0441 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u044f:"}),(0,Cn.jsxs)("span",{className:"combat-bonus-value",children:["+",a.healthBonus]})]}),(0,Cn.jsxs)("div",{className:"pet-combat-bonus",children:[(0,Cn.jsx)("span",{className:"combat-bonus-name",children:"\u0411\u043e\u043d\u0443\u0441 \u044d\u043d\u0435\u0440\u0433\u0438\u0438:"}),(0,Cn.jsxs)("span",{className:"combat-bonus-value",children:["+",a.energyBonus]})]})]})]}),(0,Cn.jsxs)("div",{className:"pet-details-section",children:[(0,Cn.jsx)("h4",{children:"\u0421\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438"}),(0,Cn.jsx)("div",{className:"pet-abilities-list",children:n.map((e=>(0,Cn.jsxs)("div",{className:"pet-ability",children:[(0,Cn.jsxs)("div",{className:"ability-header",children:[(0,Cn.jsx)("span",{className:"ability-name",children:e.name}),(0,Cn.jsx)("span",{className:"ability-type",children:"attack"===e.type?"\u0410\u0442\u0430\u043a\u0430":"buff"===e.type?"\u0423\u0441\u0438\u043b\u0435\u043d\u0438\u0435":"\u042d\u0444\u0444\u0435\u043a\u0442"})]}),(0,Cn.jsx)("div",{className:"ability-description",children:e.description}),e.cooldown&&(0,Cn.jsxs)("div",{className:"ability-cooldown",children:["\u041f\u0435\u0440\u0435\u0437\u0430\u0440\u044f\u0434\u043a\u0430: ",e.cooldown," \u0445\u043e\u0434\u043e\u0432"]})]},e.id)))}),0===n.length&&(0,Cn.jsx)("p",{className:"no-abilities",children:"\u0423 \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0435\u0439"})]}),(0,Cn.jsxs)("div",{className:"pet-details-section",children:[(0,Cn.jsx)("h4",{children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u0443\u0445\u043e\u0434\u0435"}),(0,Cn.jsxs)("div",{className:"pet-details-care",children:[(0,Cn.jsxs)("div",{className:"pet-care-info",children:[(0,Cn.jsx)("span",{className:"care-info-name",children:"\u0421\u044b\u0442\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("div",{className:"care-info-bar-container",children:(0,Cn.jsx)("div",{className:"care-info-bar",style:{width:`${t.hunger}%`,backgroundColor:t.hunger<30?"#e74c3c":"#2ecc71"}})}),(0,Cn.jsxs)("span",{className:"care-info-value",children:[t.hunger,"%"]})]}),(0,Cn.jsxs)("div",{className:"pet-care-info",children:[(0,Cn.jsx)("span",{className:"care-info-name",children:"\u041b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)("div",{className:"care-info-bar-container",children:(0,Cn.jsx)("div",{className:"care-info-bar",style:{width:`${t.loyalty}%`,backgroundColor:t.loyalty<50?"#e74c3c":"#2ecc71"}})}),(0,Cn.jsxs)("span",{className:"care-info-value",children:[t.loyalty,"%"]}),t.loyalty<=25&&(0,Cn.jsx)("div",{style:{color:"#e74c3c",fontSize:"0.85rem",fontWeight:"bold",marginTop:"5px",textAlign:"center",padding:"5px",border:"1px solid #e74c3c",borderRadius:"4px",background:"rgba(231, 76, 60, 0.1)"},children:"\u26a0\ufe0f \u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435! \u041f\u0440\u0438 \u043d\u0438\u0437\u043a\u043e\u0439 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u043f\u0438\u0442\u043e\u043c\u0435\u0446 \u043c\u043e\u0436\u0435\u0442 \u0441\u0431\u0435\u0436\u0430\u0442\u044c \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0431\u043e\u044f!"})]}),(0,Cn.jsxs)("div",{className:"pet-loyalty-mechanics",style:{marginTop:"10px",padding:"10px",backgroundColor:"rgba(50, 50, 50, 0.5)",borderRadius:"5px",fontSize:"0.9em"},children:[(0,Cn.jsx)("h5",{style:{margin:"0 0 5px 0",fontSize:"1em"},children:"\u041c\u0435\u0445\u0430\u043d\u0438\u043a\u0430 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438:"}),(0,Cn.jsxs)("ul",{style:{margin:"0",paddingLeft:"20px"},children:[(0,Cn.jsx)("li",{children:"\u041f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u043f\u043e\u0441\u043e\u0431\u043d\u043e\u0441\u0442\u0438 \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u0432 \u0431\u043e\u044e, \u043e\u043d \u0442\u0435\u0440\u044f\u0435\u0442 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c"}),(0,Cn.jsxs)("li",{children:["\u041f\u043e\u0442\u0435\u0440\u044f \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438: ",(0,Cn.jsx)("span",{style:{fontWeight:"bold"},children:"5 \xd7 (100 / \u0441\u044b\u0442\u043e\u0441\u0442\u044c)"})]}),(0,Cn.jsx)("li",{children:"\u0427\u0435\u043c \u043d\u0438\u0436\u0435 \u0441\u044b\u0442\u043e\u0441\u0442\u044c, \u0442\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u043e\u0442\u0435\u0440\u044f \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438"}),(0,Cn.jsxs)("li",{children:["\u041f\u0440\u0438\u043c\u0435\u0440\u043d\u0430\u044f \u043f\u043e\u0442\u0435\u0440\u044f \u043f\u0440\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u044b\u0442\u043e\u0441\u0442\u0438: ",(0,Cn.jsxs)("span",{style:{fontWeight:"bold",color:"#e74c3c"},children:[Math.round(100/Math.max(t.hunger,1)*5),"%"]})]}),(0,Cn.jsx)("li",{children:"\u041f\u0440\u0438 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u2264 25%, \u043f\u0438\u0442\u043e\u043c\u0435\u0446 \u043c\u043e\u0436\u0435\u0442 \u0443\u0431\u0435\u0436\u0430\u0442\u044c \u0432 \u0431\u043e\u044e"})]})]}),(0,Cn.jsxs)("div",{className:"pet-care-timestamps",style:{marginTop:"10px"},children:[(0,Cn.jsxs)("div",{className:"pet-timestamp",children:[(0,Cn.jsx)("span",{className:"timestamp-label",children:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u043a\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435:"}),(0,Cn.jsx)("span",{className:"timestamp-value",children:i(t.lastFed)})]}),(0,Cn.jsxs)("div",{className:"pet-timestamp",children:[(0,Cn.jsx)("span",{className:"timestamp-label",children:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430:"}),(0,Cn.jsx)("span",{className:"timestamp-value",children:i(t.lastTrained)})]})]})]})]})]})]})})},Cy=()=>{var e,t,r;const{state:a,actions:i}=Nn(),[o,s]=(0,n.useState)(!1),[l,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[p,h]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),[y,g]=(0,n.useState)(!1),v=(null===(e=a.player)||void 0===e?void 0:e.spiritPets)||{pets:[],activePetId:null},x=Array.isArray(v.pets)?v.pets:[],b=x.find((e=>e.id===v.activePetId));(0,n.useEffect)((()=>{var e,t,r;const n=(null===(e=a.player)||void 0===e?void 0:e.id)||"demo_user";if(null===(t=a.player)||void 0===t||!t.spiritPets||!Array.isArray(null===(r=a.player)||void 0===r?void 0:r.spiritPets.pets)||0===a.player.spiritPets.pets.length){console.log("\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0434\u0435\u043c\u043e-\u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u0434\u043b\u044f \u0438\u0433\u0440\u043e\u043a\u0430");const e=(e=>({id:`pet_${Date.now()}`,userId:e||"demo_user",name:"\u0412\u0435\u0442\u0435\u0440",type:"wind",level:1,experience:0,loyalty:80,hunger:70,strength:7,intelligence:5,agility:6,vitality:4,spirit:6,abilities:["wind_breath"],evolutionStage:1,isActive:!0,lastFed:new Date,lastTrained:new Date,createdAt:new Date,updatedAt:new Date}))(n);i.addSpiritPet(e)}}),[null===(t=a.player)||void 0===t?void 0:t.id,null===(r=a.player)||void 0===r?void 0:r.spiritPets,i]);const w=e=>{s(!0);try{i.setActiveSpiritPet(e),s(!1)}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u043f\u0438\u0442\u043e\u043c\u0446\u0430:",t),c("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435."),s(!1)}},_=e=>{const t=x.find((t=>t.id===e));t&&(u(t),g(!0))},E=e=>{const t=x.find((t=>t.id===e));t&&(u(t),h(!0))},T=e=>{u(e),f(!0)};return o&&0===x.length?(0,Cn.jsxs)("div",{className:"pets-loading-container",children:[(0,Cn.jsx)("div",{className:"pets-loading-spinner"}),(0,Cn.jsx)("div",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432..."})]}):l&&0===x.length?(0,Cn.jsxs)("div",{className:"pets-error-container",children:[(0,Cn.jsx)("div",{className:"pets-error-message",children:l}),(0,Cn.jsx)("button",{className:"pets-refresh-button",onClick:()=>window.location.reload(),children:"\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0441\u043d\u043e\u0432\u0430"})]}):(0,Cn.jsxs)("div",{className:"spirit-pets-container",children:[(0,Cn.jsxs)("div",{className:"pets-header",children:[(0,Cn.jsx)("h2",{children:"\u0414\u0443\u0445\u043e\u0432\u043d\u044b\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u044b"}),(0,Cn.jsx)("button",{className:"tame-pet-button",onClick:()=>{s(!0);try{var e,t,r;null===(e=a.player)||void 0===e||null===(t=e.location)||void 0===t||t.name;const n=(null===(r=a.player)||void 0===r?void 0:r.id)||"demo_user",o=["fire","water","earth","wind","lightning"],l=o[Math.floor(Math.random()*o.length)],c=["\u0418\u0441\u043a\u0440\u0430","\u0428\u0442\u043e\u0440\u043c","\u0422\u0435\u043d\u044c","\u041b\u0443\u043d\u0430","\u0417\u0432\u0435\u0437\u0434\u0430","\u0413\u0440\u043e\u043c","\u041c\u043e\u043b\u043d\u0438\u044f","\u0412\u0435\u0442\u0435\u0440","\u041e\u0433\u043e\u043d\u044c","\u0412\u043e\u0434\u0430","\u0417\u0435\u043c\u043b\u044f","\u041a\u0430\u043c\u0435\u043d\u044c","\u041b\u0438\u0441\u0442","\u0422\u0443\u043c\u0430\u043d"],d=c[Math.floor(Math.random()*c.length)],u=dl.petTypeBaseStats[l]||{strength:5,intelligence:5,agility:5,vitality:5,spirit:5},p={id:`pet_${Date.now()}`,userId:n,name:d,type:l,level:1,experience:0,loyalty:50,hunger:70,strength:u.strength,intelligence:u.intelligence,agility:u.agility,vitality:u.vitality,spirit:u.spirit,abilities:[`${l}_breath`],evolutionStage:1,isActive:!1,lastFed:new Date,lastTrained:new Date,createdAt:new Date,updatedAt:new Date};i.addSpiritPet(p),s(!1)}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u0438\u0440\u0443\u0447\u0435\u043d\u0438\u0438 \u043f\u0438\u0442\u043e\u043c\u0446\u0430:",n),c("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u0438\u0440\u0443\u0447\u0438\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435."),s(!1)}},children:"\u041f\u0440\u0438\u0440\u0443\u0447\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0438\u0442\u043e\u043c\u0446\u0430"})]}),l&&(0,Cn.jsx)("div",{className:"pets-error-message",children:l}),0===x.length?(0,Cn.jsx)("div",{className:"no-pets-message",children:(0,Cn.jsx)("p",{children:'\u0423 \u0432\u0430\u0441 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442 \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432. \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 "\u041f\u0440\u0438\u0440\u0443\u0447\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u043f\u0438\u0442\u043e\u043c\u0446\u0430", \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0447\u0430\u0442\u044c.'})}):(0,Cn.jsx)("div",{className:"pets-grid",children:x.map((e=>(0,Cn.jsx)(Ey,{pet:e,isActive:b&&b.id===e.id,onActivate:w,onFeed:_,onTrain:E,onViewDetails:T},e.id)))}),y&&d&&(0,Cn.jsx)(Ty,{pet:d,onClose:()=>g(!1),onSelect:e=>((e,t)=>{s(!0);try{if(t)i.feedSpiritPet({petId:e,foodItemId:t});else{console.log("\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u0435\u0434\u044b \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u0438\u043c\u043e\u0441\u0442\u0438");const t={id:"default_food",name:"\u041e\u0431\u044b\u0447\u043d\u0430\u044f \u043f\u0438\u0449\u0430",nutritionValue:20,loyaltyBonus:5};i.feedSpiritPet({petId:e,foodItem:t})}g(!1),s(!1)}catch(r){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0438 \u043f\u0438\u0442\u043e\u043c\u0446\u0430:",r),c("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043a\u043e\u0440\u043c\u0438\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435."),s(!1)}})(d.id,e),availableFood:(()=>{var e,t;return((null===(e=a.player)||void 0===e||null===(t=e.inventory)||void 0===t?void 0:t.items)||[]).filter((e=>"pet_food"===e.type))})()}),p&&d&&(0,Cn.jsx)(Sy,{pet:d,onClose:()=>h(!1),onTrain:(e,t)=>{s(!0);try{i.trainSpiritPet({petId:e,trainingType:t}),h(!1),s(!1)}catch(r){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0435 \u043f\u0438\u0442\u043e\u043c\u0446\u0430:",r),c("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0438\u0442\u043e\u043c\u0446\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435, \u0447\u0442\u043e \u043f\u0438\u0442\u043e\u043c\u0435\u0446 \u043d\u0435 \u0433\u043e\u043b\u043e\u0434\u0435\u043d."),s(!1)}}}),m&&d&&(0,Cn.jsx)(jy,{pet:d,onClose:()=>f(!1)})]})};var ky=r(870);r(3574);const Iy=nr.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  padding: 20px;
  color: #f0f0f0;
`,Ay=nr.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
`,Ny=nr.h2`
  font-size: 24px;
  margin: 0;
  color: #ffd700;
`,Dy=nr.div`
  display: flex;
  flex: 1;
  gap: 20px;
`,My=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 5px;
  padding: 15px;
  display: flex;
  flex-direction: column;
`,Ry=nr.div`
  flex: 1;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 5px;
  padding: 15px;
  display: flex;
  flex-direction: column;
`,Py=nr.div`
  display: flex;
  margin-bottom: 15px;
  border-bottom: 1px solid #444;
`,Ly=nr.button`
  background: ${e=>e.active?"rgba(255, 215, 0, 0.2)":"transparent"};
  color: ${e=>e.active?"#ffd700":"#ccc"};
  border: none;
  padding: 10px 15px;
  font-size: 16px;
  cursor: pointer;
  border-bottom: ${e=>e.active?"2px solid #ffd700":"none"};
  transition: all 0.3s;
  
  &:hover {
    background: rgba(255, 215, 0, 0.1);
    color: #ffd700;
  }
`,$y=nr.div`
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
`,Oy=nr.div`
  display: flex;
  background: ${e=>e.selected?"rgba(255, 215, 0, 0.1)":"rgba(30, 30, 30, 0.7)"};
  border: 1px solid ${e=>e.selected?"#ffd700":"#444"};
  border-radius: 5px;
  padding: 10px;
  cursor: pointer;
  transition: all 0.2s;
  
  &:hover {
    background: rgba(255, 215, 0, 0.05);
    border-color: #ffd700;
  }
`,qy=nr.div`
  width: 40px;
  height: 40px;
  background: #333;
  border-radius: 5px;
  margin-right: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
`,Uy=nr.div`
  flex: 1;
`,Fy=nr.div`
  font-weight: bold;
  color: ${e=>{switch(e.rarity){case"common":default:return"#aaa";case"uncommon":return"#1eff00";case"rare":return"#0070dd";case"epic":return"#a335ee";case"legendary":return"#ff8000"}}};
`,zy=nr.div`
  color: ${e=>{switch(e.currencyType){case"copper":return"#b87333";case"silver":return"#c0c0c0";case"gold":default:return"#ffd700";case"spiritStones":return"#7cb9e8"}}};
`,By=nr.div`
  font-size: 14px;
  color: #aaa;
  margin-top: 5px;
`,Gy=nr.div`
  padding: 15px;
  background: rgba(30, 30, 30, 0.7);
  border-radius: 5px;
  margin-top: 15px;
`,Wy=nr.h3`
  margin: 0 0 10px 0;
  color: #ffd700;
`,Hy=nr.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
`,Vy=nr.div`
  color: #aaa;
`,Qy=nr.div`
  color: #fff;
`,Yy=nr.button`
  background: ${e=>e.primary?"rgba(255, 215, 0, 0.2)":"rgba(80, 80, 80, 0.3)"};
  color: ${e=>e.primary?"#ffd700":"#ccc"};
  border: 1px solid ${e=>e.primary?"#ffd700":"#444"};
  border-radius: 5px;
  padding: 10px 15px;
  margin-top: 15px;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
  
  &:hover {
    background: ${e=>e.primary?"rgba(255, 215, 0, 0.3)":"rgba(80, 80, 80, 0.5)"};
  }
  
  &:disabled {
    background: rgba(50, 50, 50, 0.3);
    color: #666;
    border-color: #333;
    cursor: not-allowed;
  }
`,Ky=nr.div`
  display: flex;
  align-items: center;
  margin-top: 15px;
`,Xy=nr.button`
  background: rgba(80, 80, 80, 0.3);
  color: #ccc;
  border: 1px solid #444;
  border-radius: 5px;
  width: 30px;
  height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  cursor: pointer;
  
  &:hover {
    background: rgba(80, 80, 80, 0.5);
  }
  
  &:disabled {
    background: rgba(50, 50, 50, 0.3);
    color: #666;
    border-color: #333;
    cursor: not-allowed;
  }
`,Jy=nr.input`
  background: rgba(30, 30, 30, 0.7);
  color: #fff;
  border: 1px solid #444;
  border-radius: 5px;
  width: 60px;
  height: 30px;
  margin: 0 10px;
  text-align: center;
  font-size: 16px;
`,Zy=nr.input`
  background: rgba(30, 30, 30, 0.7);
  color: #fff;
  border: 1px solid #444;
  border-radius: 5px;
  padding: 10px;
  margin-bottom: 15px;
  font-size: 16px;
  
  &::placeholder {
    color: #777;
  }
`,eg=nr.div`
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
`,tg=nr.select`
  background: rgba(30, 30, 30, 0.7);
  color: #fff;
  border: 1px solid #444;
  border-radius: 5px;
  padding: 8px;
  font-size: 14px;
`,rg=nr.div`
  text-align: center;
  padding: 20px;
  color: #777;
  font-style: italic;
`,ng=nr.div`
  display: flex;
  align-items: center;
  gap: 15px;
  margin-left: auto;
`,ag=nr.div`
  display: flex;
  align-items: center;
`,ig=nr.div`
  width: 20px;
  height: 20px;
  border-radius: 50%;
  margin-right: 5px;
  background: ${e=>{switch(e.type){case"copper":return"#b87333";case"silver":return"#c0c0c0";case"gold":return"#ffd700";case"spiritStone":return"#7cb9e8";default:return"#ccc"}}};
`,og=nr.span`
  color: #fff;
`,sg=()=>{var e,t,r,a,i,o,s,l,c;const{state:d,actions:u}=Nn(),{player:p,market:h,world:m}=d,[f,y]=(0,n.useState)("market"),[g,v]=(0,n.useState)(null),[x,b]=(0,n.useState)(1),[w,_]=(0,n.useState)(""),[E,T]=(0,n.useState)("all"),[S,j]=(0,n.useState)("all"),[C,k]=(0,n.useState)(null),[I,A]=(0,n.useState)(null);(0,n.useEffect)((()=>{const e=(0,ky.getAllMerchants)(),t=[];e.forEach((e=>{const r=D(e.id);e.items&&e.items.length>0&&e.items.forEach((n=>{if("currency"===n.itemType)return void console.log(`MarketTab: \u041f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u0442\u0438\u043f\u0430 "currency": ${n.name||"\u0431\u0435\u0437 \u0438\u043c\u0435\u043d\u0438"} \u043e\u0442 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0430 ${e.name}`);const a=n.basePrice||100,i=(0,Vr.calculateMerchantDiscount)(r),{finalPrice:o}=(0,Vr.applyLoyaltyDiscount)(a,r),s={id:t.length+1,itemId:n.itemId,itemType:n.itemType,name:n.name||`\u041f\u0440\u0435\u0434\u043c\u0435\u0442 ${n.itemId}`,description:n.description||`\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 ${n.itemId}`,rarity:n.rarity||"common",quantity:n.quantity<0?10:n.quantity,price:o,originalPrice:a,discount:i,sellerId:e.id,sellerName:e.name};"pet_food"===n.itemType&&(void 0!==n.nutritionValue&&(s.nutritionValue=n.nutritionValue),void 0!==n.loyaltyBonus&&(s.loyaltyBonus=n.loyaltyBonus)),t.push(s)}))})),u.dispatch({type:Yr.UPDATE_MARKET_STATE,payload:{marketItems:t}})}),[]),(0,n.useEffect)((()=>{v(null)}),[E,S,I,w]);const N=n.useMemo((()=>{if(!h||!h.marketItems)return[];return h.marketItems.filter((e=>{if(e.quantity<=0)return!1;const t=""===w||e.name&&e.name.toLowerCase().includes(w.toLowerCase())||e.description&&e.description.toLowerCase().includes(w.toLowerCase()),r="all"===E||e.itemType&&e.itemType===E,n="all"===S||e.rarity&&e.rarity===S,a=Number(e.sellerId),i=Number(I),o=null===I||void 0!==e.sellerId&&a===i;return t&&r&&n&&o}))}),[null===h||void 0===h?void 0:h.marketItems,w,E,S,I]),D=e=>{var t,r,n;let a=(null===d||void 0===d||null===(t=d.player)||void 0===t||null===(r=t.social)||void 0===r?void 0:r.relationships)||[];Array.isArray(a)||(console.warn("\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u043d\u0435 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c, \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0438\u0445:",a),a="object"===typeof a&&null!==a?Object.values(a):[]);const i=(0,ky.getAllMerchants)().find((t=>t.id===e));if(!i)return 0;const o=a.find((e=>e.name===i.name));if(o&&void 0!==o.level)return o.level;if(i.sect&&null!==d&&void 0!==d&&null!==(n=d.sect)&&void 0!==n&&n.sect){const e=d.sect.sect.name;if(i.sect===e){if(d.sect.sect.members&&Array.isArray(d.sect.sect.members)){const e=d.sect.sect.members.find((e=>e.name===i.name));if(e&&void 0!==e.loyalty)return e.loyalty}const t=a.find((t=>t.name===e));if(t&&void 0!==t.level)return t.level}}return 0},M=e=>{switch(e){case"common":return"copper";case"uncommon":return"silver";case"rare":default:return"gold";case"epic":return"gold+spiritStones";case"legendary":return"spiritStones"}},R=(e,t)=>{switch(M(t)){case"copper":return`${e} \u043c\u0435\u0434\u0438`;case"silver":return`${e} \u0441\u0435\u0440\u0435\u0431\u0440\u0430`;case"gold":default:return`${e} \u0437\u043e\u043b\u043e\u0442\u0430`;case"gold+spiritStones":return`${Math.floor(.7*e)} \u0437\u043e\u043b\u043e\u0442\u0430 + ${Math.ceil(.3*e/100)} \u0434\u0443\u0445. \u043a\u0430\u043c\u043d\u0435\u0439`;case"spiritStones":return`${Math.ceil(e/100)} \u0434\u0443\u0445. \u043a\u0430\u043c\u043d\u0435\u0439`}},P=(e,t)=>{const r=M(t),n=e*x;switch(r){case"copper":return(p.inventory.currency.copper||0)>=n;case"silver":return(p.inventory.currency.silver||0)>=n;case"gold":default:return(p.inventory.currency.gold||0)>=n;case"gold+spiritStones":{const e=Math.floor(.7*n),t=Math.ceil(.3*n/100);return(p.inventory.currency.gold||0)>=e&&(p.inventory.currency.spiritStones||0)>=t}case"spiritStones":return(p.inventory.currency.spiritStones||0)>=Math.ceil(n/100)}};return(0,Cn.jsxs)(Iy,{children:[(0,Cn.jsxs)(Ay,{children:[(0,Cn.jsx)(Ny,{children:"\u0420\u044b\u043d\u043e\u043a"}),(0,Cn.jsxs)(ng,{children:[(0,Cn.jsxs)(ag,{children:[(0,Cn.jsx)(ig,{type:"copper"}),(0,Cn.jsx)(og,{children:(null===p||void 0===p||null===(e=p.inventory)||void 0===e||null===(t=e.currency)||void 0===t?void 0:t.copper)||0})]}),(0,Cn.jsxs)(ag,{children:[(0,Cn.jsx)(ig,{type:"silver"}),(0,Cn.jsx)(og,{children:(null===p||void 0===p||null===(r=p.inventory)||void 0===r||null===(a=r.currency)||void 0===a?void 0:a.silver)||0})]}),(0,Cn.jsxs)(ag,{children:[(0,Cn.jsx)(ig,{type:"gold"}),(0,Cn.jsx)(og,{children:(null===p||void 0===p||null===(i=p.inventory)||void 0===i||null===(o=i.currency)||void 0===o?void 0:o.gold)||0})]}),(0,Cn.jsxs)(ag,{children:[(0,Cn.jsx)(ig,{type:"spiritStone"}),(0,Cn.jsx)(og,{children:(null===p||void 0===p||null===(s=p.inventory)||void 0===s||null===(l=s.currency)||void 0===l?void 0:l.spiritStones)||0})]})]})]}),(0,Cn.jsxs)(Py,{children:[(0,Cn.jsx)(Ly,{active:"market"===f,onClick:()=>y("market"),children:"\u0422\u043e\u0432\u0430\u0440\u044b"}),(0,Cn.jsx)(Ly,{active:"sell"===f,onClick:()=>y("sell"),children:"\u041f\u0440\u043e\u0434\u0430\u0436\u0430"}),(0,Cn.jsx)(Ly,{active:"merchants"===f,onClick:()=>y("merchants"),children:"\u0422\u043e\u0440\u0433\u043e\u0432\u0446\u044b"})]}),(0,Cn.jsxs)(Dy,{children:["market"===f&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsxs)(My,{children:[(0,Cn.jsx)(Zy,{placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432...",value:w,onChange:e=>_(e.target.value)}),(0,Cn.jsxs)(eg,{children:[(0,Cn.jsxs)(tg,{value:E,onChange:e=>T(e.target.value),children:[(0,Cn.jsx)("option",{value:"all",children:"\u0412\u0441\u0435 \u0442\u0438\u043f\u044b"}),(0,Cn.jsx)("option",{value:"weapon",children:"\u041e\u0440\u0443\u0436\u0438\u0435"}),(0,Cn.jsx)("option",{value:"armor",children:"\u0411\u0440\u043e\u043d\u044f"}),(0,Cn.jsx)("option",{value:"accessory",children:"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b"}),(0,Cn.jsx)("option",{value:"consumable",children:"\u0420\u0430\u0441\u0445\u043e\u0434\u043d\u0438\u043a\u0438"}),(0,Cn.jsx)("option",{value:"pet_food",children:"\u0415\u0434\u0430 \u0434\u043b\u044f \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432"})]}),(0,Cn.jsxs)(tg,{value:S,onChange:e=>j(e.target.value),children:[(0,Cn.jsx)("option",{value:"all",children:"\u041b\u044e\u0431\u0430\u044f \u0440\u0435\u0434\u043a\u043e\u0441\u0442\u044c"}),(0,Cn.jsx)("option",{value:"common",children:"\u041e\u0431\u044b\u0447\u043d\u044b\u0439"}),(0,Cn.jsx)("option",{value:"uncommon",children:"\u041d\u0435\u043e\u0431\u044b\u0447\u043d\u044b\u0439"}),(0,Cn.jsx)("option",{value:"rare",children:"\u0420\u0435\u0434\u043a\u0438\u0439"}),(0,Cn.jsx)("option",{value:"epic",children:"\u042d\u043f\u0438\u0447\u0435\u0441\u043a\u0438\u0439"}),(0,Cn.jsx)("option",{value:"legendary",children:"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0439"})]}),(0,Cn.jsxs)(tg,{value:I||"",onChange:e=>A(""===e.target.value?null:e.target.value),children:[(0,Cn.jsx)("option",{value:"",children:"\u0412\u0441\u0435 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u044b"}),(null===h||void 0===h?void 0:h.marketItems)&&[...new Set(h.marketItems.map((e=>e.sellerId)))].map((e=>{const t=h.marketItems.find((t=>t.sellerId===e));return(0,Cn.jsx)("option",{value:e,children:(null===t||void 0===t?void 0:t.sellerName)||`\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446 #${e}`},e)}))]})]}),(0,Cn.jsx)($y,{children:N.length>0?N.map((e=>(0,Cn.jsxs)(Oy,{selected:g&&g.id===e.id,onClick:()=>v(e),children:[(0,Cn.jsx)(qy,{children:"weapon"===e.itemType?"\u2694\ufe0f":"armor"===e.itemType?"\ud83d\udee1\ufe0f":"accessory"===e.itemType?"\ud83d\udc8d":"consumable"===e.itemType?"\ud83e\uddea":"pet_food"===e.itemType?"\ud83c\udf56":"\ud83d\udce6"}),(0,Cn.jsxs)(Uy,{children:[(0,Cn.jsx)(Fy,{rarity:e.rarity,children:e.name}),(0,Cn.jsxs)(zy,{currencyType:M(e.rarity),children:[R(e.price,e.rarity),e.discount>0&&` (-${e.discount}%)`]})]})]},e.id))):(0,Cn.jsx)(rg,{children:"\u041f\u0440\u0435\u0434\u043c\u0435\u0442\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"})})]}),(0,Cn.jsx)(Ry,{children:g?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(Wy,{children:g.name}),(0,Cn.jsx)(By,{children:g.description}),(0,Cn.jsxs)(Gy,{children:[(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)(Qy,{children:"weapon"===g.itemType?"\u041e\u0440\u0443\u0436\u0438\u0435":"armor"===g.itemType?"\u0411\u0440\u043e\u043d\u044f":"accessory"===g.itemType?"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440":"consumable"===g.itemType?"\u0420\u0430\u0441\u0445\u043e\u0434\u043d\u0438\u043a":"pet_food"===g.itemType?"\u0415\u0434\u0430 \u0434\u043b\u044f \u043f\u0438\u0442\u043e\u043c\u0446\u0435\u0432":"\u041f\u0440\u0435\u0434\u043c\u0435\u0442"})]}),(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0420\u0435\u0434\u043a\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)(Qy,{children:"common"===g.rarity?"\u041e\u0431\u044b\u0447\u043d\u044b\u0439":"uncommon"===g.rarity?"\u041d\u0435\u043e\u0431\u044b\u0447\u043d\u044b\u0439":"rare"===g.rarity?"\u0420\u0435\u0434\u043a\u0438\u0439":"epic"===g.rarity?"\u042d\u043f\u0438\u0447\u0435\u0441\u043a\u0438\u0439":"legendary"===g.rarity?"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0439":"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e"})]}),(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0426\u0435\u043d\u0430:"}),(0,Cn.jsxs)(Qy,{children:[R(g.price,g.rarity),g.discount>0&&(0,Cn.jsxs)("span",{style:{color:"#8AFF8A",marginLeft:"8px"},children:["(-",g.discount,"%)"]})]})]}),(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u041f\u0440\u043e\u0434\u0430\u0432\u0435\u0446:"}),(0,Cn.jsx)(Qy,{children:g.sellerName})]}),(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0412 \u043d\u0430\u043b\u0438\u0447\u0438\u0438:"}),(0,Cn.jsx)(Qy,{children:g.quantity})]}),"pet_food"===g.itemType&&(0,Cn.jsxs)(Cn.Fragment,{children:[void 0!==g.nutritionValue&&(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u041f\u0438\u0442\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)(Qy,{children:g.nutritionValue})]}),void 0!==g.loyaltyBonus&&(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0411\u043e\u043d\u0443\u0441 \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438:"}),(0,Cn.jsxs)(Qy,{children:["+",g.loyaltyBonus]})]})]})]}),(0,Cn.jsxs)(Ky,{children:[(0,Cn.jsx)(Xy,{onClick:()=>b((e=>Math.max(1,e-1))),disabled:x<=1,children:"-"}),(0,Cn.jsx)(Jy,{type:"number",min:"1",max:g.quantity,value:x,onChange:e=>{const t=parseInt(e.target.value);!isNaN(t)&&t>0&&t<=g.quantity&&b(t)}}),(0,Cn.jsx)(Xy,{onClick:()=>b((e=>Math.min(g.quantity,e+1))),disabled:x>=g.quantity,children:"+"})]}),(0,Cn.jsxs)(Yy,{primary:!0,onClick:()=>{if(!g)return;const e=M(g.rarity),t=g.price*x;if(!P(g.price,g.rarity))return void alert(`\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e ${"copper"===e?"\u043c\u0435\u0434\u0438":"silver"===e?"\u0441\u0435\u0440\u0435\u0431\u0440\u0430":"gold"===e?"\u0437\u043e\u043b\u043e\u0442\u0430":"gold+spiritStones"===e?"\u0437\u043e\u043b\u043e\u0442\u0430 \u0438\u043b\u0438 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u043a\u0430\u043c\u043d\u0435\u0439":"\u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0445 \u043a\u0430\u043c\u043d\u0435\u0439"} \u0434\u043b\u044f \u043f\u043e\u043a\u0443\u043f\u043a\u0438`);if(g.quantity<x)return void alert(`\u0423 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0430 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432. \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e: ${g.quantity}`);console.log("\u0412\u0430\u043b\u044e\u0442\u0430 \u0434\u043e \u043f\u043e\u043a\u0443\u043f\u043a\u0438:",p.inventory.currency);const r={};switch(e){case"copper":r.copper=-t;break;case"silver":r.silver=-t;break;case"gold":r.gold=-t;break;case"gold+spiritStones":{const e=Math.floor(.7*t),n=Math.ceil(.3*t/100);r.gold=-e,r.spiritStones=-n;break}case"spiritStones":r.spiritStones=-Math.ceil(t/100)}alert(`\u041f\u043e\u043a\u0443\u043f\u043a\u0430 ${x} \u0448\u0442. \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 "${g.name}" \u0437\u0430 ${R(t,g.rarity)}`);const n={id:g.itemId,type:g.itemType,name:g.name,description:g.description,rarity:g.rarity,price:g.price,quantity:x};"pet_food"===g.itemType&&(void 0!==g.nutritionValue&&(n.nutritionValue=g.nutritionValue),void 0!==g.loyaltyBonus&&(n.loyaltyBonus=g.loyaltyBonus),g.statBonus&&(n.statBonus=g.statBonus),g.preferredTypes&&(n.preferredTypes=g.preferredTypes),console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0435\u0434\u044b \u0434\u043b\u044f \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u0441 \u043f\u043e\u043b\u043d\u044b\u043c\u0438 \u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430\u043c\u0438:",n)),u.addItem(n),u.updateCurrency(r,!0),console.log("\u0412\u0430\u043b\u044e\u0442\u0430 \u043f\u043e\u0441\u043b\u0435 \u043f\u043e\u043a\u0443\u043f\u043a\u0438 (\u0430\u0434\u0434\u0438\u0442\u0438\u0432\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c):",r);const a=(0,ky.getAllMerchants)().find((e=>e.id===g.sellerId));if(a&&a.items){const e=a.items.find((e=>e.itemId===g.itemId&&e.itemType===g.itemType));if(e){e.quantity-=x,e.quantity<0&&(e.quantity=0),void 0!==e.lastRestockTime&&(e.lastRestockTime=Date.now()/36e5),console.log(`\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0443 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0430 "${a.name}": ${e.quantity}`);const t=(0,ky.getAllMerchants)(),r=[];t.forEach((e=>{if(e.items&&e.items.length>0){const t=D(e.id);console.log(`\u041f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u043e\u0441\u043b\u0435 \u043f\u043e\u043a\u0443\u043f\u043a\u0438: \u0443\u0440\u043e\u0432\u0435\u043d\u044c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 ${e.name}: ${t}`),e.items.forEach((n=>{if("currency"===n.itemType)return;const a=n.basePrice||100,i=(0,Vr.calculateMerchantDiscount)(t),{finalPrice:o}=(0,Vr.applyLoyaltyDiscount)(a,t),s={id:r.length+1,itemId:n.itemId,itemType:n.itemType,name:n.name||`\u041f\u0440\u0435\u0434\u043c\u0435\u0442 ${n.itemId}`,description:n.description||`\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 ${n.itemId}`,rarity:n.rarity||"common",quantity:n.quantity<0?10:n.quantity,price:o,originalPrice:a,discount:i,sellerId:e.id,sellerName:e.name};"pet_food"===n.itemType&&(void 0!==n.nutritionValue&&(s.nutritionValue=n.nutritionValue),void 0!==n.loyaltyBonus&&(s.loyaltyBonus=n.loyaltyBonus)),r.push(s)}))}})),u.dispatch({type:Yr.UPDATE_MARKET_STATE,payload:{marketItems:r,merchantsUpdated:!0,timestamp:Date.now()}})}}v(null),b(1)},disabled:!P(g.price,g.rarity),children:["\u041a\u0443\u043f\u0438\u0442\u044c \u0437\u0430 ",R(g.price*x,g.rarity)]})]}):(0,Cn.jsx)(rg,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0434\u0435\u0442\u0430\u043b\u0435\u0439"})})]}),"sell"===f&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsxs)(My,{children:[(0,Cn.jsx)(Zy,{placeholder:"\u041f\u043e\u0438\u0441\u043a \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u0435...",value:w,onChange:e=>_(e.target.value)}),(0,Cn.jsxs)(eg,{children:[(0,Cn.jsxs)(tg,{value:E,onChange:e=>T(e.target.value),children:[(0,Cn.jsx)("option",{value:"all",children:"\u0412\u0441\u0435 \u0442\u0438\u043f\u044b"}),(0,Cn.jsx)("option",{value:"weapon",children:"\u041e\u0440\u0443\u0436\u0438\u0435"}),(0,Cn.jsx)("option",{value:"armor",children:"\u0411\u0440\u043e\u043d\u044f"}),(0,Cn.jsx)("option",{value:"accessory",children:"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440\u044b"}),(0,Cn.jsx)("option",{value:"consumable",children:"\u0420\u0430\u0441\u0445\u043e\u0434\u043d\u0438\u043a\u0438"})]}),(0,Cn.jsxs)(tg,{value:S,onChange:e=>j(e.target.value),children:[(0,Cn.jsx)("option",{value:"all",children:"\u041b\u044e\u0431\u0430\u044f \u0440\u0435\u0434\u043a\u043e\u0441\u0442\u044c"}),(0,Cn.jsx)("option",{value:"common",children:"\u041e\u0431\u044b\u0447\u043d\u044b\u0439"}),(0,Cn.jsx)("option",{value:"uncommon",children:"\u041d\u0435\u043e\u0431\u044b\u0447\u043d\u044b\u0439"}),(0,Cn.jsx)("option",{value:"rare",children:"\u0420\u0435\u0434\u043a\u0438\u0439"}),(0,Cn.jsx)("option",{value:"epic",children:"\u042d\u043f\u0438\u0447\u0435\u0441\u043a\u0438\u0439"}),(0,Cn.jsx)("option",{value:"legendary",children:"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0439"})]})]}),(0,Cn.jsx)($y,{children:null!==p&&void 0!==p&&null!==(c=p.inventory)&&void 0!==c&&c.items&&p.inventory.items.length>0?p.inventory.items.filter((e=>("all"===E||e.type===E)&&("all"===S||e.rarity===S)&&(""===w||e.name&&e.name.toLowerCase().includes(w.toLowerCase())||e.description&&e.description.toLowerCase().includes(w.toLowerCase())))).map((e=>(0,Cn.jsxs)(Oy,{selected:g&&g.id===e.id,onClick:()=>v(e),children:[(0,Cn.jsx)(qy,{children:"weapon"===e.type?"\u2694\ufe0f":"armor"===e.type?"\ud83d\udee1\ufe0f":"accessory"===e.type?"\ud83d\udc8d":"consumable"===e.type?"\ud83e\uddea":"\ud83d\udce6"}),(0,Cn.jsxs)(Uy,{children:[(0,Cn.jsx)(Fy,{rarity:e.rarity,children:e.name}),(0,Cn.jsxs)("div",{children:["x",e.quantity||1]})]})]},e.id))):(0,Cn.jsx)(rg,{children:"\u0412 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u0435 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435\u0442"})})]}),(0,Cn.jsx)(Ry,{children:g?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(Wy,{children:g.name}),(0,Cn.jsx)(By,{children:g.description}),(0,Cn.jsxs)(Gy,{children:[(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0422\u0438\u043f:"}),(0,Cn.jsx)(Qy,{children:"weapon"===g.type?"\u041e\u0440\u0443\u0436\u0438\u0435":"armor"===g.type?"\u0411\u0440\u043e\u043d\u044f":"accessory"===g.type?"\u0410\u043a\u0441\u0435\u0441\u0441\u0443\u0430\u0440":"consumable"===g.type?"\u0420\u0430\u0441\u0445\u043e\u0434\u043d\u0438\u043a":"\u041f\u0440\u0435\u0434\u043c\u0435\u0442"})]}),(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0420\u0435\u0434\u043a\u043e\u0441\u0442\u044c:"}),(0,Cn.jsx)(Qy,{children:"common"===g.rarity?"\u041e\u0431\u044b\u0447\u043d\u044b\u0439":"uncommon"===g.rarity?"\u041d\u0435\u043e\u0431\u044b\u0447\u043d\u044b\u0439":"rare"===g.rarity?"\u0420\u0435\u0434\u043a\u0438\u0439":"epic"===g.rarity?"\u042d\u043f\u0438\u0447\u0435\u0441\u043a\u0438\u0439":"legendary"===g.rarity?"\u041b\u0435\u0433\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0439":"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e"})]}),g.price&&(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0426\u0435\u043d\u0430 \u043f\u0440\u043e\u0434\u0430\u0436\u0438:"}),(0,Cn.jsx)(Qy,{children:R(Math.floor(.7*g.price),g.rarity)})]}),(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e:"}),(0,Cn.jsx)(Qy,{children:g.quantity||1})]})]}),(0,Cn.jsxs)(Ky,{children:[(0,Cn.jsx)(Xy,{onClick:()=>b((e=>Math.max(1,e-1))),disabled:x<=1,children:"-"}),(0,Cn.jsx)(Jy,{type:"number",min:"1",max:g.quantity||1,value:x,onChange:e=>{const t=parseInt(e.target.value);!isNaN(t)&&t>0&&t<=(g.quantity||1)&&b(t)}}),(0,Cn.jsx)(Xy,{onClick:()=>b((e=>Math.min(g.quantity||1,e+1))),disabled:x>=(g.quantity||1),children:"+"})]}),(0,Cn.jsxs)(Yy,{primary:!0,onClick:()=>{if(!g)return;if(!g.price)return void alert("\u042d\u0442\u043e\u0442 \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u043d\u0435\u043b\u044c\u0437\u044f \u043f\u0440\u043e\u0434\u0430\u0442\u044c");if(g.quantity<x)return void alert("\u0423 \u0432\u0430\u0441 \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432 \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u0430\u0436\u0438");const e=M(g.rarity||"common"),t=Math.floor(.7*g.price)*x,r={};switch(e){case"copper":r.copper=t;break;case"silver":r.silver=t;break;case"gold":default:r.gold=t;break;case"gold+spiritStones":{const e=Math.floor(.7*t),n=Math.ceil(.3*t/100);r.gold=e,r.spiritStones=n;break}case"spiritStones":r.spiritStones=Math.ceil(t/100)}alert(`\u041f\u0440\u043e\u0434\u0430\u0436\u0430 ${x} \u0448\u0442. \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 "${g.name}" \u0437\u0430 ${R(t,g.rarity)}`),u.removeItem(g.id,x),u.updateCurrency(r,!0),v(null),b(1)},disabled:!g.price,children:["\u041f\u0440\u043e\u0434\u0430\u0442\u044c \u0437\u0430 ",g.price?R(Math.floor(.7*g.price)*x,g.rarity):"\u043d\u0435\u043b\u044c\u0437\u044f \u043f\u0440\u043e\u0434\u0430\u0442\u044c"]})]}):(0,Cn.jsx)(rg,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442 \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u0430\u0436\u0438"})})]}),"merchants"===f&&(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsxs)(My,{children:[(0,Cn.jsx)(Zy,{placeholder:"\u041f\u043e\u0438\u0441\u043a \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0435\u0432...",value:w,onChange:e=>_(e.target.value)}),(0,Cn.jsx)($y,{children:(null===h||void 0===h?void 0:h.marketItems)&&[...new Set(h.marketItems.map((e=>e.sellerId)))].map((e=>{const t=h.marketItems.find((t=>t.sellerId===e));if(!t)return null;const r=t.sellerName||`\u0422\u043e\u0440\u0433\u043e\u0432\u0435\u0446 #${e}`;return w&&!r.toLowerCase().includes(w.toLowerCase())?null:(0,Cn.jsxs)(Oy,{selected:C&&C.id===e,onClick:()=>{k({id:e,name:r}),A(e)},children:[(0,Cn.jsx)(qy,{children:"\ud83e\uddd9"}),(0,Cn.jsxs)(Uy,{children:[(0,Cn.jsx)(Fy,{children:r}),(0,Cn.jsxs)("div",{children:["\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f: ",D(e)]})]})]},e)}))})]}),(0,Cn.jsx)(Ry,{children:C?(0,Cn.jsxs)(Cn.Fragment,{children:[(0,Cn.jsx)(Wy,{children:C.name}),(0,Cn.jsxs)(Gy,{children:[(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f:"}),(0,Cn.jsx)(Qy,{children:D(C.id)})]}),(0,Cn.jsxs)(Hy,{children:[(0,Cn.jsx)(Vy,{children:"\u0421\u043a\u0438\u0434\u043a\u0430:"}),(0,Cn.jsxs)(Qy,{children:[(0,Vr.calculateMerchantDiscount)(D(C.id)),"%"]})]})]}),(0,Cn.jsx)(Yy,{onClick:()=>{y("market"),A(C.id)},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0442\u043e\u0432\u0430\u0440\u044b"})]}):(0,Cn.jsx)(rg,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u043e\u0440\u0433\u043e\u0432\u0446\u0430 \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438"})})]})]})]})},lg=nr.div`
  width: 100%;
  height: 100vh;
  display: grid;
  grid-template-rows: auto 1fr;
  background: #1a1a1a;
  color: #f0f0f0;
`,cg=nr.div`
  background: rgba(30, 30, 30, 0.95);
  border-bottom: 1px solid #d4af37;
  padding: 10px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,dg=nr.div`
  display: flex;
  align-items: center;
  gap: 20px;
`,ug=nr.div`
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: #d4af37;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: #000;
`,pg=nr.div`
  display: flex;
  flex-direction: column;
  gap: 5px;
`,hg=nr.div`
  font-size: 1.2rem;
  color: #d4af37;
`,mg=nr.div`
  font-size: 0.9rem;
  color: #aaa;
`,fg=nr.div`
  display: flex;
  gap: 20px;
`,yg=nr.div`
  display: flex;
  align-items: center;
  gap: 5px;
  
  span {
    color: #d4af37;
  }
`,gg=nr.button`
  padding: 8px 15px;
  background: rgba(212, 175, 55, 0.2);
  border: 1px solid #d4af37;
  border-radius: 4px;
  color: #d4af37;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.3);
  }
`,vg=nr.div`
  display: grid;
  grid-template-columns: 200px 1fr 300px;
  gap: 1px;
  background: #111;
  height: 100%;
`,xg=nr.div`
  background: rgba(30, 30, 30, 0.95);
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
`,bg=nr.div`
  padding: 10px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s ease;
  
  &:hover {
    background: rgba(212, 175, 55, 0.1);
    color: #d4af37;
  }
  
  ${e=>e.active&&"\n    background: rgba(212, 175, 55, 0.2);\n    color: #d4af37;\n  "}
`,wg=nr.div`
  background: rgba(30, 30, 30, 0.95);
  padding: 20px;
  overflow-y: auto;
`,_g=nr.div`
  background: rgba(30, 30, 30, 0.95);
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
`,Eg=(nr.div`
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
`,nr.div`
  padding: 5px 10px;
  border-radius: 4px;
  background: rgba(212, 175, 55, 0.1);
  font-size: 0.9rem;
  
  ${e=>"buff"===e.type&&"\n    color: #4caf50;\n  "}
  
  ${e=>"debuff"===e.type&&"\n    color: #f44336;\n  "}
`,nr.div`
  display: flex;
  flex-direction: column;
  gap: 10px;
`),Tg=nr.div`
  padding: 10px;
  border-radius: 4px;
  background: rgba(0, 0, 0, 0.3);
  border-left: 3px solid #d4af37;
  font-size: 0.9rem;
`;const Sg=function(){const{state:e,actions:t}=Nn(),[r,a]=(0,n.useState)("cultivation"),i=re(),[o,s]=(0,n.useState)(!1),[l,c]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=setInterval((()=>{const e=["\u0412\u044b \u0447\u0443\u0432\u0441\u0442\u0432\u0443\u0435\u0442\u0435 \u043f\u0440\u0438\u043b\u0438\u0432 \u0434\u0443\u0445\u043e\u0432\u043d\u043e\u0439 \u044d\u043d\u0435\u0440\u0433\u0438\u0438...","\u041f\u043e\u0431\u043b\u0438\u0437\u043e\u0441\u0442\u0438 \u043f\u043e\u044f\u0432\u0438\u043b\u0441\u044f \u0440\u0435\u0434\u043a\u0438\u0439 \u0434\u0443\u0445\u043e\u0432\u043d\u044b\u0439 \u0437\u0432\u0435\u0440\u044c!","\u0412\u0430\u0448\u0430 \u0442\u0435\u0445\u043d\u0438\u043a\u0430 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044f \u0431\u043e\u043b\u0435\u0435 \u0441\u043e\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u043e\u0439.","\u0412 \u043e\u043a\u0440\u0443\u0433\u0435 \u0437\u0430\u043c\u0435\u0447\u0435\u043d\u044b \u0441\u043b\u0435\u0434\u044b \u0434\u0440\u0435\u0432\u043d\u0435\u0433\u043e \u0430\u0440\u0442\u0435\u0444\u0430\u043a\u0442\u0430..."];t.addNotification({message:e[Math.floor(Math.random()*e.length)],type:"info"})}),3e4);return()=>clearInterval(e)}),[t]),(0,n.useEffect)((()=>{const r=setInterval((()=>{const r=e.world.time.hour,n=e.world.time.minute,a=e.world.time.day,i=(n+10)%60,o=(r+(n+10>=60?1:0))%24,s=23===r&&0===o?1:0,l=a+s;console.log("\u23f1\ufe0f \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432 \u0442\u0430\u0439\u043c\u0435\u0440\u0435:",{"\u0442\u0435\u043a\u0443\u0449\u0435\u0435":`${r}:${n} \u0434\u0435\u043d\u044c ${a}`,"\u043d\u043e\u0432\u043e\u0435":`${o}:${i} \u0434\u0435\u043d\u044c ${l}`,"\u043f\u0435\u0440\u0435\u0445\u043e\u0434_\u043f\u043e\u043b\u043d\u043e\u0447\u0438":1===s}),t.updateTime({minute:i,hour:o,day:l,season:e.world.time.season})}),1e3);return()=>clearInterval(r)}),[t,e.world.time]);const d=async()=>{try{return await Br.checkAuth()?(await Br.saveGameState(e),!0):(console.warn("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043e - \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d"),!1)}catch(t){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430:",t),!1}};return(0,n.useEffect)((()=>{const r=setInterval((async()=>{try{await d()&&t.addNotification({message:"\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d",type:"info"})}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438:",e)}}),3e5);return e.isInitialized&&!e.isLoading&&(async()=>{await d()})(),()=>clearInterval(r)}),[e.player.stats,e.player.cultivation,e.player.inventory,e.player.techniques,e.player.progress.quests,e.achievements,e.isInitialized,e.isLoading,t]),(0,Cn.jsxs)(lg,{children:[(0,Cn.jsx)(ai,{}),l&&(0,Cn.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.7)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,Cn.jsx)(Ii,{onClose:()=>c(!1)})}),(0,Cn.jsxs)(cg,{children:[(0,Cn.jsxs)(dg,{children:[(0,Cn.jsx)(ug,{children:e.player.name[0]}),(0,Cn.jsxs)(pg,{children:[(0,Cn.jsx)(hg,{children:e.player.name}),(0,Cn.jsxs)(mg,{children:[e.player.cultivation.stage," (",e.player.cultivation.level,")"]})]})]}),(0,Cn.jsxs)(fg,{children:[(0,Cn.jsxs)(yg,{children:["\u0414\u0443\u0445\u043e\u0432\u043d\u0430\u044f \u044d\u043d\u0435\u0440\u0433\u0438\u044f: ",(0,Cn.jsxs)("span",{children:[e.player.cultivation.energy||0,"/",e.player.cultivation.maxEnergy||100]})]}),(0,Cn.jsxs)(yg,{children:["\u041e\u043f\u044b\u0442: ",(0,Cn.jsxs)("span",{children:[e.player.cultivation.experience||0,"/",e.player.cultivation.experienceToNextLevel||100]})]}),(0,Cn.jsxs)(yg,{children:["\u0417\u043e\u043b\u043e\u0442\u043e: ",(0,Cn.jsx)("span",{children:e.player.inventory.currency.gold||0})]}),(0,Cn.jsx)(gg,{onClick:async()=>{try{s(!0),t.addNotification({message:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430...",type:"info"}),await Br.saveGameState(e),t.addNotification({message:"\u041f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d. \u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0438\u0433\u0440\u044b...",type:"success"}),await Br.logout(),setTimeout((()=>{i("/")}),1500)}catch(r){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u044b\u0445\u043e\u0434\u0435 \u0438\u0437 \u0438\u0433\u0440\u044b:",r),t.addNotification({message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u0430: "+r.message,type:"error"}),s(!1)}},disabled:o,children:o?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u0438\u0433\u0440\u044b"})]})]}),(0,Cn.jsxs)(vg,{children:[(0,Cn.jsxs)(xg,{children:[(0,Cn.jsx)(bg,{active:"cultivation"===r,onClick:()=>a("cultivation"),children:"\u041a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u044f"}),(0,Cn.jsx)(bg,{active:"inventory"===r,onClick:()=>a("inventory"),children:"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044c"}),(0,Cn.jsx)(bg,{active:"equipment"===r,onClick:()=>a("equipment"),children:"\u042d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0430"}),(0,Cn.jsx)(bg,{active:"character"===r,onClick:()=>a("character"),children:"\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436"}),(0,Cn.jsx)(bg,{active:"map"===r,onClick:()=>a("map"),children:"\u041a\u0430\u0440\u0442\u0430"}),(0,Cn.jsx)(bg,{active:"quests"===r,onClick:()=>a("quests"),children:"\u0417\u0430\u0434\u0430\u043d\u0438\u044f"}),(0,Cn.jsx)(bg,{active:"sect"===r,onClick:()=>a("sect"),children:"\u0421\u0435\u043a\u0442\u0430"}),(0,Cn.jsx)(bg,{active:"groups"===r,onClick:()=>a("groups"),children:"\u0413\u0440\u0443\u043f\u043f\u044b"}),(0,Cn.jsx)(bg,{active:"skills"===r,onClick:()=>a("skills"),children:"\u0422\u0435\u0445\u043d\u0438\u043a\u0438"}),(0,Cn.jsx)(bg,{active:"alchemy"===r,onClick:()=>a("alchemy"),children:"\u0410\u043b\u0445\u0438\u043c\u0438\u044f"}),(0,Cn.jsx)(bg,{active:"social"===r,onClick:()=>a("social"),children:"\u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u043e\u0435"}),(0,Cn.jsx)(bg,{active:"achievements"===r,onClick:()=>a("achievements"),children:"\u0414\u043e\u0441\u0442\u0438\u0436\u0435\u043d\u0438\u044f"}),(0,Cn.jsx)(bg,{active:"spiritPets"===r,onClick:()=>a("spiritPets"),children:"\u041f\u0438\u0442\u043e\u043c\u0446\u044b"}),(0,Cn.jsx)(bg,{active:"market"===r,onClick:()=>a("market"),children:"\u0420\u044b\u043d\u043e\u043a"})]}),(0,Cn.jsx)(wg,{children:(()=>{switch(r){case"cultivation":return(0,Cn.jsx)(Zi,{});case"inventory":return(0,Cn.jsx)(ho,{});case"equipment":return(0,Cn.jsx)(Mo,{});case"character":return(0,Cn.jsx)(es,{});case"map":return(0,Cn.jsx)(Bc,{});case"quests":return(0,Cn.jsx)(ld,{});case"sect":return(0,Cn.jsx)(Qd,{});case"groups":return(0,Cn.jsx)(Am,{});case"skills":return(0,Cn.jsx)(Xm,{});case"alchemy":return(0,Cn.jsx)(_y,{});case"social":return(0,Cn.jsx)(_f,{});case"achievements":return(0,Cn.jsx)(Gf,{});case"spiritPets":return(0,Cn.jsx)(Cy,{});case"market":return(0,Cn.jsx)(sg,{});default:return null}})()}),(0,Cn.jsxs)(_g,{children:[(0,Cn.jsx)("div",{style:{cursor:"pointer"},onClick:()=>c(!0),children:(0,Cn.jsx)(qa,{})}),(0,Cn.jsx)(Qa,{}),(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("h3",{children:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),(0,Cn.jsx)(Eg,{children:e.ui.notifications.map((e=>(0,Cn.jsx)(Tg,{children:e.message},e.id)))})]})]})]})]})},jg={time:0};const Cg=function(e){var t,r,a;let{debug:i=!1}=e;const{actions:o}=Nn(),s=(0,n.useRef)(null),l=(0,n.useRef)(o.dispatch);(0,n.useEffect)((()=>{l.current=o.dispatch}),[o.dispatch]);const c=(0,n.useRef)(new Date),d=(0,n.useCallback)((()=>!(Date.now()-jg.time<2e3)),[]),u=(0,n.useCallback)((()=>{if(!d())return;const e=new Date,t=(e-c.current)/6e4;l.current(dn(t,!1)),c.current=e}),[d]);return(0,n.useEffect)((()=>{const e=setTimeout((()=>{l.current({type:"SYNC_SEASON_DAY"}),console.log("\ud83d\udcc5 GameTimeUpdater: \u0434\u0435\u043d\u044c \u0441\u0435\u0437\u043e\u043d\u0430 \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d \u0441 \u043c\u0438\u0440\u043e\u0432\u044b\u043c \u0434\u043d\u0435\u043c"),l.current({type:ln}),console.log("\ud83c\udf24\ufe0f GameTimeUpdater: \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0430 \u043f\u043e\u043b\u043d\u0430\u044f \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043f\u043e\u0433\u043e\u0434\u044b \u043f\u0440\u0438 \u0437\u0430\u043f\u0443\u0441\u043a\u0435"),window.dispatchEvent(new CustomEvent("weather_changed",{detail:{auto:!0,initialization:!0,withForecast:!0}}))}),500);return()=>clearTimeout(e)}),[]),(0,n.useEffect)((()=>(u(),s.current=setInterval(u,15e3),()=>{s.current&&(clearInterval(s.current),s.current=null)})),[u]),(0,n.useEffect)((()=>{const e=setInterval((()=>{var e,t;d()&&(l.current({type:"SYNC_SEASON_DAY"}),0===(null===(e=o.state)||void 0===e||null===(t=e.weather)||void 0===t?void 0:t.nextWeatherChange)&&(console.log("\u26a0\ufe0f GameTimeUpdater: \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d \u043d\u0443\u043b\u0435\u0432\u043e\u0439 nextWeatherChange, \u0438\u043d\u0438\u0446\u0438\u0438\u0440\u0443\u0435\u043c \u0441\u043c\u0435\u043d\u0443 \u043f\u043e\u0433\u043e\u0434\u044b"),l.current({type:"FORCE_WEATHER_CHANGE"}),window.dispatchEvent(new CustomEvent("weather_changed",{detail:{auto:!0}}))))}),15e3);return()=>clearInterval(e)}),[d,o.state]),(0,n.useEffect)((()=>{var e,t,r;const n=null===(e=o.state)||void 0===e||null===(t=e.world)||void 0===t||null===(r=t.time)||void 0===r?void 0:r.gameTime;if(void 0===n)return;const a=()=>{if(d()){(0,ky.restockMerchantItems)(n)&&l.current({type:Yr.UPDATE_MARKET_STATE,payload:{merchantsUpdated:!0,timestamp:Date.now()}})}};a();const i=setInterval(a,3e5);return()=>clearInterval(i)}),[null===(t=o.state)||void 0===t||null===(r=t.world)||void 0===r||null===(a=r.time)||void 0===a?void 0:a.gameTime,d]),(0,n.useEffect)((()=>{const e=e=>{var t;"manual_time_update"===(null===(t=e.detail)||void 0===t?void 0:t.type)&&(jg.time=Date.now())};return window.addEventListener("manual_time_update",e),()=>{window.removeEventListener("manual_time_update",e)}}),[i]),(0,n.useEffect)((()=>{const e=()=>{if("visible"===document.visibilityState){(new Date-c.current)/6e4>.25&&d()&&u()}};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[u,d]),(0,n.useEffect)((()=>{i&&sr({context:{state:o.state}})}),[i,o]),(0,n.useEffect)((()=>{i&&o.state&&sr({context:{state:o.state}})}),[o.state,i]),null},kg=(0,Vr.integrateRelationshipSyncer)((e=>{var t;let{children:a}=e;const[i,o]=(0,n.useReducer)(En,Qr);(0,n.useEffect)((()=>{if(i){const e=(e=>{if(!e.weather)return console.log("\ud83d\udd04 initializeWeatherState: state.weather \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442, \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043d\u043e\u0432\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442"),{...e,weather:fn};if(e.weather&&e.world&&e.world.time){let t={...e.weather},r=!1;if("number"===typeof e.world.time.hour&&"number"===typeof e.world.time.minute){const n=e.world.time.hour,a=e.world.time.minute,i=60*n+a;t={...t,currentTime:i,hour:n,minute:a,formattedTime:`${String(n).padStart(2,"0")}:${String(a).padStart(2,"0")}`,timeOfDay:n>=5&&n<7?"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":n>=7&&n<11?"\u0443\u0442\u0440\u043e":n>=11&&n<14?"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":n>=14&&n<17?"\u0434\u0435\u043d\u044c":n>=17&&n<20?"\u0432\u0435\u0447\u0435\u0440":n>=20&&n<23?"\u043d\u043e\u0447\u044c":"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c",isDayTime:n>=6&&n<20},r=!0,console.log(`\ud83d\udd04 initializeWeatherState: \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u0432\u0440\u0435\u043c\u044f: ${n}:${a} -> ${i}`)}if("number"===typeof e.world.time.day){const n=e.world.time.day;let a,i;t.dayCount=n,n>un?(a=hn(n),i=mn(n),console.log("\ud83c\udf08 initializeWeatherState: \u0420\u0410\u0421\u0427\u0415\u0422 \u0421\u0415\u0417\u041e\u041d\u0410 \u041f\u0420\u0418 \u0418\u041d\u0418\u0426\u0418\u0410\u041b\u0418\u0417\u0410\u0426\u0418\u0418:",{"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":n,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":a,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":i}),e.world.time.season&&i!==e.world.time.season&&console.log(`\ud83c\udf08\ud83c\udf08 initializeWeatherState: \u041a\u041e\u0420\u0420\u0415\u041a\u0426\u0418\u042f \u0421\u0415\u0417\u041e\u041d\u0410: ${e.world.time.season} -> ${i}`),t.seasonDay=a,t.currentSeason=i):(t.seasonDay=n,e.world.time.season?t.currentSeason=e.world.time.season:t.currentSeason="spring"),r=!0,console.log("\ud83d\udd04 initializeWeatherState: \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u0443\u0435\u043c \u0434\u0435\u043d\u044c \u0438 \u0441\u0435\u0437\u043e\u043d:",{"\u043c\u0438\u0440\u043e\u0432\u043e\u0439_\u0434\u0435\u043d\u044c":n,"\u0434\u0435\u043d\u044c_\u0441\u0435\u0437\u043e\u043d\u0430":t.seasonDay,"\u0441\u0435\u0437\u043e\u043d":t.currentSeason})}if(r)return"number"===typeof e.world.time.day&&e.world.time.day>un&&e.world.time.season&&t.currentSeason!==e.world.time.season?(console.log("\ud83c\udf08 initializeWeatherState: \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u0418\u0417\u0410\u0426\u0418\u042f \u0421\u0415\u0417\u041e\u041d\u0410 \u0412 WORLD.TIME:",{"\u0442\u0435\u043a\u0443\u0449\u0438\u0439_\u0441\u0435\u0437\u043e\u043d_world_time":e.world.time.season,"\u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0439_\u0441\u0435\u0437\u043e\u043d":t.currentSeason,"\u0434\u0435\u043d\u044c":e.world.time.day}),{...e,world:{...e.world,time:{...e.world.time,season:t.currentSeason}},weather:t}):{...e,weather:t}}return e})(i);e!==i&&o({type:"INITIALIZE_WEATHER_STATE",payload:e})}}),[]),(0,n.useEffect)((()=>{if("undefined"!==typeof window){window.__GAME_STATE__=i,window.__GAME_CONTEXT__?window.__GAME_CONTEXT__.state=i:window.__GAME_CONTEXT__={state:i,actions:{}};try{var e,t,r;if(document.body.setAttribute("data-gamestate-available","true"),i.player)document.body.setAttribute("data-player-health",`${(null===(e=i.player.stats)||void 0===e?void 0:e.health)||0}/${(null===(t=i.player.stats)||void 0===t?void 0:t.maxHealth)||100}`),document.body.setAttribute("data-player-level",(null===(r=i.player.cultivation)||void 0===r?void 0:r.level)||1)}catch(n){console.debug("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c DOM-\u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b:",n)}try{const e=new CustomEvent("game-state-updated",{detail:{timestamp:Date.now()}});window.dispatchEvent(e)}catch(n){console.debug("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0435 \u043e\u0431 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f:",n)}}}),[i]);const s=e=>t=>{const n=(a={getState:()=>i,dispatch:o},e=>t=>{if("UPDATE_TIME_MULTIPLIER"===t.type)return"undefined"!==typeof WeatherService||Promise.resolve().then(r.bind(r,4953)).then((e=>{const r=e.default;r&&(r.TIME_MULTIPLIER=t.payload.multiplier)})).catch((e=>{})),e(t);const n=e(t);if(t.type===ln){const e=a.getState(),{dispatch:t}=a;if(Sn){console.log("\u2705\u2705 weatherServiceInstance \u0423\u0416\u0415 \u0421\u0423\u0429\u0415\u0421\u0422\u0412\u0423\u0415\u0422, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0435\u0433\u043e \u0434\u043b\u044f \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0433\u043e\u0434\u044b");try{var i,o;null===(i=e.world)||void 0===i||i.time,null===(o=e.world)||void 0===o||o.currentLocation,t(cn(initializedWeather)),setTimeout((()=>{a.getState()}),10)}catch(d){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0433\u043e\u0434\u044b:",d)}}else Promise.resolve().then(r.bind(r,4953)).then((r=>{var n,a;const i=r.default;Sn=new i;const o=null===(n=e.world)||void 0===n?void 0:n.time,s=(null===(a=e.world)||void 0===a?void 0:a.currentLocation)||null,l=Sn.initWeather(s,o);t(cn(l))})).catch((e=>{console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0435 weather-service \u0434\u043b\u044f \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043e\u0433\u043e\u0434\u044b:",e)}));return n}if(t.type===sn){const e=a.getState(),{dispatch:t}=a;if(Sn)try{var s;const r=e.weather||{},n=(null===(s=e.world)||void 0===s?void 0:s.currentLocation)||null,a=Sn.forceWeatherChange(r,n);t(cn(a))}catch(d){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043c\u0435\u043d\u0435 \u043f\u043e\u0433\u043e\u0434\u044b:",d)}else Promise.resolve().then(r.bind(r,4953)).then((r=>{var n;const a=r.default;Sn=new a;const i=e.weather||{},o=(null===(n=e.world)||void 0===n?void 0:n.currentLocation)||null,s=Sn.forceWeatherChange(i,o);t(cn(s))})).catch((e=>{console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0435 weather-service \u0434\u043b\u044f \u0441\u043c\u0435\u043d\u044b \u043f\u043e\u0433\u043e\u0434\u044b:",e)}));return n}if(t.type===on){var l,c;const e=(null===(l=t.payload)||void 0===l?void 0:l.minutesToAdd)||1,i=(null===(c=t.payload)||void 0===c?void 0:c.isManual)||!1;if(Tn&&!i)return n;if(i)jn=Date.now();else if(Date.now()-jn<1e3)return n;Tn=!0;const{dispatch:o}=a;setTimeout((()=>{try{a.getState(),Sn?t():Promise.resolve().then(r.bind(r,4953)).then((e=>{const r=e.default;Sn=new r,t()})).catch((e=>{Tn=!1}))}catch(n){Tn=!1}function t(){try{var t,n,s,l,c,u,p,h,m,f,y,g;if(!i&&Date.now()-jn<1e3)return void(Tn=!1);const x=a.getState();let b=x.weather||{};const w=(null===(t=x.world)||void 0===t?void 0:t.currentLocation)||null;if(!b.forecast||0===b.forecast.length)if(Sn)try{var v;const e=null===(v=x.world)||void 0===v?void 0:v.time;if(e){const t=Sn.initWeather(w,e);b={...t,currentWeather:b.currentWeather||t.currentWeather,weatherIntensity:b.weatherIntensity||t.weatherIntensity},console.log("\ud83c\udf24\ufe0f \u041f\u043e\u0433\u043e\u0434\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0441 \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u043e\u043c:",t.forecast),o(cn(b))}}catch(d){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430 \u043f\u043e\u0433\u043e\u0434\u044b:",d)}else console.log("\u23f3 weatherServiceInstance \u0435\u0449\u0435 \u043d\u0435 \u0433\u043e\u0442\u043e\u0432 \u0434\u043b\u044f \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430, \u043e\u0436\u0438\u0434\u0430\u0435\u043c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0433\u043e \u0446\u0438\u043a\u043b\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f"),Promise.resolve().then(r.bind(r,4953)).then((e=>{console.log("\u2705 \u041c\u043e\u0434\u0443\u043b\u044c weather-service \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0434\u043b\u044f \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430");const t=e.default;Sn=new t})).catch((e=>{console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043c\u043f\u043e\u0440\u0442\u0435 weather-service \u0434\u043b\u044f \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430:",e)}));if(void 0!==b.currentTime&&(void 0===b.hour||void 0===b.minute)){const e=b.currentTime||0,t=Math.floor(e/60),r=e%60;b={...b,hour:t,minute:r,dayCount:b.dayCount||1,seasonDay:b.seasonDay||1,currentSeason:b.currentSeason||"spring",currentWeather:b.weatherType||"clear",weatherIntensity:b.weatherIntensity||1,isDayTime:t>=6&&t<20},console.log("\ud83d\udd04 \u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043f\u043e\u0433\u043e\u0434\u044b:",{hour:t,minute:r,dayCount:b.dayCount,currentWeather:b.currentWeather})}if(console.log(`\ud83d\udd04 \u0412\u044b\u0437\u043e\u0432 weatherServiceInstance.updateTime \u0441 worldTime \u0438 minutesToAdd=${e}`),!Sn)return console.error("\u274c weatherServiceInstance \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442!"),void(Tn=!1);if("function"!==typeof Sn.updateTime)return console.error("\u274c \u041c\u0435\u0442\u043e\u0434 updateTime \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442:",Sn),void(Tn=!1);const _=(null===(n=x.world)||void 0===n?void 0:n.time)||{};console.log("\ud83d\udccb \u0414\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0434 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435\u043c:",{worldTime:{hour:_.hour,minute:_.minute,day:_.day,season:_.season},weatherState:{hour:b.hour,minute:b.minute,dayCount:b.dayCount,seasonDay:b.seasonDay,currentWeather:b.currentWeather},timeMultiplier:WeatherService.TIME_MULTIPLIER,gameMinutesToAdd:e*WeatherService.TIME_MULTIPLIER});const E=Sn.updateTime(b,w,{hour:_.hour,minute:_.minute,day:_.day,season:_.season},e);console.log("\u2705 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u043f\u043e\u0433\u043e\u0434\u044b:",{hour:E.hour,minute:E.minute,dayCount:E.dayCount,seasonDay:E.seasonDay,currentWeather:E.currentWeather,totalGameMinutes:60*E.hour+E.minute});const T=e*WeatherService.TIME_MULTIPLIER,S=(null===(s=x.world)||void 0===s||null===(l=s.time)||void 0===l?void 0:l.hour)||0,j=(null===(c=x.world)||void 0===c||null===(u=c.time)||void 0===u?void 0:u.minute)||0,C=60*S+j,k=T;let I,A=(C+k)%1440;console.log("\ud83d\udd0d \u041e\u0422\u041b\u0410\u0414\u041a\u0410 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u0447\u0435\u0440\u0435\u0437 \u043f\u043e\u043b\u043d\u043e\u0447\u044c:",{totalOldMinutes:C,newTotalMinutesOfDay:A,isTransition:A<C,minutesToAddTotal:k,oldTime:`${S}:${j}`,newTime:`${Math.floor(A/60)}:${A%60}`,check1:23===S&&0===Math.floor(A/60),check2:C>1380&&A<60});const N=S,D=Math.floor(A/60),M=N>=23&&D<1||C>1380&&A<60,R=Math.floor(k/1440);M?(I=1+R,console.log("\ud83c\udf19\ud83c\udf19\ud83c\udf19\ud83c\udf19 \u041f\u0415\u0420\u0415\u0425\u041e\u0414 \u0427\u0415\u0420\u0415\u0417 \u041f\u041e\u041b\u041d\u041e\u0427\u042c!",{oldTime:`${N}:${j}`,newTime:`${D}:${A%60}`,criteriaMatched:"\u042f\u0432\u043d\u044b\u0439 \u043f\u0435\u0440\u0435\u0445\u043e\u0434 \u0438\u0437 \u043f\u043e\u0437\u0434\u043d\u0435\u0433\u043e \u0447\u0430\u0441\u0430 (23+) \u0432 \u0440\u0430\u043d\u043d\u0438\u0439 \u0447\u0430\u0441 (0-1)",explicitFullDays:R,totalDaysToAdd:I})):A<C?(I=1+R,console.log("\ud83c\udf19\ud83c\udf19\ud83c\udf19 \u041f\u0415\u0420\u0415\u0425\u041e\u0414 \u0427\u0415\u0420\u0415\u0417 \u041f\u041e\u041b\u041d\u041e\u0427\u042c (\u0443\u043c\u0435\u043d\u044c\u0448\u0435\u043d\u0438\u0435 \u043c\u0438\u043d\u0443\u0442)!",{oldTime:`${N}:${j}`,newTime:`${D}:${A%60}`,oldTotalMinutes:C,newTotalMinutes:A,minutesDiff:A-C,explicitFullDays:R,totalDaysToAdd:I})):(I=R,I>0&&console.log("\ud83d\udcc5 \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u0434\u043d\u0435\u0439:",I,"(\u043f\u043e\u043b\u043d\u044b\u0445 \u0441\u0443\u0442\u043e\u043a)")),23===N&&0===D&&0===I?(console.log("\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f \u0412\u041d\u0418\u041c\u0410\u041d\u0418\u0415! \u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0410\u042f \u0421\u0418\u0422\u0423\u0410\u0426\u0418\u042f: \u043f\u0435\u0440\u0435\u0445\u043e\u0434 23:xx \u2192 00:xx, \u043d\u043e daysToAdd = 0!"),console.log("\ud83d\udee0\ufe0f \u041f\u0420\u0418\u041d\u0423\u0414\u0418\u0422\u0415\u041b\u042c\u041d\u041e\u0415 \u0418\u0421\u041f\u0420\u0410\u0412\u041b\u0415\u041d\u0418\u0415: \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c daysToAdd = 1"),I=1):N>=22&&D<=5&&k>=60&&0===I?(console.log("\u26a0\ufe0f\u26a0\ufe0f \u041e\u0411\u041d\u0410\u0420\u0423\u0416\u0415\u041d \u0421\u041b\u041e\u0416\u041d\u042b\u0419 \u041f\u0415\u0420\u0415\u0425\u041e\u0414 \u0427\u0415\u0420\u0415\u0417 \u041f\u041e\u041b\u041d\u041e\u0427\u042c: \u043f\u043e\u0437\u0434\u043d\u0435\u0435 \u0432\u0440\u0435\u043c\u044f + \u043f\u0440\u0438\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0431\u043e\u043b\u044c\u0448\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u043c\u0438\u043d\u0443\u0442!"),console.log("\ud83d\udee0\ufe0f \u041f\u0420\u0418\u041d\u0423\u0414\u0418\u0422\u0415\u041b\u042c\u041d\u041e\u0415 \u0418\u0421\u041f\u0420\u0410\u0412\u041b\u0415\u041d\u0418\u0415: \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c daysToAdd = 1"),I=1):60*N+j>=1410&&60*D+A%60<=30&&0===I&&(console.log("\u26a0\ufe0f\u26a0\ufe0f \u041e\u0411\u041d\u0410\u0420\u0423\u0416\u0415\u041d \u0421\u041f\u0415\u0426\u0418\u0410\u041b\u042c\u041d\u042b\u0419 \u0413\u0420\u0410\u041d\u0418\u0427\u041d\u042b\u0419 \u0421\u041b\u0423\u0427\u0410\u0419 \u041f\u041e\u041b\u0423\u041d\u041e\u0427\u0418 (23:30+ \u2192 00:30-)"),console.log("\ud83d\udee0\ufe0f \u041f\u0420\u0418\u041d\u0423\u0414\u0418\u0422\u0415\u041b\u042c\u041d\u041e\u0415 \u0418\u0421\u041f\u0420\u0410\u0412\u041b\u0415\u041d\u0418\u0415: \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c daysToAdd = 1"),I=1);let P=Math.floor(A/60),L=A%60;console.log("\ud83d\udd52 \u0412\u0410\u0416\u041d\u041e! \u041f\u0420\u042f\u041c\u041e\u0415 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 worldTime:",{oldWorldTime:`${S}:${j}`,newWorldTime:`${P}:${L}`,totalOldMinutes:C,newTotalMinutesOfDay:A,minutesAdded:T,minutesToAddTotal:k,daysToAdd:I});const $=(null===(p=x.world)||void 0===p||null===(h=p.time)||void 0===h?void 0:h.day)||1,O=$+I;console.log("\ud83d\udcc5 \u0418\u0421\u041f\u0420\u0410\u0412\u041b\u0415\u041d\u041d\u041e\u0415 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 \u043f\u043e\u043b\u043d\u043e\u0447\u044c:",{oldTime:`${N}:${j}`,newTime:`${D}:${A%60}`,totalOldMinutes:C,newTotalMinutesOfDay:A,minutesToAddTotal:k,daysToAdd:I,currentWorldDay:$,newDay:O}),console.log("\ud83c\udf19 \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u0447\u0435\u0440\u0435\u0437 \u043f\u043e\u043b\u043d\u043e\u0447\u044c:",{oldTime:`${S}:${j}`,newTime:`${P}:${L}`,gameMinutes:T,daysToAdd:I,totalOldMinutes:C,newTotalMinutesOfDay:A,currentWorldDay:$,newDay:O}),console.log("\ud83d\udcc5 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u043d\u044f:",{currentWorldDay:$,newDay:O,debug:{worldTimeDayType:typeof(null===(m=x.world)||void 0===m||null===(f=m.time)||void 0===f?void 0:f.day)}}),console.log("\ud83d\ude80\ud83d\ude80 \u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u0418\u0419 \u041b\u041e\u0413 - \u0414\u0410\u041d\u041d\u042b\u0415 \u041f\u0415\u0420\u0415\u0414 \u041e\u0422\u041f\u0420\u0410\u0412\u041a\u041e\u0419 \u042d\u041a\u0428\u0415\u041d\u0410:",{hour:P,minute:L,day:O,currentWorldDay:$,daysToAdd:I,isMidnightCrossing:M,time_values:{oldHour:N,newHour:D,oldMinutes:C,newMinutes:A},actions_taken:{condition1:N>=23&&D<1,condition2:A<C,explicit_days:R},state_world_time:(null===(y=x.world)||void 0===y?void 0:y.time)||"\u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442"}),console.log(`\ud83d\udd2c \u041e\u0422\u041b\u0410\u0414\u041a\u0410 \u041f\u0420\u041e\u0411\u041b\u0415\u041c\u042b \u0421 \u0414\u041d\u0415\u041c: \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0434\u0435\u043d\u044c=${$}, \u043d\u043e\u0432\u044b\u0439 \u0434\u0435\u043d\u044c=${O}, daysToAdd=${I}`);const q={type:Yr.UPDATE_TIME,payload:{hour:P,minute:L,day:O,season:E.currentSeason||"spring"}};console.log("\ud83d\ude80 \u041e\u0422\u041f\u0420\u0410\u0412\u041b\u042f\u0415\u041c \u042d\u041a\u0428\u0415\u041d UPDATE_TIME:",q);const U={type:Yr.UPDATE_TIME,payload:{hour:Number(P),minute:Number(L),day:Number(O),season:E.currentSeason||"spring"}};console.log("\ud83c\udfaf\ud83c\udfaf \u041a\u0420\u0418\u0422\u0418\u0427\u0415\u0421\u041a\u041e\u0415 \u041f\u0420\u0415\u041e\u0411\u0420\u0410\u0417\u041e\u0412\u0410\u041d\u0418\u0415 UPDATE_TIME:",{"\u0438\u0441\u0445\u043e\u0434\u043d\u043e\u0435_\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435":q,"\u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0435_\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435_\u0434\u043d\u044f":Number(O),"\u0442\u0438\u043f_\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f_\u0434\u043d\u044f":typeof Number(O),"\u043e\u0447\u0438\u0449\u0435\u043d\u043d\u043e\u0435_\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435":U}),o(U),setTimeout((()=>{var e,t;const r=a.getState();console.log("\ud83d\udcca \u0421\u041e\u0421\u0422\u041e\u042f\u041d\u0418\u0415 \u041f\u041e\u0421\u041b\u0415 \u0414\u0418\u0421\u041f\u0410\u0422\u0427\u0410:",{world_time:null===(e=r.world)||void 0===e?void 0:e.time,weather_dayCount:null===(t=r.weather)||void 0===t?void 0:t.dayCount})}),0),0===E.nextWeatherChange?(console.log("\u26a0\ufe0f\u26a0\ufe0f\u26a0\ufe0f \u041e\u0411\u041d\u0410\u0420\u0423\u0416\u0415\u041d \u041d\u0423\u041b\u0415\u0412\u041e\u0419 nextWeatherChange! \u041d\u0435\u043c\u0435\u0434\u043b\u0435\u043d\u043d\u043e \u043c\u0435\u043d\u044f\u0435\u043c \u043f\u043e\u0433\u043e\u0434\u0443!"),o(cn({currentWeather:E.currentWeather,weatherIntensity:E.weatherIntensity,weatherEffects:E.weatherEffects,dayCount:O,currentSeason:_.season||E.currentSeason,nextWeatherChange:E.nextWeatherChange,forecast:E.forecast})),setTimeout((()=>{console.log("\ud83c\udf24\ufe0f\ud83c\udf24\ufe0f \u0412\u044b\u0437\u044b\u0432\u0430\u0435\u043c \u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0441\u043c\u0435\u043d\u0443 \u043f\u043e\u0433\u043e\u0434\u044b \u0438\u0437-\u0437\u0430 \u043d\u0443\u043b\u0435\u0432\u043e\u0433\u043e nextWeatherChange"),o({type:sn})}),100)):o(cn({currentWeather:E.currentWeather,weatherIntensity:E.weatherIntensity,weatherEffects:E.weatherEffects,dayCount:O,currentSeason:_.season||E.currentSeason,nextWeatherChange:E.nextWeatherChange,forecast:E.forecast})),console.log("\u23f3 \u041f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043d\u043e\u0432\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 nextWeatherChange:",{"\u043f\u043e\u043b\u0443\u0447\u0435\u043d\u043e_\u043e\u0442_\u0441\u0435\u0440\u0432\u0438\u0441\u0430":E.nextWeatherChange,"\u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0435\u0435_\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435":b.nextWeatherChange,"\u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0435":E.nextWeatherChange-(b.nextWeatherChange||0)});const F=60*P+L,z=(null===(g=x.weather)||void 0===g?void 0:g.seasonDay)||1;let B=O;if(z!==O&&console.log(`\ud83d\udcc5 \u041f\u041e\u041b\u041d\u0410\u042f \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u0418\u0417\u0410\u0426\u0418\u042f \u0414\u041d\u042f \u0421\u0415\u0417\u041e\u041d\u0410 \u0441 \u043c\u0438\u0440\u043e\u0432\u044b\u043c \u0434\u043d\u0435\u043c: ${z} \u2192 ${O}`,{"\u043f\u0440\u0438\u0447\u0438\u043d\u0430":I>0?"\u0441\u043c\u0435\u043d\u0430 \u0434\u043d\u044f":"\u043f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f",dayDiff:Math.abs(O-z)}),o({type:"DIRECT_UPDATE_WEATHER_TIME",payload:{currentTime:F,formattedTime:`${String(P).padStart(2,"0")}:${String(L).padStart(2,"0")}`,hour:P,minute:L,dayCount:O,seasonDay:B,currentSeason:_.season||E.currentSeason,timeOfDay:P>=5&&P<7?"\u0440\u0430\u0441\u0441\u0432\u0435\u0442":P>=7&&P<11?"\u0443\u0442\u0440\u043e":P>=11&&P<14?"\u043f\u043e\u043b\u0434\u0435\u043d\u044c":P>=14&&P<17?"\u0434\u0435\u043d\u044c":P>=17&&P<20?"\u0432\u0435\u0447\u0435\u0440":P>=20&&P<23?"\u043d\u043e\u0447\u044c":"\u0433\u043b\u0443\u0431\u043e\u043a\u0430\u044f \u043d\u043e\u0447\u044c",isDayTime:P>=6&&P<20}}),setTimeout((()=>{var e,t,r;const n=a.getState();var i,o,s;(null===(e=n.weather)||void 0===e?void 0:e.hour)!==P||(null===(t=n.weather)||void 0===t?void 0:t.minute)!==L||(null===(r=n.weather)||void 0===r?void 0:r.dayCount)!==O?console.error("\u26a0\ufe0f \u041e\u0428\u0418\u0411\u041a\u0410 \u0421\u0418\u041d\u0425\u0420\u041e\u041d\u0418\u0417\u0410\u0426\u0418\u0418! \u0412\u0440\u0435\u043c\u044f \u0432 weather \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 world_time:",{worldTime:{hour:P,minute:L,day:O},weather:{hour:null===(i=n.weather)||void 0===i?void 0:i.hour,minute:null===(o=n.weather)||void 0===o?void 0:o.minute,dayCount:null===(s=n.weather)||void 0===s?void 0:s.dayCount}}):console.log("\u2705 \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!")}),50),console.log("\ud83d\udd04 \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432\u0440\u0435\u043c\u0435\u043d\u0438:",{worldTime:{hour:P,minute:L,day:O},weatherTime:{hour:P,minute:L,dayCount:O,totalMinutes:F}}),console.log("\u2705 \u0412\u0440\u0435\u043c\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u0432 state.world.time \u0418 state.weather"),i){const e=b.hour||0,t=b.minute||0,r=E.hour||0,n=E.minute||0,a=60*e+t,i=60*r+n,o=i>=a?i-a:1440-a+i;console.log(`\u2713 \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442: ${e}:${t.toString().padStart(2,"0")} \u2192 ${r}:${n.toString().padStart(2,"0")} (+${o} \u0438\u0433\u0440.\u043c\u0438\u043d)`)}}catch(d){Tn=!1}finally{Tn=!1}}}),i?0:100)}return n})(e)(t);var a;return n},l=e=>s(o)(e);(0,n.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("gameState");if(e)l({type:Yr.LOAD_GAME,payload:JSON.parse(e)});else{const e=await Br.getCurrentUser();e&&l({type:Yr.UPDATE_PLAYER,payload:e})}l({type:Yr.SET_INITIALIZED,payload:!0}),console.log("\ud83d\udd04 \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0438\u0433\u0440\u044b \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0438\u0433\u0440\u044b:",e),l({type:Yr.SET_ERROR,payload:e.message})}})()}),[]),(0,n.useEffect)((()=>{var e;if(i.isInitialized&&Array.isArray(null===(e=i.player)||void 0===e?void 0:e.techniques)&&i.player.techniques.length>0){const e=setTimeout((()=>{console.log("\ud83d\udee0\ufe0f \u0417\u0430\u043f\u0443\u0441\u043a \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0433\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u0445\u043d\u0438\u043a \u043f\u043e\u0441\u043b\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438...");try{l({type:Yr.REPAIR_TECHNIQUES}),console.log("\u2705 \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u0445\u043d\u0438\u043a \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e")}catch(e){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u043c \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0442\u0435\u0445\u043d\u0438\u043a:",e)}}),1e3);return()=>clearTimeout(e)}}),[i.isInitialized,null===(t=i.player)||void 0===t?void 0:t.techniques]);const c=()=>(console.log("\ud83e\uddf9 \u0417\u0430\u043f\u0443\u0441\u043a \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430..."),l({type:Yr.NORMALIZE_EFFECTS}),l({type:Yr.ADD_NOTIFICATION,payload:{message:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u0431\u044b\u043b\u0430 \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u0430",type:"info"}}),setTimeout((()=>{console.log("\u2705 \u042d\u0444\u0444\u0435\u043a\u0442\u044b \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u043f\u043e\u0441\u043b\u0435 \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438:",i.player.statusEffects)}),100),i.player.statusEffects);(0,n.useEffect)((()=>{i.isInitialized&&setTimeout((()=>{try{(0,en.checkAndNormalizeSectData)(i)!==i&&(console.log("\ud83d\udd0d \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u044b \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b, \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e..."),console.log("\ud83e\uddf9 \u0417\u0430\u043f\u0443\u0441\u043a \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b..."),l({type:Yr.NORMALIZE_SECT_DATA}),l({type:Yr.ADD_NOTIFICATION,payload:{message:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b \u0431\u044b\u043b\u0430 \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u0430",type:"info"}}),setTimeout((()=>{console.log("\u2705 \u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u0435\u043a\u0442\u044b \u043f\u043e\u0441\u043b\u0435 \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438:",i.sect)}),100),i.sect),console.log("\ud83d\udd04 \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441\u0435\u043a\u0442\u044b \u0438 \u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439..."),(0,Vr.initRelationshipSync)({getState:()=>i,dispatch:l}),i.player&&i.player.statusEffects&&(Array.isArray(i.player.statusEffects)?0===i.player.statusEffects.length&&i.player.sect&&i.player.sect.benefits&&i.player.sect.benefits.length>0&&(console.log("\ud83d\udd0d \u042d\u0444\u0444\u0435\u043a\u0442\u044b \u0441\u0435\u043a\u0442\u044b \u043d\u0435 \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u044b \u0432 \u0441\u043f\u0438\u0441\u043e\u043a \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430, \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e..."),c()):(console.log("\ud83d\udd0d \u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d \u043d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 (\u043e\u0431\u044a\u0435\u043a\u0442 \u0432\u043c\u0435\u0441\u0442\u043e \u043c\u0430\u0441\u0441\u0438\u0432\u0430), \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0443\u044e \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044e..."),c()))}catch(e){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u043a\u0442\u044b \u0438\u043b\u0438 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432:",e)}}),1500)}),[i.isInitialized]);const d={dispatch:l,normalizeEffects:()=>(console.log("\ud83e\uddf9 \u0420\u0443\u0447\u043d\u043e\u0439 \u0437\u0430\u043f\u0443\u0441\u043a \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430..."),c()),updatePlayer:e=>l({type:Yr.UPDATE_PLAYER,payload:e}),updatePlayerStats:e=>l({type:Yr.UPDATE_PLAYER_STATS,payload:e}),updateCultivation:e=>l({type:Yr.UPDATE_CULTIVATION,payload:e}),addItem:e=>l({type:Yr.ADD_ITEM,payload:e}),removeItem:e=>{const t="object"===typeof e?e:{id:e};console.log("Removing item with payload:",t),l({type:Yr.REMOVE_ITEM,payload:t})},equipItem:e=>l({type:Yr.EQUIP_ITEM,payload:e}),unequipItem:e=>l({type:Yr.UNEQUIP_ITEM,payload:e}),updateCurrency:function(e){return l({type:Yr.UPDATE_CURRENCY,payload:e,isAdditive:arguments.length>1&&void 0!==arguments[1]&&arguments[1]})},addCurrency:e=>{console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0430\u043b\u044e\u0442\u044b \u0432 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044c:",e),l({type:Yr.UPDATE_CURRENCY,payload:e,isAdditive:!0})},updateLocation:e=>l({type:Yr.UPDATE_LOCATION,payload:e}),updateTime:e=>l({type:Yr.UPDATE_TIME,payload:e}),updateWeather:e=>l({type:Yr.UPDATE_WEATHER,payload:e}),addEvent:e=>l({type:Yr.ADD_EVENT,payload:e}),removeEvent:e=>l({type:Yr.REMOVE_EVENT,payload:e}),cacheGeneratedEnemy:(e,t,r)=>l({type:Yr.CACHE_GENERATED_ENEMY,payload:{areaId:e,enemyId:t,enemy:r}}),changeScreen:e=>l({type:Yr.CHANGE_SCREEN,payload:e}),addNotification:e=>l({type:Yr.ADD_NOTIFICATION,payload:e}),removeNotification:e=>l({type:Yr.REMOVE_NOTIFICATION,payload:e}),updateSettings:e=>l({type:Yr.UPDATE_SETTINGS,payload:e}),saveGame:e=>l({type:Yr.SAVE_GAME,payload:e}),loadGame:e=>l({type:Yr.LOAD_GAME,payload:e}),acceptQuest:e=>l({type:Yr.ACCEPT_QUEST,payload:e}),completeQuest:e=>l({type:Yr.COMPLETE_QUEST,payload:e}),updateQuestObjective:e=>l({type:Yr.UPDATE_QUEST_OBJECTIVE,payload:e}),checkAchievements:e=>l({type:Yr.CHECK_ACHIEVEMENTS,payload:{achievements:e}}),completeAchievement:e=>l({type:Yr.COMPLETE_ACHIEVEMENT,payload:e}),learnTechnique:e=>l({type:Yr.LEARN_TECHNIQUE,payload:e}),upgradeTechnique:e=>l({type:Yr.UPGRADE_TECHNIQUE,payload:e}),useTechnique:e=>l({type:Yr.USE_TECHNIQUE,payload:e}),repairTechniques:()=>{console.log("\ud83d\udd27 \u0417\u0430\u043f\u0443\u0441\u043a \u0440\u0443\u0447\u043d\u043e\u0433\u043e \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0435\u0445\u043d\u0438\u043a"),l({type:Yr.REPAIR_TECHNIQUES}),l({type:Yr.ADD_NOTIFICATION,payload:{message:"\u0422\u0435\u0445\u043d\u0438\u043a\u0438 \u0431\u044b\u043b\u0438 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b",type:"success"}})},startCombat:e=>l({type:Yr.START_COMBAT,payload:e}),endCombat:()=>l({type:Yr.END_COMBAT}),updateCombat:e=>l({type:Yr.UPDATE_COMBAT,payload:e}),updateCombatState:e=>l({type:Yr.UPDATE_COMBAT_STATE,payload:e}),addCombatLog:e=>l({type:Yr.ADD_COMBAT_LOG,payload:e}),addCombatHistory:e=>{console.log("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0431\u043e\u044f \u0432 \u0438\u0441\u0442\u043e\u0440\u0438\u044e:",e),l({type:Yr.ADD_COMBAT_HISTORY,payload:e})},addStatusEffect:e=>l({type:Yr.ADD_STATUS_EFFECT,payload:e}),updateStatusEffect:e=>l({type:Yr.UPDATE_STATUS_EFFECT,payload:e}),removeStatusEffect:e=>l({type:Yr.REMOVE_STATUS_EFFECT,payload:e}),addSpiritPet:e=>l({type:Yr.ADD_SPIRIT_PET,payload:e}),removeSpiritPet:e=>l({type:Yr.REMOVE_SPIRIT_PET,payload:e}),updateSpiritPet:e=>l({type:Yr.UPDATE_SPIRIT_PET,payload:e}),setActiveSpiritPet:e=>l({type:Yr.SET_ACTIVE_SPIRIT_PET,payload:e}),feedSpiritPet:e=>l({type:Yr.FEED_SPIRIT_PET,payload:e}),trainSpiritPet:e=>l({type:Yr.TRAIN_SPIRIT_PET,payload:e}),usePetAbility:e=>l({type:Yr.USE_PET_ABILITY,payload:e}),removeFleePet:e=>l({type:Yr.REMOVE_FLEEING_PET,payload:e}),updatePetsState:()=>l({type:Yr.UPDATE_PETS_STATE}),applyEquipmentBonuses:e=>{if(console.log("===== \u041f\u0420\u0418\u041c\u0415\u041d\u0415\u041d\u0418\u0415 \u0411\u041e\u041d\u0423\u0421\u041e\u0412 \u042d\u041a\u0418\u041f\u0418\u0420\u041e\u0412\u041a\u0418 ====="),console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0431\u043e\u043d\u0443\u0441\u043e\u0432 \u043e\u0442 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438:",e),!e||"object"!==typeof e)return void console.error("\u041e\u0448\u0438\u0431\u043a\u0430: \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 equippedItems",e);const t={};Object.entries(e).forEach((e=>{let[n,a]=e;if(a&&(t[n]=a,!a.calculatedBonuses&&a.itemId))try{const{getEquipmentItemById:e}=r(3574),i=e(parseInt(a.itemId));i&&i.calculatedBonuses&&(console.log(`\ud83d\udd0d \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u044b \u043f\u0440\u0435\u0434\u0440\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u043d\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430 ${a.name} (ID: ${a.itemId})`),t[n]={...a,calculatedBonuses:i.calculatedBonuses})}catch(i){console.error(`\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0435\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0435 ${a.name}:`,i)}})),console.log("\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u044d\u043a\u0438\u043f\u0438\u0440\u043e\u0432\u043a\u0438 \u0434\u043b\u044f \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0431\u043e\u043d\u0443\u0441\u043e\u0432:",t),o({type:Yr.APPLY_EQUIPMENT_BONUSES,payload:t}),setTimeout((()=>{console.log("\ud83d\udd04 \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b:",i.player.equipmentBonuses)}),100)},updateRelationship:e=>{if(console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0441 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u043c:",e),e&&e.id&&e.name&&void 0!==e.level){l({type:Yr.UPDATE_RELATIONSHIP_AND_LOYALTY,payload:{name:e.name,value:e.level}});try{setTimeout((()=>{if(i.player&&i.player.social){let t=i.player.social.relationships||[];Array.isArray(t)||(console.warn("\u041e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u043d\u0435 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u043e\u043c, \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0438\u0445:",t),t="object"===typeof t&&null!==t?Object.values(t):[]);let r=[];try{r=t.filter((e=>e&&"object"===typeof e&&"number"===typeof e.level&&e.level>=75)).map((e=>e.id))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u0438 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u0434\u0440\u0443\u0437\u0435\u0439:",e),r=[];for(let n=0;n<t.length;n++){const e=t[n];e&&"object"===typeof e&&"number"===typeof e.level&&e.level>=75&&r.push(e.id)}}r.length>0&&(console.log("\ud83d\udc6b \u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0434\u0440\u0443\u0437\u0435\u0439:",r),l({type:"UPDATE_SOCIAL_FRIENDS",payload:r}),d.checkAchievements(["ach8"]))}}),100)}catch(t){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u0440\u0443\u0437\u0435\u0439:",t)}}else console.error("\u041e\u0448\u0438\u0431\u043a\u0430: \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430",e)},loadUserSect:async()=>{try{const e=await An.getUserSect(i.player.id);if(e){if(e.benefits&&!Array.isArray(e.benefits)){console.warn("\u0411\u043e\u043d\u0443\u0441\u044b \u0441\u0435\u043a\u0442\u044b \u043d\u0435 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u043c\u0430\u0441\u0441\u0438\u0432\u0430, \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0432 \u043c\u0430\u0441\u0441\u0438\u0432");const t=e.benefits;e.benefits=[{type:"cultivation_speed",modifier:Math.round(100*(t.cultivationSpeedBonus||0))},{type:"resource_gathering",modifier:Math.round(100*(t.resourceGatheringBonus||0))},{type:"energy_regen",modifier:t.energyRegenBonus||0},{type:"technique_discount",modifier:Math.round(100*(t.techniqueDiscountPercent||0))},{type:"max_energy",modifier:t.maxEnergyBonus||0}]}l({type:Yr.SET_SECT,payload:e});const t=await An.getSectBenefits(i.player.id);let r=t;if(t&&!Array.isArray(t)){console.warn("\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u043d\u044b\u0435 \u0431\u043e\u043d\u0443\u0441\u044b \u043d\u0435 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u043c\u0430\u0441\u0441\u0438\u0432\u0430, \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c");const e=t;r=[{type:"cultivation_speed",modifier:Math.round(100*(e.cultivationSpeedBonus||0))},{type:"resource_gathering",modifier:Math.round(100*(e.resourceGatheringBonus||0))},{type:"energy_regen",modifier:e.energyRegenBonus||0},{type:"technique_discount",modifier:Math.round(100*(e.techniqueDiscountPercent||0))},{type:"max_energy",modifier:e.maxEnergyBonus||0}]}l({type:Yr.UPDATE_SECT_BENEFITS,payload:r});const n=await An.getUserSectRank(i.player.id);l({type:Yr.UPDATE_SECT_RANK,payload:n})}return e}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u0435\u043a\u0442\u0435:",e),l({type:Yr.ADD_NOTIFICATION,payload:{message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0435\u043a\u0442\u0435",type:"error"}}),null}},contributeToSect:async(e,t,r)=>{try{const n=await An.contributeToSect(e,t,r);return l({type:Yr.UPDATE_CULTIVATION,payload:{energy:i.player.cultivation.energy-r}}),l({type:`${Yr.CONTRIBUTE_TO_SECT}_SUCCESS`,payload:n}),n}catch(n){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u043d\u0435\u0441\u0435\u043d\u0438\u0438 \u0432\u043a\u043b\u0430\u0434\u0430 \u0432 \u0441\u0435\u043a\u0442\u0443:",n),l({type:`${Yr.CONTRIBUTE_TO_SECT}_ERROR`,payload:n.message}),n}},trainSectMember:async(e,t,r)=>{try{var n;const a=await An.trainWithMember(e,t,r);l({type:Yr.UPDATE_CULTIVATION,payload:{energy:i.player.cultivation.energy-a.energySpent,experience:i.player.cultivation.experience+a.userGainedXP}});const o=null===(n=i.sect)||void 0===n?void 0:n.sect;let s=0;if(o&&Array.isArray(o.members)){const e=o.members.find((e=>e.id===t));e&&(s=e.loyalty||0)}const c=a.memberLoyalty-s,d=s+Math.min(10,c);if(console.log(`\u2705 \u041b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0430: \u0422\u0435\u043a\u0443\u0449\u0430\u044f=${s}, \u041f\u0440\u0438\u0440\u043e\u0441\u0442=${c}, \u041c\u0430\u043a\u0441.\u043f\u0440\u0438\u0440\u043e\u0441\u0442=10, \u041d\u043e\u0432\u0430\u044f=${d}`),l({type:`${Yr.TRAIN_SECT_MEMBER}_SUCCESS`,payload:{memberId:t,memberLevel:a.memberLevel,memberExperience:a.memberExperience,memberRequiredExperience:a.memberRequiredExperience,memberRole:a.memberRole,memberLoyalty:d}}),o&&Array.isArray(o.members)){const e=o.members.find((e=>e.id===t));e&&e.name&&(console.log(`\ud83d\udd04 \u0421\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u044f \u043b\u043e\u044f\u043b\u044c\u043d\u043e\u0441\u0442\u0438 -> \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f ${e.name}: ${d}`),l({type:Yr.UPDATE_RELATIONSHIP_AND_LOYALTY,payload:{name:e.name,value:d}}))}return{...a,memberLoyalty:d}}catch(a){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0435 \u0447\u043b\u0435\u043d\u0430 \u0441\u0435\u043a\u0442\u044b:",a),l({type:`${Yr.TRAIN_SECT_MEMBER}_ERROR`,payload:a.message}),a}},joinSect:async(e,t)=>{try{const r=await An.joinSect(e,t),n=await An.getSectById(t);return l({type:Yr.JOIN_SECT,payload:n}),r}catch(r){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u043a\u0442\u0435:",r),l({type:Yr.ADD_NOTIFICATION,payload:{message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0435\u043a\u0442\u0435: "+r.message,type:"error"}}),r}},leaveSect:async e=>{try{return l({type:Yr.LEAVE_SECT}),!0}catch(t){throw console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0432\u044b\u0445\u043e\u0434\u0435 \u0438\u0437 \u0441\u0435\u043a\u0442\u044b:",t),l({type:Yr.ADD_NOTIFICATION,payload:{message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0432\u044b\u0439\u0442\u0438 \u0438\u0437 \u0441\u0435\u043a\u0442\u044b: "+t.message,type:"error"}}),t}},selectSectMember:e=>{l({type:"SELECT_SECT_MEMBER",payload:e})}};return(0,n.useEffect)((()=>{"undefined"!==typeof window&&(window.__GAME_CONTEXT__&&(window.__GAME_CONTEXT__.actions=d),window.__GAME_DISPATCH__=l,window.refreshGameState=()=>{console.log("\ud83d\udd04 \u041f\u0440\u0438\u043d\u0443\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u0433\u0440\u044b");try{const e=new CustomEvent("game-state-updated",{detail:{timestamp:Date.now(),forced:!0}});return window.dispatchEvent(e),window.__GAME_STATE__}catch(e){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f:",e),null}})}),[d,l]),(0,Cn.jsx)(kn.Provider,{value:{state:i,actions:d},children:a})})),Ig=nr.div`
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;
  background: #1a1a1a;
`,Ag=nr.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  background: #111;
  color: #f0f0f0;
  font-family: '"Ma Shan Zheng", cursive';
  font-size: 2rem;
  flex-direction: column;
  text-align: center;
`,Ng=nr.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  background: #111;
  color: #ff6b6b;
  font-family: '"Ma Shan Zheng", cursive';
  font-size: 1.5rem;
  flex-direction: column;
  text-align: center;
  padding: 20px;
`,Dg=nr.h1`
  color: #ff6b6b;
  margin-bottom: 20px;
`,Mg=nr.p`
  margin-bottom: 20px;
`,Rg=nr.button`
  padding: 10px 20px;
  background: #d4af37;
  color: #000;
  border: none;
  border-radius: 4px;
  font-size: 1rem;
  cursor: pointer;
  margin-top: 20px;
  font-weight: bold;
  
  &:hover {
    background: #f4cf47;
  }
`;const Pg=function(){const[e,t]=(0,n.useState)(!0),[r,a]=(0,n.useState)(null),[i,o]=(0,n.useState)(null);(0,n.useEffect)((()=>{const e=function(){const e=navigator.userAgent;let t;return t=e.match(/chrome|chromium|crios/i)?"Chrome":e.match(/firefox|fxios/i)?"Firefox":e.match(/safari/i)?"Safari":e.match(/opr\//i)?"Opera":e.match(/edg/i)?"Edge":"Unknown",t}();if(o(e),console.log("\u041e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d \u0431\u0440\u0430\u0443\u0437\u0435\u0440:",e),"Chrome"===e)try{const e=localStorage.getItem("gameState");if(e)try{const t=JSON.parse(e);t&&"object"===typeof t&&(t.player||(t.player={}),t.player.social||(t.player.social={}),t.player.social.relationships||(t.player.social.relationships={}),t.player.progress||(t.player.progress={}),t.player.progress.discoveries||(t.player.progress.discoveries={}),localStorage.setItem("gameState",JSON.stringify(t)),console.log("\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0441\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u0434\u043b\u044f Chrome"))}catch(n){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f:",n),localStorage.removeItem("gameState"),console.log("\u0423\u0434\u0430\u043b\u0435\u043d\u043e \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u043d\u043e\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435")}}catch(i){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 localStorage:",i)}const r=setTimeout((()=>{try{t(!1)}catch(i){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f:",i),a("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."),t(!1)}}),2e3);return()=>clearTimeout(r)}),[]),(0,n.useEffect)((()=>{!function(){if("undefined"!==typeof window&&(window.add1000ToEverything=()=>{try{var e,t,n;const r=window.__GAME_CONTEXT__||window.gameContext;if(!r||!r.actions)return console.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0430\u0439\u0442\u0438 \u0438\u0433\u0440\u043e\u0432\u043e\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 add1000Currency(), \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u044f\u043c\u043e\u0439 \u0434\u043e\u0441\u0442\u0443\u043f."),"function"===typeof window.add1000Currency&&window.add1000Currency(),!1;null===(e=r.state)||void 0===e||null===(t=e.player)||void 0===t||null===(n=t.inventory)||void 0===n||n.currency;const a={copper:1e3,silver:1e3,gold:1e3,spiritStones:1e3};return r.actions.updateCurrency(a,!0),console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u043e 1000 \u0435\u0434\u0438\u043d\u0438\u0446 \u043a\u0430\u0436\u0434\u043e\u0439 \u0432\u0430\u043b\u044e\u0442\u044b!",a),!0}catch(r){return console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u0432\u0430\u043b\u044e\u0442\u044b:",r),!1}},window.\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c1000\u0412\u0441\u0435\u0433\u043e=window.add1000ToEverything),"undefined"!==typeof window){window.gameDebug=window.gameDebug||{};const e=new ar.default;window.getGameTime=function(){var t,r,n,a;const i=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||ir||window.gameState||(null===(t=window.gameContext)||void 0===t?void 0:t.state);if(!i)return console.warn("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0433\u0440\u044b. \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0435\u0449\u0435 \u043d\u0435 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430."),console.info("\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043d\u043e\u0432\u0430 \u0447\u0435\u0440\u0435\u0437 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0441\u0435\u043a\u0443\u043d\u0434 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0439\u0442\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u044f\u0432\u043d\u043e: getGameTime(yourStateObject)"),null;const o=i.weather||{},s=(null===(r=i.world)||void 0===r?void 0:r.time)||{},l={hour:o.hour||s.hour||12,minute:o.minute||s.minute||0,dayCount:o.dayCount||s.day||1,currentSeason:o.currentSeason||s.season||"spring",seasonDay:o.seasonDay||1,isDayTime:void 0===o.isDayTime||o.isDayTime,nextWeatherChange:o.nextWeatherChange,currentWeather:o.currentWeather||"clear"};return l.daytimePeriod||(l.daytimePeriod=e._getDaytimePeriod(l.hour)),l.daytimeName=(null===(n=e.daytimeEffects)||void 0===n||null===(a=n[l.daytimePeriod])||void 0===a?void 0:a.name)||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e",l.formattedTime=`${l.hour.toString().padStart(2,"0")}:${l.minute.toString().padStart(2,"0")}`,l},window.gameDebug.getTime=window.getGameTime,window.startStateLogging=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3;if(null!==or)return console.warn("\u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0443\u0436\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043e. \u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0435 \u0435\u0433\u043e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e window.stopStateLogging()"),!1;const t=()=>{try{var e,t,n,a,i,o,s,l,c,d,u,p,h,m,f,y,g,v,x,b,w,_,E,T,S,j,C,k,I,A;const r=window.__GAME_STATE__||ir||(null===(e=window.gameContext)||void 0===e?void 0:e.state)||(null===(t=window.__GAME_CONTEXT__)||void 0===t?void 0:t.state);if(!r&&window.__REACT_DEVTOOLS_GLOBAL_HOOK__)try{const e=Array.from(window.__REACT_DEVTOOLS_GLOBAL_HOOK__.renderers.values())[0];if(e&&e._currentFiber){let t=e._currentFiber,r=1e3;for(;t&&r>0;){if(t.type&&("function"===typeof t.type&&"GameContextProvider"===t.type.name||"object"===typeof t.type&&"GameContextProvider"===t.type.displayName)&&t.memoizedState&&t.memoizedState.memoizedState)return console.log("\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 React DevTools"),t.memoizedState.memoizedState;if(t.child)t=t.child;else if(t.sibling)t=t.sibling;else{for(t=t.return;t&&!t.sibling&&r>0;)t=t.return,r--;t&&(t=t.sibling)}r--}}}catch(N){console.debug("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 React DevTools:",N)}if(!r&&document.querySelector("[data-gamestate]"))try{const e=document.querySelector("[data-gamestate]").getAttribute("data-gamestate");if(e)return JSON.parse(e)}catch(D){console.debug("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437 DOM \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b:",D)}if(!r)return console.error("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0433\u0440\u044b \u0434\u043b\u044f \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"),console.info("\u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u0430 \u0438 \u0438\u0433\u0440\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0430"),console.info("\u041c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c window.getGameDebugInfo() \u0434\u043b\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438"),console.group("\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b:"),console.log("window.__GAME_STATE__:",Boolean(window.__GAME_STATE__)),console.log("gameStateRef:",Boolean(ir)),console.log("window.gameContext:",Boolean(window.gameContext)),console.log("window.__GAME_CONTEXT__:",Boolean(window.__GAME_CONTEXT__)),void console.groupEnd();console.group("\ud83c\udfae \u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0433\u0440\u044b:"),console.log("\u23f0 \u0412\u0440\u0435\u043c\u044f:",(new Date).toLocaleTimeString()),console.group("\ud83d\udc64 \u0418\u0433\u0440\u043e\u043a:"),console.log("\u0418\u043c\u044f:",(null===(n=r.player)||void 0===n?void 0:n.name)||"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),console.log("\u0423\u0440\u043e\u0432\u0435\u043d\u044c:",(null===(a=r.player)||void 0===a||null===(i=a.cultivation)||void 0===i?void 0:i.level)||"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445");const M=(null===(o=r.player)||void 0===o||null===(s=o.stats)||void 0===s?void 0:s.health)||100,R=(null===(l=r.player)||void 0===l||null===(c=l.stats)||void 0===c?void 0:c.maxHealth)||100;console.log("\u0417\u0434\u043e\u0440\u043e\u0432\u044c\u0435:",M+"/"+R);const P=(null===(d=r.player)||void 0===d||null===(u=d.stats)||void 0===u?void 0:u.energy)||100,L=(null===(p=r.player)||void 0===p||null===(h=p.stats)||void 0===h?void 0:h.maxEnergy)||100;console.log("\u042d\u043d\u0435\u0440\u0433\u0438\u044f:",P+"/"+L),null!==(m=r.player)&&void 0!==m&&m.statusEffects?Object.keys(r.player.statusEffects).length>0?(console.group("\u0421\u0442\u0430\u0442\u0443\u0441-\u044d\u0444\u0444\u0435\u043a\u0442\u044b:"),Object.entries(r.player.statusEffects).forEach((e=>{let[t,r]=e;console.log(`- ${r.name||t}: ${r.description||"\u041d\u0435\u0442 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f"}`)})),console.groupEnd()):console.log("\u0421\u0442\u0430\u0442\u0443\u0441-\u044d\u0444\u0444\u0435\u043a\u0442\u044b: \u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432"):console.log("\u0421\u0442\u0430\u0442\u0443\u0441-\u044d\u0444\u0444\u0435\u043a\u0442\u044b: \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),console.groupEnd(),console.group("\ud83c\udf0d \u0418\u0433\u0440\u043e\u0432\u043e\u0439 \u043c\u0438\u0440:"),console.log("\u041b\u043e\u043a\u0430\u0446\u0438\u044f:",(null===(f=r.world)||void 0===f||null===(y=f.currentLocation)||void 0===y?void 0:y.name)||"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),console.log("\u041f\u043e\u0433\u043e\u0434\u0430:",(null===(g=r.weather)||void 0===g?void 0:g.currentWeather)||"\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445");const $=(null===(v=r.weather)||void 0===v?void 0:v.hour)||(null===(x=r.world)||void 0===x||null===(b=x.time)||void 0===b?void 0:b.hour)||0,O=(null===(w=r.weather)||void 0===w?void 0:w.minute)||(null===(_=r.world)||void 0===_||null===(E=_.time)||void 0===E?void 0:E.minute)||0;console.log("\u0412\u0440\u0435\u043c\u044f:",`${$}:${String(O).padStart(2,"0")}`);const q=(null===(T=r.weather)||void 0===T?void 0:T.dayCount)||(null===(S=r.world)||void 0===S||null===(j=S.time)||void 0===j?void 0:j.day)||1,U=(null===(C=r.weather)||void 0===C?void 0:C.currentSeason)||(null===(k=r.world)||void 0===k||null===(I=k.time)||void 0===I?void 0:I.season)||"spring";console.log("\u0414\u0435\u043d\u044c:",`${q} (\u0441\u0435\u0437\u043e\u043d: ${U})`),null!==(A=r.weather)&&void 0!==A&&A.weatherEffects?(console.group("\u041f\u043e\u0433\u043e\u0434\u043d\u044b\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b:"),Array.isArray(r.weather.weatherEffects)?r.weather.weatherEffects.length>0?r.weather.weatherEffects.forEach(((e,t)=>{console.log(`- \u042d\u0444\u0444\u0435\u043a\u0442 ${t+1}:`,e)})):console.log("\u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u043f\u043e\u0433\u043e\u0434\u043d\u044b\u0445 \u044d\u0444\u0444\u0435\u043a\u0442\u043e\u0432"):"object"===typeof r.weather.weatherEffects?Object.entries(r.weather.weatherEffects).forEach((e=>{let[t,r]=e;console.log(`- ${t}:`,r)})):console.log(r.weather.weatherEffects),console.groupEnd()):console.log("\u041f\u043e\u0433\u043e\u0434\u043d\u044b\u0435 \u044d\u0444\u0444\u0435\u043a\u0442\u044b: \u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),console.groupEnd(),console.group("\ud83d\udd0d \u041f\u043e\u043b\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435:"),console.group("\u0418\u0433\u0440\u043e\u043a (state.player):"),r.player?Object.keys(r.player).forEach((e=>{console.log(`- ${e}:`,r.player[e])})):console.log("\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),console.groupEnd(),console.group("\u041c\u0438\u0440 (state.world):"),r.world?Object.keys(r.world).forEach((e=>{console.log(`- ${e}:`,r.world[e])})):console.log("\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),console.groupEnd(),console.group("\u041f\u043e\u0433\u043e\u0434\u0430 (state.weather):"),r.weather?Object.keys(r.weather).forEach((e=>{console.log(`- ${e}:`,r.weather[e])})):console.log("\u041d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445"),console.groupEnd(),console.log("\u041f\u043e\u043b\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435:",r),console.groupEnd(),console.groupEnd(),window.__LAST_LOGGED_STATE__=r}catch(r){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f:",r)}};return or=setInterval(t,e),t(),console.info(`\u2705 \u0417\u0430\u043f\u0443\u0449\u0435\u043d\u043e \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u0433\u0440\u044b \u043a\u0430\u0436\u0434\u044b\u0435 ${e/1e3} \u0441\u0435\u043a\u0443\u043d\u0434. \u0414\u043b\u044f \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 window.stopStateLogging()`),!0},window.stopStateLogging=()=>null===or?(console.warn("\u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u043d\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u043e"),!1):(clearInterval(or),or=null,console.info("\u2705 \u041b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u0433\u0440\u044b \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e"),!0),window.getLastLoggedState=()=>window.__LAST_LOGGED_STATE__?window.__LAST_LOGGED_STATE__:(console.warn("\u041d\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0433\u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f. \u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e window.startStateLogging()"),null),window.getGameDebugInfo=()=>{const e={globalGameState:Boolean(window.__GAME_STATE__),gameStateRef:Boolean(ir),gameContext:Boolean(window.gameContext)||Boolean(window.__GAME_CONTEXT__),lastLoggedState:Boolean(window.__LAST_LOGGED_STATE__),reactDevTools:Boolean(window.__REACT_DEVTOOLS_GLOBAL_HOOK__),browser:navigator.userAgent,time:(new Date).toISOString()};return console.group("\ud83d\udee0\ufe0f \u041e\u0442\u043b\u0430\u0434\u043e\u0447\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0438\u0433\u0440\u044b:"),console.log("- \u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 (__GAME_STATE__):",e.globalGameState),console.log("- \u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 (gameStateRef):",e.gameStateRef),console.log("- \u0418\u0433\u0440\u043e\u0432\u043e\u0439 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 (gameContext):",e.gameContext),console.log("- \u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435:",e.lastLoggedState),console.log("- React DevTools:",e.reactDevTools),console.log("- \u0411\u0440\u0430\u0443\u0437\u0435\u0440:",e.browser),console.log("- \u0412\u0440\u0435\u043c\u044f:",e.time),console.groupEnd(),e},console.info("\ud83d\udee0\ufe0f \u0418\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442\u044b \u043e\u0442\u043b\u0430\u0434\u043a\u0438 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b. \u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438:"),console.info("\u2022 window.getGameTime() - \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0438\u0433\u0440\u043e\u0432\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438"),console.info("\u2022 window.gameDebug.getTime() - \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438"),console.info("\u2022 window.add1000ToEverything() - \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c 1000 \u0435\u0434\u0438\u043d\u0438\u0446 \u043a\u0430\u0436\u0434\u043e\u0439 \u0432\u0430\u043b\u044e\u0442\u044b"),console.info("\u2022 window.\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c1000\u0412\u0441\u0435\u0433\u043e() - \u0442\u043e \u0436\u0435 \u0441\u0430\u043c\u043e\u0435 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c"),console.info("\u2022 window.add1000Currency() - \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432\u0430\u043b\u044e\u0442\u044b"),console.info("\u2022 window.\u0434\u0430\u0442\u044c1000\u0420\u0435\u0441\u0443\u0440\u0441\u043e\u0432() - \u0442\u043e \u0436\u0435 \u0441\u0430\u043c\u043e\u0435 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u043e\u043c"),console.info("\u2022 window.startStateLogging(interval) - \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0432\u044b\u0432\u043e\u0434 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u0433\u0440\u044b \u043a\u0430\u0436\u0434\u044b\u0435 3 \u0441\u0435\u043a\u0443\u043d\u0434\u044b"),console.info("\u2022 window.stopStateLogging() - \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0432\u044b\u0432\u043e\u0434 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u044f \u0438\u0433\u0440\u044b"),console.info("\u2022 window.getLastLoggedState() - \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435 \u0437\u0430\u043b\u043e\u0433\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435"),console.info("\u2022 window.getGameDebugInfo() - \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043e\u0442\u043b\u0430\u0434\u043e\u0447\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e\u0441\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0433\u0440\u044b")}}(),"undefined"!==typeof window&&(window.showTimeHelp=()=>{console.group("\ud83d\udd52 \u041a\u0430\u043a \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0441\u0443\u0442\u043e\u043a:"),console.log("1. \u0412 \u043a\u043e\u043d\u0441\u043e\u043b\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u0443: getGameTime()"),console.log("2. \u042d\u0442\u043e \u0432\u044b\u0432\u0435\u0434\u0435\u0442 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u0438\u0433\u0440\u043e\u0432\u043e\u043c \u0432\u0440\u0435\u043c\u0435\u043d\u0438"),console.log("3. \u0410\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u044b\u0439 \u0441\u043f\u043e\u0441\u043e\u0431: gameDebug.getTime()"),console.log("4. \u0414\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u0447\u0430\u0441\u0430 \u0438 \u043c\u0438\u043d\u0443\u0442\u044b: getGameTime().formattedTime"),console.log("5. \u0414\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u043f\u0435\u0440\u0438\u043e\u0434\u0430 \u0441\u0443\u0442\u043e\u043a: getGameTime().daytimeName"),console.groupEnd()},setTimeout((()=>{console.info("\ud83d\udca1 \u0414\u043b\u044f \u043f\u043e\u043c\u043e\u0449\u0438 \u043f\u043e \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044e \u0438\u0433\u0440\u043e\u0432\u043e\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435: showTimeHelp()")}),3e3))}),[]);const s=()=>{window.location.reload()};return e?(0,Cn.jsxs)(Ag,{children:[(0,Cn.jsx)("h1",{children:"\u041f\u0443\u0442\u044c \u043a \u0411\u0435\u0441\u0441\u043c\u0435\u0440\u0442\u0438\u044e"}),(0,Cn.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u043c\u0438\u0440\u0430 \u043a\u0443\u043b\u044c\u0442\u0438\u0432\u0430\u0446\u0438\u0438..."}),i&&(0,Cn.jsxs)("p",{style:{fontSize:"1rem",marginTop:"10px"},children:["\u0411\u0440\u0430\u0443\u0437\u0435\u0440: ",i]})]}):r?(0,Cn.jsxs)(Ng,{children:[(0,Cn.jsx)(Dg,{children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438"}),(0,Cn.jsx)(Mg,{children:r}),i&&(0,Cn.jsxs)("p",{children:["\u0411\u0440\u0430\u0443\u0437\u0435\u0440: ",i]}),(0,Cn.jsx)(Rg,{onClick:s,children:"\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0441\u043d\u043e\u0432\u0430"})]}):(0,Cn.jsxs)(kg,{children:[(0,Cn.jsx)(Cg,{debug:!0}),(0,Cn.jsx)(Hn,{enabled:!0}),(0,Cn.jsx)(we,{children:(0,Cn.jsx)(Ig,{children:(0,Cn.jsxs)(ve,{children:[(0,Cn.jsx)(ye,{path:"/",element:(0,Cn.jsx)(ia,{})}),(0,Cn.jsx)(ye,{path:"/character-creation",element:(0,Cn.jsx)(Ta,{})}),(0,Cn.jsx)(ye,{path:"/game",element:(0,Cn.jsx)(Sg,{})})]})})})]})};(0,i.H)(document.getElementById("root")).render((0,Cn.jsx)(n.StrictMode,{children:(0,Cn.jsx)(Pg,{})}))})()})();
//# sourceMappingURL=main.6197578b.js.map