# üêå –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã —Å chown –≤ Dockerfile

## üìä –†–∞–∑–º–µ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ñ–∞–π–ª–æ–≤:

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ):
- **src/**: ~500+ —Ñ–∞–π–ª–æ–≤ JavaScript
- **public/assets/**: ~100+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤  
- **sql/**: ~50+ SQL —Ñ–∞–π–ª–æ–≤
- **docs/**: ~20+ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **node_modules/**: ~50,000+ —Ñ–∞–π–ª–æ–≤ (–ø–æ—Å–ª–µ npm install)
- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä**: ~200-500 –ú–ë

### –ü—Ä–æ–±–ª–µ–º–∞ —Å chown

–ö–æ–º–∞–Ω–¥–∞ `RUN chown -R appuser:appuser /app` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
- –í—Å–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ (~50,000+ —Ñ–∞–π–ª–æ–≤)
- –ù–∞ –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏ –≥—Ä—É–ø–ø—É
- –û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ

## ‚è±Ô∏è –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ù–∞ –º–∞—à–∏–Ω–µ —Å 4 CPU:
- **–û–±—ã—á–Ω–æ**: 5-15 –º–∏–Ω—É—Ç –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ —Ç–∞–∫–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- **–í —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ**: 20-30 –º–∏–Ω—É—Ç
- **–§–∞–∫—Ç–æ—Ä—ã –≤–ª–∏—è–Ω–∏—è**:
  - –°–∫–æ—Ä–æ—Å—Ç—å –¥–∏—Å–∫–∞ (SSD vs HDD)
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ node_modules
  - –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã

### –ü–æ—á–µ–º—É —Ç–∞–∫ –¥–æ–ª–≥–æ:
1. **chown** - —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞
2. **–†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –≤—Å–µ—Ö –ø–æ–¥–ø–∞–ø–æ–∫
3. **node_modules** —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Å—è—Ç–∫–∏ —Ç—ã—Å—è—á –º–µ–ª–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
4. **Docker layer** —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–æ –≤—Å–µ–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

## üöÄ –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –£–±—Ä–∞—Ç—å chown (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
```dockerfile
# –£–±—Ä–∞—Ç—å —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏:
# RUN groupadd -r appuser && useradd -r -g appuser appuser
# RUN chown -R appuser:appuser /app
# USER appuser
```

### –†–µ—à–µ–Ω–∏–µ 2: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å chown
```dockerfile
# –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
RUN groupadd -r appuser && useradd -r -g appuser appuser
USER appuser
# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã —É–∂–µ –ø–æ–¥ –Ω—É–∂–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
COPY --chown=appuser:appuser . .
```

### –†–µ—à–µ–Ω–∏–µ 3: –ò—Å–∫–ª—é—á–∏—Ç—å node_modules
```dockerfile
# –í .dockerignore –¥–æ–±–∞–≤–∏—Ç—å:
node_modules
# –¢–æ–≥–¥–∞ chown –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä–µ–µ
```

## ‚ö° –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–°–∞–º–æ–µ –±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ - —É–±—Ä–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```dockerfile
# –ù–æ–≤—ã–π –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Dockerfile –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
FROM node:18-bullseye-slim

WORKDIR /app

RUN apt-get update && apt-get install -y \
    git \
    curl \
    && rm -rf /var/lib/apt/lists/* \
    && apt-get clean

COPY package*.json ./
RUN npm ci --only=production=false --silent

COPY . .

# –£–ë–†–ê–õ–ò —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
# RUN groupadd -r appuser && useradd -r -g appuser appuser
# RUN chown -R appuser:appuser /app
# USER appuser

EXPOSE 80 3001

ENV NODE_ENV=development
ENV CHOKIDAR_USEPOLLING=true
ENV WATCHPACK_POLLING=true
ENV GENERATE_SOURCEMAP=false
ENV SKIP_PREFLIGHT_CHECK=true
ENV FAST_REFRESH=true
ENV CI=false

CMD ["npm", "run", "dev"]
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** - —É–±—Ä–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ª–Ω–æ—Å—Ç—å—é. –≠—Ç–æ:
- ‚úÖ –£—Å–∫–æ—Ä–∏—Ç —Å–±–æ—Ä–∫—É –≤ 10+ —Ä–∞–∑
- ‚úÖ –£–ø—Ä–æ—Å—Ç–∏—Ç –æ—Ç–ª–∞–¥–∫—É
- ‚úÖ –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ dev-—Å—Ä–µ–¥–µ

**–î–ª—è production** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `COPY --chown=user:group` –≤–º–µ—Å—Ç–æ `RUN chown`

–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è —Å —Ç–µ–∫—É—â–∏–º Dockerfile: **15-30 –º–∏–Ω—É—Ç**
–í—Ä–µ–º—è —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º Dockerfile: **2-5 –º–∏–Ω—É—Ç**